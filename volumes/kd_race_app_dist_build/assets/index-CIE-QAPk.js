(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=t(n);fetch(n.href,s)}})();var zs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function uf(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function G1(r){if(r.__esModule)return r;var e=r.default;if(typeof e=="function"){var t=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(i){var n=Object.getOwnPropertyDescriptor(r,i);Object.defineProperty(t,i,n.get?n:{enumerable:!0,get:function(){return r[i]}})}),t}var i0={exports:{}},Jl={},n0={exports:{}},te={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Po=Symbol.for("react.element"),H1=Symbol.for("react.portal"),$1=Symbol.for("react.fragment"),z1=Symbol.for("react.strict_mode"),V1=Symbol.for("react.profiler"),X1=Symbol.for("react.provider"),j1=Symbol.for("react.context"),W1=Symbol.for("react.forward_ref"),Y1=Symbol.for("react.suspense"),q1=Symbol.for("react.memo"),K1=Symbol.for("react.lazy"),Ap=Symbol.iterator;function Z1(r){return r===null||typeof r!="object"?null:(r=Ap&&r[Ap]||r["@@iterator"],typeof r=="function"?r:null)}var s0={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},o0=Object.assign,a0={};function us(r,e,t){this.props=r,this.context=e,this.refs=a0,this.updater=t||s0}us.prototype.isReactComponent={};us.prototype.setState=function(r,e){if(typeof r!="object"&&typeof r!="function"&&r!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,r,e,"setState")};us.prototype.forceUpdate=function(r){this.updater.enqueueForceUpdate(this,r,"forceUpdate")};function l0(){}l0.prototype=us.prototype;function hf(r,e,t){this.props=r,this.context=e,this.refs=a0,this.updater=t||s0}var cf=hf.prototype=new l0;cf.constructor=hf;o0(cf,us.prototype);cf.isPureReactComponent=!0;var bp=Array.isArray,u0=Object.prototype.hasOwnProperty,df={current:null},h0={key:!0,ref:!0,__self:!0,__source:!0};function c0(r,e,t){var i,n={},s=null,o=null;if(e!=null)for(i in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)u0.call(e,i)&&!h0.hasOwnProperty(i)&&(n[i]=e[i]);var a=arguments.length-2;if(a===1)n.children=t;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];n.children=l}if(r&&r.defaultProps)for(i in a=r.defaultProps,a)n[i]===void 0&&(n[i]=a[i]);return{$$typeof:Po,type:r,key:s,ref:o,props:n,_owner:df.current}}function Q1(r,e){return{$$typeof:Po,type:r.type,key:e,ref:r.ref,props:r.props,_owner:r._owner}}function ff(r){return typeof r=="object"&&r!==null&&r.$$typeof===Po}function J1(r){var e={"=":"=0",":":"=2"};return"$"+r.replace(/[=:]/g,function(t){return e[t]})}var Cp=/\/+/g;function Du(r,e){return typeof r=="object"&&r!==null&&r.key!=null?J1(""+r.key):e.toString(36)}function Ba(r,e,t,i,n){var s=typeof r;(s==="undefined"||s==="boolean")&&(r=null);var o=!1;if(r===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(r.$$typeof){case Po:case H1:o=!0}}if(o)return o=r,n=n(o),r=i===""?"."+Du(o,0):i,bp(n)?(t="",r!=null&&(t=r.replace(Cp,"$&/")+"/"),Ba(n,e,t,"",function(u){return u})):n!=null&&(ff(n)&&(n=Q1(n,t+(!n.key||o&&o.key===n.key?"":(""+n.key).replace(Cp,"$&/")+"/")+r)),e.push(n)),1;if(o=0,i=i===""?".":i+":",bp(r))for(var a=0;a<r.length;a++){s=r[a];var l=i+Du(s,a);o+=Ba(s,e,t,l,n)}else if(l=Z1(r),typeof l=="function")for(r=l.call(r),a=0;!(s=r.next()).done;)s=s.value,l=i+Du(s,a++),o+=Ba(s,e,t,l,n);else if(s==="object")throw e=String(r),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function zo(r,e,t){if(r==null)return r;var i=[],n=0;return Ba(r,i,"","",function(s){return e.call(t,s,n++)}),i}function ew(r){if(r._status===-1){var e=r._result;e=e(),e.then(function(t){(r._status===0||r._status===-1)&&(r._status=1,r._result=t)},function(t){(r._status===0||r._status===-1)&&(r._status=2,r._result=t)}),r._status===-1&&(r._status=0,r._result=e)}if(r._status===1)return r._result.default;throw r._result}var ot={current:null},La={transition:null},tw={ReactCurrentDispatcher:ot,ReactCurrentBatchConfig:La,ReactCurrentOwner:df};function d0(){throw Error("act(...) is not supported in production builds of React.")}te.Children={map:zo,forEach:function(r,e,t){zo(r,function(){e.apply(this,arguments)},t)},count:function(r){var e=0;return zo(r,function(){e++}),e},toArray:function(r){return zo(r,function(e){return e})||[]},only:function(r){if(!ff(r))throw Error("React.Children.only expected to receive a single React element child.");return r}};te.Component=us;te.Fragment=$1;te.Profiler=V1;te.PureComponent=hf;te.StrictMode=z1;te.Suspense=Y1;te.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tw;te.act=d0;te.cloneElement=function(r,e,t){if(r==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+r+".");var i=o0({},r.props),n=r.key,s=r.ref,o=r._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=df.current),e.key!==void 0&&(n=""+e.key),r.type&&r.type.defaultProps)var a=r.type.defaultProps;for(l in e)u0.call(e,l)&&!h0.hasOwnProperty(l)&&(i[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)i.children=t;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];i.children=a}return{$$typeof:Po,type:r.type,key:n,ref:s,props:i,_owner:o}};te.createContext=function(r){return r={$$typeof:j1,_currentValue:r,_currentValue2:r,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},r.Provider={$$typeof:X1,_context:r},r.Consumer=r};te.createElement=c0;te.createFactory=function(r){var e=c0.bind(null,r);return e.type=r,e};te.createRef=function(){return{current:null}};te.forwardRef=function(r){return{$$typeof:W1,render:r}};te.isValidElement=ff;te.lazy=function(r){return{$$typeof:K1,_payload:{_status:-1,_result:r},_init:ew}};te.memo=function(r,e){return{$$typeof:q1,type:r,compare:e===void 0?null:e}};te.startTransition=function(r){var e=La.transition;La.transition={};try{r()}finally{La.transition=e}};te.unstable_act=d0;te.useCallback=function(r,e){return ot.current.useCallback(r,e)};te.useContext=function(r){return ot.current.useContext(r)};te.useDebugValue=function(){};te.useDeferredValue=function(r){return ot.current.useDeferredValue(r)};te.useEffect=function(r,e){return ot.current.useEffect(r,e)};te.useId=function(){return ot.current.useId()};te.useImperativeHandle=function(r,e,t){return ot.current.useImperativeHandle(r,e,t)};te.useInsertionEffect=function(r,e){return ot.current.useInsertionEffect(r,e)};te.useLayoutEffect=function(r,e){return ot.current.useLayoutEffect(r,e)};te.useMemo=function(r,e){return ot.current.useMemo(r,e)};te.useReducer=function(r,e,t){return ot.current.useReducer(r,e,t)};te.useRef=function(r){return ot.current.useRef(r)};te.useState=function(r){return ot.current.useState(r)};te.useSyncExternalStore=function(r,e,t){return ot.current.useSyncExternalStore(r,e,t)};te.useTransition=function(){return ot.current.useTransition()};te.version="18.3.1";n0.exports=te;var ue=n0.exports;const rw=uf(ue);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iw=ue,nw=Symbol.for("react.element"),sw=Symbol.for("react.fragment"),ow=Object.prototype.hasOwnProperty,aw=iw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,lw={key:!0,ref:!0,__self:!0,__source:!0};function f0(r,e,t){var i,n={},s=null,o=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(i in e)ow.call(e,i)&&!lw.hasOwnProperty(i)&&(n[i]=e[i]);if(r&&r.defaultProps)for(i in e=r.defaultProps,e)n[i]===void 0&&(n[i]=e[i]);return{$$typeof:nw,type:r,key:s,ref:o,props:n,_owner:aw.current}}Jl.Fragment=sw;Jl.jsx=f0;Jl.jsxs=f0;i0.exports=Jl;var Pe=i0.exports,uc={},p0={exports:{}},Et={},m0={exports:{}},g0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(r){function e(P,G){var R=P.length;P.push(G);e:for(;0<R;){var M=R-1>>>1,j=P[M];if(0<n(j,G))P[M]=G,P[R]=j,R=M;else break e}}function t(P){return P.length===0?null:P[0]}function i(P){if(P.length===0)return null;var G=P[0],R=P.pop();if(R!==G){P[0]=R;e:for(var M=0,j=P.length,Q=j>>>1;M<Q;){var J=2*(M+1)-1,fe=P[J],oe=J+1,he=P[oe];if(0>n(fe,R))oe<j&&0>n(he,fe)?(P[M]=he,P[oe]=R,M=oe):(P[M]=fe,P[J]=R,M=J);else if(oe<j&&0>n(he,R))P[M]=he,P[oe]=R,M=oe;else break e}}return G}function n(P,G){var R=P.sortIndex-G.sortIndex;return R!==0?R:P.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;r.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();r.unstable_now=function(){return o.now()-a}}var l=[],u=[],h=1,d=null,c=3,f=!1,p=!1,v=!1,x=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function m(P){for(var G=t(u);G!==null;){if(G.callback===null)i(u);else if(G.startTime<=P)i(u),G.sortIndex=G.expirationTime,e(l,G);else break;G=t(u)}}function _(P){if(v=!1,m(P),!p)if(t(l)!==null)p=!0,Y(w);else{var G=t(u);G!==null&&$(_,G.startTime-P)}}function w(P,G){p=!1,v&&(v=!1,g(T),T=-1),f=!0;var R=c;try{for(m(G),d=t(l);d!==null&&(!(d.expirationTime>G)||P&&!I());){var M=d.callback;if(typeof M=="function"){d.callback=null,c=d.priorityLevel;var j=M(d.expirationTime<=G);G=r.unstable_now(),typeof j=="function"?d.callback=j:d===t(l)&&i(l),m(G)}else i(l);d=t(l)}if(d!==null)var Q=!0;else{var J=t(u);J!==null&&$(_,J.startTime-G),Q=!1}return Q}finally{d=null,c=R,f=!1}}var S=!1,E=null,T=-1,b=5,A=-1;function I(){return!(r.unstable_now()-A<b)}function D(){if(E!==null){var P=r.unstable_now();A=P;var G=!0;try{G=E(!0,P)}finally{G?C():(S=!1,E=null)}}else S=!1}var C;if(typeof y=="function")C=function(){y(D)};else if(typeof MessageChannel<"u"){var k=new MessageChannel,L=k.port2;k.port1.onmessage=D,C=function(){L.postMessage(null)}}else C=function(){x(D,0)};function Y(P){E=P,S||(S=!0,C())}function $(P,G){T=x(function(){P(r.unstable_now())},G)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(P){P.callback=null},r.unstable_continueExecution=function(){p||f||(p=!0,Y(w))},r.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):b=0<P?Math.floor(1e3/P):5},r.unstable_getCurrentPriorityLevel=function(){return c},r.unstable_getFirstCallbackNode=function(){return t(l)},r.unstable_next=function(P){switch(c){case 1:case 2:case 3:var G=3;break;default:G=c}var R=c;c=G;try{return P()}finally{c=R}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(P,G){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var R=c;c=P;try{return G()}finally{c=R}},r.unstable_scheduleCallback=function(P,G,R){var M=r.unstable_now();switch(typeof R=="object"&&R!==null?(R=R.delay,R=typeof R=="number"&&0<R?M+R:M):R=M,P){case 1:var j=-1;break;case 2:j=250;break;case 5:j=1073741823;break;case 4:j=1e4;break;default:j=5e3}return j=R+j,P={id:h++,callback:G,priorityLevel:P,startTime:R,expirationTime:j,sortIndex:-1},R>M?(P.sortIndex=R,e(u,P),t(l)===null&&P===t(u)&&(v?(g(T),T=-1):v=!0,$(_,R-M))):(P.sortIndex=j,e(l,P),p||f||(p=!0,Y(w))),P},r.unstable_shouldYield=I,r.unstable_wrapCallback=function(P){var G=c;return function(){var R=c;c=G;try{return P.apply(this,arguments)}finally{c=R}}}})(g0);m0.exports=g0;var uw=m0.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hw=ue,wt=uw;function N(r){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+r,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+r+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var y0=new Set,so={};function sn(r,e){Jn(r,e),Jn(r+"Capture",e)}function Jn(r,e){for(so[r]=e,r=0;r<e.length;r++)y0.add(e[r])}var Fr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),hc=Object.prototype.hasOwnProperty,cw=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Rp={},Ip={};function dw(r){return hc.call(Ip,r)?!0:hc.call(Rp,r)?!1:cw.test(r)?Ip[r]=!0:(Rp[r]=!0,!1)}function fw(r,e,t,i){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:t!==null?!t.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function pw(r,e,t,i){if(e===null||typeof e>"u"||fw(r,e,t,i))return!0;if(i)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function at(r,e,t,i,n,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=n,this.mustUseProperty=t,this.propertyName=r,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Qe={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){Qe[r]=new at(r,0,!1,r,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var e=r[0];Qe[e]=new at(e,1,!1,r[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(r){Qe[r]=new at(r,2,!1,r.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){Qe[r]=new at(r,2,!1,r,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){Qe[r]=new at(r,3,!1,r.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(r){Qe[r]=new at(r,3,!0,r,null,!1,!1)});["capture","download"].forEach(function(r){Qe[r]=new at(r,4,!1,r,null,!1,!1)});["cols","rows","size","span"].forEach(function(r){Qe[r]=new at(r,6,!1,r,null,!1,!1)});["rowSpan","start"].forEach(function(r){Qe[r]=new at(r,5,!1,r.toLowerCase(),null,!1,!1)});var pf=/[\-:]([a-z])/g;function mf(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var e=r.replace(pf,mf);Qe[e]=new at(e,1,!1,r,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var e=r.replace(pf,mf);Qe[e]=new at(e,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(r){var e=r.replace(pf,mf);Qe[e]=new at(e,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(r){Qe[r]=new at(r,1,!1,r.toLowerCase(),null,!1,!1)});Qe.xlinkHref=new at("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(r){Qe[r]=new at(r,1,!1,r.toLowerCase(),null,!0,!0)});function gf(r,e,t,i){var n=Qe.hasOwnProperty(e)?Qe[e]:null;(n!==null?n.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(pw(e,t,n,i)&&(t=null),i||n===null?dw(e)&&(t===null?r.removeAttribute(e):r.setAttribute(e,""+t)):n.mustUseProperty?r[n.propertyName]=t===null?n.type===3?!1:"":t:(e=n.attributeName,i=n.attributeNamespace,t===null?r.removeAttribute(e):(n=n.type,t=n===3||n===4&&t===!0?"":""+t,i?r.setAttributeNS(i,e,t):r.setAttribute(e,t))))}var Vr=hw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Vo=Symbol.for("react.element"),An=Symbol.for("react.portal"),bn=Symbol.for("react.fragment"),yf=Symbol.for("react.strict_mode"),cc=Symbol.for("react.profiler"),v0=Symbol.for("react.provider"),_0=Symbol.for("react.context"),vf=Symbol.for("react.forward_ref"),dc=Symbol.for("react.suspense"),fc=Symbol.for("react.suspense_list"),_f=Symbol.for("react.memo"),Kr=Symbol.for("react.lazy"),x0=Symbol.for("react.offscreen"),Pp=Symbol.iterator;function ys(r){return r===null||typeof r!="object"?null:(r=Pp&&r[Pp]||r["@@iterator"],typeof r=="function"?r:null)}var be=Object.assign,Nu;function ks(r){if(Nu===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);Nu=e&&e[1]||""}return`
`+Nu+r}var Ou=!1;function Bu(r,e){if(!r||Ou)return"";Ou=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var i=u}Reflect.construct(r,[],e)}else{try{e.call()}catch(u){i=u}r.call(e.prototype)}else{try{throw Error()}catch(u){i=u}r()}}catch(u){if(u&&i&&typeof u.stack=="string"){for(var n=u.stack.split(`
`),s=i.stack.split(`
`),o=n.length-1,a=s.length-1;1<=o&&0<=a&&n[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(n[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||n[o]!==s[a]){var l=`
`+n[o].replace(" at new "," at ");return r.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",r.displayName)),l}while(1<=o&&0<=a);break}}}finally{Ou=!1,Error.prepareStackTrace=t}return(r=r?r.displayName||r.name:"")?ks(r):""}function mw(r){switch(r.tag){case 5:return ks(r.type);case 16:return ks("Lazy");case 13:return ks("Suspense");case 19:return ks("SuspenseList");case 0:case 2:case 15:return r=Bu(r.type,!1),r;case 11:return r=Bu(r.type.render,!1),r;case 1:return r=Bu(r.type,!0),r;default:return""}}function pc(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case bn:return"Fragment";case An:return"Portal";case cc:return"Profiler";case yf:return"StrictMode";case dc:return"Suspense";case fc:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case _0:return(r.displayName||"Context")+".Consumer";case v0:return(r._context.displayName||"Context")+".Provider";case vf:var e=r.render;return r=r.displayName,r||(r=e.displayName||e.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case _f:return e=r.displayName||null,e!==null?e:pc(r.type)||"Memo";case Kr:e=r._payload,r=r._init;try{return pc(r(e))}catch{}}return null}function gw(r){var e=r.type;switch(r.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=e.render,r=r.displayName||r.name||"",e.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return pc(e);case 8:return e===yf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function yi(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function w0(r){var e=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function yw(r){var e=w0(r)?"checked":"value",t=Object.getOwnPropertyDescriptor(r.constructor.prototype,e),i=""+r[e];if(!r.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var n=t.get,s=t.set;return Object.defineProperty(r,e,{configurable:!0,get:function(){return n.call(this)},set:function(o){i=""+o,s.call(this,o)}}),Object.defineProperty(r,e,{enumerable:t.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){r._valueTracker=null,delete r[e]}}}}function Xo(r){r._valueTracker||(r._valueTracker=yw(r))}function E0(r){if(!r)return!1;var e=r._valueTracker;if(!e)return!0;var t=e.getValue(),i="";return r&&(i=w0(r)?r.checked?"true":"false":r.value),r=i,r!==t?(e.setValue(r),!0):!1}function ul(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function mc(r,e){var t=e.checked;return be({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??r._wrapperState.initialChecked})}function kp(r,e){var t=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;t=yi(e.value!=null?e.value:t),r._wrapperState={initialChecked:i,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function T0(r,e){e=e.checked,e!=null&&gf(r,"checked",e,!1)}function gc(r,e){T0(r,e);var t=yi(e.value),i=e.type;if(t!=null)i==="number"?(t===0&&r.value===""||r.value!=t)&&(r.value=""+t):r.value!==""+t&&(r.value=""+t);else if(i==="submit"||i==="reset"){r.removeAttribute("value");return}e.hasOwnProperty("value")?yc(r,e.type,t):e.hasOwnProperty("defaultValue")&&yc(r,e.type,yi(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(r.defaultChecked=!!e.defaultChecked)}function Mp(r,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+r._wrapperState.initialValue,t||e===r.value||(r.value=e),r.defaultValue=e}t=r.name,t!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,t!==""&&(r.name=t)}function yc(r,e,t){(e!=="number"||ul(r.ownerDocument)!==r)&&(t==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+t&&(r.defaultValue=""+t))}var Ms=Array.isArray;function Un(r,e,t,i){if(r=r.options,e){e={};for(var n=0;n<t.length;n++)e["$"+t[n]]=!0;for(t=0;t<r.length;t++)n=e.hasOwnProperty("$"+r[t].value),r[t].selected!==n&&(r[t].selected=n),n&&i&&(r[t].defaultSelected=!0)}else{for(t=""+yi(t),e=null,n=0;n<r.length;n++){if(r[n].value===t){r[n].selected=!0,i&&(r[n].defaultSelected=!0);return}e!==null||r[n].disabled||(e=r[n])}e!==null&&(e.selected=!0)}}function vc(r,e){if(e.dangerouslySetInnerHTML!=null)throw Error(N(91));return be({},e,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function Dp(r,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(N(92));if(Ms(t)){if(1<t.length)throw Error(N(93));t=t[0]}e=t}e==null&&(e=""),t=e}r._wrapperState={initialValue:yi(t)}}function S0(r,e){var t=yi(e.value),i=yi(e.defaultValue);t!=null&&(t=""+t,t!==r.value&&(r.value=t),e.defaultValue==null&&r.defaultValue!==t&&(r.defaultValue=t)),i!=null&&(r.defaultValue=""+i)}function Np(r){var e=r.textContent;e===r._wrapperState.initialValue&&e!==""&&e!==null&&(r.value=e)}function A0(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function _c(r,e){return r==null||r==="http://www.w3.org/1999/xhtml"?A0(e):r==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var jo,b0=function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,i,n){MSApp.execUnsafeLocalFunction(function(){return r(e,t,i,n)})}:r}(function(r,e){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=e;else{for(jo=jo||document.createElement("div"),jo.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=jo.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;e.firstChild;)r.appendChild(e.firstChild)}});function oo(r,e){if(e){var t=r.firstChild;if(t&&t===r.lastChild&&t.nodeType===3){t.nodeValue=e;return}}r.textContent=e}var Vs={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},vw=["Webkit","ms","Moz","O"];Object.keys(Vs).forEach(function(r){vw.forEach(function(e){e=e+r.charAt(0).toUpperCase()+r.substring(1),Vs[e]=Vs[r]})});function C0(r,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||Vs.hasOwnProperty(r)&&Vs[r]?(""+e).trim():e+"px"}function R0(r,e){r=r.style;for(var t in e)if(e.hasOwnProperty(t)){var i=t.indexOf("--")===0,n=C0(t,e[t],i);t==="float"&&(t="cssFloat"),i?r.setProperty(t,n):r[t]=n}}var _w=be({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function xc(r,e){if(e){if(_w[r]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(N(137,r));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(N(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(N(61))}if(e.style!=null&&typeof e.style!="object")throw Error(N(62))}}function wc(r,e){if(r.indexOf("-")===-1)return typeof e.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ec=null;function xf(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Tc=null,Gn=null,Hn=null;function Op(r){if(r=Do(r)){if(typeof Tc!="function")throw Error(N(280));var e=r.stateNode;e&&(e=nu(e),Tc(r.stateNode,r.type,e))}}function I0(r){Gn?Hn?Hn.push(r):Hn=[r]:Gn=r}function P0(){if(Gn){var r=Gn,e=Hn;if(Hn=Gn=null,Op(r),e)for(r=0;r<e.length;r++)Op(e[r])}}function k0(r,e){return r(e)}function M0(){}var Lu=!1;function D0(r,e,t){if(Lu)return r(e,t);Lu=!0;try{return k0(r,e,t)}finally{Lu=!1,(Gn!==null||Hn!==null)&&(M0(),P0())}}function ao(r,e){var t=r.stateNode;if(t===null)return null;var i=nu(t);if(i===null)return null;t=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(r=r.type,i=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!i;break e;default:r=!1}if(r)return null;if(t&&typeof t!="function")throw Error(N(231,e,typeof t));return t}var Sc=!1;if(Fr)try{var vs={};Object.defineProperty(vs,"passive",{get:function(){Sc=!0}}),window.addEventListener("test",vs,vs),window.removeEventListener("test",vs,vs)}catch{Sc=!1}function xw(r,e,t,i,n,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(h){this.onError(h)}}var Xs=!1,hl=null,cl=!1,Ac=null,ww={onError:function(r){Xs=!0,hl=r}};function Ew(r,e,t,i,n,s,o,a,l){Xs=!1,hl=null,xw.apply(ww,arguments)}function Tw(r,e,t,i,n,s,o,a,l){if(Ew.apply(this,arguments),Xs){if(Xs){var u=hl;Xs=!1,hl=null}else throw Error(N(198));cl||(cl=!0,Ac=u)}}function on(r){var e=r,t=r;if(r.alternate)for(;e.return;)e=e.return;else{r=e;do e=r,e.flags&4098&&(t=e.return),r=e.return;while(r)}return e.tag===3?t:null}function N0(r){if(r.tag===13){var e=r.memoizedState;if(e===null&&(r=r.alternate,r!==null&&(e=r.memoizedState)),e!==null)return e.dehydrated}return null}function Bp(r){if(on(r)!==r)throw Error(N(188))}function Sw(r){var e=r.alternate;if(!e){if(e=on(r),e===null)throw Error(N(188));return e!==r?null:r}for(var t=r,i=e;;){var n=t.return;if(n===null)break;var s=n.alternate;if(s===null){if(i=n.return,i!==null){t=i;continue}break}if(n.child===s.child){for(s=n.child;s;){if(s===t)return Bp(n),r;if(s===i)return Bp(n),e;s=s.sibling}throw Error(N(188))}if(t.return!==i.return)t=n,i=s;else{for(var o=!1,a=n.child;a;){if(a===t){o=!0,t=n,i=s;break}if(a===i){o=!0,i=n,t=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===t){o=!0,t=s,i=n;break}if(a===i){o=!0,i=s,t=n;break}a=a.sibling}if(!o)throw Error(N(189))}}if(t.alternate!==i)throw Error(N(190))}if(t.tag!==3)throw Error(N(188));return t.stateNode.current===t?r:e}function O0(r){return r=Sw(r),r!==null?B0(r):null}function B0(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var e=B0(r);if(e!==null)return e;r=r.sibling}return null}var L0=wt.unstable_scheduleCallback,Lp=wt.unstable_cancelCallback,Aw=wt.unstable_shouldYield,bw=wt.unstable_requestPaint,Me=wt.unstable_now,Cw=wt.unstable_getCurrentPriorityLevel,wf=wt.unstable_ImmediatePriority,F0=wt.unstable_UserBlockingPriority,dl=wt.unstable_NormalPriority,Rw=wt.unstable_LowPriority,U0=wt.unstable_IdlePriority,eu=null,pr=null;function Iw(r){if(pr&&typeof pr.onCommitFiberRoot=="function")try{pr.onCommitFiberRoot(eu,r,void 0,(r.current.flags&128)===128)}catch{}}var Wt=Math.clz32?Math.clz32:Mw,Pw=Math.log,kw=Math.LN2;function Mw(r){return r>>>=0,r===0?32:31-(Pw(r)/kw|0)|0}var Wo=64,Yo=4194304;function Ds(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function fl(r,e){var t=r.pendingLanes;if(t===0)return 0;var i=0,n=r.suspendedLanes,s=r.pingedLanes,o=t&268435455;if(o!==0){var a=o&~n;a!==0?i=Ds(a):(s&=o,s!==0&&(i=Ds(s)))}else o=t&~n,o!==0?i=Ds(o):s!==0&&(i=Ds(s));if(i===0)return 0;if(e!==0&&e!==i&&!(e&n)&&(n=i&-i,s=e&-e,n>=s||n===16&&(s&4194240)!==0))return e;if(i&4&&(i|=t&16),e=r.entangledLanes,e!==0)for(r=r.entanglements,e&=i;0<e;)t=31-Wt(e),n=1<<t,i|=r[t],e&=~n;return i}function Dw(r,e){switch(r){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Nw(r,e){for(var t=r.suspendedLanes,i=r.pingedLanes,n=r.expirationTimes,s=r.pendingLanes;0<s;){var o=31-Wt(s),a=1<<o,l=n[o];l===-1?(!(a&t)||a&i)&&(n[o]=Dw(a,e)):l<=e&&(r.expiredLanes|=a),s&=~a}}function bc(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function G0(){var r=Wo;return Wo<<=1,!(Wo&4194240)&&(Wo=64),r}function Fu(r){for(var e=[],t=0;31>t;t++)e.push(r);return e}function ko(r,e,t){r.pendingLanes|=e,e!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,e=31-Wt(e),r[e]=t}function Ow(r,e){var t=r.pendingLanes&~e;r.pendingLanes=e,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=e,r.mutableReadLanes&=e,r.entangledLanes&=e,e=r.entanglements;var i=r.eventTimes;for(r=r.expirationTimes;0<t;){var n=31-Wt(t),s=1<<n;e[n]=0,i[n]=-1,r[n]=-1,t&=~s}}function Ef(r,e){var t=r.entangledLanes|=e;for(r=r.entanglements;t;){var i=31-Wt(t),n=1<<i;n&e|r[i]&e&&(r[i]|=e),t&=~n}}var ae=0;function H0(r){return r&=-r,1<r?4<r?r&268435455?16:536870912:4:1}var $0,Tf,z0,V0,X0,Cc=!1,qo=[],ai=null,li=null,ui=null,lo=new Map,uo=new Map,Jr=[],Bw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Fp(r,e){switch(r){case"focusin":case"focusout":ai=null;break;case"dragenter":case"dragleave":li=null;break;case"mouseover":case"mouseout":ui=null;break;case"pointerover":case"pointerout":lo.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":uo.delete(e.pointerId)}}function _s(r,e,t,i,n,s){return r===null||r.nativeEvent!==s?(r={blockedOn:e,domEventName:t,eventSystemFlags:i,nativeEvent:s,targetContainers:[n]},e!==null&&(e=Do(e),e!==null&&Tf(e)),r):(r.eventSystemFlags|=i,e=r.targetContainers,n!==null&&e.indexOf(n)===-1&&e.push(n),r)}function Lw(r,e,t,i,n){switch(e){case"focusin":return ai=_s(ai,r,e,t,i,n),!0;case"dragenter":return li=_s(li,r,e,t,i,n),!0;case"mouseover":return ui=_s(ui,r,e,t,i,n),!0;case"pointerover":var s=n.pointerId;return lo.set(s,_s(lo.get(s)||null,r,e,t,i,n)),!0;case"gotpointercapture":return s=n.pointerId,uo.set(s,_s(uo.get(s)||null,r,e,t,i,n)),!0}return!1}function j0(r){var e=Gi(r.target);if(e!==null){var t=on(e);if(t!==null){if(e=t.tag,e===13){if(e=N0(t),e!==null){r.blockedOn=e,X0(r.priority,function(){z0(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){r.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Fa(r){if(r.blockedOn!==null)return!1;for(var e=r.targetContainers;0<e.length;){var t=Rc(r.domEventName,r.eventSystemFlags,e[0],r.nativeEvent);if(t===null){t=r.nativeEvent;var i=new t.constructor(t.type,t);Ec=i,t.target.dispatchEvent(i),Ec=null}else return e=Do(t),e!==null&&Tf(e),r.blockedOn=t,!1;e.shift()}return!0}function Up(r,e,t){Fa(r)&&t.delete(e)}function Fw(){Cc=!1,ai!==null&&Fa(ai)&&(ai=null),li!==null&&Fa(li)&&(li=null),ui!==null&&Fa(ui)&&(ui=null),lo.forEach(Up),uo.forEach(Up)}function xs(r,e){r.blockedOn===e&&(r.blockedOn=null,Cc||(Cc=!0,wt.unstable_scheduleCallback(wt.unstable_NormalPriority,Fw)))}function ho(r){function e(n){return xs(n,r)}if(0<qo.length){xs(qo[0],r);for(var t=1;t<qo.length;t++){var i=qo[t];i.blockedOn===r&&(i.blockedOn=null)}}for(ai!==null&&xs(ai,r),li!==null&&xs(li,r),ui!==null&&xs(ui,r),lo.forEach(e),uo.forEach(e),t=0;t<Jr.length;t++)i=Jr[t],i.blockedOn===r&&(i.blockedOn=null);for(;0<Jr.length&&(t=Jr[0],t.blockedOn===null);)j0(t),t.blockedOn===null&&Jr.shift()}var $n=Vr.ReactCurrentBatchConfig,pl=!0;function Uw(r,e,t,i){var n=ae,s=$n.transition;$n.transition=null;try{ae=1,Sf(r,e,t,i)}finally{ae=n,$n.transition=s}}function Gw(r,e,t,i){var n=ae,s=$n.transition;$n.transition=null;try{ae=4,Sf(r,e,t,i)}finally{ae=n,$n.transition=s}}function Sf(r,e,t,i){if(pl){var n=Rc(r,e,t,i);if(n===null)Yu(r,e,i,ml,t),Fp(r,i);else if(Lw(n,r,e,t,i))i.stopPropagation();else if(Fp(r,i),e&4&&-1<Bw.indexOf(r)){for(;n!==null;){var s=Do(n);if(s!==null&&$0(s),s=Rc(r,e,t,i),s===null&&Yu(r,e,i,ml,t),s===n)break;n=s}n!==null&&i.stopPropagation()}else Yu(r,e,i,null,t)}}var ml=null;function Rc(r,e,t,i){if(ml=null,r=xf(i),r=Gi(r),r!==null)if(e=on(r),e===null)r=null;else if(t=e.tag,t===13){if(r=N0(e),r!==null)return r;r=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;r=null}else e!==r&&(r=null);return ml=r,null}function W0(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Cw()){case wf:return 1;case F0:return 4;case dl:case Rw:return 16;case U0:return 536870912;default:return 16}default:return 16}}var ri=null,Af=null,Ua=null;function Y0(){if(Ua)return Ua;var r,e=Af,t=e.length,i,n="value"in ri?ri.value:ri.textContent,s=n.length;for(r=0;r<t&&e[r]===n[r];r++);var o=t-r;for(i=1;i<=o&&e[t-i]===n[s-i];i++);return Ua=n.slice(r,1<i?1-i:void 0)}function Ga(r){var e=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&e===13&&(r=13)):r=e,r===10&&(r=13),32<=r||r===13?r:0}function Ko(){return!0}function Gp(){return!1}function Tt(r){function e(t,i,n,s,o){this._reactName=t,this._targetInst=n,this.type=i,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in r)r.hasOwnProperty(a)&&(t=r[a],this[a]=t?t(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Ko:Gp,this.isPropagationStopped=Gp,this}return be(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Ko)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Ko)},persist:function(){},isPersistent:Ko}),e}var hs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},bf=Tt(hs),Mo=be({},hs,{view:0,detail:0}),Hw=Tt(Mo),Uu,Gu,ws,tu=be({},Mo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cf,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==ws&&(ws&&r.type==="mousemove"?(Uu=r.screenX-ws.screenX,Gu=r.screenY-ws.screenY):Gu=Uu=0,ws=r),Uu)},movementY:function(r){return"movementY"in r?r.movementY:Gu}}),Hp=Tt(tu),$w=be({},tu,{dataTransfer:0}),zw=Tt($w),Vw=be({},Mo,{relatedTarget:0}),Hu=Tt(Vw),Xw=be({},hs,{animationName:0,elapsedTime:0,pseudoElement:0}),jw=Tt(Xw),Ww=be({},hs,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Yw=Tt(Ww),qw=be({},hs,{data:0}),$p=Tt(qw),Kw={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Zw={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Qw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Jw(r){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(r):(r=Qw[r])?!!e[r]:!1}function Cf(){return Jw}var eE=be({},Mo,{key:function(r){if(r.key){var e=Kw[r.key]||r.key;if(e!=="Unidentified")return e}return r.type==="keypress"?(r=Ga(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?Zw[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cf,charCode:function(r){return r.type==="keypress"?Ga(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Ga(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),tE=Tt(eE),rE=be({},tu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),zp=Tt(rE),iE=be({},Mo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cf}),nE=Tt(iE),sE=be({},hs,{propertyName:0,elapsedTime:0,pseudoElement:0}),oE=Tt(sE),aE=be({},tu,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),lE=Tt(aE),uE=[9,13,27,32],Rf=Fr&&"CompositionEvent"in window,js=null;Fr&&"documentMode"in document&&(js=document.documentMode);var hE=Fr&&"TextEvent"in window&&!js,q0=Fr&&(!Rf||js&&8<js&&11>=js),Vp=" ",Xp=!1;function K0(r,e){switch(r){case"keyup":return uE.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Z0(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Cn=!1;function cE(r,e){switch(r){case"compositionend":return Z0(e);case"keypress":return e.which!==32?null:(Xp=!0,Vp);case"textInput":return r=e.data,r===Vp&&Xp?null:r;default:return null}}function dE(r,e){if(Cn)return r==="compositionend"||!Rf&&K0(r,e)?(r=Y0(),Ua=Af=ri=null,Cn=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return q0&&e.locale!=="ko"?null:e.data;default:return null}}var fE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jp(r){var e=r&&r.nodeName&&r.nodeName.toLowerCase();return e==="input"?!!fE[r.type]:e==="textarea"}function Q0(r,e,t,i){I0(i),e=gl(e,"onChange"),0<e.length&&(t=new bf("onChange","change",null,t,i),r.push({event:t,listeners:e}))}var Ws=null,co=null;function pE(r){uv(r,0)}function ru(r){var e=Pn(r);if(E0(e))return r}function mE(r,e){if(r==="change")return e}var J0=!1;if(Fr){var $u;if(Fr){var zu="oninput"in document;if(!zu){var Wp=document.createElement("div");Wp.setAttribute("oninput","return;"),zu=typeof Wp.oninput=="function"}$u=zu}else $u=!1;J0=$u&&(!document.documentMode||9<document.documentMode)}function Yp(){Ws&&(Ws.detachEvent("onpropertychange",ev),co=Ws=null)}function ev(r){if(r.propertyName==="value"&&ru(co)){var e=[];Q0(e,co,r,xf(r)),D0(pE,e)}}function gE(r,e,t){r==="focusin"?(Yp(),Ws=e,co=t,Ws.attachEvent("onpropertychange",ev)):r==="focusout"&&Yp()}function yE(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return ru(co)}function vE(r,e){if(r==="click")return ru(e)}function _E(r,e){if(r==="input"||r==="change")return ru(e)}function xE(r,e){return r===e&&(r!==0||1/r===1/e)||r!==r&&e!==e}var Zt=typeof Object.is=="function"?Object.is:xE;function fo(r,e){if(Zt(r,e))return!0;if(typeof r!="object"||r===null||typeof e!="object"||e===null)return!1;var t=Object.keys(r),i=Object.keys(e);if(t.length!==i.length)return!1;for(i=0;i<t.length;i++){var n=t[i];if(!hc.call(e,n)||!Zt(r[n],e[n]))return!1}return!0}function qp(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Kp(r,e){var t=qp(r);r=0;for(var i;t;){if(t.nodeType===3){if(i=r+t.textContent.length,r<=e&&i>=e)return{node:t,offset:e-r};r=i}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=qp(t)}}function tv(r,e){return r&&e?r===e?!0:r&&r.nodeType===3?!1:e&&e.nodeType===3?tv(r,e.parentNode):"contains"in r?r.contains(e):r.compareDocumentPosition?!!(r.compareDocumentPosition(e)&16):!1:!1}function rv(){for(var r=window,e=ul();e instanceof r.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)r=e.contentWindow;else break;e=ul(r.document)}return e}function If(r){var e=r&&r.nodeName&&r.nodeName.toLowerCase();return e&&(e==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||e==="textarea"||r.contentEditable==="true")}function wE(r){var e=rv(),t=r.focusedElem,i=r.selectionRange;if(e!==t&&t&&t.ownerDocument&&tv(t.ownerDocument.documentElement,t)){if(i!==null&&If(t)){if(e=i.start,r=i.end,r===void 0&&(r=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(r,t.value.length);else if(r=(e=t.ownerDocument||document)&&e.defaultView||window,r.getSelection){r=r.getSelection();var n=t.textContent.length,s=Math.min(i.start,n);i=i.end===void 0?s:Math.min(i.end,n),!r.extend&&s>i&&(n=i,i=s,s=n),n=Kp(t,s);var o=Kp(t,i);n&&o&&(r.rangeCount!==1||r.anchorNode!==n.node||r.anchorOffset!==n.offset||r.focusNode!==o.node||r.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(n.node,n.offset),r.removeAllRanges(),s>i?(r.addRange(e),r.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),r.addRange(e)))}}for(e=[],r=t;r=r.parentNode;)r.nodeType===1&&e.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)r=e[t],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var EE=Fr&&"documentMode"in document&&11>=document.documentMode,Rn=null,Ic=null,Ys=null,Pc=!1;function Zp(r,e,t){var i=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;Pc||Rn==null||Rn!==ul(i)||(i=Rn,"selectionStart"in i&&If(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Ys&&fo(Ys,i)||(Ys=i,i=gl(Ic,"onSelect"),0<i.length&&(e=new bf("onSelect","select",null,e,t),r.push({event:e,listeners:i}),e.target=Rn)))}function Zo(r,e){var t={};return t[r.toLowerCase()]=e.toLowerCase(),t["Webkit"+r]="webkit"+e,t["Moz"+r]="moz"+e,t}var In={animationend:Zo("Animation","AnimationEnd"),animationiteration:Zo("Animation","AnimationIteration"),animationstart:Zo("Animation","AnimationStart"),transitionend:Zo("Transition","TransitionEnd")},Vu={},iv={};Fr&&(iv=document.createElement("div").style,"AnimationEvent"in window||(delete In.animationend.animation,delete In.animationiteration.animation,delete In.animationstart.animation),"TransitionEvent"in window||delete In.transitionend.transition);function iu(r){if(Vu[r])return Vu[r];if(!In[r])return r;var e=In[r],t;for(t in e)if(e.hasOwnProperty(t)&&t in iv)return Vu[r]=e[t];return r}var nv=iu("animationend"),sv=iu("animationiteration"),ov=iu("animationstart"),av=iu("transitionend"),lv=new Map,Qp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ti(r,e){lv.set(r,e),sn(e,[r])}for(var Xu=0;Xu<Qp.length;Xu++){var ju=Qp[Xu],TE=ju.toLowerCase(),SE=ju[0].toUpperCase()+ju.slice(1);Ti(TE,"on"+SE)}Ti(nv,"onAnimationEnd");Ti(sv,"onAnimationIteration");Ti(ov,"onAnimationStart");Ti("dblclick","onDoubleClick");Ti("focusin","onFocus");Ti("focusout","onBlur");Ti(av,"onTransitionEnd");Jn("onMouseEnter",["mouseout","mouseover"]);Jn("onMouseLeave",["mouseout","mouseover"]);Jn("onPointerEnter",["pointerout","pointerover"]);Jn("onPointerLeave",["pointerout","pointerover"]);sn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));sn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));sn("onBeforeInput",["compositionend","keypress","textInput","paste"]);sn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));sn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));sn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ns="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),AE=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ns));function Jp(r,e,t){var i=r.type||"unknown-event";r.currentTarget=t,Tw(i,e,void 0,r),r.currentTarget=null}function uv(r,e){e=(e&4)!==0;for(var t=0;t<r.length;t++){var i=r[t],n=i.event;i=i.listeners;e:{var s=void 0;if(e)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&n.isPropagationStopped())break e;Jp(n,a,u),s=l}else for(o=0;o<i.length;o++){if(a=i[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&n.isPropagationStopped())break e;Jp(n,a,u),s=l}}}if(cl)throw r=Ac,cl=!1,Ac=null,r}function pe(r,e){var t=e[Oc];t===void 0&&(t=e[Oc]=new Set);var i=r+"__bubble";t.has(i)||(hv(e,r,2,!1),t.add(i))}function Wu(r,e,t){var i=0;e&&(i|=4),hv(t,r,i,e)}var Qo="_reactListening"+Math.random().toString(36).slice(2);function po(r){if(!r[Qo]){r[Qo]=!0,y0.forEach(function(t){t!=="selectionchange"&&(AE.has(t)||Wu(t,!1,r),Wu(t,!0,r))});var e=r.nodeType===9?r:r.ownerDocument;e===null||e[Qo]||(e[Qo]=!0,Wu("selectionchange",!1,e))}}function hv(r,e,t,i){switch(W0(e)){case 1:var n=Uw;break;case 4:n=Gw;break;default:n=Sf}t=n.bind(null,e,t,r),n=void 0,!Sc||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(n=!0),i?n!==void 0?r.addEventListener(e,t,{capture:!0,passive:n}):r.addEventListener(e,t,!0):n!==void 0?r.addEventListener(e,t,{passive:n}):r.addEventListener(e,t,!1)}function Yu(r,e,t,i,n){var s=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var a=i.stateNode.containerInfo;if(a===n||a.nodeType===8&&a.parentNode===n)break;if(o===4)for(o=i.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===n||l.nodeType===8&&l.parentNode===n))return;o=o.return}for(;a!==null;){if(o=Gi(a),o===null)return;if(l=o.tag,l===5||l===6){i=s=o;continue e}a=a.parentNode}}i=i.return}D0(function(){var u=s,h=xf(t),d=[];e:{var c=lv.get(r);if(c!==void 0){var f=bf,p=r;switch(r){case"keypress":if(Ga(t)===0)break e;case"keydown":case"keyup":f=tE;break;case"focusin":p="focus",f=Hu;break;case"focusout":p="blur",f=Hu;break;case"beforeblur":case"afterblur":f=Hu;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=Hp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=zw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=nE;break;case nv:case sv:case ov:f=jw;break;case av:f=oE;break;case"scroll":f=Hw;break;case"wheel":f=lE;break;case"copy":case"cut":case"paste":f=Yw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=zp}var v=(e&4)!==0,x=!v&&r==="scroll",g=v?c!==null?c+"Capture":null:c;v=[];for(var y=u,m;y!==null;){m=y;var _=m.stateNode;if(m.tag===5&&_!==null&&(m=_,g!==null&&(_=ao(y,g),_!=null&&v.push(mo(y,_,m)))),x)break;y=y.return}0<v.length&&(c=new f(c,p,null,t,h),d.push({event:c,listeners:v}))}}if(!(e&7)){e:{if(c=r==="mouseover"||r==="pointerover",f=r==="mouseout"||r==="pointerout",c&&t!==Ec&&(p=t.relatedTarget||t.fromElement)&&(Gi(p)||p[Ur]))break e;if((f||c)&&(c=h.window===h?h:(c=h.ownerDocument)?c.defaultView||c.parentWindow:window,f?(p=t.relatedTarget||t.toElement,f=u,p=p?Gi(p):null,p!==null&&(x=on(p),p!==x||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=u),f!==p)){if(v=Hp,_="onMouseLeave",g="onMouseEnter",y="mouse",(r==="pointerout"||r==="pointerover")&&(v=zp,_="onPointerLeave",g="onPointerEnter",y="pointer"),x=f==null?c:Pn(f),m=p==null?c:Pn(p),c=new v(_,y+"leave",f,t,h),c.target=x,c.relatedTarget=m,_=null,Gi(h)===u&&(v=new v(g,y+"enter",p,t,h),v.target=m,v.relatedTarget=x,_=v),x=_,f&&p)t:{for(v=f,g=p,y=0,m=v;m;m=cn(m))y++;for(m=0,_=g;_;_=cn(_))m++;for(;0<y-m;)v=cn(v),y--;for(;0<m-y;)g=cn(g),m--;for(;y--;){if(v===g||g!==null&&v===g.alternate)break t;v=cn(v),g=cn(g)}v=null}else v=null;f!==null&&em(d,c,f,v,!1),p!==null&&x!==null&&em(d,x,p,v,!0)}}e:{if(c=u?Pn(u):window,f=c.nodeName&&c.nodeName.toLowerCase(),f==="select"||f==="input"&&c.type==="file")var w=mE;else if(jp(c))if(J0)w=_E;else{w=yE;var S=gE}else(f=c.nodeName)&&f.toLowerCase()==="input"&&(c.type==="checkbox"||c.type==="radio")&&(w=vE);if(w&&(w=w(r,u))){Q0(d,w,t,h);break e}S&&S(r,c,u),r==="focusout"&&(S=c._wrapperState)&&S.controlled&&c.type==="number"&&yc(c,"number",c.value)}switch(S=u?Pn(u):window,r){case"focusin":(jp(S)||S.contentEditable==="true")&&(Rn=S,Ic=u,Ys=null);break;case"focusout":Ys=Ic=Rn=null;break;case"mousedown":Pc=!0;break;case"contextmenu":case"mouseup":case"dragend":Pc=!1,Zp(d,t,h);break;case"selectionchange":if(EE)break;case"keydown":case"keyup":Zp(d,t,h)}var E;if(Rf)e:{switch(r){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else Cn?K0(r,t)&&(T="onCompositionEnd"):r==="keydown"&&t.keyCode===229&&(T="onCompositionStart");T&&(q0&&t.locale!=="ko"&&(Cn||T!=="onCompositionStart"?T==="onCompositionEnd"&&Cn&&(E=Y0()):(ri=h,Af="value"in ri?ri.value:ri.textContent,Cn=!0)),S=gl(u,T),0<S.length&&(T=new $p(T,r,null,t,h),d.push({event:T,listeners:S}),E?T.data=E:(E=Z0(t),E!==null&&(T.data=E)))),(E=hE?cE(r,t):dE(r,t))&&(u=gl(u,"onBeforeInput"),0<u.length&&(h=new $p("onBeforeInput","beforeinput",null,t,h),d.push({event:h,listeners:u}),h.data=E))}uv(d,e)})}function mo(r,e,t){return{instance:r,listener:e,currentTarget:t}}function gl(r,e){for(var t=e+"Capture",i=[];r!==null;){var n=r,s=n.stateNode;n.tag===5&&s!==null&&(n=s,s=ao(r,t),s!=null&&i.unshift(mo(r,s,n)),s=ao(r,e),s!=null&&i.push(mo(r,s,n))),r=r.return}return i}function cn(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function em(r,e,t,i,n){for(var s=e._reactName,o=[];t!==null&&t!==i;){var a=t,l=a.alternate,u=a.stateNode;if(l!==null&&l===i)break;a.tag===5&&u!==null&&(a=u,n?(l=ao(t,s),l!=null&&o.unshift(mo(t,l,a))):n||(l=ao(t,s),l!=null&&o.push(mo(t,l,a)))),t=t.return}o.length!==0&&r.push({event:e,listeners:o})}var bE=/\r\n?/g,CE=/\u0000|\uFFFD/g;function tm(r){return(typeof r=="string"?r:""+r).replace(bE,`
`).replace(CE,"")}function Jo(r,e,t){if(e=tm(e),tm(r)!==e&&t)throw Error(N(425))}function yl(){}var kc=null,Mc=null;function Dc(r,e){return r==="textarea"||r==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Nc=typeof setTimeout=="function"?setTimeout:void 0,RE=typeof clearTimeout=="function"?clearTimeout:void 0,rm=typeof Promise=="function"?Promise:void 0,IE=typeof queueMicrotask=="function"?queueMicrotask:typeof rm<"u"?function(r){return rm.resolve(null).then(r).catch(PE)}:Nc;function PE(r){setTimeout(function(){throw r})}function qu(r,e){var t=e,i=0;do{var n=t.nextSibling;if(r.removeChild(t),n&&n.nodeType===8)if(t=n.data,t==="/$"){if(i===0){r.removeChild(n),ho(e);return}i--}else t!=="$"&&t!=="$?"&&t!=="$!"||i++;t=n}while(t);ho(e)}function hi(r){for(;r!=null;r=r.nextSibling){var e=r.nodeType;if(e===1||e===3)break;if(e===8){if(e=r.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return r}function im(r){r=r.previousSibling;for(var e=0;r;){if(r.nodeType===8){var t=r.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return r;e--}else t==="/$"&&e++}r=r.previousSibling}return null}var cs=Math.random().toString(36).slice(2),dr="__reactFiber$"+cs,go="__reactProps$"+cs,Ur="__reactContainer$"+cs,Oc="__reactEvents$"+cs,kE="__reactListeners$"+cs,ME="__reactHandles$"+cs;function Gi(r){var e=r[dr];if(e)return e;for(var t=r.parentNode;t;){if(e=t[Ur]||t[dr]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(r=im(r);r!==null;){if(t=r[dr])return t;r=im(r)}return e}r=t,t=r.parentNode}return null}function Do(r){return r=r[dr]||r[Ur],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function Pn(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(N(33))}function nu(r){return r[go]||null}var Bc=[],kn=-1;function Si(r){return{current:r}}function ge(r){0>kn||(r.current=Bc[kn],Bc[kn]=null,kn--)}function de(r,e){kn++,Bc[kn]=r.current,r.current=e}var vi={},rt=Si(vi),dt=Si(!1),Yi=vi;function es(r,e){var t=r.type.contextTypes;if(!t)return vi;var i=r.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var n={},s;for(s in t)n[s]=e[s];return i&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=e,r.__reactInternalMemoizedMaskedChildContext=n),n}function ft(r){return r=r.childContextTypes,r!=null}function vl(){ge(dt),ge(rt)}function nm(r,e,t){if(rt.current!==vi)throw Error(N(168));de(rt,e),de(dt,t)}function cv(r,e,t){var i=r.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return t;i=i.getChildContext();for(var n in i)if(!(n in e))throw Error(N(108,gw(r)||"Unknown",n));return be({},t,i)}function _l(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||vi,Yi=rt.current,de(rt,r),de(dt,dt.current),!0}function sm(r,e,t){var i=r.stateNode;if(!i)throw Error(N(169));t?(r=cv(r,e,Yi),i.__reactInternalMemoizedMergedChildContext=r,ge(dt),ge(rt),de(rt,r)):ge(dt),de(dt,t)}var Rr=null,su=!1,Ku=!1;function dv(r){Rr===null?Rr=[r]:Rr.push(r)}function DE(r){su=!0,dv(r)}function Ai(){if(!Ku&&Rr!==null){Ku=!0;var r=0,e=ae;try{var t=Rr;for(ae=1;r<t.length;r++){var i=t[r];do i=i(!0);while(i!==null)}Rr=null,su=!1}catch(n){throw Rr!==null&&(Rr=Rr.slice(r+1)),L0(wf,Ai),n}finally{ae=e,Ku=!1}}return null}var Mn=[],Dn=0,xl=null,wl=0,bt=[],Ct=0,qi=null,Pr=1,kr="";function Pi(r,e){Mn[Dn++]=wl,Mn[Dn++]=xl,xl=r,wl=e}function fv(r,e,t){bt[Ct++]=Pr,bt[Ct++]=kr,bt[Ct++]=qi,qi=r;var i=Pr;r=kr;var n=32-Wt(i)-1;i&=~(1<<n),t+=1;var s=32-Wt(e)+n;if(30<s){var o=n-n%5;s=(i&(1<<o)-1).toString(32),i>>=o,n-=o,Pr=1<<32-Wt(e)+n|t<<n|i,kr=s+r}else Pr=1<<s|t<<n|i,kr=r}function Pf(r){r.return!==null&&(Pi(r,1),fv(r,1,0))}function kf(r){for(;r===xl;)xl=Mn[--Dn],Mn[Dn]=null,wl=Mn[--Dn],Mn[Dn]=null;for(;r===qi;)qi=bt[--Ct],bt[Ct]=null,kr=bt[--Ct],bt[Ct]=null,Pr=bt[--Ct],bt[Ct]=null}var xt=null,vt=null,xe=!1,Xt=null;function pv(r,e){var t=It(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=r,e=r.deletions,e===null?(r.deletions=[t],r.flags|=16):e.push(t)}function om(r,e){switch(r.tag){case 5:var t=r.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(r.stateNode=e,xt=r,vt=hi(e.firstChild),!0):!1;case 6:return e=r.pendingProps===""||e.nodeType!==3?null:e,e!==null?(r.stateNode=e,xt=r,vt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=qi!==null?{id:Pr,overflow:kr}:null,r.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=It(18,null,null,0),t.stateNode=e,t.return=r,r.child=t,xt=r,vt=null,!0):!1;default:return!1}}function Lc(r){return(r.mode&1)!==0&&(r.flags&128)===0}function Fc(r){if(xe){var e=vt;if(e){var t=e;if(!om(r,e)){if(Lc(r))throw Error(N(418));e=hi(t.nextSibling);var i=xt;e&&om(r,e)?pv(i,t):(r.flags=r.flags&-4097|2,xe=!1,xt=r)}}else{if(Lc(r))throw Error(N(418));r.flags=r.flags&-4097|2,xe=!1,xt=r}}}function am(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;xt=r}function ea(r){if(r!==xt)return!1;if(!xe)return am(r),xe=!0,!1;var e;if((e=r.tag!==3)&&!(e=r.tag!==5)&&(e=r.type,e=e!=="head"&&e!=="body"&&!Dc(r.type,r.memoizedProps)),e&&(e=vt)){if(Lc(r))throw mv(),Error(N(418));for(;e;)pv(r,e),e=hi(e.nextSibling)}if(am(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(N(317));e:{for(r=r.nextSibling,e=0;r;){if(r.nodeType===8){var t=r.data;if(t==="/$"){if(e===0){vt=hi(r.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}r=r.nextSibling}vt=null}}else vt=xt?hi(r.stateNode.nextSibling):null;return!0}function mv(){for(var r=vt;r;)r=hi(r.nextSibling)}function ts(){vt=xt=null,xe=!1}function Mf(r){Xt===null?Xt=[r]:Xt.push(r)}var NE=Vr.ReactCurrentBatchConfig;function Es(r,e,t){if(r=t.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(N(309));var i=t.stateNode}if(!i)throw Error(N(147,r));var n=i,s=""+r;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=n.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof r!="string")throw Error(N(284));if(!t._owner)throw Error(N(290,r))}return r}function ta(r,e){throw r=Object.prototype.toString.call(e),Error(N(31,r==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":r))}function lm(r){var e=r._init;return e(r._payload)}function gv(r){function e(g,y){if(r){var m=g.deletions;m===null?(g.deletions=[y],g.flags|=16):m.push(y)}}function t(g,y){if(!r)return null;for(;y!==null;)e(g,y),y=y.sibling;return null}function i(g,y){for(g=new Map;y!==null;)y.key!==null?g.set(y.key,y):g.set(y.index,y),y=y.sibling;return g}function n(g,y){return g=pi(g,y),g.index=0,g.sibling=null,g}function s(g,y,m){return g.index=m,r?(m=g.alternate,m!==null?(m=m.index,m<y?(g.flags|=2,y):m):(g.flags|=2,y)):(g.flags|=1048576,y)}function o(g){return r&&g.alternate===null&&(g.flags|=2),g}function a(g,y,m,_){return y===null||y.tag!==6?(y=ih(m,g.mode,_),y.return=g,y):(y=n(y,m),y.return=g,y)}function l(g,y,m,_){var w=m.type;return w===bn?h(g,y,m.props.children,_,m.key):y!==null&&(y.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===Kr&&lm(w)===y.type)?(_=n(y,m.props),_.ref=Es(g,y,m),_.return=g,_):(_=Wa(m.type,m.key,m.props,null,g.mode,_),_.ref=Es(g,y,m),_.return=g,_)}function u(g,y,m,_){return y===null||y.tag!==4||y.stateNode.containerInfo!==m.containerInfo||y.stateNode.implementation!==m.implementation?(y=nh(m,g.mode,_),y.return=g,y):(y=n(y,m.children||[]),y.return=g,y)}function h(g,y,m,_,w){return y===null||y.tag!==7?(y=Vi(m,g.mode,_,w),y.return=g,y):(y=n(y,m),y.return=g,y)}function d(g,y,m){if(typeof y=="string"&&y!==""||typeof y=="number")return y=ih(""+y,g.mode,m),y.return=g,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Vo:return m=Wa(y.type,y.key,y.props,null,g.mode,m),m.ref=Es(g,null,y),m.return=g,m;case An:return y=nh(y,g.mode,m),y.return=g,y;case Kr:var _=y._init;return d(g,_(y._payload),m)}if(Ms(y)||ys(y))return y=Vi(y,g.mode,m,null),y.return=g,y;ta(g,y)}return null}function c(g,y,m,_){var w=y!==null?y.key:null;if(typeof m=="string"&&m!==""||typeof m=="number")return w!==null?null:a(g,y,""+m,_);if(typeof m=="object"&&m!==null){switch(m.$$typeof){case Vo:return m.key===w?l(g,y,m,_):null;case An:return m.key===w?u(g,y,m,_):null;case Kr:return w=m._init,c(g,y,w(m._payload),_)}if(Ms(m)||ys(m))return w!==null?null:h(g,y,m,_,null);ta(g,m)}return null}function f(g,y,m,_,w){if(typeof _=="string"&&_!==""||typeof _=="number")return g=g.get(m)||null,a(y,g,""+_,w);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Vo:return g=g.get(_.key===null?m:_.key)||null,l(y,g,_,w);case An:return g=g.get(_.key===null?m:_.key)||null,u(y,g,_,w);case Kr:var S=_._init;return f(g,y,m,S(_._payload),w)}if(Ms(_)||ys(_))return g=g.get(m)||null,h(y,g,_,w,null);ta(y,_)}return null}function p(g,y,m,_){for(var w=null,S=null,E=y,T=y=0,b=null;E!==null&&T<m.length;T++){E.index>T?(b=E,E=null):b=E.sibling;var A=c(g,E,m[T],_);if(A===null){E===null&&(E=b);break}r&&E&&A.alternate===null&&e(g,E),y=s(A,y,T),S===null?w=A:S.sibling=A,S=A,E=b}if(T===m.length)return t(g,E),xe&&Pi(g,T),w;if(E===null){for(;T<m.length;T++)E=d(g,m[T],_),E!==null&&(y=s(E,y,T),S===null?w=E:S.sibling=E,S=E);return xe&&Pi(g,T),w}for(E=i(g,E);T<m.length;T++)b=f(E,g,T,m[T],_),b!==null&&(r&&b.alternate!==null&&E.delete(b.key===null?T:b.key),y=s(b,y,T),S===null?w=b:S.sibling=b,S=b);return r&&E.forEach(function(I){return e(g,I)}),xe&&Pi(g,T),w}function v(g,y,m,_){var w=ys(m);if(typeof w!="function")throw Error(N(150));if(m=w.call(m),m==null)throw Error(N(151));for(var S=w=null,E=y,T=y=0,b=null,A=m.next();E!==null&&!A.done;T++,A=m.next()){E.index>T?(b=E,E=null):b=E.sibling;var I=c(g,E,A.value,_);if(I===null){E===null&&(E=b);break}r&&E&&I.alternate===null&&e(g,E),y=s(I,y,T),S===null?w=I:S.sibling=I,S=I,E=b}if(A.done)return t(g,E),xe&&Pi(g,T),w;if(E===null){for(;!A.done;T++,A=m.next())A=d(g,A.value,_),A!==null&&(y=s(A,y,T),S===null?w=A:S.sibling=A,S=A);return xe&&Pi(g,T),w}for(E=i(g,E);!A.done;T++,A=m.next())A=f(E,g,T,A.value,_),A!==null&&(r&&A.alternate!==null&&E.delete(A.key===null?T:A.key),y=s(A,y,T),S===null?w=A:S.sibling=A,S=A);return r&&E.forEach(function(D){return e(g,D)}),xe&&Pi(g,T),w}function x(g,y,m,_){if(typeof m=="object"&&m!==null&&m.type===bn&&m.key===null&&(m=m.props.children),typeof m=="object"&&m!==null){switch(m.$$typeof){case Vo:e:{for(var w=m.key,S=y;S!==null;){if(S.key===w){if(w=m.type,w===bn){if(S.tag===7){t(g,S.sibling),y=n(S,m.props.children),y.return=g,g=y;break e}}else if(S.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===Kr&&lm(w)===S.type){t(g,S.sibling),y=n(S,m.props),y.ref=Es(g,S,m),y.return=g,g=y;break e}t(g,S);break}else e(g,S);S=S.sibling}m.type===bn?(y=Vi(m.props.children,g.mode,_,m.key),y.return=g,g=y):(_=Wa(m.type,m.key,m.props,null,g.mode,_),_.ref=Es(g,y,m),_.return=g,g=_)}return o(g);case An:e:{for(S=m.key;y!==null;){if(y.key===S)if(y.tag===4&&y.stateNode.containerInfo===m.containerInfo&&y.stateNode.implementation===m.implementation){t(g,y.sibling),y=n(y,m.children||[]),y.return=g,g=y;break e}else{t(g,y);break}else e(g,y);y=y.sibling}y=nh(m,g.mode,_),y.return=g,g=y}return o(g);case Kr:return S=m._init,x(g,y,S(m._payload),_)}if(Ms(m))return p(g,y,m,_);if(ys(m))return v(g,y,m,_);ta(g,m)}return typeof m=="string"&&m!==""||typeof m=="number"?(m=""+m,y!==null&&y.tag===6?(t(g,y.sibling),y=n(y,m),y.return=g,g=y):(t(g,y),y=ih(m,g.mode,_),y.return=g,g=y),o(g)):t(g,y)}return x}var rs=gv(!0),yv=gv(!1),El=Si(null),Tl=null,Nn=null,Df=null;function Nf(){Df=Nn=Tl=null}function Of(r){var e=El.current;ge(El),r._currentValue=e}function Uc(r,e,t){for(;r!==null;){var i=r.alternate;if((r.childLanes&e)!==e?(r.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),r===t)break;r=r.return}}function zn(r,e){Tl=r,Df=Nn=null,r=r.dependencies,r!==null&&r.firstContext!==null&&(r.lanes&e&&(ht=!0),r.firstContext=null)}function Dt(r){var e=r._currentValue;if(Df!==r)if(r={context:r,memoizedValue:e,next:null},Nn===null){if(Tl===null)throw Error(N(308));Nn=r,Tl.dependencies={lanes:0,firstContext:r}}else Nn=Nn.next=r;return e}var Hi=null;function Bf(r){Hi===null?Hi=[r]:Hi.push(r)}function vv(r,e,t,i){var n=e.interleaved;return n===null?(t.next=t,Bf(e)):(t.next=n.next,n.next=t),e.interleaved=t,Gr(r,i)}function Gr(r,e){r.lanes|=e;var t=r.alternate;for(t!==null&&(t.lanes|=e),t=r,r=r.return;r!==null;)r.childLanes|=e,t=r.alternate,t!==null&&(t.childLanes|=e),t=r,r=r.return;return t.tag===3?t.stateNode:null}var Zr=!1;function Lf(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function _v(r,e){r=r.updateQueue,e.updateQueue===r&&(e.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function Br(r,e){return{eventTime:r,lane:e,tag:0,payload:null,callback:null,next:null}}function ci(r,e,t){var i=r.updateQueue;if(i===null)return null;if(i=i.shared,se&2){var n=i.pending;return n===null?e.next=e:(e.next=n.next,n.next=e),i.pending=e,Gr(r,t)}return n=i.interleaved,n===null?(e.next=e,Bf(i)):(e.next=n.next,n.next=e),i.interleaved=e,Gr(r,t)}function Ha(r,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var i=e.lanes;i&=r.pendingLanes,t|=i,e.lanes=t,Ef(r,t)}}function um(r,e){var t=r.updateQueue,i=r.alternate;if(i!==null&&(i=i.updateQueue,t===i)){var n=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?n=s=o:s=s.next=o,t=t.next}while(t!==null);s===null?n=s=e:s=s.next=e}else n=s=e;t={baseState:i.baseState,firstBaseUpdate:n,lastBaseUpdate:s,shared:i.shared,effects:i.effects},r.updateQueue=t;return}r=t.lastBaseUpdate,r===null?t.firstBaseUpdate=e:r.next=e,t.lastBaseUpdate=e}function Sl(r,e,t,i){var n=r.updateQueue;Zr=!1;var s=n.firstBaseUpdate,o=n.lastBaseUpdate,a=n.shared.pending;if(a!==null){n.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var h=r.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=u:a.next=u,h.lastBaseUpdate=l))}if(s!==null){var d=n.baseState;o=0,h=u=l=null,a=s;do{var c=a.lane,f=a.eventTime;if((i&c)===c){h!==null&&(h=h.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=r,v=a;switch(c=e,f=t,v.tag){case 1:if(p=v.payload,typeof p=="function"){d=p.call(f,d,c);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=v.payload,c=typeof p=="function"?p.call(f,d,c):p,c==null)break e;d=be({},d,c);break e;case 2:Zr=!0}}a.callback!==null&&a.lane!==0&&(r.flags|=64,c=n.effects,c===null?n.effects=[a]:c.push(a))}else f={eventTime:f,lane:c,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(u=h=f,l=d):h=h.next=f,o|=c;if(a=a.next,a===null){if(a=n.shared.pending,a===null)break;c=a,a=c.next,c.next=null,n.lastBaseUpdate=c,n.shared.pending=null}}while(!0);if(h===null&&(l=d),n.baseState=l,n.firstBaseUpdate=u,n.lastBaseUpdate=h,e=n.shared.interleaved,e!==null){n=e;do o|=n.lane,n=n.next;while(n!==e)}else s===null&&(n.shared.lanes=0);Zi|=o,r.lanes=o,r.memoizedState=d}}function hm(r,e,t){if(r=e.effects,e.effects=null,r!==null)for(e=0;e<r.length;e++){var i=r[e],n=i.callback;if(n!==null){if(i.callback=null,i=t,typeof n!="function")throw Error(N(191,n));n.call(i)}}}var No={},mr=Si(No),yo=Si(No),vo=Si(No);function $i(r){if(r===No)throw Error(N(174));return r}function Ff(r,e){switch(de(vo,e),de(yo,r),de(mr,No),r=e.nodeType,r){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:_c(null,"");break;default:r=r===8?e.parentNode:e,e=r.namespaceURI||null,r=r.tagName,e=_c(e,r)}ge(mr),de(mr,e)}function is(){ge(mr),ge(yo),ge(vo)}function xv(r){$i(vo.current);var e=$i(mr.current),t=_c(e,r.type);e!==t&&(de(yo,r),de(mr,t))}function Uf(r){yo.current===r&&(ge(mr),ge(yo))}var Te=Si(0);function Al(r){for(var e=r;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===r)break;for(;e.sibling===null;){if(e.return===null||e.return===r)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Zu=[];function Gf(){for(var r=0;r<Zu.length;r++)Zu[r]._workInProgressVersionPrimary=null;Zu.length=0}var $a=Vr.ReactCurrentDispatcher,Qu=Vr.ReactCurrentBatchConfig,Ki=0,Ae=null,Ue=null,ze=null,bl=!1,qs=!1,_o=0,OE=0;function Je(){throw Error(N(321))}function Hf(r,e){if(e===null)return!1;for(var t=0;t<e.length&&t<r.length;t++)if(!Zt(r[t],e[t]))return!1;return!0}function $f(r,e,t,i,n,s){if(Ki=s,Ae=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,$a.current=r===null||r.memoizedState===null?UE:GE,r=t(i,n),qs){s=0;do{if(qs=!1,_o=0,25<=s)throw Error(N(301));s+=1,ze=Ue=null,e.updateQueue=null,$a.current=HE,r=t(i,n)}while(qs)}if($a.current=Cl,e=Ue!==null&&Ue.next!==null,Ki=0,ze=Ue=Ae=null,bl=!1,e)throw Error(N(300));return r}function zf(){var r=_o!==0;return _o=0,r}function lr(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ze===null?Ae.memoizedState=ze=r:ze=ze.next=r,ze}function Nt(){if(Ue===null){var r=Ae.alternate;r=r!==null?r.memoizedState:null}else r=Ue.next;var e=ze===null?Ae.memoizedState:ze.next;if(e!==null)ze=e,Ue=r;else{if(r===null)throw Error(N(310));Ue=r,r={memoizedState:Ue.memoizedState,baseState:Ue.baseState,baseQueue:Ue.baseQueue,queue:Ue.queue,next:null},ze===null?Ae.memoizedState=ze=r:ze=ze.next=r}return ze}function xo(r,e){return typeof e=="function"?e(r):e}function Ju(r){var e=Nt(),t=e.queue;if(t===null)throw Error(N(311));t.lastRenderedReducer=r;var i=Ue,n=i.baseQueue,s=t.pending;if(s!==null){if(n!==null){var o=n.next;n.next=s.next,s.next=o}i.baseQueue=n=s,t.pending=null}if(n!==null){s=n.next,i=i.baseState;var a=o=null,l=null,u=s;do{var h=u.lane;if((Ki&h)===h)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:r(i,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=d,o=i):l=l.next=d,Ae.lanes|=h,Zi|=h}u=u.next}while(u!==null&&u!==s);l===null?o=i:l.next=a,Zt(i,e.memoizedState)||(ht=!0),e.memoizedState=i,e.baseState=o,e.baseQueue=l,t.lastRenderedState=i}if(r=t.interleaved,r!==null){n=r;do s=n.lane,Ae.lanes|=s,Zi|=s,n=n.next;while(n!==r)}else n===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function eh(r){var e=Nt(),t=e.queue;if(t===null)throw Error(N(311));t.lastRenderedReducer=r;var i=t.dispatch,n=t.pending,s=e.memoizedState;if(n!==null){t.pending=null;var o=n=n.next;do s=r(s,o.action),o=o.next;while(o!==n);Zt(s,e.memoizedState)||(ht=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,i]}function wv(){}function Ev(r,e){var t=Ae,i=Nt(),n=e(),s=!Zt(i.memoizedState,n);if(s&&(i.memoizedState=n,ht=!0),i=i.queue,Vf(Av.bind(null,t,i,r),[r]),i.getSnapshot!==e||s||ze!==null&&ze.memoizedState.tag&1){if(t.flags|=2048,wo(9,Sv.bind(null,t,i,n,e),void 0,null),Xe===null)throw Error(N(349));Ki&30||Tv(t,e,n)}return n}function Tv(r,e,t){r.flags|=16384,r={getSnapshot:e,value:t},e=Ae.updateQueue,e===null?(e={lastEffect:null,stores:null},Ae.updateQueue=e,e.stores=[r]):(t=e.stores,t===null?e.stores=[r]:t.push(r))}function Sv(r,e,t,i){e.value=t,e.getSnapshot=i,bv(e)&&Cv(r)}function Av(r,e,t){return t(function(){bv(e)&&Cv(r)})}function bv(r){var e=r.getSnapshot;r=r.value;try{var t=e();return!Zt(r,t)}catch{return!0}}function Cv(r){var e=Gr(r,1);e!==null&&Yt(e,r,1,-1)}function cm(r){var e=lr();return typeof r=="function"&&(r=r()),e.memoizedState=e.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xo,lastRenderedState:r},e.queue=r,r=r.dispatch=FE.bind(null,Ae,r),[e.memoizedState,r]}function wo(r,e,t,i){return r={tag:r,create:e,destroy:t,deps:i,next:null},e=Ae.updateQueue,e===null?(e={lastEffect:null,stores:null},Ae.updateQueue=e,e.lastEffect=r.next=r):(t=e.lastEffect,t===null?e.lastEffect=r.next=r:(i=t.next,t.next=r,r.next=i,e.lastEffect=r)),r}function Rv(){return Nt().memoizedState}function za(r,e,t,i){var n=lr();Ae.flags|=r,n.memoizedState=wo(1|e,t,void 0,i===void 0?null:i)}function ou(r,e,t,i){var n=Nt();i=i===void 0?null:i;var s=void 0;if(Ue!==null){var o=Ue.memoizedState;if(s=o.destroy,i!==null&&Hf(i,o.deps)){n.memoizedState=wo(e,t,s,i);return}}Ae.flags|=r,n.memoizedState=wo(1|e,t,s,i)}function dm(r,e){return za(8390656,8,r,e)}function Vf(r,e){return ou(2048,8,r,e)}function Iv(r,e){return ou(4,2,r,e)}function Pv(r,e){return ou(4,4,r,e)}function kv(r,e){if(typeof e=="function")return r=r(),e(r),function(){e(null)};if(e!=null)return r=r(),e.current=r,function(){e.current=null}}function Mv(r,e,t){return t=t!=null?t.concat([r]):null,ou(4,4,kv.bind(null,e,r),t)}function Xf(){}function Dv(r,e){var t=Nt();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&Hf(e,i[1])?i[0]:(t.memoizedState=[r,e],r)}function Nv(r,e){var t=Nt();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&Hf(e,i[1])?i[0]:(r=r(),t.memoizedState=[r,e],r)}function Ov(r,e,t){return Ki&21?(Zt(t,e)||(t=G0(),Ae.lanes|=t,Zi|=t,r.baseState=!0),e):(r.baseState&&(r.baseState=!1,ht=!0),r.memoizedState=t)}function BE(r,e){var t=ae;ae=t!==0&&4>t?t:4,r(!0);var i=Qu.transition;Qu.transition={};try{r(!1),e()}finally{ae=t,Qu.transition=i}}function Bv(){return Nt().memoizedState}function LE(r,e,t){var i=fi(r);if(t={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null},Lv(r))Fv(e,t);else if(t=vv(r,e,t,i),t!==null){var n=st();Yt(t,r,i,n),Uv(t,e,i)}}function FE(r,e,t){var i=fi(r),n={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null};if(Lv(r))Fv(e,n);else{var s=r.alternate;if(r.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,t);if(n.hasEagerState=!0,n.eagerState=a,Zt(a,o)){var l=e.interleaved;l===null?(n.next=n,Bf(e)):(n.next=l.next,l.next=n),e.interleaved=n;return}}catch{}finally{}t=vv(r,e,n,i),t!==null&&(n=st(),Yt(t,r,i,n),Uv(t,e,i))}}function Lv(r){var e=r.alternate;return r===Ae||e!==null&&e===Ae}function Fv(r,e){qs=bl=!0;var t=r.pending;t===null?e.next=e:(e.next=t.next,t.next=e),r.pending=e}function Uv(r,e,t){if(t&4194240){var i=e.lanes;i&=r.pendingLanes,t|=i,e.lanes=t,Ef(r,t)}}var Cl={readContext:Dt,useCallback:Je,useContext:Je,useEffect:Je,useImperativeHandle:Je,useInsertionEffect:Je,useLayoutEffect:Je,useMemo:Je,useReducer:Je,useRef:Je,useState:Je,useDebugValue:Je,useDeferredValue:Je,useTransition:Je,useMutableSource:Je,useSyncExternalStore:Je,useId:Je,unstable_isNewReconciler:!1},UE={readContext:Dt,useCallback:function(r,e){return lr().memoizedState=[r,e===void 0?null:e],r},useContext:Dt,useEffect:dm,useImperativeHandle:function(r,e,t){return t=t!=null?t.concat([r]):null,za(4194308,4,kv.bind(null,e,r),t)},useLayoutEffect:function(r,e){return za(4194308,4,r,e)},useInsertionEffect:function(r,e){return za(4,2,r,e)},useMemo:function(r,e){var t=lr();return e=e===void 0?null:e,r=r(),t.memoizedState=[r,e],r},useReducer:function(r,e,t){var i=lr();return e=t!==void 0?t(e):e,i.memoizedState=i.baseState=e,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:e},i.queue=r,r=r.dispatch=LE.bind(null,Ae,r),[i.memoizedState,r]},useRef:function(r){var e=lr();return r={current:r},e.memoizedState=r},useState:cm,useDebugValue:Xf,useDeferredValue:function(r){return lr().memoizedState=r},useTransition:function(){var r=cm(!1),e=r[0];return r=BE.bind(null,r[1]),lr().memoizedState=r,[e,r]},useMutableSource:function(){},useSyncExternalStore:function(r,e,t){var i=Ae,n=lr();if(xe){if(t===void 0)throw Error(N(407));t=t()}else{if(t=e(),Xe===null)throw Error(N(349));Ki&30||Tv(i,e,t)}n.memoizedState=t;var s={value:t,getSnapshot:e};return n.queue=s,dm(Av.bind(null,i,s,r),[r]),i.flags|=2048,wo(9,Sv.bind(null,i,s,t,e),void 0,null),t},useId:function(){var r=lr(),e=Xe.identifierPrefix;if(xe){var t=kr,i=Pr;t=(i&~(1<<32-Wt(i)-1)).toString(32)+t,e=":"+e+"R"+t,t=_o++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=OE++,e=":"+e+"r"+t.toString(32)+":";return r.memoizedState=e},unstable_isNewReconciler:!1},GE={readContext:Dt,useCallback:Dv,useContext:Dt,useEffect:Vf,useImperativeHandle:Mv,useInsertionEffect:Iv,useLayoutEffect:Pv,useMemo:Nv,useReducer:Ju,useRef:Rv,useState:function(){return Ju(xo)},useDebugValue:Xf,useDeferredValue:function(r){var e=Nt();return Ov(e,Ue.memoizedState,r)},useTransition:function(){var r=Ju(xo)[0],e=Nt().memoizedState;return[r,e]},useMutableSource:wv,useSyncExternalStore:Ev,useId:Bv,unstable_isNewReconciler:!1},HE={readContext:Dt,useCallback:Dv,useContext:Dt,useEffect:Vf,useImperativeHandle:Mv,useInsertionEffect:Iv,useLayoutEffect:Pv,useMemo:Nv,useReducer:eh,useRef:Rv,useState:function(){return eh(xo)},useDebugValue:Xf,useDeferredValue:function(r){var e=Nt();return Ue===null?e.memoizedState=r:Ov(e,Ue.memoizedState,r)},useTransition:function(){var r=eh(xo)[0],e=Nt().memoizedState;return[r,e]},useMutableSource:wv,useSyncExternalStore:Ev,useId:Bv,unstable_isNewReconciler:!1};function $t(r,e){if(r&&r.defaultProps){e=be({},e),r=r.defaultProps;for(var t in r)e[t]===void 0&&(e[t]=r[t]);return e}return e}function Gc(r,e,t,i){e=r.memoizedState,t=t(i,e),t=t==null?e:be({},e,t),r.memoizedState=t,r.lanes===0&&(r.updateQueue.baseState=t)}var au={isMounted:function(r){return(r=r._reactInternals)?on(r)===r:!1},enqueueSetState:function(r,e,t){r=r._reactInternals;var i=st(),n=fi(r),s=Br(i,n);s.payload=e,t!=null&&(s.callback=t),e=ci(r,s,n),e!==null&&(Yt(e,r,n,i),Ha(e,r,n))},enqueueReplaceState:function(r,e,t){r=r._reactInternals;var i=st(),n=fi(r),s=Br(i,n);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=ci(r,s,n),e!==null&&(Yt(e,r,n,i),Ha(e,r,n))},enqueueForceUpdate:function(r,e){r=r._reactInternals;var t=st(),i=fi(r),n=Br(t,i);n.tag=2,e!=null&&(n.callback=e),e=ci(r,n,i),e!==null&&(Yt(e,r,i,t),Ha(e,r,i))}};function fm(r,e,t,i,n,s,o){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(i,s,o):e.prototype&&e.prototype.isPureReactComponent?!fo(t,i)||!fo(n,s):!0}function Gv(r,e,t){var i=!1,n=vi,s=e.contextType;return typeof s=="object"&&s!==null?s=Dt(s):(n=ft(e)?Yi:rt.current,i=e.contextTypes,s=(i=i!=null)?es(r,n):vi),e=new e(t,s),r.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=au,r.stateNode=e,e._reactInternals=r,i&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=n,r.__reactInternalMemoizedMaskedChildContext=s),e}function pm(r,e,t,i){r=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,i),e.state!==r&&au.enqueueReplaceState(e,e.state,null)}function Hc(r,e,t,i){var n=r.stateNode;n.props=t,n.state=r.memoizedState,n.refs={},Lf(r);var s=e.contextType;typeof s=="object"&&s!==null?n.context=Dt(s):(s=ft(e)?Yi:rt.current,n.context=es(r,s)),n.state=r.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Gc(r,e,s,t),n.state=r.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(e=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),e!==n.state&&au.enqueueReplaceState(n,n.state,null),Sl(r,t,n,i),n.state=r.memoizedState),typeof n.componentDidMount=="function"&&(r.flags|=4194308)}function ns(r,e){try{var t="",i=e;do t+=mw(i),i=i.return;while(i);var n=t}catch(s){n=`
Error generating stack: `+s.message+`
`+s.stack}return{value:r,source:e,stack:n,digest:null}}function th(r,e,t){return{value:r,source:null,stack:t??null,digest:e??null}}function $c(r,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var $E=typeof WeakMap=="function"?WeakMap:Map;function Hv(r,e,t){t=Br(-1,t),t.tag=3,t.payload={element:null};var i=e.value;return t.callback=function(){Il||(Il=!0,Qc=i),$c(r,e)},t}function $v(r,e,t){t=Br(-1,t),t.tag=3;var i=r.type.getDerivedStateFromError;if(typeof i=="function"){var n=e.value;t.payload=function(){return i(n)},t.callback=function(){$c(r,e)}}var s=r.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){$c(r,e),typeof i!="function"&&(di===null?di=new Set([this]):di.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function mm(r,e,t){var i=r.pingCache;if(i===null){i=r.pingCache=new $E;var n=new Set;i.set(e,n)}else n=i.get(e),n===void 0&&(n=new Set,i.set(e,n));n.has(t)||(n.add(t),r=rT.bind(null,r,e,t),e.then(r,r))}function gm(r){do{var e;if((e=r.tag===13)&&(e=r.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return r;r=r.return}while(r!==null);return null}function ym(r,e,t,i,n){return r.mode&1?(r.flags|=65536,r.lanes=n,r):(r===e?r.flags|=65536:(r.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Br(-1,1),e.tag=2,ci(t,e,1))),t.lanes|=1),r)}var zE=Vr.ReactCurrentOwner,ht=!1;function it(r,e,t,i){e.child=r===null?yv(e,null,t,i):rs(e,r.child,t,i)}function vm(r,e,t,i,n){t=t.render;var s=e.ref;return zn(e,n),i=$f(r,e,t,i,s,n),t=zf(),r!==null&&!ht?(e.updateQueue=r.updateQueue,e.flags&=-2053,r.lanes&=~n,Hr(r,e,n)):(xe&&t&&Pf(e),e.flags|=1,it(r,e,i,n),e.child)}function _m(r,e,t,i,n){if(r===null){var s=t.type;return typeof s=="function"&&!Jf(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,zv(r,e,s,i,n)):(r=Wa(t.type,null,i,e,e.mode,n),r.ref=e.ref,r.return=e,e.child=r)}if(s=r.child,!(r.lanes&n)){var o=s.memoizedProps;if(t=t.compare,t=t!==null?t:fo,t(o,i)&&r.ref===e.ref)return Hr(r,e,n)}return e.flags|=1,r=pi(s,i),r.ref=e.ref,r.return=e,e.child=r}function zv(r,e,t,i,n){if(r!==null){var s=r.memoizedProps;if(fo(s,i)&&r.ref===e.ref)if(ht=!1,e.pendingProps=i=s,(r.lanes&n)!==0)r.flags&131072&&(ht=!0);else return e.lanes=r.lanes,Hr(r,e,n)}return zc(r,e,t,i,n)}function Vv(r,e,t){var i=e.pendingProps,n=i.children,s=r!==null?r.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},de(Bn,yt),yt|=t;else{if(!(t&1073741824))return r=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:r,cachePool:null,transitions:null},e.updateQueue=null,de(Bn,yt),yt|=r,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:t,de(Bn,yt),yt|=i}else s!==null?(i=s.baseLanes|t,e.memoizedState=null):i=t,de(Bn,yt),yt|=i;return it(r,e,n,t),e.child}function Xv(r,e){var t=e.ref;(r===null&&t!==null||r!==null&&r.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function zc(r,e,t,i,n){var s=ft(t)?Yi:rt.current;return s=es(e,s),zn(e,n),t=$f(r,e,t,i,s,n),i=zf(),r!==null&&!ht?(e.updateQueue=r.updateQueue,e.flags&=-2053,r.lanes&=~n,Hr(r,e,n)):(xe&&i&&Pf(e),e.flags|=1,it(r,e,t,n),e.child)}function xm(r,e,t,i,n){if(ft(t)){var s=!0;_l(e)}else s=!1;if(zn(e,n),e.stateNode===null)Va(r,e),Gv(e,t,i),Hc(e,t,i,n),i=!0;else if(r===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=t.contextType;typeof u=="object"&&u!==null?u=Dt(u):(u=ft(t)?Yi:rt.current,u=es(e,u));var h=t.getDerivedStateFromProps,d=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==i||l!==u)&&pm(e,o,i,u),Zr=!1;var c=e.memoizedState;o.state=c,Sl(e,i,o,n),l=e.memoizedState,a!==i||c!==l||dt.current||Zr?(typeof h=="function"&&(Gc(e,t,h,i),l=e.memoizedState),(a=Zr||fm(e,t,a,i,c,l,u))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=l),o.props=i,o.state=l,o.context=u,i=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{o=e.stateNode,_v(r,e),a=e.memoizedProps,u=e.type===e.elementType?a:$t(e.type,a),o.props=u,d=e.pendingProps,c=o.context,l=t.contextType,typeof l=="object"&&l!==null?l=Dt(l):(l=ft(t)?Yi:rt.current,l=es(e,l));var f=t.getDerivedStateFromProps;(h=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||c!==l)&&pm(e,o,i,l),Zr=!1,c=e.memoizedState,o.state=c,Sl(e,i,o,n);var p=e.memoizedState;a!==d||c!==p||dt.current||Zr?(typeof f=="function"&&(Gc(e,t,f,i),p=e.memoizedState),(u=Zr||fm(e,t,u,i,c,p,l)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(i,p,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(i,p,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===r.memoizedProps&&c===r.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===r.memoizedProps&&c===r.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=p),o.props=i,o.state=p,o.context=l,i=u):(typeof o.componentDidUpdate!="function"||a===r.memoizedProps&&c===r.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===r.memoizedProps&&c===r.memoizedState||(e.flags|=1024),i=!1)}return Vc(r,e,t,i,s,n)}function Vc(r,e,t,i,n,s){Xv(r,e);var o=(e.flags&128)!==0;if(!i&&!o)return n&&sm(e,t,!1),Hr(r,e,s);i=e.stateNode,zE.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,r!==null&&o?(e.child=rs(e,r.child,null,s),e.child=rs(e,null,a,s)):it(r,e,a,s),e.memoizedState=i.state,n&&sm(e,t,!0),e.child}function jv(r){var e=r.stateNode;e.pendingContext?nm(r,e.pendingContext,e.pendingContext!==e.context):e.context&&nm(r,e.context,!1),Ff(r,e.containerInfo)}function wm(r,e,t,i,n){return ts(),Mf(n),e.flags|=256,it(r,e,t,i),e.child}var Xc={dehydrated:null,treeContext:null,retryLane:0};function jc(r){return{baseLanes:r,cachePool:null,transitions:null}}function Wv(r,e,t){var i=e.pendingProps,n=Te.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=r!==null&&r.memoizedState===null?!1:(n&2)!==0),a?(s=!0,e.flags&=-129):(r===null||r.memoizedState!==null)&&(n|=1),de(Te,n&1),r===null)return Fc(e),r=e.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?(e.mode&1?r.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=i.children,r=i.fallback,s?(i=e.mode,s=e.child,o={mode:"hidden",children:o},!(i&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=hu(o,i,0,null),r=Vi(r,i,t,null),s.return=e,r.return=e,s.sibling=r,e.child=s,e.child.memoizedState=jc(t),e.memoizedState=Xc,r):jf(e,o));if(n=r.memoizedState,n!==null&&(a=n.dehydrated,a!==null))return VE(r,e,o,i,a,n,t);if(s){s=i.fallback,o=e.mode,n=r.child,a=n.sibling;var l={mode:"hidden",children:i.children};return!(o&1)&&e.child!==n?(i=e.child,i.childLanes=0,i.pendingProps=l,e.deletions=null):(i=pi(n,l),i.subtreeFlags=n.subtreeFlags&14680064),a!==null?s=pi(a,s):(s=Vi(s,o,t,null),s.flags|=2),s.return=e,i.return=e,i.sibling=s,e.child=i,i=s,s=e.child,o=r.child.memoizedState,o=o===null?jc(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=r.childLanes&~t,e.memoizedState=Xc,i}return s=r.child,r=s.sibling,i=pi(s,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=t),i.return=e,i.sibling=null,r!==null&&(t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)),e.child=i,e.memoizedState=null,i}function jf(r,e){return e=hu({mode:"visible",children:e},r.mode,0,null),e.return=r,r.child=e}function ra(r,e,t,i){return i!==null&&Mf(i),rs(e,r.child,null,t),r=jf(e,e.pendingProps.children),r.flags|=2,e.memoizedState=null,r}function VE(r,e,t,i,n,s,o){if(t)return e.flags&256?(e.flags&=-257,i=th(Error(N(422))),ra(r,e,o,i)):e.memoizedState!==null?(e.child=r.child,e.flags|=128,null):(s=i.fallback,n=e.mode,i=hu({mode:"visible",children:i.children},n,0,null),s=Vi(s,n,o,null),s.flags|=2,i.return=e,s.return=e,i.sibling=s,e.child=i,e.mode&1&&rs(e,r.child,null,o),e.child.memoizedState=jc(o),e.memoizedState=Xc,s);if(!(e.mode&1))return ra(r,e,o,null);if(n.data==="$!"){if(i=n.nextSibling&&n.nextSibling.dataset,i)var a=i.dgst;return i=a,s=Error(N(419)),i=th(s,i,void 0),ra(r,e,o,i)}if(a=(o&r.childLanes)!==0,ht||a){if(i=Xe,i!==null){switch(o&-o){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}n=n&(i.suspendedLanes|o)?0:n,n!==0&&n!==s.retryLane&&(s.retryLane=n,Gr(r,n),Yt(i,r,n,-1))}return Qf(),i=th(Error(N(421))),ra(r,e,o,i)}return n.data==="$?"?(e.flags|=128,e.child=r.child,e=iT.bind(null,r),n._reactRetry=e,null):(r=s.treeContext,vt=hi(n.nextSibling),xt=e,xe=!0,Xt=null,r!==null&&(bt[Ct++]=Pr,bt[Ct++]=kr,bt[Ct++]=qi,Pr=r.id,kr=r.overflow,qi=e),e=jf(e,i.children),e.flags|=4096,e)}function Em(r,e,t){r.lanes|=e;var i=r.alternate;i!==null&&(i.lanes|=e),Uc(r.return,e,t)}function rh(r,e,t,i,n){var s=r.memoizedState;s===null?r.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:t,tailMode:n}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=t,s.tailMode=n)}function Yv(r,e,t){var i=e.pendingProps,n=i.revealOrder,s=i.tail;if(it(r,e,i.children,t),i=Te.current,i&2)i=i&1|2,e.flags|=128;else{if(r!==null&&r.flags&128)e:for(r=e.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&Em(r,t,e);else if(r.tag===19)Em(r,t,e);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break e;for(;r.sibling===null;){if(r.return===null||r.return===e)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}i&=1}if(de(Te,i),!(e.mode&1))e.memoizedState=null;else switch(n){case"forwards":for(t=e.child,n=null;t!==null;)r=t.alternate,r!==null&&Al(r)===null&&(n=t),t=t.sibling;t=n,t===null?(n=e.child,e.child=null):(n=t.sibling,t.sibling=null),rh(e,!1,n,t,s);break;case"backwards":for(t=null,n=e.child,e.child=null;n!==null;){if(r=n.alternate,r!==null&&Al(r)===null){e.child=n;break}r=n.sibling,n.sibling=t,t=n,n=r}rh(e,!0,t,null,s);break;case"together":rh(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Va(r,e){!(e.mode&1)&&r!==null&&(r.alternate=null,e.alternate=null,e.flags|=2)}function Hr(r,e,t){if(r!==null&&(e.dependencies=r.dependencies),Zi|=e.lanes,!(t&e.childLanes))return null;if(r!==null&&e.child!==r.child)throw Error(N(153));if(e.child!==null){for(r=e.child,t=pi(r,r.pendingProps),e.child=t,t.return=e;r.sibling!==null;)r=r.sibling,t=t.sibling=pi(r,r.pendingProps),t.return=e;t.sibling=null}return e.child}function XE(r,e,t){switch(e.tag){case 3:jv(e),ts();break;case 5:xv(e);break;case 1:ft(e.type)&&_l(e);break;case 4:Ff(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,n=e.memoizedProps.value;de(El,i._currentValue),i._currentValue=n;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(de(Te,Te.current&1),e.flags|=128,null):t&e.child.childLanes?Wv(r,e,t):(de(Te,Te.current&1),r=Hr(r,e,t),r!==null?r.sibling:null);de(Te,Te.current&1);break;case 19:if(i=(t&e.childLanes)!==0,r.flags&128){if(i)return Yv(r,e,t);e.flags|=128}if(n=e.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),de(Te,Te.current),i)break;return null;case 22:case 23:return e.lanes=0,Vv(r,e,t)}return Hr(r,e,t)}var qv,Wc,Kv,Zv;qv=function(r,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)r.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};Wc=function(){};Kv=function(r,e,t,i){var n=r.memoizedProps;if(n!==i){r=e.stateNode,$i(mr.current);var s=null;switch(t){case"input":n=mc(r,n),i=mc(r,i),s=[];break;case"select":n=be({},n,{value:void 0}),i=be({},i,{value:void 0}),s=[];break;case"textarea":n=vc(r,n),i=vc(r,i),s=[];break;default:typeof n.onClick!="function"&&typeof i.onClick=="function"&&(r.onclick=yl)}xc(t,i);var o;t=null;for(u in n)if(!i.hasOwnProperty(u)&&n.hasOwnProperty(u)&&n[u]!=null)if(u==="style"){var a=n[u];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(so.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in i){var l=i[u];if(a=n!=null?n[u]:void 0,i.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(t||(t={}),t[o]=l[o])}else t||(s||(s=[]),s.push(u,t)),t=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(so.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&pe("scroll",r),s||a===l||(s=[])):(s=s||[]).push(u,l))}t&&(s=s||[]).push("style",t);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};Zv=function(r,e,t,i){t!==i&&(e.flags|=4)};function Ts(r,e){if(!xe)switch(r.tailMode){case"hidden":e=r.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?r.tail=null:t.sibling=null;break;case"collapsed":t=r.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e||r.tail===null?r.tail=null:r.tail.sibling=null:i.sibling=null}}function et(r){var e=r.alternate!==null&&r.alternate.child===r.child,t=0,i=0;if(e)for(var n=r.child;n!==null;)t|=n.lanes|n.childLanes,i|=n.subtreeFlags&14680064,i|=n.flags&14680064,n.return=r,n=n.sibling;else for(n=r.child;n!==null;)t|=n.lanes|n.childLanes,i|=n.subtreeFlags,i|=n.flags,n.return=r,n=n.sibling;return r.subtreeFlags|=i,r.childLanes=t,e}function jE(r,e,t){var i=e.pendingProps;switch(kf(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return et(e),null;case 1:return ft(e.type)&&vl(),et(e),null;case 3:return i=e.stateNode,is(),ge(dt),ge(rt),Gf(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(r===null||r.child===null)&&(ea(e)?e.flags|=4:r===null||r.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Xt!==null&&(td(Xt),Xt=null))),Wc(r,e),et(e),null;case 5:Uf(e);var n=$i(vo.current);if(t=e.type,r!==null&&e.stateNode!=null)Kv(r,e,t,i,n),r.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(N(166));return et(e),null}if(r=$i(mr.current),ea(e)){i=e.stateNode,t=e.type;var s=e.memoizedProps;switch(i[dr]=e,i[go]=s,r=(e.mode&1)!==0,t){case"dialog":pe("cancel",i),pe("close",i);break;case"iframe":case"object":case"embed":pe("load",i);break;case"video":case"audio":for(n=0;n<Ns.length;n++)pe(Ns[n],i);break;case"source":pe("error",i);break;case"img":case"image":case"link":pe("error",i),pe("load",i);break;case"details":pe("toggle",i);break;case"input":kp(i,s),pe("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},pe("invalid",i);break;case"textarea":Dp(i,s),pe("invalid",i)}xc(t,s),n=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?i.textContent!==a&&(s.suppressHydrationWarning!==!0&&Jo(i.textContent,a,r),n=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Jo(i.textContent,a,r),n=["children",""+a]):so.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&pe("scroll",i)}switch(t){case"input":Xo(i),Mp(i,s,!0);break;case"textarea":Xo(i),Np(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=yl)}i=n,e.updateQueue=i,i!==null&&(e.flags|=4)}else{o=n.nodeType===9?n:n.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=A0(t)),r==="http://www.w3.org/1999/xhtml"?t==="script"?(r=o.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof i.is=="string"?r=o.createElement(t,{is:i.is}):(r=o.createElement(t),t==="select"&&(o=r,i.multiple?o.multiple=!0:i.size&&(o.size=i.size))):r=o.createElementNS(r,t),r[dr]=e,r[go]=i,qv(r,e,!1,!1),e.stateNode=r;e:{switch(o=wc(t,i),t){case"dialog":pe("cancel",r),pe("close",r),n=i;break;case"iframe":case"object":case"embed":pe("load",r),n=i;break;case"video":case"audio":for(n=0;n<Ns.length;n++)pe(Ns[n],r);n=i;break;case"source":pe("error",r),n=i;break;case"img":case"image":case"link":pe("error",r),pe("load",r),n=i;break;case"details":pe("toggle",r),n=i;break;case"input":kp(r,i),n=mc(r,i),pe("invalid",r);break;case"option":n=i;break;case"select":r._wrapperState={wasMultiple:!!i.multiple},n=be({},i,{value:void 0}),pe("invalid",r);break;case"textarea":Dp(r,i),n=vc(r,i),pe("invalid",r);break;default:n=i}xc(t,n),a=n;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?R0(r,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&b0(r,l)):s==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&oo(r,l):typeof l=="number"&&oo(r,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(so.hasOwnProperty(s)?l!=null&&s==="onScroll"&&pe("scroll",r):l!=null&&gf(r,s,l,o))}switch(t){case"input":Xo(r),Mp(r,i,!1);break;case"textarea":Xo(r),Np(r);break;case"option":i.value!=null&&r.setAttribute("value",""+yi(i.value));break;case"select":r.multiple=!!i.multiple,s=i.value,s!=null?Un(r,!!i.multiple,s,!1):i.defaultValue!=null&&Un(r,!!i.multiple,i.defaultValue,!0);break;default:typeof n.onClick=="function"&&(r.onclick=yl)}switch(t){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return et(e),null;case 6:if(r&&e.stateNode!=null)Zv(r,e,r.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(N(166));if(t=$i(vo.current),$i(mr.current),ea(e)){if(i=e.stateNode,t=e.memoizedProps,i[dr]=e,(s=i.nodeValue!==t)&&(r=xt,r!==null))switch(r.tag){case 3:Jo(i.nodeValue,t,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&Jo(i.nodeValue,t,(r.mode&1)!==0)}s&&(e.flags|=4)}else i=(t.nodeType===9?t:t.ownerDocument).createTextNode(i),i[dr]=e,e.stateNode=i}return et(e),null;case 13:if(ge(Te),i=e.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(xe&&vt!==null&&e.mode&1&&!(e.flags&128))mv(),ts(),e.flags|=98560,s=!1;else if(s=ea(e),i!==null&&i.dehydrated!==null){if(r===null){if(!s)throw Error(N(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(N(317));s[dr]=e}else ts(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;et(e),s=!1}else Xt!==null&&(td(Xt),Xt=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(i=i!==null,i!==(r!==null&&r.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(r===null||Te.current&1?Ge===0&&(Ge=3):Qf())),e.updateQueue!==null&&(e.flags|=4),et(e),null);case 4:return is(),Wc(r,e),r===null&&po(e.stateNode.containerInfo),et(e),null;case 10:return Of(e.type._context),et(e),null;case 17:return ft(e.type)&&vl(),et(e),null;case 19:if(ge(Te),s=e.memoizedState,s===null)return et(e),null;if(i=(e.flags&128)!==0,o=s.rendering,o===null)if(i)Ts(s,!1);else{if(Ge!==0||r!==null&&r.flags&128)for(r=e.child;r!==null;){if(o=Al(r),o!==null){for(e.flags|=128,Ts(s,!1),i=o.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=t,t=e.child;t!==null;)s=t,r=i,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=r,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,r=o.dependencies,s.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),t=t.sibling;return de(Te,Te.current&1|2),e.child}r=r.sibling}s.tail!==null&&Me()>ss&&(e.flags|=128,i=!0,Ts(s,!1),e.lanes=4194304)}else{if(!i)if(r=Al(o),r!==null){if(e.flags|=128,i=!0,t=r.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Ts(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!xe)return et(e),null}else 2*Me()-s.renderingStartTime>ss&&t!==1073741824&&(e.flags|=128,i=!0,Ts(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(t=s.last,t!==null?t.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Me(),e.sibling=null,t=Te.current,de(Te,i?t&1|2:t&1),e):(et(e),null);case 22:case 23:return Zf(),i=e.memoizedState!==null,r!==null&&r.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?yt&1073741824&&(et(e),e.subtreeFlags&6&&(e.flags|=8192)):et(e),null;case 24:return null;case 25:return null}throw Error(N(156,e.tag))}function WE(r,e){switch(kf(e),e.tag){case 1:return ft(e.type)&&vl(),r=e.flags,r&65536?(e.flags=r&-65537|128,e):null;case 3:return is(),ge(dt),ge(rt),Gf(),r=e.flags,r&65536&&!(r&128)?(e.flags=r&-65537|128,e):null;case 5:return Uf(e),null;case 13:if(ge(Te),r=e.memoizedState,r!==null&&r.dehydrated!==null){if(e.alternate===null)throw Error(N(340));ts()}return r=e.flags,r&65536?(e.flags=r&-65537|128,e):null;case 19:return ge(Te),null;case 4:return is(),null;case 10:return Of(e.type._context),null;case 22:case 23:return Zf(),null;case 24:return null;default:return null}}var ia=!1,tt=!1,YE=typeof WeakSet=="function"?WeakSet:Set,H=null;function On(r,e){var t=r.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(i){Ie(r,e,i)}else t.current=null}function Yc(r,e,t){try{t()}catch(i){Ie(r,e,i)}}var Tm=!1;function qE(r,e){if(kc=pl,r=rv(),If(r)){if("selectionStart"in r)var t={start:r.selectionStart,end:r.selectionEnd};else e:{t=(t=r.ownerDocument)&&t.defaultView||window;var i=t.getSelection&&t.getSelection();if(i&&i.rangeCount!==0){t=i.anchorNode;var n=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var o=0,a=-1,l=-1,u=0,h=0,d=r,c=null;t:for(;;){for(var f;d!==t||n!==0&&d.nodeType!==3||(a=o+n),d!==s||i!==0&&d.nodeType!==3||(l=o+i),d.nodeType===3&&(o+=d.nodeValue.length),(f=d.firstChild)!==null;)c=d,d=f;for(;;){if(d===r)break t;if(c===t&&++u===n&&(a=o),c===s&&++h===i&&(l=o),(f=d.nextSibling)!==null)break;d=c,c=d.parentNode}d=f}t=a===-1||l===-1?null:{start:a,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(Mc={focusedElem:r,selectionRange:t},pl=!1,H=e;H!==null;)if(e=H,r=e.child,(e.subtreeFlags&1028)!==0&&r!==null)r.return=e,H=r;else for(;H!==null;){e=H;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var v=p.memoizedProps,x=p.memoizedState,g=e.stateNode,y=g.getSnapshotBeforeUpdate(e.elementType===e.type?v:$t(e.type,v),x);g.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var m=e.stateNode.containerInfo;m.nodeType===1?m.textContent="":m.nodeType===9&&m.documentElement&&m.removeChild(m.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(N(163))}}catch(_){Ie(e,e.return,_)}if(r=e.sibling,r!==null){r.return=e.return,H=r;break}H=e.return}return p=Tm,Tm=!1,p}function Ks(r,e,t){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var n=i=i.next;do{if((n.tag&r)===r){var s=n.destroy;n.destroy=void 0,s!==void 0&&Yc(e,t,s)}n=n.next}while(n!==i)}}function lu(r,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&r)===r){var i=t.create;t.destroy=i()}t=t.next}while(t!==e)}}function qc(r){var e=r.ref;if(e!==null){var t=r.stateNode;switch(r.tag){case 5:r=t;break;default:r=t}typeof e=="function"?e(r):e.current=r}}function Qv(r){var e=r.alternate;e!==null&&(r.alternate=null,Qv(e)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(e=r.stateNode,e!==null&&(delete e[dr],delete e[go],delete e[Oc],delete e[kE],delete e[ME])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function Jv(r){return r.tag===5||r.tag===3||r.tag===4}function Sm(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||Jv(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Kc(r,e,t){var i=r.tag;if(i===5||i===6)r=r.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(r,e):t.insertBefore(r,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(r,t)):(e=t,e.appendChild(r)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=yl));else if(i!==4&&(r=r.child,r!==null))for(Kc(r,e,t),r=r.sibling;r!==null;)Kc(r,e,t),r=r.sibling}function Zc(r,e,t){var i=r.tag;if(i===5||i===6)r=r.stateNode,e?t.insertBefore(r,e):t.appendChild(r);else if(i!==4&&(r=r.child,r!==null))for(Zc(r,e,t),r=r.sibling;r!==null;)Zc(r,e,t),r=r.sibling}var qe=null,zt=!1;function jr(r,e,t){for(t=t.child;t!==null;)e_(r,e,t),t=t.sibling}function e_(r,e,t){if(pr&&typeof pr.onCommitFiberUnmount=="function")try{pr.onCommitFiberUnmount(eu,t)}catch{}switch(t.tag){case 5:tt||On(t,e);case 6:var i=qe,n=zt;qe=null,jr(r,e,t),qe=i,zt=n,qe!==null&&(zt?(r=qe,t=t.stateNode,r.nodeType===8?r.parentNode.removeChild(t):r.removeChild(t)):qe.removeChild(t.stateNode));break;case 18:qe!==null&&(zt?(r=qe,t=t.stateNode,r.nodeType===8?qu(r.parentNode,t):r.nodeType===1&&qu(r,t),ho(r)):qu(qe,t.stateNode));break;case 4:i=qe,n=zt,qe=t.stateNode.containerInfo,zt=!0,jr(r,e,t),qe=i,zt=n;break;case 0:case 11:case 14:case 15:if(!tt&&(i=t.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){n=i=i.next;do{var s=n,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Yc(t,e,o),n=n.next}while(n!==i)}jr(r,e,t);break;case 1:if(!tt&&(On(t,e),i=t.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=t.memoizedProps,i.state=t.memoizedState,i.componentWillUnmount()}catch(a){Ie(t,e,a)}jr(r,e,t);break;case 21:jr(r,e,t);break;case 22:t.mode&1?(tt=(i=tt)||t.memoizedState!==null,jr(r,e,t),tt=i):jr(r,e,t);break;default:jr(r,e,t)}}function Am(r){var e=r.updateQueue;if(e!==null){r.updateQueue=null;var t=r.stateNode;t===null&&(t=r.stateNode=new YE),e.forEach(function(i){var n=nT.bind(null,r,i);t.has(i)||(t.add(i),i.then(n,n))})}}function Lt(r,e){var t=e.deletions;if(t!==null)for(var i=0;i<t.length;i++){var n=t[i];try{var s=r,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:qe=a.stateNode,zt=!1;break e;case 3:qe=a.stateNode.containerInfo,zt=!0;break e;case 4:qe=a.stateNode.containerInfo,zt=!0;break e}a=a.return}if(qe===null)throw Error(N(160));e_(s,o,n),qe=null,zt=!1;var l=n.alternate;l!==null&&(l.return=null),n.return=null}catch(u){Ie(n,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)t_(e,r),e=e.sibling}function t_(r,e){var t=r.alternate,i=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(Lt(e,r),er(r),i&4){try{Ks(3,r,r.return),lu(3,r)}catch(v){Ie(r,r.return,v)}try{Ks(5,r,r.return)}catch(v){Ie(r,r.return,v)}}break;case 1:Lt(e,r),er(r),i&512&&t!==null&&On(t,t.return);break;case 5:if(Lt(e,r),er(r),i&512&&t!==null&&On(t,t.return),r.flags&32){var n=r.stateNode;try{oo(n,"")}catch(v){Ie(r,r.return,v)}}if(i&4&&(n=r.stateNode,n!=null)){var s=r.memoizedProps,o=t!==null?t.memoizedProps:s,a=r.type,l=r.updateQueue;if(r.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&T0(n,s),wc(a,o);var u=wc(a,s);for(o=0;o<l.length;o+=2){var h=l[o],d=l[o+1];h==="style"?R0(n,d):h==="dangerouslySetInnerHTML"?b0(n,d):h==="children"?oo(n,d):gf(n,h,d,u)}switch(a){case"input":gc(n,s);break;case"textarea":S0(n,s);break;case"select":var c=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!s.multiple;var f=s.value;f!=null?Un(n,!!s.multiple,f,!1):c!==!!s.multiple&&(s.defaultValue!=null?Un(n,!!s.multiple,s.defaultValue,!0):Un(n,!!s.multiple,s.multiple?[]:"",!1))}n[go]=s}catch(v){Ie(r,r.return,v)}}break;case 6:if(Lt(e,r),er(r),i&4){if(r.stateNode===null)throw Error(N(162));n=r.stateNode,s=r.memoizedProps;try{n.nodeValue=s}catch(v){Ie(r,r.return,v)}}break;case 3:if(Lt(e,r),er(r),i&4&&t!==null&&t.memoizedState.isDehydrated)try{ho(e.containerInfo)}catch(v){Ie(r,r.return,v)}break;case 4:Lt(e,r),er(r);break;case 13:Lt(e,r),er(r),n=r.child,n.flags&8192&&(s=n.memoizedState!==null,n.stateNode.isHidden=s,!s||n.alternate!==null&&n.alternate.memoizedState!==null||(qf=Me())),i&4&&Am(r);break;case 22:if(h=t!==null&&t.memoizedState!==null,r.mode&1?(tt=(u=tt)||h,Lt(e,r),tt=u):Lt(e,r),er(r),i&8192){if(u=r.memoizedState!==null,(r.stateNode.isHidden=u)&&!h&&r.mode&1)for(H=r,h=r.child;h!==null;){for(d=H=h;H!==null;){switch(c=H,f=c.child,c.tag){case 0:case 11:case 14:case 15:Ks(4,c,c.return);break;case 1:On(c,c.return);var p=c.stateNode;if(typeof p.componentWillUnmount=="function"){i=c,t=c.return;try{e=i,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(v){Ie(i,t,v)}}break;case 5:On(c,c.return);break;case 22:if(c.memoizedState!==null){Cm(d);continue}}f!==null?(f.return=c,H=f):Cm(d)}h=h.sibling}e:for(h=null,d=r;;){if(d.tag===5){if(h===null){h=d;try{n=d.stateNode,u?(s=n.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=d.stateNode,l=d.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=C0("display",o))}catch(v){Ie(r,r.return,v)}}}else if(d.tag===6){if(h===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(v){Ie(r,r.return,v)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===r)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===r)break e;for(;d.sibling===null;){if(d.return===null||d.return===r)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Lt(e,r),er(r),i&4&&Am(r);break;case 21:break;default:Lt(e,r),er(r)}}function er(r){var e=r.flags;if(e&2){try{e:{for(var t=r.return;t!==null;){if(Jv(t)){var i=t;break e}t=t.return}throw Error(N(160))}switch(i.tag){case 5:var n=i.stateNode;i.flags&32&&(oo(n,""),i.flags&=-33);var s=Sm(r);Zc(r,s,n);break;case 3:case 4:var o=i.stateNode.containerInfo,a=Sm(r);Kc(r,a,o);break;default:throw Error(N(161))}}catch(l){Ie(r,r.return,l)}r.flags&=-3}e&4096&&(r.flags&=-4097)}function KE(r,e,t){H=r,r_(r)}function r_(r,e,t){for(var i=(r.mode&1)!==0;H!==null;){var n=H,s=n.child;if(n.tag===22&&i){var o=n.memoizedState!==null||ia;if(!o){var a=n.alternate,l=a!==null&&a.memoizedState!==null||tt;a=ia;var u=tt;if(ia=o,(tt=l)&&!u)for(H=n;H!==null;)o=H,l=o.child,o.tag===22&&o.memoizedState!==null?Rm(n):l!==null?(l.return=o,H=l):Rm(n);for(;s!==null;)H=s,r_(s),s=s.sibling;H=n,ia=a,tt=u}bm(r)}else n.subtreeFlags&8772&&s!==null?(s.return=n,H=s):bm(r)}}function bm(r){for(;H!==null;){var e=H;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:tt||lu(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!tt)if(t===null)i.componentDidMount();else{var n=e.elementType===e.type?t.memoizedProps:$t(e.type,t.memoizedProps);i.componentDidUpdate(n,t.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&hm(e,s,i);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}hm(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var d=h.dehydrated;d!==null&&ho(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(N(163))}tt||e.flags&512&&qc(e)}catch(c){Ie(e,e.return,c)}}if(e===r){H=null;break}if(t=e.sibling,t!==null){t.return=e.return,H=t;break}H=e.return}}function Cm(r){for(;H!==null;){var e=H;if(e===r){H=null;break}var t=e.sibling;if(t!==null){t.return=e.return,H=t;break}H=e.return}}function Rm(r){for(;H!==null;){var e=H;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{lu(4,e)}catch(l){Ie(e,t,l)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var n=e.return;try{i.componentDidMount()}catch(l){Ie(e,n,l)}}var s=e.return;try{qc(e)}catch(l){Ie(e,s,l)}break;case 5:var o=e.return;try{qc(e)}catch(l){Ie(e,o,l)}}}catch(l){Ie(e,e.return,l)}if(e===r){H=null;break}var a=e.sibling;if(a!==null){a.return=e.return,H=a;break}H=e.return}}var ZE=Math.ceil,Rl=Vr.ReactCurrentDispatcher,Wf=Vr.ReactCurrentOwner,Mt=Vr.ReactCurrentBatchConfig,se=0,Xe=null,Oe=null,Ze=0,yt=0,Bn=Si(0),Ge=0,Eo=null,Zi=0,uu=0,Yf=0,Zs=null,ut=null,qf=0,ss=1/0,br=null,Il=!1,Qc=null,di=null,na=!1,ii=null,Pl=0,Qs=0,Jc=null,Xa=-1,ja=0;function st(){return se&6?Me():Xa!==-1?Xa:Xa=Me()}function fi(r){return r.mode&1?se&2&&Ze!==0?Ze&-Ze:NE.transition!==null?(ja===0&&(ja=G0()),ja):(r=ae,r!==0||(r=window.event,r=r===void 0?16:W0(r.type)),r):1}function Yt(r,e,t,i){if(50<Qs)throw Qs=0,Jc=null,Error(N(185));ko(r,t,i),(!(se&2)||r!==Xe)&&(r===Xe&&(!(se&2)&&(uu|=t),Ge===4&&ei(r,Ze)),pt(r,i),t===1&&se===0&&!(e.mode&1)&&(ss=Me()+500,su&&Ai()))}function pt(r,e){var t=r.callbackNode;Nw(r,e);var i=fl(r,r===Xe?Ze:0);if(i===0)t!==null&&Lp(t),r.callbackNode=null,r.callbackPriority=0;else if(e=i&-i,r.callbackPriority!==e){if(t!=null&&Lp(t),e===1)r.tag===0?DE(Im.bind(null,r)):dv(Im.bind(null,r)),IE(function(){!(se&6)&&Ai()}),t=null;else{switch(H0(i)){case 1:t=wf;break;case 4:t=F0;break;case 16:t=dl;break;case 536870912:t=U0;break;default:t=dl}t=h_(t,i_.bind(null,r))}r.callbackPriority=e,r.callbackNode=t}}function i_(r,e){if(Xa=-1,ja=0,se&6)throw Error(N(327));var t=r.callbackNode;if(Vn()&&r.callbackNode!==t)return null;var i=fl(r,r===Xe?Ze:0);if(i===0)return null;if(i&30||i&r.expiredLanes||e)e=kl(r,i);else{e=i;var n=se;se|=2;var s=s_();(Xe!==r||Ze!==e)&&(br=null,ss=Me()+500,zi(r,e));do try{eT();break}catch(a){n_(r,a)}while(!0);Nf(),Rl.current=s,se=n,Oe!==null?e=0:(Xe=null,Ze=0,e=Ge)}if(e!==0){if(e===2&&(n=bc(r),n!==0&&(i=n,e=ed(r,n))),e===1)throw t=Eo,zi(r,0),ei(r,i),pt(r,Me()),t;if(e===6)ei(r,i);else{if(n=r.current.alternate,!(i&30)&&!QE(n)&&(e=kl(r,i),e===2&&(s=bc(r),s!==0&&(i=s,e=ed(r,s))),e===1))throw t=Eo,zi(r,0),ei(r,i),pt(r,Me()),t;switch(r.finishedWork=n,r.finishedLanes=i,e){case 0:case 1:throw Error(N(345));case 2:ki(r,ut,br);break;case 3:if(ei(r,i),(i&130023424)===i&&(e=qf+500-Me(),10<e)){if(fl(r,0)!==0)break;if(n=r.suspendedLanes,(n&i)!==i){st(),r.pingedLanes|=r.suspendedLanes&n;break}r.timeoutHandle=Nc(ki.bind(null,r,ut,br),e);break}ki(r,ut,br);break;case 4:if(ei(r,i),(i&4194240)===i)break;for(e=r.eventTimes,n=-1;0<i;){var o=31-Wt(i);s=1<<o,o=e[o],o>n&&(n=o),i&=~s}if(i=n,i=Me()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*ZE(i/1960))-i,10<i){r.timeoutHandle=Nc(ki.bind(null,r,ut,br),i);break}ki(r,ut,br);break;case 5:ki(r,ut,br);break;default:throw Error(N(329))}}}return pt(r,Me()),r.callbackNode===t?i_.bind(null,r):null}function ed(r,e){var t=Zs;return r.current.memoizedState.isDehydrated&&(zi(r,e).flags|=256),r=kl(r,e),r!==2&&(e=ut,ut=t,e!==null&&td(e)),r}function td(r){ut===null?ut=r:ut.push.apply(ut,r)}function QE(r){for(var e=r;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var i=0;i<t.length;i++){var n=t[i],s=n.getSnapshot;n=n.value;try{if(!Zt(s(),n))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===r)break;for(;e.sibling===null;){if(e.return===null||e.return===r)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ei(r,e){for(e&=~Yf,e&=~uu,r.suspendedLanes|=e,r.pingedLanes&=~e,r=r.expirationTimes;0<e;){var t=31-Wt(e),i=1<<t;r[t]=-1,e&=~i}}function Im(r){if(se&6)throw Error(N(327));Vn();var e=fl(r,0);if(!(e&1))return pt(r,Me()),null;var t=kl(r,e);if(r.tag!==0&&t===2){var i=bc(r);i!==0&&(e=i,t=ed(r,i))}if(t===1)throw t=Eo,zi(r,0),ei(r,e),pt(r,Me()),t;if(t===6)throw Error(N(345));return r.finishedWork=r.current.alternate,r.finishedLanes=e,ki(r,ut,br),pt(r,Me()),null}function Kf(r,e){var t=se;se|=1;try{return r(e)}finally{se=t,se===0&&(ss=Me()+500,su&&Ai())}}function Qi(r){ii!==null&&ii.tag===0&&!(se&6)&&Vn();var e=se;se|=1;var t=Mt.transition,i=ae;try{if(Mt.transition=null,ae=1,r)return r()}finally{ae=i,Mt.transition=t,se=e,!(se&6)&&Ai()}}function Zf(){yt=Bn.current,ge(Bn)}function zi(r,e){r.finishedWork=null,r.finishedLanes=0;var t=r.timeoutHandle;if(t!==-1&&(r.timeoutHandle=-1,RE(t)),Oe!==null)for(t=Oe.return;t!==null;){var i=t;switch(kf(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&vl();break;case 3:is(),ge(dt),ge(rt),Gf();break;case 5:Uf(i);break;case 4:is();break;case 13:ge(Te);break;case 19:ge(Te);break;case 10:Of(i.type._context);break;case 22:case 23:Zf()}t=t.return}if(Xe=r,Oe=r=pi(r.current,null),Ze=yt=e,Ge=0,Eo=null,Yf=uu=Zi=0,ut=Zs=null,Hi!==null){for(e=0;e<Hi.length;e++)if(t=Hi[e],i=t.interleaved,i!==null){t.interleaved=null;var n=i.next,s=t.pending;if(s!==null){var o=s.next;s.next=n,i.next=o}t.pending=i}Hi=null}return r}function n_(r,e){do{var t=Oe;try{if(Nf(),$a.current=Cl,bl){for(var i=Ae.memoizedState;i!==null;){var n=i.queue;n!==null&&(n.pending=null),i=i.next}bl=!1}if(Ki=0,ze=Ue=Ae=null,qs=!1,_o=0,Wf.current=null,t===null||t.return===null){Ge=1,Eo=e,Oe=null;break}e:{var s=r,o=t.return,a=t,l=e;if(e=Ze,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,h=a,d=h.tag;if(!(h.mode&1)&&(d===0||d===11||d===15)){var c=h.alternate;c?(h.updateQueue=c.updateQueue,h.memoizedState=c.memoizedState,h.lanes=c.lanes):(h.updateQueue=null,h.memoizedState=null)}var f=gm(o);if(f!==null){f.flags&=-257,ym(f,o,a,s,e),f.mode&1&&mm(s,u,e),e=f,l=u;var p=e.updateQueue;if(p===null){var v=new Set;v.add(l),e.updateQueue=v}else p.add(l);break e}else{if(!(e&1)){mm(s,u,e),Qf();break e}l=Error(N(426))}}else if(xe&&a.mode&1){var x=gm(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),ym(x,o,a,s,e),Mf(ns(l,a));break e}}s=l=ns(l,a),Ge!==4&&(Ge=2),Zs===null?Zs=[s]:Zs.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var g=Hv(s,l,e);um(s,g);break e;case 1:a=l;var y=s.type,m=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(di===null||!di.has(m)))){s.flags|=65536,e&=-e,s.lanes|=e;var _=$v(s,a,e);um(s,_);break e}}s=s.return}while(s!==null)}a_(t)}catch(w){e=w,Oe===t&&t!==null&&(Oe=t=t.return);continue}break}while(!0)}function s_(){var r=Rl.current;return Rl.current=Cl,r===null?Cl:r}function Qf(){(Ge===0||Ge===3||Ge===2)&&(Ge=4),Xe===null||!(Zi&268435455)&&!(uu&268435455)||ei(Xe,Ze)}function kl(r,e){var t=se;se|=2;var i=s_();(Xe!==r||Ze!==e)&&(br=null,zi(r,e));do try{JE();break}catch(n){n_(r,n)}while(!0);if(Nf(),se=t,Rl.current=i,Oe!==null)throw Error(N(261));return Xe=null,Ze=0,Ge}function JE(){for(;Oe!==null;)o_(Oe)}function eT(){for(;Oe!==null&&!Aw();)o_(Oe)}function o_(r){var e=u_(r.alternate,r,yt);r.memoizedProps=r.pendingProps,e===null?a_(r):Oe=e,Wf.current=null}function a_(r){var e=r;do{var t=e.alternate;if(r=e.return,e.flags&32768){if(t=WE(t,e),t!==null){t.flags&=32767,Oe=t;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{Ge=6,Oe=null;return}}else if(t=jE(t,e,yt),t!==null){Oe=t;return}if(e=e.sibling,e!==null){Oe=e;return}Oe=e=r}while(e!==null);Ge===0&&(Ge=5)}function ki(r,e,t){var i=ae,n=Mt.transition;try{Mt.transition=null,ae=1,tT(r,e,t,i)}finally{Mt.transition=n,ae=i}return null}function tT(r,e,t,i){do Vn();while(ii!==null);if(se&6)throw Error(N(327));t=r.finishedWork;var n=r.finishedLanes;if(t===null)return null;if(r.finishedWork=null,r.finishedLanes=0,t===r.current)throw Error(N(177));r.callbackNode=null,r.callbackPriority=0;var s=t.lanes|t.childLanes;if(Ow(r,s),r===Xe&&(Oe=Xe=null,Ze=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||na||(na=!0,h_(dl,function(){return Vn(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=Mt.transition,Mt.transition=null;var o=ae;ae=1;var a=se;se|=4,Wf.current=null,qE(r,t),t_(t,r),wE(Mc),pl=!!kc,Mc=kc=null,r.current=t,KE(t),bw(),se=a,ae=o,Mt.transition=s}else r.current=t;if(na&&(na=!1,ii=r,Pl=n),s=r.pendingLanes,s===0&&(di=null),Iw(t.stateNode),pt(r,Me()),e!==null)for(i=r.onRecoverableError,t=0;t<e.length;t++)n=e[t],i(n.value,{componentStack:n.stack,digest:n.digest});if(Il)throw Il=!1,r=Qc,Qc=null,r;return Pl&1&&r.tag!==0&&Vn(),s=r.pendingLanes,s&1?r===Jc?Qs++:(Qs=0,Jc=r):Qs=0,Ai(),null}function Vn(){if(ii!==null){var r=H0(Pl),e=Mt.transition,t=ae;try{if(Mt.transition=null,ae=16>r?16:r,ii===null)var i=!1;else{if(r=ii,ii=null,Pl=0,se&6)throw Error(N(331));var n=se;for(se|=4,H=r.current;H!==null;){var s=H,o=s.child;if(H.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(H=u;H!==null;){var h=H;switch(h.tag){case 0:case 11:case 15:Ks(8,h,s)}var d=h.child;if(d!==null)d.return=h,H=d;else for(;H!==null;){h=H;var c=h.sibling,f=h.return;if(Qv(h),h===u){H=null;break}if(c!==null){c.return=f,H=c;break}H=f}}}var p=s.alternate;if(p!==null){var v=p.child;if(v!==null){p.child=null;do{var x=v.sibling;v.sibling=null,v=x}while(v!==null)}}H=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,H=o;else e:for(;H!==null;){if(s=H,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Ks(9,s,s.return)}var g=s.sibling;if(g!==null){g.return=s.return,H=g;break e}H=s.return}}var y=r.current;for(H=y;H!==null;){o=H;var m=o.child;if(o.subtreeFlags&2064&&m!==null)m.return=o,H=m;else e:for(o=y;H!==null;){if(a=H,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:lu(9,a)}}catch(w){Ie(a,a.return,w)}if(a===o){H=null;break e}var _=a.sibling;if(_!==null){_.return=a.return,H=_;break e}H=a.return}}if(se=n,Ai(),pr&&typeof pr.onPostCommitFiberRoot=="function")try{pr.onPostCommitFiberRoot(eu,r)}catch{}i=!0}return i}finally{ae=t,Mt.transition=e}}return!1}function Pm(r,e,t){e=ns(t,e),e=Hv(r,e,1),r=ci(r,e,1),e=st(),r!==null&&(ko(r,1,e),pt(r,e))}function Ie(r,e,t){if(r.tag===3)Pm(r,r,t);else for(;e!==null;){if(e.tag===3){Pm(e,r,t);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(di===null||!di.has(i))){r=ns(t,r),r=$v(e,r,1),e=ci(e,r,1),r=st(),e!==null&&(ko(e,1,r),pt(e,r));break}}e=e.return}}function rT(r,e,t){var i=r.pingCache;i!==null&&i.delete(e),e=st(),r.pingedLanes|=r.suspendedLanes&t,Xe===r&&(Ze&t)===t&&(Ge===4||Ge===3&&(Ze&130023424)===Ze&&500>Me()-qf?zi(r,0):Yf|=t),pt(r,e)}function l_(r,e){e===0&&(r.mode&1?(e=Yo,Yo<<=1,!(Yo&130023424)&&(Yo=4194304)):e=1);var t=st();r=Gr(r,e),r!==null&&(ko(r,e,t),pt(r,t))}function iT(r){var e=r.memoizedState,t=0;e!==null&&(t=e.retryLane),l_(r,t)}function nT(r,e){var t=0;switch(r.tag){case 13:var i=r.stateNode,n=r.memoizedState;n!==null&&(t=n.retryLane);break;case 19:i=r.stateNode;break;default:throw Error(N(314))}i!==null&&i.delete(e),l_(r,t)}var u_;u_=function(r,e,t){if(r!==null)if(r.memoizedProps!==e.pendingProps||dt.current)ht=!0;else{if(!(r.lanes&t)&&!(e.flags&128))return ht=!1,XE(r,e,t);ht=!!(r.flags&131072)}else ht=!1,xe&&e.flags&1048576&&fv(e,wl,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;Va(r,e),r=e.pendingProps;var n=es(e,rt.current);zn(e,t),n=$f(null,e,i,r,n,t);var s=zf();return e.flags|=1,typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,ft(i)?(s=!0,_l(e)):s=!1,e.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,Lf(e),n.updater=au,e.stateNode=n,n._reactInternals=e,Hc(e,i,r,t),e=Vc(null,e,i,!0,s,t)):(e.tag=0,xe&&s&&Pf(e),it(null,e,n,t),e=e.child),e;case 16:i=e.elementType;e:{switch(Va(r,e),r=e.pendingProps,n=i._init,i=n(i._payload),e.type=i,n=e.tag=oT(i),r=$t(i,r),n){case 0:e=zc(null,e,i,r,t);break e;case 1:e=xm(null,e,i,r,t);break e;case 11:e=vm(null,e,i,r,t);break e;case 14:e=_m(null,e,i,$t(i.type,r),t);break e}throw Error(N(306,i,""))}return e;case 0:return i=e.type,n=e.pendingProps,n=e.elementType===i?n:$t(i,n),zc(r,e,i,n,t);case 1:return i=e.type,n=e.pendingProps,n=e.elementType===i?n:$t(i,n),xm(r,e,i,n,t);case 3:e:{if(jv(e),r===null)throw Error(N(387));i=e.pendingProps,s=e.memoizedState,n=s.element,_v(r,e),Sl(e,i,null,t);var o=e.memoizedState;if(i=o.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){n=ns(Error(N(423)),e),e=wm(r,e,i,t,n);break e}else if(i!==n){n=ns(Error(N(424)),e),e=wm(r,e,i,t,n);break e}else for(vt=hi(e.stateNode.containerInfo.firstChild),xt=e,xe=!0,Xt=null,t=yv(e,null,i,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(ts(),i===n){e=Hr(r,e,t);break e}it(r,e,i,t)}e=e.child}return e;case 5:return xv(e),r===null&&Fc(e),i=e.type,n=e.pendingProps,s=r!==null?r.memoizedProps:null,o=n.children,Dc(i,n)?o=null:s!==null&&Dc(i,s)&&(e.flags|=32),Xv(r,e),it(r,e,o,t),e.child;case 6:return r===null&&Fc(e),null;case 13:return Wv(r,e,t);case 4:return Ff(e,e.stateNode.containerInfo),i=e.pendingProps,r===null?e.child=rs(e,null,i,t):it(r,e,i,t),e.child;case 11:return i=e.type,n=e.pendingProps,n=e.elementType===i?n:$t(i,n),vm(r,e,i,n,t);case 7:return it(r,e,e.pendingProps,t),e.child;case 8:return it(r,e,e.pendingProps.children,t),e.child;case 12:return it(r,e,e.pendingProps.children,t),e.child;case 10:e:{if(i=e.type._context,n=e.pendingProps,s=e.memoizedProps,o=n.value,de(El,i._currentValue),i._currentValue=o,s!==null)if(Zt(s.value,o)){if(s.children===n.children&&!dt.current){e=Hr(r,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===i){if(s.tag===1){l=Br(-1,t&-t),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?l.next=l:(l.next=h.next,h.next=l),u.pending=l}}s.lanes|=t,l=s.alternate,l!==null&&(l.lanes|=t),Uc(s.return,t,e),a.lanes|=t;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(N(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),Uc(o,t,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}it(r,e,n.children,t),e=e.child}return e;case 9:return n=e.type,i=e.pendingProps.children,zn(e,t),n=Dt(n),i=i(n),e.flags|=1,it(r,e,i,t),e.child;case 14:return i=e.type,n=$t(i,e.pendingProps),n=$t(i.type,n),_m(r,e,i,n,t);case 15:return zv(r,e,e.type,e.pendingProps,t);case 17:return i=e.type,n=e.pendingProps,n=e.elementType===i?n:$t(i,n),Va(r,e),e.tag=1,ft(i)?(r=!0,_l(e)):r=!1,zn(e,t),Gv(e,i,n),Hc(e,i,n,t),Vc(null,e,i,!0,r,t);case 19:return Yv(r,e,t);case 22:return Vv(r,e,t)}throw Error(N(156,e.tag))};function h_(r,e){return L0(r,e)}function sT(r,e,t,i){this.tag=r,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function It(r,e,t,i){return new sT(r,e,t,i)}function Jf(r){return r=r.prototype,!(!r||!r.isReactComponent)}function oT(r){if(typeof r=="function")return Jf(r)?1:0;if(r!=null){if(r=r.$$typeof,r===vf)return 11;if(r===_f)return 14}return 2}function pi(r,e){var t=r.alternate;return t===null?(t=It(r.tag,e,r.key,r.mode),t.elementType=r.elementType,t.type=r.type,t.stateNode=r.stateNode,t.alternate=r,r.alternate=t):(t.pendingProps=e,t.type=r.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=r.flags&14680064,t.childLanes=r.childLanes,t.lanes=r.lanes,t.child=r.child,t.memoizedProps=r.memoizedProps,t.memoizedState=r.memoizedState,t.updateQueue=r.updateQueue,e=r.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=r.sibling,t.index=r.index,t.ref=r.ref,t}function Wa(r,e,t,i,n,s){var o=2;if(i=r,typeof r=="function")Jf(r)&&(o=1);else if(typeof r=="string")o=5;else e:switch(r){case bn:return Vi(t.children,n,s,e);case yf:o=8,n|=8;break;case cc:return r=It(12,t,e,n|2),r.elementType=cc,r.lanes=s,r;case dc:return r=It(13,t,e,n),r.elementType=dc,r.lanes=s,r;case fc:return r=It(19,t,e,n),r.elementType=fc,r.lanes=s,r;case x0:return hu(t,n,s,e);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case v0:o=10;break e;case _0:o=9;break e;case vf:o=11;break e;case _f:o=14;break e;case Kr:o=16,i=null;break e}throw Error(N(130,r==null?r:typeof r,""))}return e=It(o,t,e,n),e.elementType=r,e.type=i,e.lanes=s,e}function Vi(r,e,t,i){return r=It(7,r,i,e),r.lanes=t,r}function hu(r,e,t,i){return r=It(22,r,i,e),r.elementType=x0,r.lanes=t,r.stateNode={isHidden:!1},r}function ih(r,e,t){return r=It(6,r,null,e),r.lanes=t,r}function nh(r,e,t){return e=It(4,r.children!==null?r.children:[],r.key,e),e.lanes=t,e.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},e}function aT(r,e,t,i,n){this.tag=e,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Fu(0),this.expirationTimes=Fu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Fu(0),this.identifierPrefix=i,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function ep(r,e,t,i,n,s,o,a,l){return r=new aT(r,e,t,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=It(3,null,null,e),r.current=s,s.stateNode=r,s.memoizedState={element:i,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},Lf(s),r}function lT(r,e,t){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:An,key:i==null?null:""+i,children:r,containerInfo:e,implementation:t}}function c_(r){if(!r)return vi;r=r._reactInternals;e:{if(on(r)!==r||r.tag!==1)throw Error(N(170));var e=r;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(ft(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(N(171))}if(r.tag===1){var t=r.type;if(ft(t))return cv(r,t,e)}return e}function d_(r,e,t,i,n,s,o,a,l){return r=ep(t,i,!0,r,n,s,o,a,l),r.context=c_(null),t=r.current,i=st(),n=fi(t),s=Br(i,n),s.callback=e??null,ci(t,s,n),r.current.lanes=n,ko(r,n,i),pt(r,i),r}function cu(r,e,t,i){var n=e.current,s=st(),o=fi(n);return t=c_(t),e.context===null?e.context=t:e.pendingContext=t,e=Br(s,o),e.payload={element:r},i=i===void 0?null:i,i!==null&&(e.callback=i),r=ci(n,e,o),r!==null&&(Yt(r,n,o,s),Ha(r,n,o)),o}function Ml(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function km(r,e){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var t=r.retryLane;r.retryLane=t!==0&&t<e?t:e}}function tp(r,e){km(r,e),(r=r.alternate)&&km(r,e)}function uT(){return null}var f_=typeof reportError=="function"?reportError:function(r){console.error(r)};function rp(r){this._internalRoot=r}du.prototype.render=rp.prototype.render=function(r){var e=this._internalRoot;if(e===null)throw Error(N(409));cu(r,e,null,null)};du.prototype.unmount=rp.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var e=r.containerInfo;Qi(function(){cu(null,r,null,null)}),e[Ur]=null}};function du(r){this._internalRoot=r}du.prototype.unstable_scheduleHydration=function(r){if(r){var e=V0();r={blockedOn:null,target:r,priority:e};for(var t=0;t<Jr.length&&e!==0&&e<Jr[t].priority;t++);Jr.splice(t,0,r),t===0&&j0(r)}};function ip(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function fu(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function Mm(){}function hT(r,e,t,i,n){if(n){if(typeof i=="function"){var s=i;i=function(){var u=Ml(o);s.call(u)}}var o=d_(e,i,r,0,null,!1,!1,"",Mm);return r._reactRootContainer=o,r[Ur]=o.current,po(r.nodeType===8?r.parentNode:r),Qi(),o}for(;n=r.lastChild;)r.removeChild(n);if(typeof i=="function"){var a=i;i=function(){var u=Ml(l);a.call(u)}}var l=ep(r,0,!1,null,null,!1,!1,"",Mm);return r._reactRootContainer=l,r[Ur]=l.current,po(r.nodeType===8?r.parentNode:r),Qi(function(){cu(e,l,t,i)}),l}function pu(r,e,t,i,n){var s=t._reactRootContainer;if(s){var o=s;if(typeof n=="function"){var a=n;n=function(){var l=Ml(o);a.call(l)}}cu(e,o,r,n)}else o=hT(t,e,r,n,i);return Ml(o)}$0=function(r){switch(r.tag){case 3:var e=r.stateNode;if(e.current.memoizedState.isDehydrated){var t=Ds(e.pendingLanes);t!==0&&(Ef(e,t|1),pt(e,Me()),!(se&6)&&(ss=Me()+500,Ai()))}break;case 13:Qi(function(){var i=Gr(r,1);if(i!==null){var n=st();Yt(i,r,1,n)}}),tp(r,1)}};Tf=function(r){if(r.tag===13){var e=Gr(r,134217728);if(e!==null){var t=st();Yt(e,r,134217728,t)}tp(r,134217728)}};z0=function(r){if(r.tag===13){var e=fi(r),t=Gr(r,e);if(t!==null){var i=st();Yt(t,r,e,i)}tp(r,e)}};V0=function(){return ae};X0=function(r,e){var t=ae;try{return ae=r,e()}finally{ae=t}};Tc=function(r,e,t){switch(e){case"input":if(gc(r,t),e=t.name,t.type==="radio"&&e!=null){for(t=r;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var i=t[e];if(i!==r&&i.form===r.form){var n=nu(i);if(!n)throw Error(N(90));E0(i),gc(i,n)}}}break;case"textarea":S0(r,t);break;case"select":e=t.value,e!=null&&Un(r,!!t.multiple,e,!1)}};k0=Kf;M0=Qi;var cT={usingClientEntryPoint:!1,Events:[Do,Pn,nu,I0,P0,Kf]},Ss={findFiberByHostInstance:Gi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},dT={bundleType:Ss.bundleType,version:Ss.version,rendererPackageName:Ss.rendererPackageName,rendererConfig:Ss.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Vr.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=O0(r),r===null?null:r.stateNode},findFiberByHostInstance:Ss.findFiberByHostInstance||uT,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var sa=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!sa.isDisabled&&sa.supportsFiber)try{eu=sa.inject(dT),pr=sa}catch{}}Et.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=cT;Et.createPortal=function(r,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ip(e))throw Error(N(200));return lT(r,e,null,t)};Et.createRoot=function(r,e){if(!ip(r))throw Error(N(299));var t=!1,i="",n=f_;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(n=e.onRecoverableError)),e=ep(r,1,!1,null,null,t,!1,i,n),r[Ur]=e.current,po(r.nodeType===8?r.parentNode:r),new rp(e)};Et.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var e=r._reactInternals;if(e===void 0)throw typeof r.render=="function"?Error(N(188)):(r=Object.keys(r).join(","),Error(N(268,r)));return r=O0(e),r=r===null?null:r.stateNode,r};Et.flushSync=function(r){return Qi(r)};Et.hydrate=function(r,e,t){if(!fu(e))throw Error(N(200));return pu(null,r,e,!0,t)};Et.hydrateRoot=function(r,e,t){if(!ip(r))throw Error(N(405));var i=t!=null&&t.hydratedSources||null,n=!1,s="",o=f_;if(t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=d_(e,null,r,1,t??null,n,!1,s,o),r[Ur]=e.current,po(r),i)for(r=0;r<i.length;r++)t=i[r],n=t._getVersion,n=n(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,n]:e.mutableSourceEagerHydrationData.push(t,n);return new du(e)};Et.render=function(r,e,t){if(!fu(e))throw Error(N(200));return pu(null,r,e,!1,t)};Et.unmountComponentAtNode=function(r){if(!fu(r))throw Error(N(40));return r._reactRootContainer?(Qi(function(){pu(null,null,r,!1,function(){r._reactRootContainer=null,r[Ur]=null})}),!0):!1};Et.unstable_batchedUpdates=Kf;Et.unstable_renderSubtreeIntoContainer=function(r,e,t,i){if(!fu(t))throw Error(N(200));if(r==null||r._reactInternals===void 0)throw Error(N(38));return pu(r,e,t,!1,i)};Et.version="18.3.1-next-f1338f8080-20240426";function p_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(p_)}catch(r){console.error(r)}}p_(),p0.exports=Et;var fT=p0.exports,Dm=fT;uc.createRoot=Dm.createRoot,uc.hydrateRoot=Dm.hydrateRoot;const pT="modulepreload",mT=function(r,e){return new URL(r,e).href},Nm={},gT=function(e,t,i){let n=Promise.resolve();if(t&&t.length>0){const o=document.getElementsByTagName("link"),a=document.querySelector("meta[property=csp-nonce]"),l=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));n=Promise.allSettled(t.map(u=>{if(u=mT(u,i),u in Nm)return;Nm[u]=!0;const h=u.endsWith(".css"),d=h?'[rel="stylesheet"]':"";if(!!i)for(let p=o.length-1;p>=0;p--){const v=o[p];if(v.href===u&&(!h||v.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${u}"]${d}`))return;const f=document.createElement("link");if(f.rel=h?"stylesheet":pT,h||(f.as="script"),f.crossOrigin="",f.href=u,l&&f.setAttribute("nonce",l),document.head.appendChild(f),h)return new Promise((p,v)=>{f.addEventListener("load",p),f.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${u}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return n.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})};var an=(r=>(r[r.WEBGL_LEGACY=0]="WEBGL_LEGACY",r[r.WEBGL=1]="WEBGL",r[r.WEBGL2=2]="WEBGL2",r))(an||{}),m_=(r=>(r[r.UNKNOWN=0]="UNKNOWN",r[r.WEBGL=1]="WEBGL",r[r.CANVAS=2]="CANVAS",r))(m_||{}),rd=(r=>(r[r.COLOR=16384]="COLOR",r[r.DEPTH=256]="DEPTH",r[r.STENCIL=1024]="STENCIL",r))(rd||{}),q=(r=>(r[r.NORMAL=0]="NORMAL",r[r.ADD=1]="ADD",r[r.MULTIPLY=2]="MULTIPLY",r[r.SCREEN=3]="SCREEN",r[r.OVERLAY=4]="OVERLAY",r[r.DARKEN=5]="DARKEN",r[r.LIGHTEN=6]="LIGHTEN",r[r.COLOR_DODGE=7]="COLOR_DODGE",r[r.COLOR_BURN=8]="COLOR_BURN",r[r.HARD_LIGHT=9]="HARD_LIGHT",r[r.SOFT_LIGHT=10]="SOFT_LIGHT",r[r.DIFFERENCE=11]="DIFFERENCE",r[r.EXCLUSION=12]="EXCLUSION",r[r.HUE=13]="HUE",r[r.SATURATION=14]="SATURATION",r[r.COLOR=15]="COLOR",r[r.LUMINOSITY=16]="LUMINOSITY",r[r.NORMAL_NPM=17]="NORMAL_NPM",r[r.ADD_NPM=18]="ADD_NPM",r[r.SCREEN_NPM=19]="SCREEN_NPM",r[r.NONE=20]="NONE",r[r.SRC_OVER=0]="SRC_OVER",r[r.SRC_IN=21]="SRC_IN",r[r.SRC_OUT=22]="SRC_OUT",r[r.SRC_ATOP=23]="SRC_ATOP",r[r.DST_OVER=24]="DST_OVER",r[r.DST_IN=25]="DST_IN",r[r.DST_OUT=26]="DST_OUT",r[r.DST_ATOP=27]="DST_ATOP",r[r.ERASE=26]="ERASE",r[r.SUBTRACT=28]="SUBTRACT",r[r.XOR=29]="XOR",r))(q||{}),fr=(r=>(r[r.POINTS=0]="POINTS",r[r.LINES=1]="LINES",r[r.LINE_LOOP=2]="LINE_LOOP",r[r.LINE_STRIP=3]="LINE_STRIP",r[r.TRIANGLES=4]="TRIANGLES",r[r.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",r[r.TRIANGLE_FAN=6]="TRIANGLE_FAN",r))(fr||{}),O=(r=>(r[r.RGBA=6408]="RGBA",r[r.RGB=6407]="RGB",r[r.RG=33319]="RG",r[r.RED=6403]="RED",r[r.RGBA_INTEGER=36249]="RGBA_INTEGER",r[r.RGB_INTEGER=36248]="RGB_INTEGER",r[r.RG_INTEGER=33320]="RG_INTEGER",r[r.RED_INTEGER=36244]="RED_INTEGER",r[r.ALPHA=6406]="ALPHA",r[r.LUMINANCE=6409]="LUMINANCE",r[r.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",r[r.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",r[r.DEPTH_STENCIL=34041]="DEPTH_STENCIL",r))(O||{}),Xn=(r=>(r[r.TEXTURE_2D=3553]="TEXTURE_2D",r[r.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",r[r.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",r[r.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",r[r.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",r[r.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",r[r.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",r))(Xn||{}),W=(r=>(r[r.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",r[r.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",r[r.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",r[r.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",r[r.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",r[r.UNSIGNED_INT=5125]="UNSIGNED_INT",r[r.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",r[r.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",r[r.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",r[r.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",r[r.BYTE=5120]="BYTE",r[r.SHORT=5122]="SHORT",r[r.INT=5124]="INT",r[r.FLOAT=5126]="FLOAT",r[r.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",r[r.HALF_FLOAT=36193]="HALF_FLOAT",r))(W||{}),F=(r=>(r[r.FLOAT=0]="FLOAT",r[r.INT=1]="INT",r[r.UINT=2]="UINT",r))(F||{}),Mr=(r=>(r[r.NEAREST=0]="NEAREST",r[r.LINEAR=1]="LINEAR",r))(Mr||{}),mi=(r=>(r[r.CLAMP=33071]="CLAMP",r[r.REPEAT=10497]="REPEAT",r[r.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",r))(mi||{}),_r=(r=>(r[r.OFF=0]="OFF",r[r.POW2=1]="POW2",r[r.ON=2]="ON",r[r.ON_MANUAL=3]="ON_MANUAL",r))(_r||{}),ct=(r=>(r[r.NPM=0]="NPM",r[r.UNPACK=1]="UNPACK",r[r.PMA=2]="PMA",r[r.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",r[r.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",r[r.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",r))(ct||{}),hr=(r=>(r[r.NO=0]="NO",r[r.YES=1]="YES",r[r.AUTO=2]="AUTO",r[r.BLEND=0]="BLEND",r[r.CLEAR=1]="CLEAR",r[r.BLIT=2]="BLIT",r))(hr||{}),np=(r=>(r[r.AUTO=0]="AUTO",r[r.MANUAL=1]="MANUAL",r))(np||{}),Pt=(r=>(r.LOW="lowp",r.MEDIUM="mediump",r.HIGH="highp",r))(Pt||{}),Fe=(r=>(r[r.NONE=0]="NONE",r[r.SCISSOR=1]="SCISSOR",r[r.STENCIL=2]="STENCIL",r[r.SPRITE=3]="SPRITE",r[r.COLOR=4]="COLOR",r))(Fe||{}),Ne=(r=>(r[r.NONE=0]="NONE",r[r.LOW=2]="LOW",r[r.MEDIUM=4]="MEDIUM",r[r.HIGH=8]="HIGH",r))(Ne||{}),gr=(r=>(r[r.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",r[r.ARRAY_BUFFER=34962]="ARRAY_BUFFER",r[r.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",r))(gr||{});const yT={createCanvas:(r,e)=>{const t=document.createElement("canvas");return t.width=r,t.height=e,t},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(r,e)=>fetch(r,e),parseXML:r=>new DOMParser().parseFromString(r,"text/xml")},U={ADAPTER:yT,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var sh=/iPhone/i,Om=/iPod/i,Bm=/iPad/i,Lm=/\biOS-universal(?:.+)Mac\b/i,oh=/\bAndroid(?:.+)Mobile\b/i,Fm=/Android/i,dn=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,oa=/Silk/i,Tr=/Windows Phone/i,Um=/\bWindows(?:.+)ARM\b/i,Gm=/BlackBerry/i,Hm=/BB10/i,$m=/Opera Mini/i,zm=/\b(CriOS|Chrome)(?:.+)Mobile/i,Vm=/Mobile(?:.+)Firefox\b/i,Xm=function(r){return typeof r<"u"&&r.platform==="MacIntel"&&typeof r.maxTouchPoints=="number"&&r.maxTouchPoints>1&&typeof MSStream>"u"};function vT(r){return function(e){return e.test(r)}}function jm(r){var e={userAgent:"",platform:"",maxTouchPoints:0};!r&&typeof navigator<"u"?e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof r=="string"?e.userAgent=r:r&&r.userAgent&&(e={userAgent:r.userAgent,platform:r.platform,maxTouchPoints:r.maxTouchPoints||0});var t=e.userAgent,i=t.split("[FBAN");typeof i[1]<"u"&&(t=i[0]),i=t.split("Twitter"),typeof i[1]<"u"&&(t=i[0]);var n=vT(t),s={apple:{phone:n(sh)&&!n(Tr),ipod:n(Om),tablet:!n(sh)&&(n(Bm)||Xm(e))&&!n(Tr),universal:n(Lm),device:(n(sh)||n(Om)||n(Bm)||n(Lm)||Xm(e))&&!n(Tr)},amazon:{phone:n(dn),tablet:!n(dn)&&n(oa),device:n(dn)||n(oa)},android:{phone:!n(Tr)&&n(dn)||!n(Tr)&&n(oh),tablet:!n(Tr)&&!n(dn)&&!n(oh)&&(n(oa)||n(Fm)),device:!n(Tr)&&(n(dn)||n(oa)||n(oh)||n(Fm))||n(/\bokhttp\b/i)},windows:{phone:n(Tr),tablet:n(Um),device:n(Tr)||n(Um)},other:{blackberry:n(Gm),blackberry10:n(Hm),opera:n($m),firefox:n(Vm),chrome:n(zm),device:n(Gm)||n(Hm)||n($m)||n(Vm)||n(zm)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}const _T=jm.default??jm,Dr=_T(globalThis.navigator);U.RETINA_PREFIX=/@([0-9\.]+)x/;U.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var g_={exports:{}};(function(r){var e=Object.prototype.hasOwnProperty,t="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(t=!1));function n(l,u,h){this.fn=l,this.context=u,this.once=h||!1}function s(l,u,h,d,c){if(typeof h!="function")throw new TypeError("The listener must be a function");var f=new n(h,d||l,c),p=t?t+u:u;return l._events[p]?l._events[p].fn?l._events[p]=[l._events[p],f]:l._events[p].push(f):(l._events[p]=f,l._eventsCount++),l}function o(l,u){--l._eventsCount===0?l._events=new i:delete l._events[u]}function a(){this._events=new i,this._eventsCount=0}a.prototype.eventNames=function(){var u=[],h,d;if(this._eventsCount===0)return u;for(d in h=this._events)e.call(h,d)&&u.push(t?d.slice(1):d);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(h)):u},a.prototype.listeners=function(u){var h=t?t+u:u,d=this._events[h];if(!d)return[];if(d.fn)return[d.fn];for(var c=0,f=d.length,p=new Array(f);c<f;c++)p[c]=d[c].fn;return p},a.prototype.listenerCount=function(u){var h=t?t+u:u,d=this._events[h];return d?d.fn?1:d.length:0},a.prototype.emit=function(u,h,d,c,f,p){var v=t?t+u:u;if(!this._events[v])return!1;var x=this._events[v],g=arguments.length,y,m;if(x.fn){switch(x.once&&this.removeListener(u,x.fn,void 0,!0),g){case 1:return x.fn.call(x.context),!0;case 2:return x.fn.call(x.context,h),!0;case 3:return x.fn.call(x.context,h,d),!0;case 4:return x.fn.call(x.context,h,d,c),!0;case 5:return x.fn.call(x.context,h,d,c,f),!0;case 6:return x.fn.call(x.context,h,d,c,f,p),!0}for(m=1,y=new Array(g-1);m<g;m++)y[m-1]=arguments[m];x.fn.apply(x.context,y)}else{var _=x.length,w;for(m=0;m<_;m++)switch(x[m].once&&this.removeListener(u,x[m].fn,void 0,!0),g){case 1:x[m].fn.call(x[m].context);break;case 2:x[m].fn.call(x[m].context,h);break;case 3:x[m].fn.call(x[m].context,h,d);break;case 4:x[m].fn.call(x[m].context,h,d,c);break;default:if(!y)for(w=1,y=new Array(g-1);w<g;w++)y[w-1]=arguments[w];x[m].fn.apply(x[m].context,y)}}return!0},a.prototype.on=function(u,h,d){return s(this,u,h,d,!1)},a.prototype.once=function(u,h,d){return s(this,u,h,d,!0)},a.prototype.removeListener=function(u,h,d,c){var f=t?t+u:u;if(!this._events[f])return this;if(!h)return o(this,f),this;var p=this._events[f];if(p.fn)p.fn===h&&(!c||p.once)&&(!d||p.context===d)&&o(this,f);else{for(var v=0,x=[],g=p.length;v<g;v++)(p[v].fn!==h||c&&!p[v].once||d&&p[v].context!==d)&&x.push(p[v]);x.length?this._events[f]=x.length===1?x[0]:x:o(this,f)}return this},a.prototype.removeAllListeners=function(u){var h;return u?(h=t?t+u:u,this._events[h]&&o(this,h)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=t,a.EventEmitter=a,r.exports=a})(g_);var xT=g_.exports;const Oo=uf(xT);var sp={exports:{}};sp.exports=mu;sp.exports.default=mu;function mu(r,e,t){t=t||2;var i=e&&e.length,n=i?e[0]*t:r.length,s=y_(r,0,n,t,!0),o=[];if(!s||s.next===s.prev)return o;var a,l,u,h,d,c,f;if(i&&(s=AT(r,e,s,t)),r.length>80*t){a=u=r[0],l=h=r[1];for(var p=t;p<n;p+=t)d=r[p],c=r[p+1],d<a&&(a=d),c<l&&(l=c),d>u&&(u=d),c>h&&(h=c);f=Math.max(u-a,h-l),f=f!==0?32767/f:0}return To(s,o,t,a,l,f,0),o}function y_(r,e,t,i,n){var s,o;if(n===sd(r,e,t,i)>0)for(s=e;s<t;s+=i)o=Wm(s,r[s],r[s+1],o);else for(s=t-i;s>=e;s-=i)o=Wm(s,r[s],r[s+1],o);return o&&gu(o,o.next)&&(Ao(o),o=o.next),o}function Ji(r,e){if(!r)return r;e||(e=r);var t=r,i;do if(i=!1,!t.steiner&&(gu(t,t.next)||Se(t.prev,t,t.next)===0)){if(Ao(t),t=e=t.prev,t===t.next)break;i=!0}else t=t.next;while(i||t!==e);return e}function To(r,e,t,i,n,s,o){if(r){!o&&s&&PT(r,i,n,s);for(var a=r,l,u;r.prev!==r.next;){if(l=r.prev,u=r.next,s?ET(r,i,n,s):wT(r)){e.push(l.i/t|0),e.push(r.i/t|0),e.push(u.i/t|0),Ao(r),r=u.next,a=u.next;continue}if(r=u,r===a){o?o===1?(r=TT(Ji(r),e,t),To(r,e,t,i,n,s,2)):o===2&&ST(r,e,t,i,n,s):To(Ji(r),e,t,i,n,s,1);break}}}}function wT(r){var e=r.prev,t=r,i=r.next;if(Se(e,t,i)>=0)return!1;for(var n=e.x,s=t.x,o=i.x,a=e.y,l=t.y,u=i.y,h=n<s?n<o?n:o:s<o?s:o,d=a<l?a<u?a:u:l<u?l:u,c=n>s?n>o?n:o:s>o?s:o,f=a>l?a>u?a:u:l>u?l:u,p=i.next;p!==e;){if(p.x>=h&&p.x<=c&&p.y>=d&&p.y<=f&&Ln(n,a,s,l,o,u,p.x,p.y)&&Se(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function ET(r,e,t,i){var n=r.prev,s=r,o=r.next;if(Se(n,s,o)>=0)return!1;for(var a=n.x,l=s.x,u=o.x,h=n.y,d=s.y,c=o.y,f=a<l?a<u?a:u:l<u?l:u,p=h<d?h<c?h:c:d<c?d:c,v=a>l?a>u?a:u:l>u?l:u,x=h>d?h>c?h:c:d>c?d:c,g=id(f,p,e,t,i),y=id(v,x,e,t,i),m=r.prevZ,_=r.nextZ;m&&m.z>=g&&_&&_.z<=y;){if(m.x>=f&&m.x<=v&&m.y>=p&&m.y<=x&&m!==n&&m!==o&&Ln(a,h,l,d,u,c,m.x,m.y)&&Se(m.prev,m,m.next)>=0||(m=m.prevZ,_.x>=f&&_.x<=v&&_.y>=p&&_.y<=x&&_!==n&&_!==o&&Ln(a,h,l,d,u,c,_.x,_.y)&&Se(_.prev,_,_.next)>=0))return!1;_=_.nextZ}for(;m&&m.z>=g;){if(m.x>=f&&m.x<=v&&m.y>=p&&m.y<=x&&m!==n&&m!==o&&Ln(a,h,l,d,u,c,m.x,m.y)&&Se(m.prev,m,m.next)>=0)return!1;m=m.prevZ}for(;_&&_.z<=y;){if(_.x>=f&&_.x<=v&&_.y>=p&&_.y<=x&&_!==n&&_!==o&&Ln(a,h,l,d,u,c,_.x,_.y)&&Se(_.prev,_,_.next)>=0)return!1;_=_.nextZ}return!0}function TT(r,e,t){var i=r;do{var n=i.prev,s=i.next.next;!gu(n,s)&&v_(n,i,i.next,s)&&So(n,s)&&So(s,n)&&(e.push(n.i/t|0),e.push(i.i/t|0),e.push(s.i/t|0),Ao(i),Ao(i.next),i=r=s),i=i.next}while(i!==r);return Ji(i)}function ST(r,e,t,i,n,s){var o=r;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&DT(o,a)){var l=__(o,a);o=Ji(o,o.next),l=Ji(l,l.next),To(o,e,t,i,n,s,0),To(l,e,t,i,n,s,0);return}a=a.next}o=o.next}while(o!==r)}function AT(r,e,t,i){var n=[],s,o,a,l,u;for(s=0,o=e.length;s<o;s++)a=e[s]*i,l=s<o-1?e[s+1]*i:r.length,u=y_(r,a,l,i,!1),u===u.next&&(u.steiner=!0),n.push(MT(u));for(n.sort(bT),s=0;s<n.length;s++)t=CT(n[s],t);return t}function bT(r,e){return r.x-e.x}function CT(r,e){var t=RT(r,e);if(!t)return e;var i=__(t,r);return Ji(i,i.next),Ji(t,t.next)}function RT(r,e){var t=e,i=r.x,n=r.y,s=-1/0,o;do{if(n<=t.y&&n>=t.next.y&&t.next.y!==t.y){var a=t.x+(n-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(a<=i&&a>s&&(s=a,o=t.x<t.next.x?t:t.next,a===i))return o}t=t.next}while(t!==e);if(!o)return null;var l=o,u=o.x,h=o.y,d=1/0,c;t=o;do i>=t.x&&t.x>=u&&i!==t.x&&Ln(n<h?i:s,n,u,h,n<h?s:i,n,t.x,t.y)&&(c=Math.abs(n-t.y)/(i-t.x),So(t,r)&&(c<d||c===d&&(t.x>o.x||t.x===o.x&&IT(o,t)))&&(o=t,d=c)),t=t.next;while(t!==l);return o}function IT(r,e){return Se(r.prev,r,e.prev)<0&&Se(e.next,r,r.next)<0}function PT(r,e,t,i){var n=r;do n.z===0&&(n.z=id(n.x,n.y,e,t,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==r);n.prevZ.nextZ=null,n.prevZ=null,kT(n)}function kT(r){var e,t,i,n,s,o,a,l,u=1;do{for(t=r,r=null,s=null,o=0;t;){for(o++,i=t,a=0,e=0;e<u&&(a++,i=i.nextZ,!!i);e++);for(l=u;a>0||l>0&&i;)a!==0&&(l===0||!i||t.z<=i.z)?(n=t,t=t.nextZ,a--):(n=i,i=i.nextZ,l--),s?s.nextZ=n:r=n,n.prevZ=s,s=n;t=i}s.nextZ=null,u*=2}while(o>1);return r}function id(r,e,t,i,n){return r=(r-t)*n|0,e=(e-i)*n|0,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,r|e<<1}function MT(r){var e=r,t=r;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==r);return t}function Ln(r,e,t,i,n,s,o,a){return(n-o)*(e-a)>=(r-o)*(s-a)&&(r-o)*(i-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(n-o)*(i-a)}function DT(r,e){return r.next.i!==e.i&&r.prev.i!==e.i&&!NT(r,e)&&(So(r,e)&&So(e,r)&&OT(r,e)&&(Se(r.prev,r,e.prev)||Se(r,e.prev,e))||gu(r,e)&&Se(r.prev,r,r.next)>0&&Se(e.prev,e,e.next)>0)}function Se(r,e,t){return(e.y-r.y)*(t.x-e.x)-(e.x-r.x)*(t.y-e.y)}function gu(r,e){return r.x===e.x&&r.y===e.y}function v_(r,e,t,i){var n=la(Se(r,e,t)),s=la(Se(r,e,i)),o=la(Se(t,i,r)),a=la(Se(t,i,e));return!!(n!==s&&o!==a||n===0&&aa(r,t,e)||s===0&&aa(r,i,e)||o===0&&aa(t,r,i)||a===0&&aa(t,e,i))}function aa(r,e,t){return e.x<=Math.max(r.x,t.x)&&e.x>=Math.min(r.x,t.x)&&e.y<=Math.max(r.y,t.y)&&e.y>=Math.min(r.y,t.y)}function la(r){return r>0?1:r<0?-1:0}function NT(r,e){var t=r;do{if(t.i!==r.i&&t.next.i!==r.i&&t.i!==e.i&&t.next.i!==e.i&&v_(t,t.next,r,e))return!0;t=t.next}while(t!==r);return!1}function So(r,e){return Se(r.prev,r,r.next)<0?Se(r,e,r.next)>=0&&Se(r,r.prev,e)>=0:Se(r,e,r.prev)<0||Se(r,r.next,e)<0}function OT(r,e){var t=r,i=!1,n=(r.x+e.x)/2,s=(r.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&n<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next;while(t!==r);return i}function __(r,e){var t=new nd(r.i,r.x,r.y),i=new nd(e.i,e.x,e.y),n=r.next,s=e.prev;return r.next=e,e.prev=r,t.next=n,n.prev=t,i.next=t,t.prev=i,s.next=i,i.prev=s,i}function Wm(r,e,t,i){var n=new nd(r,e,t);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function Ao(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function nd(r,e,t){this.i=r,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}mu.deviation=function(r,e,t,i){var n=e&&e.length,s=n?e[0]*t:r.length,o=Math.abs(sd(r,0,s,t));if(n)for(var a=0,l=e.length;a<l;a++){var u=e[a]*t,h=a<l-1?e[a+1]*t:r.length;o-=Math.abs(sd(r,u,h,t))}var d=0;for(a=0;a<i.length;a+=3){var c=i[a]*t,f=i[a+1]*t,p=i[a+2]*t;d+=Math.abs((r[c]-r[p])*(r[f+1]-r[c+1])-(r[c]-r[f])*(r[p+1]-r[c+1]))}return o===0&&d===0?0:Math.abs((d-o)/o)};function sd(r,e,t,i){for(var n=0,s=e,o=t-i;s<t;s+=i)n+=(r[o]-r[s])*(r[s+1]+r[o+1]),o=s;return n}mu.flatten=function(r){for(var e=r[0][0].length,t={vertices:[],holes:[],dimensions:e},i=0,n=0;n<r.length;n++){for(var s=0;s<r[n].length;s++)for(var o=0;o<e;o++)t.vertices.push(r[n][s][o]);n>0&&(i+=r[n-1].length,t.holes.push(i))}return t};var BT=sp.exports;const LT=uf(BT);var Dl={exports:{}};/*! https://mths.be/punycode v1.4.1 by @mathias */Dl.exports;(function(r,e){(function(t){var i=e&&!e.nodeType&&e,n=r&&!r.nodeType&&r,s=typeof zs=="object"&&zs;(s.global===s||s.window===s||s.self===s)&&(t=s);var o,a=2147483647,l=36,u=1,h=26,d=38,c=700,f=72,p=128,v="-",x=/^xn--/,g=/[^\x20-\x7E]/,y=/[\x2E\u3002\uFF0E\uFF61]/g,m={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},_=l-u,w=Math.floor,S=String.fromCharCode,E;function T(R){throw new RangeError(m[R])}function b(R,M){for(var j=R.length,Q=[];j--;)Q[j]=M(R[j]);return Q}function A(R,M){var j=R.split("@"),Q="";j.length>1&&(Q=j[0]+"@",R=j[1]),R=R.replace(y,".");var J=R.split("."),fe=b(J,M).join(".");return Q+fe}function I(R){for(var M=[],j=0,Q=R.length,J,fe;j<Q;)J=R.charCodeAt(j++),J>=55296&&J<=56319&&j<Q?(fe=R.charCodeAt(j++),(fe&64512)==56320?M.push(((J&1023)<<10)+(fe&1023)+65536):(M.push(J),j--)):M.push(J);return M}function D(R){return b(R,function(M){var j="";return M>65535&&(M-=65536,j+=S(M>>>10&1023|55296),M=56320|M&1023),j+=S(M),j}).join("")}function C(R){return R-48<10?R-22:R-65<26?R-65:R-97<26?R-97:l}function k(R,M){return R+22+75*(R<26)-((M!=0)<<5)}function L(R,M,j){var Q=0;for(R=j?w(R/c):R>>1,R+=w(R/M);R>_*h>>1;Q+=l)R=w(R/_);return w(Q+(_+1)*R/(R+d))}function Y(R){var M=[],j=R.length,Q,J=0,fe=p,oe=f,he,De,We,He,ce,we,le,St,mt;for(he=R.lastIndexOf(v),he<0&&(he=0),De=0;De<he;++De)R.charCodeAt(De)>=128&&T("not-basic"),M.push(R.charCodeAt(De));for(We=he>0?he+1:0;We<j;){for(He=J,ce=1,we=l;We>=j&&T("invalid-input"),le=C(R.charCodeAt(We++)),(le>=l||le>w((a-J)/ce))&&T("overflow"),J+=le*ce,St=we<=oe?u:we>=oe+h?h:we-oe,!(le<St);we+=l)mt=l-St,ce>w(a/mt)&&T("overflow"),ce*=mt;Q=M.length+1,oe=L(J-He,Q,He==0),w(J/Q)>a-fe&&T("overflow"),fe+=w(J/Q),J%=Q,M.splice(J++,0,fe)}return D(M)}function $(R){var M,j,Q,J,fe,oe,he,De,We,He,ce,we=[],le,St,mt,Xr;for(R=I(R),le=R.length,M=p,j=0,fe=f,oe=0;oe<le;++oe)ce=R[oe],ce<128&&we.push(S(ce));for(Q=J=we.length,J&&we.push(v);Q<le;){for(he=a,oe=0;oe<le;++oe)ce=R[oe],ce>=M&&ce<he&&(he=ce);for(St=Q+1,he-M>w((a-j)/St)&&T("overflow"),j+=(he-M)*St,M=he,oe=0;oe<le;++oe)if(ce=R[oe],ce<M&&++j>a&&T("overflow"),ce==M){for(De=j,We=l;He=We<=fe?u:We>=fe+h?h:We-fe,!(De<He);We+=l)Xr=De-He,mt=l-He,we.push(S(k(He+Xr%mt,0))),De=w(Xr/mt);we.push(S(k(De,0))),fe=L(j,St,Q==J),j=0,++Q}++j,++M}return we.join("")}function P(R){return A(R,function(M){return x.test(M)?Y(M.slice(4).toLowerCase()):M})}function G(R){return A(R,function(M){return g.test(M)?"xn--"+$(M):M})}if(o={version:"1.4.1",ucs2:{decode:I,encode:D},decode:Y,encode:$,toASCII:G,toUnicode:P},i&&n)if(r.exports==i)n.exports=o;else for(E in o)o.hasOwnProperty(E)&&(i[E]=o[E]);else t.punycode=o})(zs)})(Dl,Dl.exports);var FT=Dl.exports,ds=TypeError;const UT={},GT=Object.freeze(Object.defineProperty({__proto__:null,default:UT},Symbol.toStringTag,{value:"Module"})),HT=G1(GT);var op=typeof Map=="function"&&Map.prototype,ah=Object.getOwnPropertyDescriptor&&op?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,Nl=op&&ah&&typeof ah.get=="function"?ah.get:null,Ym=op&&Map.prototype.forEach,ap=typeof Set=="function"&&Set.prototype,lh=Object.getOwnPropertyDescriptor&&ap?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,Ol=ap&&lh&&typeof lh.get=="function"?lh.get:null,qm=ap&&Set.prototype.forEach,$T=typeof WeakMap=="function"&&WeakMap.prototype,Js=$T?WeakMap.prototype.has:null,zT=typeof WeakSet=="function"&&WeakSet.prototype,eo=zT?WeakSet.prototype.has:null,VT=typeof WeakRef=="function"&&WeakRef.prototype,Km=VT?WeakRef.prototype.deref:null,XT=Boolean.prototype.valueOf,jT=Object.prototype.toString,WT=Function.prototype.toString,YT=String.prototype.match,lp=String.prototype.slice,ni=String.prototype.replace,qT=String.prototype.toUpperCase,Zm=String.prototype.toLowerCase,x_=RegExp.prototype.test,Qm=Array.prototype.concat,cr=Array.prototype.join,KT=Array.prototype.slice,Jm=Math.floor,od=typeof BigInt=="function"?BigInt.prototype.valueOf:null,uh=Object.getOwnPropertySymbols,ad=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,os=typeof Symbol=="function"&&typeof Symbol.iterator=="object",to=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===os||!0)?Symbol.toStringTag:null,w_=Object.prototype.propertyIsEnumerable,eg=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(r){return r.__proto__}:null);function tg(r,e){if(r===1/0||r===-1/0||r!==r||r&&r>-1e3&&r<1e3||x_.call(/e/,e))return e;var t=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof r=="number"){var i=r<0?-Jm(-r):Jm(r);if(i!==r){var n=String(i),s=lp.call(e,n.length+1);return ni.call(n,t,"$&_")+"."+ni.call(ni.call(s,/([0-9]{3})/g,"$&_"),/_$/,"")}}return ni.call(e,t,"$&_")}var ld=HT,rg=ld.custom,ig=S_(rg)?rg:null,E_={__proto__:null,double:'"',single:"'"},ZT={__proto__:null,double:/(["\\])/g,single:/(['\\])/g},yu=function r(e,t,i,n){var s=t||{};if(Cr(s,"quoteStyle")&&!Cr(E_,s.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Cr(s,"maxStringLength")&&(typeof s.maxStringLength=="number"?s.maxStringLength<0&&s.maxStringLength!==1/0:s.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var o=Cr(s,"customInspect")?s.customInspect:!0;if(typeof o!="boolean"&&o!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Cr(s,"indent")&&s.indent!==null&&s.indent!=="	"&&!(parseInt(s.indent,10)===s.indent&&s.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Cr(s,"numericSeparator")&&typeof s.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var a=s.numericSeparator;if(typeof e>"u")return"undefined";if(e===null)return"null";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return b_(e,s);if(typeof e=="number"){if(e===0)return 1/0/e>0?"0":"-0";var l=String(e);return a?tg(e,l):l}if(typeof e=="bigint"){var u=String(e)+"n";return a?tg(e,u):u}var h=typeof s.depth>"u"?5:s.depth;if(typeof i>"u"&&(i=0),i>=h&&h>0&&typeof e=="object")return ud(e)?"[Array]":"[Object]";var d=mS(s,i);if(typeof n>"u")n=[];else if(A_(n,e)>=0)return"[Circular]";function c(C,k,L){if(k&&(n=KT.call(n),n.push(k)),L){var Y={depth:s.depth};return Cr(s,"quoteStyle")&&(Y.quoteStyle=s.quoteStyle),r(C,Y,i+1,n)}return r(C,s,i+1,n)}if(typeof e=="function"&&!ng(e)){var f=oS(e),p=ua(e,c);return"[Function"+(f?": "+f:" (anonymous)")+"]"+(p.length>0?" { "+cr.call(p,", ")+" }":"")}if(S_(e)){var v=os?ni.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):ad.call(e);return typeof e=="object"&&!os?As(v):v}if(dS(e)){for(var x="<"+Zm.call(String(e.nodeName)),g=e.attributes||[],y=0;y<g.length;y++)x+=" "+g[y].name+"="+T_(QT(g[y].value),"double",s);return x+=">",e.childNodes&&e.childNodes.length&&(x+="..."),x+="</"+Zm.call(String(e.nodeName))+">",x}if(ud(e)){if(e.length===0)return"[]";var m=ua(e,c);return d&&!pS(m)?"["+hd(m,d)+"]":"[ "+cr.call(m,", ")+" ]"}if(eS(e)){var _=ua(e,c);return!("cause"in Error.prototype)&&"cause"in e&&!w_.call(e,"cause")?"{ ["+String(e)+"] "+cr.call(Qm.call("[cause]: "+c(e.cause),_),", ")+" }":_.length===0?"["+String(e)+"]":"{ ["+String(e)+"] "+cr.call(_,", ")+" }"}if(typeof e=="object"&&o){if(ig&&typeof e[ig]=="function"&&ld)return ld(e,{depth:h-i});if(o!=="symbol"&&typeof e.inspect=="function")return e.inspect()}if(aS(e)){var w=[];return Ym&&Ym.call(e,function(C,k){w.push(c(k,e,!0)+" => "+c(C,e))}),sg("Map",Nl.call(e),w,d)}if(hS(e)){var S=[];return qm&&qm.call(e,function(C){S.push(c(C,e))}),sg("Set",Ol.call(e),S,d)}if(lS(e))return hh("WeakMap");if(cS(e))return hh("WeakSet");if(uS(e))return hh("WeakRef");if(rS(e))return As(c(Number(e)));if(nS(e))return As(c(od.call(e)));if(iS(e))return As(XT.call(e));if(tS(e))return As(c(String(e)));if(typeof window<"u"&&e===window)return"{ [object Window] }";if(typeof globalThis<"u"&&e===globalThis||typeof zs<"u"&&e===zs)return"{ [object globalThis] }";if(!JT(e)&&!ng(e)){var E=ua(e,c),T=eg?eg(e)===Object.prototype:e instanceof Object||e.constructor===Object,b=e instanceof Object?"":"null prototype",A=!T&&to&&Object(e)===e&&to in e?lp.call(bi(e),8,-1):b?"Object":"",I=T||typeof e.constructor!="function"?"":e.constructor.name?e.constructor.name+" ":"",D=I+(A||b?"["+cr.call(Qm.call([],A||[],b||[]),": ")+"] ":"");return E.length===0?D+"{}":d?D+"{"+hd(E,d)+"}":D+"{ "+cr.call(E,", ")+" }"}return String(e)};function T_(r,e,t){var i=t.quoteStyle||e,n=E_[i];return n+r+n}function QT(r){return ni.call(String(r),/"/g,"&quot;")}function ln(r){return!to||!(typeof r=="object"&&(to in r||typeof r[to]<"u"))}function ud(r){return bi(r)==="[object Array]"&&ln(r)}function JT(r){return bi(r)==="[object Date]"&&ln(r)}function ng(r){return bi(r)==="[object RegExp]"&&ln(r)}function eS(r){return bi(r)==="[object Error]"&&ln(r)}function tS(r){return bi(r)==="[object String]"&&ln(r)}function rS(r){return bi(r)==="[object Number]"&&ln(r)}function iS(r){return bi(r)==="[object Boolean]"&&ln(r)}function S_(r){if(os)return r&&typeof r=="object"&&r instanceof Symbol;if(typeof r=="symbol")return!0;if(!r||typeof r!="object"||!ad)return!1;try{return ad.call(r),!0}catch{}return!1}function nS(r){if(!r||typeof r!="object"||!od)return!1;try{return od.call(r),!0}catch{}return!1}var sS=Object.prototype.hasOwnProperty||function(r){return r in this};function Cr(r,e){return sS.call(r,e)}function bi(r){return jT.call(r)}function oS(r){if(r.name)return r.name;var e=YT.call(WT.call(r),/^function\s*([\w$]+)/);return e?e[1]:null}function A_(r,e){if(r.indexOf)return r.indexOf(e);for(var t=0,i=r.length;t<i;t++)if(r[t]===e)return t;return-1}function aS(r){if(!Nl||!r||typeof r!="object")return!1;try{Nl.call(r);try{Ol.call(r)}catch{return!0}return r instanceof Map}catch{}return!1}function lS(r){if(!Js||!r||typeof r!="object")return!1;try{Js.call(r,Js);try{eo.call(r,eo)}catch{return!0}return r instanceof WeakMap}catch{}return!1}function uS(r){if(!Km||!r||typeof r!="object")return!1;try{return Km.call(r),!0}catch{}return!1}function hS(r){if(!Ol||!r||typeof r!="object")return!1;try{Ol.call(r);try{Nl.call(r)}catch{return!0}return r instanceof Set}catch{}return!1}function cS(r){if(!eo||!r||typeof r!="object")return!1;try{eo.call(r,eo);try{Js.call(r,Js)}catch{return!0}return r instanceof WeakSet}catch{}return!1}function dS(r){return!r||typeof r!="object"?!1:typeof HTMLElement<"u"&&r instanceof HTMLElement?!0:typeof r.nodeName=="string"&&typeof r.getAttribute=="function"}function b_(r,e){if(r.length>e.maxStringLength){var t=r.length-e.maxStringLength,i="... "+t+" more character"+(t>1?"s":"");return b_(lp.call(r,0,e.maxStringLength),e)+i}var n=ZT[e.quoteStyle||"single"];n.lastIndex=0;var s=ni.call(ni.call(r,n,"\\$1"),/[\x00-\x1f]/g,fS);return T_(s,"single",e)}function fS(r){var e=r.charCodeAt(0),t={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return t?"\\"+t:"\\x"+(e<16?"0":"")+qT.call(e.toString(16))}function As(r){return"Object("+r+")"}function hh(r){return r+" { ? }"}function sg(r,e,t,i){var n=i?hd(t,i):cr.call(t,", ");return r+" ("+e+") {"+n+"}"}function pS(r){for(var e=0;e<r.length;e++)if(A_(r[e],`
`)>=0)return!1;return!0}function mS(r,e){var t;if(r.indent==="	")t="	";else if(typeof r.indent=="number"&&r.indent>0)t=cr.call(Array(r.indent+1)," ");else return null;return{base:t,prev:cr.call(Array(e+1),t)}}function hd(r,e){if(r.length===0)return"";var t=`
`+e.prev+e.base;return t+cr.call(r,","+t)+`
`+e.prev}function ua(r,e){var t=ud(r),i=[];if(t){i.length=r.length;for(var n=0;n<r.length;n++)i[n]=Cr(r,n)?e(r[n],r):""}var s=typeof uh=="function"?uh(r):[],o;if(os){o={};for(var a=0;a<s.length;a++)o["$"+s[a]]=s[a]}for(var l in r)Cr(r,l)&&(t&&String(Number(l))===l&&l<r.length||os&&o["$"+l]instanceof Symbol||(x_.call(/[^\w$]/,l)?i.push(e(l,r)+": "+e(r[l],r)):i.push(l+": "+e(r[l],r))));if(typeof uh=="function")for(var u=0;u<s.length;u++)w_.call(r,s[u])&&i.push("["+e(s[u])+"]: "+e(r[s[u]],r));return i}var gS=yu,yS=ds,vu=function(r,e,t){for(var i=r,n;(n=i.next)!=null;i=n)if(n.key===e)return i.next=n.next,t||(n.next=r.next,r.next=n),n},vS=function(r,e){if(r){var t=vu(r,e);return t&&t.value}},_S=function(r,e,t){var i=vu(r,e);i?i.value=t:r.next={key:e,next:r.next,value:t}},xS=function(r,e){return r?!!vu(r,e):!1},wS=function(r,e){if(r)return vu(r,e,!0)},ES=function(){var e,t={assert:function(i){if(!t.has(i))throw new yS("Side channel does not contain "+gS(i))},delete:function(i){var n=e&&e.next,s=wS(e,i);return s&&n&&n===s&&(e=void 0),!!s},get:function(i){return vS(e,i)},has:function(i){return xS(e,i)},set:function(i,n){e||(e={next:void 0}),_S(e,i,n)}};return t},C_=Object,TS=Error,SS=EvalError,AS=RangeError,bS=ReferenceError,CS=SyntaxError,RS=URIError,IS=Math.abs,PS=Math.floor,kS=Math.max,MS=Math.min,DS=Math.pow,NS=Math.round,OS=Number.isNaN||function(e){return e!==e},BS=OS,LS=function(e){return BS(e)||e===0?e:e<0?-1:1},FS=Object.getOwnPropertyDescriptor,Ya=FS;if(Ya)try{Ya([],"length")}catch{Ya=null}var R_=Ya,qa=Object.defineProperty||!1;if(qa)try{qa({},"a",{value:1})}catch{qa=!1}var US=qa,ch,og;function GS(){return og||(og=1,ch=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),i=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(i)!=="[object Symbol]")return!1;var n=42;e[t]=n;for(var s in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var o=Object.getOwnPropertySymbols(e);if(o.length!==1||o[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var a=Object.getOwnPropertyDescriptor(e,t);if(a.value!==n||a.enumerable!==!0)return!1}return!0}),ch}var dh,ag;function HS(){if(ag)return dh;ag=1;var r=typeof Symbol<"u"&&Symbol,e=GS();return dh=function(){return typeof r!="function"||typeof Symbol!="function"||typeof r("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},dh}var fh,lg;function I_(){return lg||(lg=1,fh=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),fh}var ph,ug;function P_(){if(ug)return ph;ug=1;var r=C_;return ph=r.getPrototypeOf||null,ph}var $S="Function.prototype.bind called on incompatible ",zS=Object.prototype.toString,VS=Math.max,XS="[object Function]",hg=function(e,t){for(var i=[],n=0;n<e.length;n+=1)i[n]=e[n];for(var s=0;s<t.length;s+=1)i[s+e.length]=t[s];return i},jS=function(e,t){for(var i=[],n=t,s=0;n<e.length;n+=1,s+=1)i[s]=e[n];return i},WS=function(r,e){for(var t="",i=0;i<r.length;i+=1)t+=r[i],i+1<r.length&&(t+=e);return t},YS=function(e){var t=this;if(typeof t!="function"||zS.apply(t)!==XS)throw new TypeError($S+t);for(var i=jS(arguments,1),n,s=function(){if(this instanceof n){var h=t.apply(this,hg(i,arguments));return Object(h)===h?h:this}return t.apply(e,hg(i,arguments))},o=VS(0,t.length-i.length),a=[],l=0;l<o;l++)a[l]="$"+l;if(n=Function("binder","return function ("+WS(a,",")+"){ return binder.apply(this,arguments); }")(s),t.prototype){var u=function(){};u.prototype=t.prototype,n.prototype=new u,u.prototype=null}return n},qS=YS,_u=Function.prototype.bind||qS,up=Function.prototype.call,mh,cg;function k_(){return cg||(cg=1,mh=Function.prototype.apply),mh}var KS=typeof Reflect<"u"&&Reflect&&Reflect.apply,ZS=_u,QS=k_(),JS=up,eA=KS,tA=eA||ZS.call(JS,QS),rA=_u,iA=ds,nA=up,sA=tA,M_=function(e){if(e.length<1||typeof e[0]!="function")throw new iA("a function is required");return sA(rA,nA,e)},gh,dg;function oA(){if(dg)return gh;dg=1;var r=M_,e=R_,t;try{t=[].__proto__===Array.prototype}catch(o){if(!o||typeof o!="object"||!("code"in o)||o.code!=="ERR_PROTO_ACCESS")throw o}var i=!!t&&e&&e(Object.prototype,"__proto__"),n=Object,s=n.getPrototypeOf;return gh=i&&typeof i.get=="function"?r([i.get]):typeof s=="function"?function(a){return s(a==null?a:n(a))}:!1,gh}var yh,fg;function aA(){if(fg)return yh;fg=1;var r=I_(),e=P_(),t=oA();return yh=r?function(n){return r(n)}:e?function(n){if(!n||typeof n!="object"&&typeof n!="function")throw new TypeError("getProto: not an object");return e(n)}:t?function(n){return t(n)}:null,yh}var vh,pg;function lA(){if(pg)return vh;pg=1;var r=Function.prototype.call,e=Object.prototype.hasOwnProperty,t=_u;return vh=t.call(r,e),vh}var re,uA=C_,hA=TS,cA=SS,dA=AS,fA=bS,as=CS,jn=ds,pA=RS,mA=IS,gA=PS,yA=kS,vA=MS,_A=DS,xA=NS,wA=LS,D_=Function,_h=function(r){try{return D_('"use strict"; return ('+r+").constructor;")()}catch{}},bo=R_,EA=US,xh=function(){throw new jn},TA=bo?function(){try{return arguments.callee,xh}catch{try{return bo(arguments,"callee").get}catch{return xh}}}():xh,fn=HS()(),$e=aA(),SA=P_(),AA=I_(),N_=k_(),Bo=up,vn={},bA=typeof Uint8Array>"u"||!$e?re:$e(Uint8Array),Xi={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?re:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?re:ArrayBuffer,"%ArrayIteratorPrototype%":fn&&$e?$e([][Symbol.iterator]()):re,"%AsyncFromSyncIteratorPrototype%":re,"%AsyncFunction%":vn,"%AsyncGenerator%":vn,"%AsyncGeneratorFunction%":vn,"%AsyncIteratorPrototype%":vn,"%Atomics%":typeof Atomics>"u"?re:Atomics,"%BigInt%":typeof BigInt>"u"?re:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?re:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?re:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?re:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":hA,"%eval%":eval,"%EvalError%":cA,"%Float16Array%":typeof Float16Array>"u"?re:Float16Array,"%Float32Array%":typeof Float32Array>"u"?re:Float32Array,"%Float64Array%":typeof Float64Array>"u"?re:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?re:FinalizationRegistry,"%Function%":D_,"%GeneratorFunction%":vn,"%Int8Array%":typeof Int8Array>"u"?re:Int8Array,"%Int16Array%":typeof Int16Array>"u"?re:Int16Array,"%Int32Array%":typeof Int32Array>"u"?re:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":fn&&$e?$e($e([][Symbol.iterator]())):re,"%JSON%":typeof JSON=="object"?JSON:re,"%Map%":typeof Map>"u"?re:Map,"%MapIteratorPrototype%":typeof Map>"u"||!fn||!$e?re:$e(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":uA,"%Object.getOwnPropertyDescriptor%":bo,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?re:Promise,"%Proxy%":typeof Proxy>"u"?re:Proxy,"%RangeError%":dA,"%ReferenceError%":fA,"%Reflect%":typeof Reflect>"u"?re:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?re:Set,"%SetIteratorPrototype%":typeof Set>"u"||!fn||!$e?re:$e(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?re:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":fn&&$e?$e(""[Symbol.iterator]()):re,"%Symbol%":fn?Symbol:re,"%SyntaxError%":as,"%ThrowTypeError%":TA,"%TypedArray%":bA,"%TypeError%":jn,"%Uint8Array%":typeof Uint8Array>"u"?re:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?re:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?re:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?re:Uint32Array,"%URIError%":pA,"%WeakMap%":typeof WeakMap>"u"?re:WeakMap,"%WeakRef%":typeof WeakRef>"u"?re:WeakRef,"%WeakSet%":typeof WeakSet>"u"?re:WeakSet,"%Function.prototype.call%":Bo,"%Function.prototype.apply%":N_,"%Object.defineProperty%":EA,"%Object.getPrototypeOf%":SA,"%Math.abs%":mA,"%Math.floor%":gA,"%Math.max%":yA,"%Math.min%":vA,"%Math.pow%":_A,"%Math.round%":xA,"%Math.sign%":wA,"%Reflect.getPrototypeOf%":AA};if($e)try{null.error}catch(r){var CA=$e($e(r));Xi["%Error.prototype%"]=CA}var RA=function r(e){var t;if(e==="%AsyncFunction%")t=_h("async function () {}");else if(e==="%GeneratorFunction%")t=_h("function* () {}");else if(e==="%AsyncGeneratorFunction%")t=_h("async function* () {}");else if(e==="%AsyncGenerator%"){var i=r("%AsyncGeneratorFunction%");i&&(t=i.prototype)}else if(e==="%AsyncIteratorPrototype%"){var n=r("%AsyncGenerator%");n&&$e&&(t=$e(n.prototype))}return Xi[e]=t,t},mg={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Lo=_u,Bl=lA(),IA=Lo.call(Bo,Array.prototype.concat),PA=Lo.call(N_,Array.prototype.splice),gg=Lo.call(Bo,String.prototype.replace),Ll=Lo.call(Bo,String.prototype.slice),kA=Lo.call(Bo,RegExp.prototype.exec),MA=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,DA=/\\(\\)?/g,NA=function(e){var t=Ll(e,0,1),i=Ll(e,-1);if(t==="%"&&i!=="%")throw new as("invalid intrinsic syntax, expected closing `%`");if(i==="%"&&t!=="%")throw new as("invalid intrinsic syntax, expected opening `%`");var n=[];return gg(e,MA,function(s,o,a,l){n[n.length]=a?gg(l,DA,"$1"):o||s}),n},OA=function(e,t){var i=e,n;if(Bl(mg,i)&&(n=mg[i],i="%"+n[0]+"%"),Bl(Xi,i)){var s=Xi[i];if(s===vn&&(s=RA(i)),typeof s>"u"&&!t)throw new jn("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:n,name:i,value:s}}throw new as("intrinsic "+e+" does not exist!")},hp=function(e,t){if(typeof e!="string"||e.length===0)throw new jn("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof t!="boolean")throw new jn('"allowMissing" argument must be a boolean');if(kA(/^%?[^%]*%?$/,e)===null)throw new as("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var i=NA(e),n=i.length>0?i[0]:"",s=OA("%"+n+"%",t),o=s.name,a=s.value,l=!1,u=s.alias;u&&(n=u[0],PA(i,IA([0,1],u)));for(var h=1,d=!0;h<i.length;h+=1){var c=i[h],f=Ll(c,0,1),p=Ll(c,-1);if((f==='"'||f==="'"||f==="`"||p==='"'||p==="'"||p==="`")&&f!==p)throw new as("property names with quotes must have matching quotes");if((c==="constructor"||!d)&&(l=!0),n+="."+c,o="%"+n+"%",Bl(Xi,o))a=Xi[o];else if(a!=null){if(!(c in a)){if(!t)throw new jn("base intrinsic for "+e+" exists, but the property is not available.");return}if(bo&&h+1>=i.length){var v=bo(a,c);d=!!v,d&&"get"in v&&!("originalValue"in v.get)?a=v.get:a=a[c]}else d=Bl(a,c),a=a[c];d&&!l&&(Xi[o]=a)}}return a},O_=hp,B_=M_,BA=B_([O_("%String.prototype.indexOf%")]),L_=function(e,t){var i=O_(e,!!t);return typeof i=="function"&&BA(e,".prototype.")>-1?B_([i]):i},LA=hp,Fo=L_,FA=yu,UA=ds,yg=LA("%Map%",!0),GA=Fo("Map.prototype.get",!0),HA=Fo("Map.prototype.set",!0),$A=Fo("Map.prototype.has",!0),zA=Fo("Map.prototype.delete",!0),VA=Fo("Map.prototype.size",!0),F_=!!yg&&function(){var e,t={assert:function(i){if(!t.has(i))throw new UA("Side channel does not contain "+FA(i))},delete:function(i){if(e){var n=zA(e,i);return VA(e)===0&&(e=void 0),n}return!1},get:function(i){if(e)return GA(e,i)},has:function(i){return e?$A(e,i):!1},set:function(i,n){e||(e=new yg),HA(e,i,n)}};return t},XA=hp,xu=L_,jA=yu,ha=F_,WA=ds,pn=XA("%WeakMap%",!0),YA=xu("WeakMap.prototype.get",!0),qA=xu("WeakMap.prototype.set",!0),KA=xu("WeakMap.prototype.has",!0),ZA=xu("WeakMap.prototype.delete",!0),QA=pn?function(){var e,t,i={assert:function(n){if(!i.has(n))throw new WA("Side channel does not contain "+jA(n))},delete:function(n){if(pn&&n&&(typeof n=="object"||typeof n=="function")){if(e)return ZA(e,n)}else if(ha&&t)return t.delete(n);return!1},get:function(n){return pn&&n&&(typeof n=="object"||typeof n=="function")&&e?YA(e,n):t&&t.get(n)},has:function(n){return pn&&n&&(typeof n=="object"||typeof n=="function")&&e?KA(e,n):!!t&&t.has(n)},set:function(n,s){pn&&n&&(typeof n=="object"||typeof n=="function")?(e||(e=new pn),qA(e,n,s)):ha&&(t||(t=ha()),t.set(n,s))}};return i}:ha,JA=ds,eb=yu,tb=ES,rb=F_,ib=QA,nb=ib||rb||tb,sb=function(){var e,t={assert:function(i){if(!t.has(i))throw new JA("Side channel does not contain "+eb(i))},delete:function(i){return!!e&&e.delete(i)},get:function(i){return e&&e.get(i)},has:function(i){return!!e&&e.has(i)},set:function(i,n){e||(e=nb()),e.set(i,n)}};return t},ob=String.prototype.replace,ab=/%20/g,wh={RFC1738:"RFC1738",RFC3986:"RFC3986"},cp={default:wh.RFC3986,formatters:{RFC1738:function(r){return ob.call(r,ab,"+")},RFC3986:function(r){return String(r)}},RFC1738:wh.RFC1738,RFC3986:wh.RFC3986},lb=cp,Eh=Object.prototype.hasOwnProperty,Fi=Array.isArray,tr=function(){for(var r=[],e=0;e<256;++e)r.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return r}(),ub=function(e){for(;e.length>1;){var t=e.pop(),i=t.obj[t.prop];if(Fi(i)){for(var n=[],s=0;s<i.length;++s)typeof i[s]<"u"&&n.push(i[s]);t.obj[t.prop]=n}}},U_=function(e,t){for(var i=t&&t.plainObjects?{__proto__:null}:{},n=0;n<e.length;++n)typeof e[n]<"u"&&(i[n]=e[n]);return i},hb=function r(e,t,i){if(!t)return e;if(typeof t!="object"&&typeof t!="function"){if(Fi(e))e.push(t);else if(e&&typeof e=="object")(i&&(i.plainObjects||i.allowPrototypes)||!Eh.call(Object.prototype,t))&&(e[t]=!0);else return[e,t];return e}if(!e||typeof e!="object")return[e].concat(t);var n=e;return Fi(e)&&!Fi(t)&&(n=U_(e,i)),Fi(e)&&Fi(t)?(t.forEach(function(s,o){if(Eh.call(e,o)){var a=e[o];a&&typeof a=="object"&&s&&typeof s=="object"?e[o]=r(a,s,i):e.push(s)}else e[o]=s}),e):Object.keys(t).reduce(function(s,o){var a=t[o];return Eh.call(s,o)?s[o]=r(s[o],a,i):s[o]=a,s},n)},cb=function(e,t){return Object.keys(t).reduce(function(i,n){return i[n]=t[n],i},e)},db=function(r,e,t){var i=r.replace(/\+/g," ");if(t==="iso-8859-1")return i.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(i)}catch{return i}},Th=1024,fb=function(e,t,i,n,s){if(e.length===0)return e;var o=e;if(typeof e=="symbol"?o=Symbol.prototype.toString.call(e):typeof e!="string"&&(o=String(e)),i==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(f){return"%26%23"+parseInt(f.slice(2),16)+"%3B"});for(var a="",l=0;l<o.length;l+=Th){for(var u=o.length>=Th?o.slice(l,l+Th):o,h=[],d=0;d<u.length;++d){var c=u.charCodeAt(d);if(c===45||c===46||c===95||c===126||c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122||s===lb.RFC1738&&(c===40||c===41)){h[h.length]=u.charAt(d);continue}if(c<128){h[h.length]=tr[c];continue}if(c<2048){h[h.length]=tr[192|c>>6]+tr[128|c&63];continue}if(c<55296||c>=57344){h[h.length]=tr[224|c>>12]+tr[128|c>>6&63]+tr[128|c&63];continue}d+=1,c=65536+((c&1023)<<10|u.charCodeAt(d)&1023),h[h.length]=tr[240|c>>18]+tr[128|c>>12&63]+tr[128|c>>6&63]+tr[128|c&63]}a+=h.join("")}return a},pb=function(e){for(var t=[{obj:{o:e},prop:"o"}],i=[],n=0;n<t.length;++n)for(var s=t[n],o=s.obj[s.prop],a=Object.keys(o),l=0;l<a.length;++l){var u=a[l],h=o[u];typeof h=="object"&&h!==null&&i.indexOf(h)===-1&&(t.push({obj:o,prop:u}),i.push(h))}return ub(t),e},mb=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"},gb=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},yb=function(e,t){return[].concat(e,t)},vb=function(e,t){if(Fi(e)){for(var i=[],n=0;n<e.length;n+=1)i.push(t(e[n]));return i}return t(e)},G_={arrayToObject:U_,assign:cb,combine:yb,compact:pb,decode:db,encode:fb,isBuffer:gb,isRegExp:mb,maybeMap:vb,merge:hb},H_=sb,Ka=G_,ro=cp,_b=Object.prototype.hasOwnProperty,$_={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},ur=Array.isArray,xb=Array.prototype.push,z_=function(r,e){xb.apply(r,ur(e)?e:[e])},wb=Date.prototype.toISOString,vg=ro.default,Le={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,commaRoundTrip:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:Ka.encode,encodeValuesOnly:!1,filter:void 0,format:vg,formatter:ro.formatters[vg],indices:!1,serializeDate:function(e){return wb.call(e)},skipNulls:!1,strictNullHandling:!1},Eb=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},Sh={},Tb=function r(e,t,i,n,s,o,a,l,u,h,d,c,f,p,v,x,g,y){for(var m=e,_=y,w=0,S=!1;(_=_.get(Sh))!==void 0&&!S;){var E=_.get(e);if(w+=1,typeof E<"u"){if(E===w)throw new RangeError("Cyclic object value");S=!0}typeof _.get(Sh)>"u"&&(w=0)}if(typeof h=="function"?m=h(t,m):m instanceof Date?m=f(m):i==="comma"&&ur(m)&&(m=Ka.maybeMap(m,function(R){return R instanceof Date?f(R):R})),m===null){if(o)return u&&!x?u(t,Le.encoder,g,"key",p):t;m=""}if(Eb(m)||Ka.isBuffer(m)){if(u){var T=x?t:u(t,Le.encoder,g,"key",p);return[v(T)+"="+v(u(m,Le.encoder,g,"value",p))]}return[v(t)+"="+v(String(m))]}var b=[];if(typeof m>"u")return b;var A;if(i==="comma"&&ur(m))x&&u&&(m=Ka.maybeMap(m,u)),A=[{value:m.length>0?m.join(",")||null:void 0}];else if(ur(h))A=h;else{var I=Object.keys(m);A=d?I.sort(d):I}var D=l?String(t).replace(/\./g,"%2E"):String(t),C=n&&ur(m)&&m.length===1?D+"[]":D;if(s&&ur(m)&&m.length===0)return C+"[]";for(var k=0;k<A.length;++k){var L=A[k],Y=typeof L=="object"&&L&&typeof L.value<"u"?L.value:m[L];if(!(a&&Y===null)){var $=c&&l?String(L).replace(/\./g,"%2E"):String(L),P=ur(m)?typeof i=="function"?i(C,$):C:C+(c?"."+$:"["+$+"]");y.set(e,w);var G=H_();G.set(Sh,y),z_(b,r(Y,P,i,n,s,o,a,l,i==="comma"&&x&&ur(m)?null:u,h,d,c,f,p,v,x,g,G))}}return b},Sb=function(e){if(!e)return Le;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.encodeDotInKeys<"u"&&typeof e.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");var t=e.charset||Le.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var i=ro.default;if(typeof e.format<"u"){if(!_b.call(ro.formatters,e.format))throw new TypeError("Unknown format option provided.");i=e.format}var n=ro.formatters[i],s=Le.filter;(typeof e.filter=="function"||ur(e.filter))&&(s=e.filter);var o;if(e.arrayFormat in $_?o=e.arrayFormat:"indices"in e?o=e.indices?"indices":"repeat":o=Le.arrayFormat,"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var a=typeof e.allowDots>"u"?e.encodeDotInKeys===!0?!0:Le.allowDots:!!e.allowDots;return{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:Le.addQueryPrefix,allowDots:a,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:Le.allowEmptyArrays,arrayFormat:o,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:Le.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:typeof e.delimiter>"u"?Le.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:Le.encode,encodeDotInKeys:typeof e.encodeDotInKeys=="boolean"?e.encodeDotInKeys:Le.encodeDotInKeys,encoder:typeof e.encoder=="function"?e.encoder:Le.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:Le.encodeValuesOnly,filter:s,format:i,formatter:n,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:Le.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:Le.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:Le.strictNullHandling}},Ab=function(r,e){var t=r,i=Sb(e),n,s;typeof i.filter=="function"?(s=i.filter,t=s("",t)):ur(i.filter)&&(s=i.filter,n=s);var o=[];if(typeof t!="object"||t===null)return"";var a=$_[i.arrayFormat],l=a==="comma"&&i.commaRoundTrip;n||(n=Object.keys(t)),i.sort&&n.sort(i.sort);for(var u=H_(),h=0;h<n.length;++h){var d=n[h],c=t[d];i.skipNulls&&c===null||z_(o,Tb(c,d,a,l,i.allowEmptyArrays,i.strictNullHandling,i.skipNulls,i.encodeDotInKeys,i.encode?i.encoder:null,i.filter,i.sort,i.allowDots,i.serializeDate,i.format,i.formatter,i.encodeValuesOnly,i.charset,u))}var f=o.join(i.delimiter),p=i.addQueryPrefix===!0?"?":"";return i.charsetSentinel&&(i.charset==="iso-8859-1"?p+="utf8=%26%2310003%3B&":p+="utf8=%E2%9C%93&"),f.length>0?p+f:""},en=G_,cd=Object.prototype.hasOwnProperty,_g=Array.isArray,Re={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:en.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1,throwOnLimitExceeded:!1},bb=function(r){return r.replace(/&#(\d+);/g,function(e,t){return String.fromCharCode(parseInt(t,10))})},V_=function(r,e,t){if(r&&typeof r=="string"&&e.comma&&r.indexOf(",")>-1)return r.split(",");if(e.throwOnLimitExceeded&&t>=e.arrayLimit)throw new RangeError("Array limit exceeded. Only "+e.arrayLimit+" element"+(e.arrayLimit===1?"":"s")+" allowed in an array.");return r},Cb="utf8=%26%2310003%3B",Rb="utf8=%E2%9C%93",Ib=function(e,t){var i={__proto__:null},n=t.ignoreQueryPrefix?e.replace(/^\?/,""):e;n=n.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var s=t.parameterLimit===1/0?void 0:t.parameterLimit,o=n.split(t.delimiter,t.throwOnLimitExceeded?s+1:s);if(t.throwOnLimitExceeded&&o.length>s)throw new RangeError("Parameter limit exceeded. Only "+s+" parameter"+(s===1?"":"s")+" allowed.");var a=-1,l,u=t.charset;if(t.charsetSentinel)for(l=0;l<o.length;++l)o[l].indexOf("utf8=")===0&&(o[l]===Rb?u="utf-8":o[l]===Cb&&(u="iso-8859-1"),a=l,l=o.length);for(l=0;l<o.length;++l)if(l!==a){var h=o[l],d=h.indexOf("]="),c=d===-1?h.indexOf("="):d+1,f,p;c===-1?(f=t.decoder(h,Re.decoder,u,"key"),p=t.strictNullHandling?null:""):(f=t.decoder(h.slice(0,c),Re.decoder,u,"key"),p=en.maybeMap(V_(h.slice(c+1),t,_g(i[f])?i[f].length:0),function(x){return t.decoder(x,Re.decoder,u,"value")})),p&&t.interpretNumericEntities&&u==="iso-8859-1"&&(p=bb(String(p))),h.indexOf("[]=")>-1&&(p=_g(p)?[p]:p);var v=cd.call(i,f);v&&t.duplicates==="combine"?i[f]=en.combine(i[f],p):(!v||t.duplicates==="last")&&(i[f]=p)}return i},Pb=function(r,e,t,i){var n=0;if(r.length>0&&r[r.length-1]==="[]"){var s=r.slice(0,-1).join("");n=Array.isArray(e)&&e[s]?e[s].length:0}for(var o=i?e:V_(e,t,n),a=r.length-1;a>=0;--a){var l,u=r[a];if(u==="[]"&&t.parseArrays)l=t.allowEmptyArrays&&(o===""||t.strictNullHandling&&o===null)?[]:en.combine([],o);else{l=t.plainObjects?{__proto__:null}:{};var h=u.charAt(0)==="["&&u.charAt(u.length-1)==="]"?u.slice(1,-1):u,d=t.decodeDotInKeys?h.replace(/%2E/g,"."):h,c=parseInt(d,10);!t.parseArrays&&d===""?l={0:o}:!isNaN(c)&&u!==d&&String(c)===d&&c>=0&&t.parseArrays&&c<=t.arrayLimit?(l=[],l[c]=o):d!=="__proto__"&&(l[d]=o)}o=l}return o},kb=function(e,t,i,n){if(e){var s=i.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,o=/(\[[^[\]]*])/,a=/(\[[^[\]]*])/g,l=i.depth>0&&o.exec(s),u=l?s.slice(0,l.index):s,h=[];if(u){if(!i.plainObjects&&cd.call(Object.prototype,u)&&!i.allowPrototypes)return;h.push(u)}for(var d=0;i.depth>0&&(l=a.exec(s))!==null&&d<i.depth;){if(d+=1,!i.plainObjects&&cd.call(Object.prototype,l[1].slice(1,-1))&&!i.allowPrototypes)return;h.push(l[1])}if(l){if(i.strictDepth===!0)throw new RangeError("Input depth exceeded depth option of "+i.depth+" and strictDepth is true");h.push("["+s.slice(l.index)+"]")}return Pb(h,t,i,n)}},Mb=function(e){if(!e)return Re;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.decodeDotInKeys<"u"&&typeof e.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(e.decoder!==null&&typeof e.decoder<"u"&&typeof e.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");if(typeof e.throwOnLimitExceeded<"u"&&typeof e.throwOnLimitExceeded!="boolean")throw new TypeError("`throwOnLimitExceeded` option must be a boolean");var t=typeof e.charset>"u"?Re.charset:e.charset,i=typeof e.duplicates>"u"?Re.duplicates:e.duplicates;if(i!=="combine"&&i!=="first"&&i!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var n=typeof e.allowDots>"u"?e.decodeDotInKeys===!0?!0:Re.allowDots:!!e.allowDots;return{allowDots:n,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:Re.allowEmptyArrays,allowPrototypes:typeof e.allowPrototypes=="boolean"?e.allowPrototypes:Re.allowPrototypes,allowSparse:typeof e.allowSparse=="boolean"?e.allowSparse:Re.allowSparse,arrayLimit:typeof e.arrayLimit=="number"?e.arrayLimit:Re.arrayLimit,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:Re.charsetSentinel,comma:typeof e.comma=="boolean"?e.comma:Re.comma,decodeDotInKeys:typeof e.decodeDotInKeys=="boolean"?e.decodeDotInKeys:Re.decodeDotInKeys,decoder:typeof e.decoder=="function"?e.decoder:Re.decoder,delimiter:typeof e.delimiter=="string"||en.isRegExp(e.delimiter)?e.delimiter:Re.delimiter,depth:typeof e.depth=="number"||e.depth===!1?+e.depth:Re.depth,duplicates:i,ignoreQueryPrefix:e.ignoreQueryPrefix===!0,interpretNumericEntities:typeof e.interpretNumericEntities=="boolean"?e.interpretNumericEntities:Re.interpretNumericEntities,parameterLimit:typeof e.parameterLimit=="number"?e.parameterLimit:Re.parameterLimit,parseArrays:e.parseArrays!==!1,plainObjects:typeof e.plainObjects=="boolean"?e.plainObjects:Re.plainObjects,strictDepth:typeof e.strictDepth=="boolean"?!!e.strictDepth:Re.strictDepth,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:Re.strictNullHandling,throwOnLimitExceeded:typeof e.throwOnLimitExceeded=="boolean"?e.throwOnLimitExceeded:!1}},Db=function(r,e){var t=Mb(e);if(r===""||r===null||typeof r>"u")return t.plainObjects?{__proto__:null}:{};for(var i=typeof r=="string"?Ib(r,t):r,n=t.plainObjects?{__proto__:null}:{},s=Object.keys(i),o=0;o<s.length;++o){var a=s[o],l=kb(a,i[a],t,typeof r=="string");n=en.merge(n,l,t)}return t.allowSparse===!0?n:en.compact(n)},Nb=Ab,Ob=Db,Bb=cp,Lb={formats:Bb,parse:Ob,stringify:Nb},Fb=FT;function Lr(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var Ub=/^([a-z0-9.+-]+:)/i,Gb=/:[0-9]*$/,Hb=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,$b=["<",">",'"',"`"," ","\r",`
`,"	"],zb=["{","}","|","\\","^","`"].concat($b),dd=["'"].concat(zb),xg=["%","/","?",";","#"].concat(dd),wg=["/","?","#"],Vb=255,Eg=/^[+a-z0-9A-Z_-]{0,63}$/,Xb=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,jb={javascript:!0,"javascript:":!0},fd={javascript:!0,"javascript:":!0},Wn={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},pd=Lb;function Wb(r,e,t){if(r&&typeof r=="object"&&r instanceof Lr)return r;var i=new Lr;return i.parse(r,e,t),i}Lr.prototype.parse=function(r,e,t){if(typeof r!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof r);var i=r.indexOf("?"),n=i!==-1&&i<r.indexOf("#")?"?":"#",s=r.split(n),o=/\\/g;s[0]=s[0].replace(o,"/"),r=s.join(n);var a=r;if(a=a.trim(),!t&&r.split("#").length===1){var l=Hb.exec(a);if(l)return this.path=a,this.href=a,this.pathname=l[1],l[2]?(this.search=l[2],e?this.query=pd.parse(this.search.substr(1)):this.query=this.search.substr(1)):e&&(this.search="",this.query={}),this}var u=Ub.exec(a);if(u){u=u[0];var h=u.toLowerCase();this.protocol=h,a=a.substr(u.length)}if(t||u||a.match(/^\/\/[^@/]+@[^@/]+/)){var d=a.substr(0,2)==="//";d&&!(u&&fd[u])&&(a=a.substr(2),this.slashes=!0)}if(!fd[u]&&(d||u&&!Wn[u])){for(var c=-1,f=0;f<wg.length;f++){var p=a.indexOf(wg[f]);p!==-1&&(c===-1||p<c)&&(c=p)}var v,x;c===-1?x=a.lastIndexOf("@"):x=a.lastIndexOf("@",c),x!==-1&&(v=a.slice(0,x),a=a.slice(x+1),this.auth=decodeURIComponent(v)),c=-1;for(var f=0;f<xg.length;f++){var p=a.indexOf(xg[f]);p!==-1&&(c===-1||p<c)&&(c=p)}c===-1&&(c=a.length),this.host=a.slice(0,c),a=a.slice(c),this.parseHost(),this.hostname=this.hostname||"";var g=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!g)for(var y=this.hostname.split(/\./),f=0,m=y.length;f<m;f++){var _=y[f];if(_&&!_.match(Eg)){for(var w="",S=0,E=_.length;S<E;S++)_.charCodeAt(S)>127?w+="x":w+=_[S];if(!w.match(Eg)){var T=y.slice(0,f),b=y.slice(f+1),A=_.match(Xb);A&&(T.push(A[1]),b.unshift(A[2])),b.length&&(a="/"+b.join(".")+a),this.hostname=T.join(".");break}}}this.hostname.length>Vb?this.hostname="":this.hostname=this.hostname.toLowerCase(),g||(this.hostname=Fb.toASCII(this.hostname));var I=this.port?":"+this.port:"",D=this.hostname||"";this.host=D+I,this.href+=this.host,g&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),a[0]!=="/"&&(a="/"+a))}if(!jb[h])for(var f=0,m=dd.length;f<m;f++){var C=dd[f];if(a.indexOf(C)!==-1){var k=encodeURIComponent(C);k===C&&(k=escape(C)),a=a.split(C).join(k)}}var L=a.indexOf("#");L!==-1&&(this.hash=a.substr(L),a=a.slice(0,L));var Y=a.indexOf("?");if(Y!==-1?(this.search=a.substr(Y),this.query=a.substr(Y+1),e&&(this.query=pd.parse(this.query)),a=a.slice(0,Y)):e&&(this.search="",this.query={}),a&&(this.pathname=a),Wn[h]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var I=this.pathname||"",$=this.search||"";this.path=I+$}return this.href=this.format(),this};Lr.prototype.format=function(){var r=this.auth||"";r&&(r=encodeURIComponent(r),r=r.replace(/%3A/i,":"),r+="@");var e=this.protocol||"",t=this.pathname||"",i=this.hash||"",n=!1,s="";this.host?n=r+this.host:this.hostname&&(n=r+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(n+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(s=pd.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var o=this.search||s&&"?"+s||"";return e&&e.substr(-1)!==":"&&(e+=":"),this.slashes||(!e||Wn[e])&&n!==!1?(n="//"+(n||""),t&&t.charAt(0)!=="/"&&(t="/"+t)):n||(n=""),i&&i.charAt(0)!=="#"&&(i="#"+i),o&&o.charAt(0)!=="?"&&(o="?"+o),t=t.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),o=o.replace("#","%23"),e+n+t+o+i};Lr.prototype.resolve=function(r){return this.resolveObject(Wb(r,!1,!0)).format()};Lr.prototype.resolveObject=function(r){if(typeof r=="string"){var e=new Lr;e.parse(r,!1,!0),r=e}for(var t=new Lr,i=Object.keys(this),n=0;n<i.length;n++){var s=i[n];t[s]=this[s]}if(t.hash=r.hash,r.href==="")return t.href=t.format(),t;if(r.slashes&&!r.protocol){for(var o=Object.keys(r),a=0;a<o.length;a++){var l=o[a];l!=="protocol"&&(t[l]=r[l])}return Wn[t.protocol]&&t.hostname&&!t.pathname&&(t.pathname="/",t.path=t.pathname),t.href=t.format(),t}if(r.protocol&&r.protocol!==t.protocol){if(!Wn[r.protocol]){for(var u=Object.keys(r),h=0;h<u.length;h++){var d=u[h];t[d]=r[d]}return t.href=t.format(),t}if(t.protocol=r.protocol,!r.host&&!fd[r.protocol]){for(var m=(r.pathname||"").split("/");m.length&&!(r.host=m.shift()););r.host||(r.host=""),r.hostname||(r.hostname=""),m[0]!==""&&m.unshift(""),m.length<2&&m.unshift(""),t.pathname=m.join("/")}else t.pathname=r.pathname;if(t.search=r.search,t.query=r.query,t.host=r.host||"",t.auth=r.auth,t.hostname=r.hostname||r.host,t.port=r.port,t.pathname||t.search){var c=t.pathname||"",f=t.search||"";t.path=c+f}return t.slashes=t.slashes||r.slashes,t.href=t.format(),t}var p=t.pathname&&t.pathname.charAt(0)==="/",v=r.host||r.pathname&&r.pathname.charAt(0)==="/",x=v||p||t.host&&r.pathname,g=x,y=t.pathname&&t.pathname.split("/")||[],m=r.pathname&&r.pathname.split("/")||[],_=t.protocol&&!Wn[t.protocol];if(_&&(t.hostname="",t.port=null,t.host&&(y[0]===""?y[0]=t.host:y.unshift(t.host)),t.host="",r.protocol&&(r.hostname=null,r.port=null,r.host&&(m[0]===""?m[0]=r.host:m.unshift(r.host)),r.host=null),x=x&&(m[0]===""||y[0]==="")),v)t.host=r.host||r.host===""?r.host:t.host,t.hostname=r.hostname||r.hostname===""?r.hostname:t.hostname,t.search=r.search,t.query=r.query,y=m;else if(m.length)y||(y=[]),y.pop(),y=y.concat(m),t.search=r.search,t.query=r.query;else if(r.search!=null){if(_){t.host=y.shift(),t.hostname=t.host;var w=t.host&&t.host.indexOf("@")>0?t.host.split("@"):!1;w&&(t.auth=w.shift(),t.hostname=w.shift(),t.host=t.hostname)}return t.search=r.search,t.query=r.query,(t.pathname!==null||t.search!==null)&&(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.href=t.format(),t}if(!y.length)return t.pathname=null,t.search?t.path="/"+t.search:t.path=null,t.href=t.format(),t;for(var S=y.slice(-1)[0],E=(t.host||r.host||y.length>1)&&(S==="."||S==="..")||S==="",T=0,b=y.length;b>=0;b--)S=y[b],S==="."?y.splice(b,1):S===".."?(y.splice(b,1),T++):T&&(y.splice(b,1),T--);if(!x&&!g)for(;T--;T)y.unshift("..");x&&y[0]!==""&&(!y[0]||y[0].charAt(0)!=="/")&&y.unshift(""),E&&y.join("/").substr(-1)!=="/"&&y.push("");var A=y[0]===""||y[0]&&y[0].charAt(0)==="/";if(_){t.hostname=A?"":y.length?y.shift():"",t.host=t.hostname;var w=t.host&&t.host.indexOf("@")>0?t.host.split("@"):!1;w&&(t.auth=w.shift(),t.hostname=w.shift(),t.host=t.hostname)}return x=x||t.host&&y.length,x&&!A&&y.unshift(""),y.length>0?t.pathname=y.join("/"):(t.pathname=null,t.path=null),(t.pathname!==null||t.search!==null)&&(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.auth=r.auth||t.auth,t.slashes=t.slashes||r.slashes,t.href=t.format(),t};Lr.prototype.parseHost=function(){var r=this.host,e=Gb.exec(r);e&&(e=e[0],e!==":"&&(this.port=e.substr(1)),r=r.substr(0,r.length-e.length)),r&&(this.hostname=r)};const Tg={};function ee(r,e,t=3){if(Tg[e])return;let i=new Error().stack;typeof i>"u"?console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${r}`):(i=i.split(`
`).splice(t).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${e}
Deprecated since v${r}`),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${r}`),console.warn(i))),Tg[e]=!0}function Ft(r){if(typeof r!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(r)}`)}function bs(r){return r.split("?")[0].split("#")[0]}function Yb(r){return r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function qb(r,e,t){return r.replace(new RegExp(Yb(e),"g"),t)}function Kb(r,e){let t="",i=0,n=-1,s=0,o=-1;for(let a=0;a<=r.length;++a){if(a<r.length)o=r.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(n===a-1||s===1))if(n!==a-1&&s===2){if(t.length<2||i!==2||t.charCodeAt(t.length-1)!==46||t.charCodeAt(t.length-2)!==46){if(t.length>2){const l=t.lastIndexOf("/");if(l!==t.length-1){l===-1?(t="",i=0):(t=t.slice(0,l),i=t.length-1-t.lastIndexOf("/")),n=a,s=0;continue}}else if(t.length===2||t.length===1){t="",i=0,n=a,s=0;continue}}}else t.length>0?t+=`/${r.slice(n+1,a)}`:t=r.slice(n+1,a),i=a-n-1;n=a,s=0}else o===46&&s!==-1?++s:s=-1}return t}const je={toPosix(r){return qb(r,"\\","/")},isUrl(r){return/^https?:/.test(this.toPosix(r))},isDataUrl(r){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(r)},isBlobUrl(r){return r.startsWith("blob:")},hasProtocol(r){return/^[^/:]+:/.test(this.toPosix(r))},getProtocol(r){Ft(r),r=this.toPosix(r);const e=/^file:\/\/\//.exec(r);if(e)return e[0];const t=/^[^/:]+:\/{0,2}/.exec(r);return t?t[0]:""},toAbsolute(r,e,t){if(Ft(r),this.isDataUrl(r)||this.isBlobUrl(r))return r;const i=bs(this.toPosix(e??U.ADAPTER.getBaseUrl())),n=bs(this.toPosix(t??this.rootname(i)));return r=this.toPosix(r),r.startsWith("/")?je.join(n,r.slice(1)):this.isAbsolute(r)?r:this.join(i,r)},normalize(r){if(Ft(r),r.length===0)return".";if(this.isDataUrl(r)||this.isBlobUrl(r))return r;r=this.toPosix(r);let e="";const t=r.startsWith("/");this.hasProtocol(r)&&(e=this.rootname(r),r=r.slice(e.length));const i=r.endsWith("/");return r=Kb(r),r.length>0&&i&&(r+="/"),t?`/${r}`:e+r},isAbsolute(r){return Ft(r),r=this.toPosix(r),this.hasProtocol(r)?!0:r.startsWith("/")},join(...r){if(r.length===0)return".";let e;for(let t=0;t<r.length;++t){const i=r[t];if(Ft(i),i.length>0)if(e===void 0)e=i;else{const n=r[t-1]??"";this.joinExtensions.includes(this.extname(n).toLowerCase())?e+=`/../${i}`:e+=`/${i}`}}return e===void 0?".":this.normalize(e)},dirname(r){if(Ft(r),r.length===0)return".";r=this.toPosix(r);let e=r.charCodeAt(0);const t=e===47;let i=-1,n=!0;const s=this.getProtocol(r),o=r;r=r.slice(s.length);for(let a=r.length-1;a>=1;--a)if(e=r.charCodeAt(a),e===47){if(!n){i=a;break}}else n=!1;return i===-1?t?"/":this.isUrl(o)?s+r:s:t&&i===1?"//":s+r.slice(0,i)},rootname(r){Ft(r),r=this.toPosix(r);let e="";if(r.startsWith("/")?e="/":e=this.getProtocol(r),this.isUrl(r)){const t=r.indexOf("/",e.length);t!==-1?e=r.slice(0,t):e=r,e.endsWith("/")||(e+="/")}return e},basename(r,e){Ft(r),e&&Ft(e),r=bs(this.toPosix(r));let t=0,i=-1,n=!0,s;if(e!==void 0&&e.length>0&&e.length<=r.length){if(e.length===r.length&&e===r)return"";let o=e.length-1,a=-1;for(s=r.length-1;s>=0;--s){const l=r.charCodeAt(s);if(l===47){if(!n){t=s+1;break}}else a===-1&&(n=!1,a=s+1),o>=0&&(l===e.charCodeAt(o)?--o===-1&&(i=s):(o=-1,i=a))}return t===i?i=a:i===-1&&(i=r.length),r.slice(t,i)}for(s=r.length-1;s>=0;--s)if(r.charCodeAt(s)===47){if(!n){t=s+1;break}}else i===-1&&(n=!1,i=s+1);return i===-1?"":r.slice(t,i)},extname(r){Ft(r),r=bs(this.toPosix(r));let e=-1,t=0,i=-1,n=!0,s=0;for(let o=r.length-1;o>=0;--o){const a=r.charCodeAt(o);if(a===47){if(!n){t=o+1;break}continue}i===-1&&(n=!1,i=o+1),a===46?e===-1?e=o:s!==1&&(s=1):e!==-1&&(s=-1)}return e===-1||i===-1||s===0||s===1&&e===i-1&&e===t+1?"":r.slice(e,i)},parse(r){Ft(r);const e={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return e;r=bs(this.toPosix(r));let t=r.charCodeAt(0);const i=this.isAbsolute(r);let n;e.root=this.rootname(r),i||this.hasProtocol(r)?n=1:n=0;let s=-1,o=0,a=-1,l=!0,u=r.length-1,h=0;for(;u>=n;--u){if(t=r.charCodeAt(u),t===47){if(!l){o=u+1;break}continue}a===-1&&(l=!1,a=u+1),t===46?s===-1?s=u:h!==1&&(h=1):s!==-1&&(h=-1)}return s===-1||a===-1||h===0||h===1&&s===a-1&&s===o+1?a!==-1&&(o===0&&i?e.base=e.name=r.slice(1,a):e.base=e.name=r.slice(o,a)):(o===0&&i?(e.name=r.slice(1,s),e.base=r.slice(1,a)):(e.name=r.slice(o,s),e.base=r.slice(o,a)),e.ext=r.slice(s,a)),e.dir=this.dirname(r),e},sep:"/",delimiter:":",joinExtensions:[".html"]};let Ah;async function Zb(){return Ah??(Ah=(async()=>{var s;const r=document.createElement("canvas").getContext("webgl");if(!r)return ct.UNPACK;const e=await new Promise(o=>{const a=document.createElement("video");a.onloadeddata=()=>o(a),a.onerror=()=>o(null),a.autoplay=!1,a.crossOrigin="anonymous",a.preload="auto",a.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",a.load()});if(!e)return ct.UNPACK;const t=r.createTexture();r.bindTexture(r.TEXTURE_2D,t);const i=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,i),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,t,0),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),r.pixelStorei(r.UNPACK_COLORSPACE_CONVERSION_WEBGL,r.NONE),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,e);const n=new Uint8Array(4);return r.readPixels(0,0,1,1,r.RGBA,r.UNSIGNED_BYTE,n),r.deleteFramebuffer(i),r.deleteTexture(t),(s=r.getExtension("WEBGL_lose_context"))==null||s.loseContext(),n[0]<=n[3]?ct.PMA:ct.UNPACK})()),Ah}let bh;function Qb(){return typeof bh>"u"&&(bh=function(){var e;const r={stencil:!0,failIfMajorPerformanceCaveat:U.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!U.ADAPTER.getWebGLRenderingContext())return!1;const t=U.ADAPTER.createCanvas();let i=t.getContext("webgl",r)||t.getContext("experimental-webgl",r);const n=!!((e=i==null?void 0:i.getContextAttributes())!=null&&e.stencil);if(i){const s=i.getExtension("WEBGL_lose_context");s&&s.loseContext()}return i=null,n}catch{return!1}}()),bh}var Jb={grad:.9,turn:360,rad:360/(2*Math.PI)},Sr=function(r){return typeof r=="string"?r.length>0:typeof r=="number"},Ve=function(r,e,t){return e===void 0&&(e=0),t===void 0&&(t=Math.pow(10,e)),Math.round(t*r)/t+0},kt=function(r,e,t){return e===void 0&&(e=0),t===void 0&&(t=1),r>t?t:r>e?r:e},X_=function(r){return(r=isFinite(r)?r%360:0)>0?r:r+360},Sg=function(r){return{r:kt(r.r,0,255),g:kt(r.g,0,255),b:kt(r.b,0,255),a:kt(r.a)}},Ch=function(r){return{r:Ve(r.r),g:Ve(r.g),b:Ve(r.b),a:Ve(r.a,3)}},eC=/^#([0-9a-f]{3,8})$/i,ca=function(r){var e=r.toString(16);return e.length<2?"0"+e:e},j_=function(r){var e=r.r,t=r.g,i=r.b,n=r.a,s=Math.max(e,t,i),o=s-Math.min(e,t,i),a=o?s===e?(t-i)/o:s===t?2+(i-e)/o:4+(e-t)/o:0;return{h:60*(a<0?a+6:a),s:s?o/s*100:0,v:s/255*100,a:n}},W_=function(r){var e=r.h,t=r.s,i=r.v,n=r.a;e=e/360*6,t/=100,i/=100;var s=Math.floor(e),o=i*(1-t),a=i*(1-(e-s)*t),l=i*(1-(1-e+s)*t),u=s%6;return{r:255*[i,a,o,o,l,i][u],g:255*[l,i,i,a,o,o][u],b:255*[o,o,l,i,i,a][u],a:n}},Ag=function(r){return{h:X_(r.h),s:kt(r.s,0,100),l:kt(r.l,0,100),a:kt(r.a)}},bg=function(r){return{h:Ve(r.h),s:Ve(r.s),l:Ve(r.l),a:Ve(r.a,3)}},Cg=function(r){return W_((t=(e=r).s,{h:e.h,s:(t*=((i=e.l)<50?i:100-i)/100)>0?2*t/(i+t)*100:0,v:i+t,a:e.a}));var e,t,i},io=function(r){return{h:(e=j_(r)).h,s:(n=(200-(t=e.s))*(i=e.v)/100)>0&&n<200?t*i/100/(n<=100?n:200-n)*100:0,l:n/2,a:e.a};var e,t,i,n},tC=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,rC=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,iC=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,nC=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,md={string:[[function(r){var e=eC.exec(r);return e?(r=e[1]).length<=4?{r:parseInt(r[0]+r[0],16),g:parseInt(r[1]+r[1],16),b:parseInt(r[2]+r[2],16),a:r.length===4?Ve(parseInt(r[3]+r[3],16)/255,2):1}:r.length===6||r.length===8?{r:parseInt(r.substr(0,2),16),g:parseInt(r.substr(2,2),16),b:parseInt(r.substr(4,2),16),a:r.length===8?Ve(parseInt(r.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(r){var e=iC.exec(r)||nC.exec(r);return e?e[2]!==e[4]||e[4]!==e[6]?null:Sg({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(r){var e=tC.exec(r)||rC.exec(r);if(!e)return null;var t,i,n=Ag({h:(t=e[1],i=e[2],i===void 0&&(i="deg"),Number(t)*(Jb[i]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return Cg(n)},"hsl"]],object:[[function(r){var e=r.r,t=r.g,i=r.b,n=r.a,s=n===void 0?1:n;return Sr(e)&&Sr(t)&&Sr(i)?Sg({r:Number(e),g:Number(t),b:Number(i),a:Number(s)}):null},"rgb"],[function(r){var e=r.h,t=r.s,i=r.l,n=r.a,s=n===void 0?1:n;if(!Sr(e)||!Sr(t)||!Sr(i))return null;var o=Ag({h:Number(e),s:Number(t),l:Number(i),a:Number(s)});return Cg(o)},"hsl"],[function(r){var e=r.h,t=r.s,i=r.v,n=r.a,s=n===void 0?1:n;if(!Sr(e)||!Sr(t)||!Sr(i))return null;var o=function(a){return{h:X_(a.h),s:kt(a.s,0,100),v:kt(a.v,0,100),a:kt(a.a)}}({h:Number(e),s:Number(t),v:Number(i),a:Number(s)});return W_(o)},"hsv"]]},Rg=function(r,e){for(var t=0;t<e.length;t++){var i=e[t][0](r);if(i)return[i,e[t][1]]}return[null,void 0]},sC=function(r){return typeof r=="string"?Rg(r.trim(),md.string):typeof r=="object"&&r!==null?Rg(r,md.object):[null,void 0]},Rh=function(r,e){var t=io(r);return{h:t.h,s:kt(t.s+100*e,0,100),l:t.l,a:t.a}},Ih=function(r){return(299*r.r+587*r.g+114*r.b)/1e3/255},Ig=function(r,e){var t=io(r);return{h:t.h,s:t.s,l:kt(t.l+100*e,0,100),a:t.a}},gd=function(){function r(e){this.parsed=sC(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return r.prototype.isValid=function(){return this.parsed!==null},r.prototype.brightness=function(){return Ve(Ih(this.rgba),2)},r.prototype.isDark=function(){return Ih(this.rgba)<.5},r.prototype.isLight=function(){return Ih(this.rgba)>=.5},r.prototype.toHex=function(){return e=Ch(this.rgba),t=e.r,i=e.g,n=e.b,o=(s=e.a)<1?ca(Ve(255*s)):"","#"+ca(t)+ca(i)+ca(n)+o;var e,t,i,n,s,o},r.prototype.toRgb=function(){return Ch(this.rgba)},r.prototype.toRgbString=function(){return e=Ch(this.rgba),t=e.r,i=e.g,n=e.b,(s=e.a)<1?"rgba("+t+", "+i+", "+n+", "+s+")":"rgb("+t+", "+i+", "+n+")";var e,t,i,n,s},r.prototype.toHsl=function(){return bg(io(this.rgba))},r.prototype.toHslString=function(){return e=bg(io(this.rgba)),t=e.h,i=e.s,n=e.l,(s=e.a)<1?"hsla("+t+", "+i+"%, "+n+"%, "+s+")":"hsl("+t+", "+i+"%, "+n+"%)";var e,t,i,n,s},r.prototype.toHsv=function(){return e=j_(this.rgba),{h:Ve(e.h),s:Ve(e.s),v:Ve(e.v),a:Ve(e.a,3)};var e},r.prototype.invert=function(){return ir({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},r.prototype.saturate=function(e){return e===void 0&&(e=.1),ir(Rh(this.rgba,e))},r.prototype.desaturate=function(e){return e===void 0&&(e=.1),ir(Rh(this.rgba,-e))},r.prototype.grayscale=function(){return ir(Rh(this.rgba,-1))},r.prototype.lighten=function(e){return e===void 0&&(e=.1),ir(Ig(this.rgba,e))},r.prototype.darken=function(e){return e===void 0&&(e=.1),ir(Ig(this.rgba,-e))},r.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},r.prototype.alpha=function(e){return typeof e=="number"?ir({r:(t=this.rgba).r,g:t.g,b:t.b,a:e}):Ve(this.rgba.a,3);var t},r.prototype.hue=function(e){var t=io(this.rgba);return typeof e=="number"?ir({h:e,s:t.s,l:t.l,a:t.a}):Ve(t.h)},r.prototype.isEqual=function(e){return this.toHex()===ir(e).toHex()},r}(),ir=function(r){return r instanceof gd?r:new gd(r)},Pg=[],oC=function(r){r.forEach(function(e){Pg.indexOf(e)<0&&(e(gd,md),Pg.push(e))})};function aC(r,e){var t={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},i={};for(var n in t)i[t[n]]=n;var s={};r.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,l,u=i[this.toHex()];if(u)return u;if(o!=null&&o.closest){var h=this.toRgb(),d=1/0,c="black";if(!s.length)for(var f in t)s[f]=new r(t[f]).toRgb();for(var p in t){var v=(a=h,l=s[p],Math.pow(a.r-l.r,2)+Math.pow(a.g-l.g,2)+Math.pow(a.b-l.b,2));v<d&&(d=v,c=p)}return c}},e.string.push([function(o){var a=o.toLowerCase(),l=a==="transparent"?"#0000":t[a];return l?new r(l).toRgb():null},"name"])}oC([aC]);const _n=class Za{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof Za)this._value=this.cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(e===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,e))&&(this.normalize(e),this._value=this.cloneSource(e))}}get value(){return this._value}cloneSource(e){return typeof e=="string"||typeof e=="number"||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e=="object"&&e!==null?{...e}:e}isSourceEqual(e,t){const i=typeof e;if(i!==typeof t)return!1;if(i==="number"||i==="string"||e instanceof Number)return e===t;if(Array.isArray(e)&&Array.isArray(t)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(t))return e.length!==t.length?!1:e.every((n,s)=>n===t[s]);if(e!==null&&t!==null){const n=Object.keys(e),s=Object.keys(t);return n.length!==s.length?!1:n.every(o=>e[o]===t[o])}return e===t}toRgba(){const[e,t,i,n]=this._components;return{r:e,g:t,b:i,a:n}}toRgb(){const[e,t,i]=this._components;return{r:e,g:t,b:i}}toRgbaString(){const[e,t,i]=this.toUint8RgbArray();return`rgba(${e},${t},${i},${this.alpha})`}toUint8RgbArray(e){const[t,i,n]=this._components;return e=e??[],e[0]=Math.round(t*255),e[1]=Math.round(i*255),e[2]=Math.round(n*255),e}toRgbArray(e){e=e??[];const[t,i,n]=this._components;return e[0]=t,e[1]=i,e[2]=n,e}toNumber(){return this._int}toLittleEndianNumber(){const e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(e){const[t,i,n,s]=Za.temp.setValue(e)._components;return this._components[0]*=t,this._components[1]*=i,this._components[2]*=n,this._components[3]*=s,this.refreshInt(),this._value=null,this}premultiply(e,t=!0){return t&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this.refreshInt(),this._value=null,this}toPremultiplied(e,t=!0){if(e===1)return(255<<24)+this._int;if(e===0)return t?0:this._int;let i=this._int>>16&255,n=this._int>>8&255,s=this._int&255;return t&&(i=i*e+.5|0,n=n*e+.5|0,s=s*e+.5|0),(e*255<<24)+(i<<16)+(n<<8)+s}toHex(){const e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){const e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(e){return this._components[3]=this._clamp(e),this}round(e){const[t,i,n]=this._components;return this._components[0]=Math.round(t*e)/e,this._components[1]=Math.round(i*e)/e,this._components[2]=Math.round(n*e)/e,this.refreshInt(),this._value=null,this}toArray(e){e=e??[];const[t,i,n,s]=this._components;return e[0]=t,e[1]=i,e[2]=n,e[3]=s,e}normalize(e){let t,i,n,s;if((typeof e=="number"||e instanceof Number)&&e>=0&&e<=16777215){const o=e;t=(o>>16&255)/255,i=(o>>8&255)/255,n=(o&255)/255,s=1}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[t,i,n,s=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[t,i,n,s=255]=e,t/=255,i/=255,n/=255,s/=255;else if(typeof e=="string"||typeof e=="object"){if(typeof e=="string"){const a=Za.HEX_PATTERN.exec(e);a&&(e=`#${a[2]}`)}const o=ir(e);o.isValid()&&({r:t,g:i,b:n,a:s}=o.rgba,t/=255,i/=255,n/=255)}if(t!==void 0)this._components[0]=t,this._components[1]=i,this._components[2]=n,this._components[3]=s,this.refreshInt();else throw new Error(`Unable to convert color ${e}`)}refreshInt(){this._clamp(this._components);const[e,t,i]=this._components;this._int=(e*255<<16)+(t*255<<8)+(i*255|0)}_clamp(e,t=0,i=1){return typeof e=="number"?Math.min(Math.max(e,t),i):(e.forEach((n,s)=>{e[s]=Math.min(Math.max(n,t),i)}),e)}};_n.shared=new _n,_n.temp=new _n,_n.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let me=_n;function lC(r){return ee("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),me.shared.setValue(r).toHex()}function uC(r){return ee("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),me.shared.setValue(r).toNumber()}function hC(){const r=[],e=[];for(let i=0;i<32;i++)r[i]=i,e[i]=i;r[q.NORMAL_NPM]=q.NORMAL,r[q.ADD_NPM]=q.ADD,r[q.SCREEN_NPM]=q.SCREEN,e[q.NORMAL]=q.NORMAL_NPM,e[q.ADD]=q.ADD_NPM,e[q.SCREEN]=q.SCREEN_NPM;const t=[];return t.push(e),t.push(r),t}const Y_=hC();function q_(r,e){return Y_[e?1:0][r]}function cC(r,e=null){const t=r*6;if(e=e||new Uint16Array(t),e.length!==t)throw new Error(`Out buffer length is incorrect, got ${e.length} and expected ${t}`);for(let i=0,n=0;i<t;i+=6,n+=4)e[i+0]=n+0,e[i+1]=n+1,e[i+2]=n+2,e[i+3]=n+0,e[i+4]=n+2,e[i+5]=n+3;return e}function K_(r){if(r.BYTES_PER_ELEMENT===4)return r instanceof Float32Array?"Float32Array":r instanceof Uint32Array?"Uint32Array":"Int32Array";if(r.BYTES_PER_ELEMENT===2){if(r instanceof Uint16Array)return"Uint16Array"}else if(r.BYTES_PER_ELEMENT===1&&r instanceof Uint8Array)return"Uint8Array";return null}function Fl(r){return r+=r===0?1:0,--r,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r+1}function kg(r){return!(r&r-1)&&!!r}function Mg(r){let e=(r>65535?1:0)<<4;r>>>=e;let t=(r>255?1:0)<<3;return r>>>=t,e|=t,t=(r>15?1:0)<<2,r>>>=t,e|=t,t=(r>3?1:0)<<1,r>>>=t,e|=t,e|r>>1}function Yn(r,e,t){const i=r.length;let n;if(e>=i||t===0)return;t=e+t>i?i-e:t;const s=i-t;for(n=e;n<s;++n)r[n]=r[n+t];r.length=s}function si(r){return r===0?0:r<0?-1:1}let dC=0;function tn(){return++dC}const yd=class{constructor(r,e,t,i){this.left=r,this.top=e,this.right=t,this.bottom=i}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};yd.EMPTY=new yd(0,0,0,0);let Dg=yd;const Ng={},nr=Object.create(null),Wr=Object.create(null);class fC{constructor(e,t,i){this._canvas=U.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=i||U.RESOLUTION,this.resize(e,t)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(e,t){this._checkDestroyed(),this._canvas.width=Math.round(e*this.resolution),this._canvas.height=Math.round(t*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(e){this._checkDestroyed(),this._canvas.width=Math.round(e)}get height(){return this._checkDestroyed(),this._canvas.height}set height(e){this._checkDestroyed(),this._canvas.height=Math.round(e)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function Og(r,e,t){for(let i=0,n=4*t*e;i<e;++i,n+=4)if(r[n+3]!==0)return!1;return!0}function Bg(r,e,t,i,n){const s=4*e;for(let o=i,a=i*s+4*t;o<=n;++o,a+=s)if(r[a+3]!==0)return!1;return!0}function pC(r){const{width:e,height:t}=r,i=r.getContext("2d",{willReadFrequently:!0});if(i===null)throw new TypeError("Failed to get canvas 2D context");const n=i.getImageData(0,0,e,t).data;let s=0,o=0,a=e-1,l=t-1;for(;o<t&&Og(n,e,o);)++o;if(o===t)return Dg.EMPTY;for(;Og(n,e,l);)--l;for(;Bg(n,e,s,o,l);)++s;for(;Bg(n,e,a,o,l);)--a;return++a,++l,new Dg(s,o,a,l)}function mC(r){const e=pC(r),{width:t,height:i}=e;let n=null;if(!e.isEmpty()){const s=r.getContext("2d");if(s===null)throw new TypeError("Failed to get canvas 2D context");n=s.getImageData(e.left,e.top,t,i)}return{width:t,height:i,data:n}}function gC(r,e=globalThis.location){if(r.startsWith("data:"))return"";e=e||globalThis.location;const t=new URL(r,document.baseURI);return t.hostname!==e.hostname||t.port!==e.port||t.protocol!==e.protocol?"anonymous":""}function $r(r,e=1){var i;const t=(i=U.RETINA_PREFIX)==null?void 0:i.exec(r);return t?parseFloat(t[1]):e}var B=(r=>(r.Renderer="renderer",r.Application="application",r.RendererSystem="renderer-webgl-system",r.RendererPlugin="renderer-webgl-plugin",r.CanvasRendererSystem="renderer-canvas-system",r.CanvasRendererPlugin="renderer-canvas-plugin",r.Asset="asset",r.LoadParser="load-parser",r.ResolveParser="resolve-parser",r.CacheParser="cache-parser",r.DetectionParser="detection-parser",r))(B||{});const vd=r=>{if(typeof r=="function"||typeof r=="object"&&r.extension){if(!r.extension)throw new Error("Extension class must have an extension object");r={...typeof r.extension!="object"?{type:r.extension}:r.extension,ref:r}}if(typeof r=="object")r={...r};else throw new Error("Invalid extension type");return typeof r.type=="string"&&(r.type=[r.type]),r},Lg=(r,e)=>vd(r).priority??e,V={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...r){return r.map(vd).forEach(e=>{e.type.forEach(t=>{var i,n;return(n=(i=this._removeHandlers)[t])==null?void 0:n.call(i,e)})}),this},add(...r){return r.map(vd).forEach(e=>{e.type.forEach(t=>{var s,o;const i=this._addHandlers,n=this._queue;i[t]?(s=i[t])==null||s.call(i,e):(n[t]=n[t]||[],(o=n[t])==null||o.push(e))})}),this},handle(r,e,t){var o;const i=this._addHandlers,n=this._removeHandlers;if(i[r]||n[r])throw new Error(`Extension type ${r} already has a handler`);i[r]=e,n[r]=t;const s=this._queue;return s[r]&&((o=s[r])==null||o.forEach(a=>e(a)),delete s[r]),this},handleByMap(r,e){return this.handle(r,t=>{t.name&&(e[t.name]=t.ref)},t=>{t.name&&delete e[t.name]})},handleByList(r,e,t=-1){return this.handle(r,i=>{e.includes(i.ref)||(e.push(i.ref),e.sort((n,s)=>Lg(s,t)-Lg(n,t)))},i=>{const n=e.indexOf(i.ref);n!==-1&&e.splice(n,1)})}};class _d{constructor(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}const yC=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function vC(r){let e="";for(let t=0;t<r;++t)t>0&&(e+=`
else `),t<r-1&&(e+=`if(test == ${t}.0){}`);return e}function _C(r,e){if(r===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const t=e.createShader(e.FRAGMENT_SHADER);for(;;){const i=yC.replace(/%forloop%/gi,vC(r));if(e.shaderSource(t,i),e.compileShader(t),!e.getShaderParameter(t,e.COMPILE_STATUS))r=r/2|0;else break}return r}const Ph=0,kh=1,Mh=2,Dh=3,Nh=4,Oh=5;class wr{constructor(){this.data=0,this.blendMode=q.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<Ph)}set blend(e){!!(this.data&1<<Ph)!==e&&(this.data^=1<<Ph)}get offsets(){return!!(this.data&1<<kh)}set offsets(e){!!(this.data&1<<kh)!==e&&(this.data^=1<<kh)}get culling(){return!!(this.data&1<<Mh)}set culling(e){!!(this.data&1<<Mh)!==e&&(this.data^=1<<Mh)}get depthTest(){return!!(this.data&1<<Dh)}set depthTest(e){!!(this.data&1<<Dh)!==e&&(this.data^=1<<Dh)}get depthMask(){return!!(this.data&1<<Oh)}set depthMask(e){!!(this.data&1<<Oh)!==e&&(this.data^=1<<Oh)}get clockwiseFrontFace(){return!!(this.data&1<<Nh)}set clockwiseFrontFace(e){!!(this.data&1<<Nh)!==e&&(this.data^=1<<Nh)}get blendMode(){return this._blendMode}set blendMode(e){this.blend=e!==q.NONE,this._blendMode=e}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){this.offsets=!!e,this._polygonOffset=e}static for2d(){const e=new wr;return e.depthTest=!1,e.blend=!0,e}}wr.prototype.toString=function(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`};const xd=[];function Z_(r,e){if(!r)return null;let t="";if(typeof r=="string"){const i=/\.(\w{3,4})(?:$|\?|#)/i.exec(r);i&&(t=i[1].toLowerCase())}for(let i=xd.length-1;i>=0;--i){const n=xd[i];if(n.test&&n.test(r,t))return new n(r,e)}throw new Error("Unrecognized source type to auto-detect Resource")}class qt{constructor(e){this.items=[],this._name=e,this._aliasCount=0}emit(e,t,i,n,s,o,a,l){if(arguments.length>8)throw new Error("max arguments reached");const{name:u,items:h}=this;this._aliasCount++;for(let d=0,c=h.length;d<c;d++)h[d][u](e,t,i,n,s,o,a,l);return h===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(e){return e[this._name]&&(this.ensureNonAliasedItems(),this.remove(e),this.items.push(e)),this}remove(e){const t=this.items.indexOf(e);return t!==-1&&(this.ensureNonAliasedItems(),this.items.splice(t,1)),this}contains(e){return this.items.includes(e)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items.length=0,this._name=""}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(qt.prototype,{dispatch:{value:qt.prototype.emit},run:{value:qt.prototype.emit}});class Co{constructor(e=0,t=0){this._width=e,this._height=t,this.destroyed=!1,this.internal=!1,this.onResize=new qt("setRealSize"),this.onUpdate=new qt("update"),this.onError=new qt("onError")}bind(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)}resize(e,t){(e!==this._width||t!==this._height)&&(this._width=e,this._height=t,this.onResize.emit(e,t))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(e,t,i){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(e,t){return!1}}class wu extends Co{constructor(e,t){const{width:i,height:n}=t||{};if(!i||!n)throw new Error("BufferResource width or height invalid");super(i,n),this.data=e,this.unpackAlignment=t.unpackAlignment??4}upload(e,t,i){const n=e.gl;n.pixelStorei(n.UNPACK_ALIGNMENT,this.unpackAlignment),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===ct.UNPACK);const s=t.realWidth,o=t.realHeight;return i.width===s&&i.height===o?n.texSubImage2D(t.target,0,0,0,s,o,t.format,i.type,this.data):(i.width=s,i.height=o,n.texImage2D(t.target,0,i.internalFormat,s,o,0,t.format,i.type,this.data)),!0}dispose(){this.data=null}static test(e){return e===null||e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}}const xC={scaleMode:Mr.NEAREST,alphaMode:ct.NPM},wd=class xn extends Oo{constructor(e=null,t=null){super(),t=Object.assign({},xn.defaultOptions,t);const{alphaMode:i,mipmap:n,anisotropicLevel:s,scaleMode:o,width:a,height:l,wrapMode:u,format:h,type:d,target:c,resolution:f,resourceOptions:p}=t;e&&!(e instanceof Co)&&(e=Z_(e,p),e.internal=!0),this.resolution=f||U.RESOLUTION,this.width=Math.round((a||0)*this.resolution)/this.resolution,this.height=Math.round((l||0)*this.resolution)/this.resolution,this._mipmap=n,this.anisotropicLevel=s,this._wrapMode=u,this._scaleMode=o,this.format=h,this.type=d,this.target=c,this.alphaMode=i,this.uid=tn(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=a>0&&l>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(e)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(e){this._mipmap!==e&&(this._mipmap=e,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(e){this._scaleMode!==e&&(this._scaleMode=e,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(e){this._wrapMode!==e&&(this._wrapMode=e,this.dirtyStyleId++)}setStyle(e,t){let i;return e!==void 0&&e!==this.scaleMode&&(this.scaleMode=e,i=!0),t!==void 0&&t!==this.mipmap&&(this.mipmap=t,i=!0),i&&this.dirtyStyleId++,this}setSize(e,t,i){return i=i||this.resolution,this.setRealSize(e*i,t*i,i)}setRealSize(e,t,i){return this.resolution=i||this.resolution,this.width=Math.round(e)/this.resolution,this.height=Math.round(t)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=kg(this.realWidth)&&kg(this.realHeight)}setResolution(e){const t=this.resolution;return t===e?this:(this.resolution=e,this.valid&&(this.width=Math.round(this.width*t)/e,this.height=Math.round(this.height*t)/e,this.emit("update",this)),this._refreshPOT(),this)}setResource(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(e){this.emit("error",this,e)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Wr[this.cacheId],delete nr[this.cacheId],this.cacheId=null),this.valid=!1,this.dispose(),xn.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(e,t,i=U.STRICT_TEXTURE_CACHE){const n=typeof e=="string";let s=null;if(n)s=e;else{if(!e._pixiId){const a=(t==null?void 0:t.pixiIdPrefix)||"pixiid";e._pixiId=`${a}_${tn()}`}s=e._pixiId}let o=Wr[s];if(n&&i&&!o)throw new Error(`The cacheId "${s}" does not exist in BaseTextureCache.`);return o||(o=new xn(e,t),o.cacheId=s,xn.addToCache(o,s)),o}static fromBuffer(e,t,i,n){e=e||new Float32Array(t*i*4);const s=new wu(e,{width:t,height:i,...n==null?void 0:n.resourceOptions});let o,a;return e instanceof Float32Array?(o=O.RGBA,a=W.FLOAT):e instanceof Int32Array?(o=O.RGBA_INTEGER,a=W.INT):e instanceof Uint32Array?(o=O.RGBA_INTEGER,a=W.UNSIGNED_INT):e instanceof Int16Array?(o=O.RGBA_INTEGER,a=W.SHORT):e instanceof Uint16Array?(o=O.RGBA_INTEGER,a=W.UNSIGNED_SHORT):e instanceof Int8Array?(o=O.RGBA,a=W.BYTE):(o=O.RGBA,a=W.UNSIGNED_BYTE),s.internal=!0,new xn(s,Object.assign({},xC,{type:a,format:o},n))}static addToCache(e,t){t&&(e.textureCacheIds.includes(t)||e.textureCacheIds.push(t),Wr[t]&&Wr[t]!==e&&console.warn(`BaseTexture added to the cache with an id [${t}] that already had an entry`),Wr[t]=e)}static removeFromCache(e){if(typeof e=="string"){const t=Wr[e];if(t){const i=t.textureCacheIds.indexOf(e);return i>-1&&t.textureCacheIds.splice(i,1),delete Wr[e],t}}else if(e!=null&&e.textureCacheIds){for(let t=0;t<e.textureCacheIds.length;++t)delete Wr[e.textureCacheIds[t]];return e.textureCacheIds.length=0,e}return null}};wd.defaultOptions={mipmap:_r.POW2,anisotropicLevel:0,scaleMode:Mr.LINEAR,wrapMode:mi.CLAMP,alphaMode:ct.UNPACK,target:Xn.TEXTURE_2D,format:O.RGBA,type:W.UNSIGNED_BYTE},wd._globalBatch=0;let K=wd;class Ed{constructor(){this.texArray=null,this.blend=0,this.type=fr.TRIANGLES,this.start=0,this.size=0,this.data=null}}let wC=0;class ke{constructor(e,t=!0,i=!1){this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=t,this.id=wC++,this.disposeRunner=new qt("disposeBuffer")}update(e){e instanceof Array&&(e=new Float32Array(e)),this.data=e||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(e){this.type=e?gr.ELEMENT_ARRAY_BUFFER:gr.ARRAY_BUFFER}get index(){return this.type===gr.ELEMENT_ARRAY_BUFFER}static from(e){return e instanceof Array&&(e=new Float32Array(e)),new ke(e)}}class Ul{constructor(e,t=0,i=!1,n=W.FLOAT,s,o,a,l=1){this.buffer=e,this.size=t,this.normalized=i,this.type=n,this.stride=s,this.start=o,this.instance=a,this.divisor=l}destroy(){this.buffer=null}static from(e,t,i,n,s){return new Ul(e,t,i,n,s)}}const EC={Float32Array,Uint32Array,Int32Array,Uint8Array};function TC(r,e){let t=0,i=0;const n={};for(let l=0;l<r.length;l++)i+=e[l],t+=r[l].length;const s=new ArrayBuffer(t*4);let o=null,a=0;for(let l=0;l<r.length;l++){const u=e[l],h=r[l],d=K_(h);n[d]||(n[d]=new EC[d](s)),o=n[d];for(let c=0;c<h.length;c++){const f=(c/u|0)*i+a,p=c%u;o[f+p]=h[c]}a+=u}return new Float32Array(s)}const Fg={5126:4,5123:2,5121:1};let SC=0;const AC={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class _i{constructor(e=[],t={}){this.buffers=e,this.indexBuffer=null,this.attributes=t,this.glVertexArrayObjects={},this.id=SC++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new qt("disposeGeometry"),this.refCount=0}addAttribute(e,t,i=0,n=!1,s,o,a,l=!1){if(!t)throw new Error("You must pass a buffer when creating an attribute");t instanceof ke||(t instanceof Array&&(t=new Float32Array(t)),t=new ke(t));const u=e.split("|");if(u.length>1){for(let d=0;d<u.length;d++)this.addAttribute(u[d],t,i,n,s);return this}let h=this.buffers.indexOf(t);return h===-1&&(this.buffers.push(t),h=this.buffers.length-1),this.attributes[e]=new Ul(h,i,n,s,o,a,l),this.instanced=this.instanced||l,this}getAttribute(e){return this.attributes[e]}getBuffer(e){return this.buffers[this.getAttribute(e).buffer]}addIndex(e){return e instanceof ke||(e instanceof Array&&(e=new Uint16Array(e)),e=new ke(e)),e.type=gr.ELEMENT_ARRAY_BUFFER,this.indexBuffer=e,this.buffers.includes(e)||this.buffers.push(e),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const e=[],t=[],i=new ke;let n;for(n in this.attributes){const s=this.attributes[n],o=this.buffers[s.buffer];e.push(o.data),t.push(s.size*Fg[s.type]/4),s.buffer=0}for(i.data=TC(e,t),n=0;n<this.buffers.length;n++)this.buffers[n]!==this.indexBuffer&&this.buffers[n].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const e in this.attributes){const t=this.attributes[e];return this.buffers[t.buffer].data.length/(t.stride/4||t.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const e=new _i;for(let t=0;t<this.buffers.length;t++)e.buffers[t]=new ke(this.buffers[t].data.slice(0));for(const t in this.attributes){const i=this.attributes[t];e.attributes[t]=new Ul(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.type=gr.ELEMENT_ARRAY_BUFFER),e}static merge(e){const t=new _i,i=[],n=[],s=[];let o;for(let a=0;a<e.length;a++){o=e[a];for(let l=0;l<o.buffers.length;l++)n[l]=n[l]||0,n[l]+=o.buffers[l].data.length,s[l]=0}for(let a=0;a<o.buffers.length;a++)i[a]=new AC[K_(o.buffers[a].data)](n[a]),t.buffers[a]=new ke(i[a]);for(let a=0;a<e.length;a++){o=e[a];for(let l=0;l<o.buffers.length;l++)i[l].set(o.buffers[l].data,s[l]),s[l]+=o.buffers[l].data.length}if(t.attributes=o.attributes,o.indexBuffer){t.indexBuffer=t.buffers[o.buffers.indexOf(o.indexBuffer)],t.indexBuffer.type=gr.ELEMENT_ARRAY_BUFFER;let a=0,l=0,u=0,h=0;for(let d=0;d<o.buffers.length;d++)if(o.buffers[d]!==o.indexBuffer){h=d;break}for(const d in o.attributes){const c=o.attributes[d];(c.buffer|0)===h&&(l+=c.size*Fg[c.type]/4)}for(let d=0;d<e.length;d++){const c=e[d].indexBuffer.data;for(let f=0;f<c.length;f++)t.indexBuffer.data[f+u]+=a;a+=e[d].buffers[h].data.length/l,u+=c.length}}return t}}class Q_ extends _i{constructor(e=!1){super(),this._buffer=new ke(null,e,!1),this._indexBuffer=new ke(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,W.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,W.FLOAT).addAttribute("aColor",this._buffer,4,!0,W.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,W.FLOAT).addIndex(this._indexBuffer)}}const Gl=Math.PI*2,bC=180/Math.PI,CC=Math.PI/180;var Ke=(r=>(r[r.POLY=0]="POLY",r[r.RECT=1]="RECT",r[r.CIRC=2]="CIRC",r[r.ELIP=3]="ELIP",r[r.RREC=4]="RREC",r))(Ke||{});class ne{constructor(e=0,t=0){this.x=0,this.y=0,this.x=e,this.y=t}clone(){return new ne(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,t=e){return this.x=e,this.y=t,this}}ne.prototype.toString=function(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`};const da=[new ne,new ne,new ne,new ne];class Z{constructor(e=0,t=0,i=0,n=0){this.x=Number(e),this.y=Number(t),this.width=Number(i),this.height=Number(n),this.type=Ke.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new Z(0,0,0,0)}clone(){return new Z(this.x,this.y,this.width,this.height)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}contains(e,t){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&t>=this.y&&t<this.y+this.height}intersects(e,t){if(!t){const T=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=T)return!1;const b=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>b}const i=this.left,n=this.right,s=this.top,o=this.bottom;if(n<=i||o<=s)return!1;const a=da[0].set(e.left,e.top),l=da[1].set(e.left,e.bottom),u=da[2].set(e.right,e.top),h=da[3].set(e.right,e.bottom);if(u.x<=a.x||l.y<=a.y)return!1;const d=Math.sign(t.a*t.d-t.b*t.c);if(d===0||(t.apply(a,a),t.apply(l,l),t.apply(u,u),t.apply(h,h),Math.max(a.x,l.x,u.x,h.x)<=i||Math.min(a.x,l.x,u.x,h.x)>=n||Math.max(a.y,l.y,u.y,h.y)<=s||Math.min(a.y,l.y,u.y,h.y)>=o))return!1;const c=d*(l.y-a.y),f=d*(a.x-l.x),p=c*i+f*s,v=c*n+f*s,x=c*i+f*o,g=c*n+f*o;if(Math.max(p,v,x,g)<=c*a.x+f*a.y||Math.min(p,v,x,g)>=c*h.x+f*h.y)return!1;const y=d*(a.y-u.y),m=d*(u.x-a.x),_=y*i+m*s,w=y*n+m*s,S=y*i+m*o,E=y*n+m*o;return!(Math.max(_,w,S,E)<=y*a.x+m*a.y||Math.min(_,w,S,E)>=y*h.x+m*h.y)}pad(e=0,t=e){return this.x-=e,this.y-=t,this.width+=e*2,this.height+=t*2,this}fit(e){const t=Math.max(this.x,e.x),i=Math.min(this.x+this.width,e.x+e.width),n=Math.max(this.y,e.y),s=Math.min(this.y+this.height,e.y+e.height);return this.x=t,this.width=Math.max(i-t,0),this.y=n,this.height=Math.max(s-n,0),this}ceil(e=1,t=.001){const i=Math.ceil((this.x+this.width-t)*e)/e,n=Math.ceil((this.y+this.height-t)*e)/e;return this.x=Math.floor((this.x+t)*e)/e,this.y=Math.floor((this.y+t)*e)/e,this.width=i-this.x,this.height=n-this.y,this}enlarge(e){const t=Math.min(this.x,e.x),i=Math.max(this.x+this.width,e.x+e.width),n=Math.min(this.y,e.y),s=Math.max(this.y+this.height,e.y+e.height);return this.x=t,this.width=i-t,this.y=n,this.height=s-n,this}}Z.prototype.toString=function(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class Eu{constructor(e=0,t=0,i=0){this.x=e,this.y=t,this.radius=i,this.type=Ke.CIRC}clone(){return new Eu(this.x,this.y,this.radius)}contains(e,t){if(this.radius<=0)return!1;const i=this.radius*this.radius;let n=this.x-e,s=this.y-t;return n*=n,s*=s,n+s<=i}getBounds(){return new Z(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}}Eu.prototype.toString=function(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`};class Tu{constructor(e=0,t=0,i=0,n=0){this.x=e,this.y=t,this.width=i,this.height=n,this.type=Ke.ELIP}clone(){return new Tu(this.x,this.y,this.width,this.height)}contains(e,t){if(this.width<=0||this.height<=0)return!1;let i=(e-this.x)/this.width,n=(t-this.y)/this.height;return i*=i,n*=n,i+n<=1}getBounds(){return new Z(this.x-this.width,this.y-this.height,this.width,this.height)}}Tu.prototype.toString=function(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class ji{constructor(...e){let t=Array.isArray(e[0])?e[0]:e;if(typeof t[0]!="number"){const i=[];for(let n=0,s=t.length;n<s;n++)i.push(t[n].x,t[n].y);t=i}this.points=t,this.type=Ke.POLY,this.closeStroke=!0}clone(){const e=this.points.slice(),t=new ji(e);return t.closeStroke=this.closeStroke,t}contains(e,t){let i=!1;const n=this.points.length/2;for(let s=0,o=n-1;s<n;o=s++){const a=this.points[s*2],l=this.points[s*2+1],u=this.points[o*2],h=this.points[o*2+1];l>t!=h>t&&e<(u-a)*((t-l)/(h-l))+a&&(i=!i)}return i}}ji.prototype.toString=function(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((r,e)=>`${r}, ${e}`,"")}]`};class Su{constructor(e=0,t=0,i=0,n=0,s=20){this.x=e,this.y=t,this.width=i,this.height=n,this.radius=s,this.type=Ke.RREC}clone(){return new Su(this.x,this.y,this.width,this.height,this.radius)}contains(e,t){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height){const i=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(t>=this.y+i&&t<=this.y+this.height-i||e>=this.x+i&&e<=this.x+this.width-i)return!0;let n=e-(this.x+i),s=t-(this.y+i);const o=i*i;if(n*n+s*s<=o||(n=e-(this.x+this.width-i),n*n+s*s<=o)||(s=t-(this.y+this.height-i),n*n+s*s<=o)||(n=e-(this.x+i),n*n+s*s<=o))return!0}return!1}}Su.prototype.toString=function(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`};class ye{constructor(e=1,t=0,i=0,n=1,s=0,o=0){this.array=null,this.a=e,this.b=t,this.c=i,this.d=n,this.tx=s,this.ty=o}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,t,i,n,s,o){return this.a=e,this.b=t,this.c=i,this.d=n,this.tx=s,this.ty=o,this}toArray(e,t){this.array||(this.array=new Float32Array(9));const i=t||this.array;return e?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i}apply(e,t){t=t||new ne;const i=e.x,n=e.y;return t.x=this.a*i+this.c*n+this.tx,t.y=this.b*i+this.d*n+this.ty,t}applyInverse(e,t){t=t||new ne;const i=1/(this.a*this.d+this.c*-this.b),n=e.x,s=e.y;return t.x=this.d*i*n+-this.c*i*s+(this.ty*this.c-this.tx*this.d)*i,t.y=this.a*i*s+-this.b*i*n+(-this.ty*this.a+this.tx*this.b)*i,t}translate(e,t){return this.tx+=e,this.ty+=t,this}scale(e,t){return this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this}rotate(e){const t=Math.cos(e),i=Math.sin(e),n=this.a,s=this.c,o=this.tx;return this.a=n*t-this.b*i,this.b=n*i+this.b*t,this.c=s*t-this.d*i,this.d=s*i+this.d*t,this.tx=o*t-this.ty*i,this.ty=o*i+this.ty*t,this}append(e){const t=this.a,i=this.b,n=this.c,s=this.d;return this.a=e.a*t+e.b*n,this.b=e.a*i+e.b*s,this.c=e.c*t+e.d*n,this.d=e.c*i+e.d*s,this.tx=e.tx*t+e.ty*n+this.tx,this.ty=e.tx*i+e.ty*s+this.ty,this}setTransform(e,t,i,n,s,o,a,l,u){return this.a=Math.cos(a+u)*s,this.b=Math.sin(a+u)*s,this.c=-Math.sin(a-l)*o,this.d=Math.cos(a-l)*o,this.tx=e-(i*this.a+n*this.c),this.ty=t-(i*this.b+n*this.d),this}prepend(e){const t=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const i=this.a,n=this.c;this.a=i*e.a+this.b*e.c,this.b=i*e.b+this.b*e.d,this.c=n*e.a+this.d*e.c,this.d=n*e.b+this.d*e.d}return this.tx=t*e.a+this.ty*e.c+e.tx,this.ty=t*e.b+this.ty*e.d+e.ty,this}decompose(e){const t=this.a,i=this.b,n=this.c,s=this.d,o=e.pivot,a=-Math.atan2(-n,s),l=Math.atan2(i,t),u=Math.abs(a+l);return u<1e-5||Math.abs(Gl-u)<1e-5?(e.rotation=l,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=a,e.skew.y=l),e.scale.x=Math.sqrt(t*t+i*i),e.scale.y=Math.sqrt(n*n+s*s),e.position.x=this.tx+(o.x*t+o.y*n),e.position.y=this.ty+(o.x*i+o.y*s),e}invert(){const e=this.a,t=this.b,i=this.c,n=this.d,s=this.tx,o=e*n-t*i;return this.a=n/o,this.b=-t/o,this.c=-i/o,this.d=e/o,this.tx=(i*this.ty-n*s)/o,this.ty=-(e*this.ty-t*s)/o,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new ye;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}static get IDENTITY(){return new ye}static get TEMP_MATRIX(){return new ye}}ye.prototype.toString=function(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`};const Mi=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Di=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Ni=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Oi=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Td=[],J_=[],fa=Math.sign;function RC(){for(let r=0;r<16;r++){const e=[];Td.push(e);for(let t=0;t<16;t++){const i=fa(Mi[r]*Mi[t]+Ni[r]*Di[t]),n=fa(Di[r]*Mi[t]+Oi[r]*Di[t]),s=fa(Mi[r]*Ni[t]+Ni[r]*Oi[t]),o=fa(Di[r]*Ni[t]+Oi[r]*Oi[t]);for(let a=0;a<16;a++)if(Mi[a]===i&&Di[a]===n&&Ni[a]===s&&Oi[a]===o){e.push(a);break}}}for(let r=0;r<16;r++){const e=new ye;e.set(Mi[r],Di[r],Ni[r],Oi[r],0,0),J_.push(e)}}RC();const Ee={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:r=>Mi[r],uY:r=>Di[r],vX:r=>Ni[r],vY:r=>Oi[r],inv:r=>r&8?r&15:-r&7,add:(r,e)=>Td[r][e],sub:(r,e)=>Td[r][Ee.inv(e)],rotate180:r=>r^4,isVertical:r=>(r&3)===2,byDirection:(r,e)=>Math.abs(r)*2<=Math.abs(e)?e>=0?Ee.S:Ee.N:Math.abs(e)*2<=Math.abs(r)?r>0?Ee.E:Ee.W:e>0?r>0?Ee.SE:Ee.SW:r>0?Ee.NE:Ee.NW,matrixAppendRotationInv:(r,e,t=0,i=0)=>{const n=J_[Ee.inv(e)];n.tx=t,n.ty=i,r.append(n)}};class Nr{constructor(e,t,i=0,n=0){this._x=i,this._y=n,this.cb=e,this.scope=t}clone(e=this.cb,t=this.scope){return new Nr(e,t,this._x,this._y)}set(e=0,t=e){return(this._x!==e||this._y!==t)&&(this._x=e,this._y=t,this.cb.call(this.scope)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))}}Nr.prototype.toString=function(){return`[@pixi/math:ObservablePoint x=${this.x} y=${this.y} scope=${this.scope}]`};const Sd=class{constructor(){this.worldTransform=new ye,this.localTransform=new ye,this.position=new Nr(this.onChange,this,0,0),this.scale=new Nr(this.onChange,this,1,1),this.pivot=new Nr(this.onChange,this,0,0),this.skew=new Nr(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){const r=this.localTransform;this._localID!==this._currentLocalID&&(r.a=this._cx*this.scale.x,r.b=this._sx*this.scale.x,r.c=this._cy*this.scale.y,r.d=this._sy*this.scale.y,r.tx=this.position.x-(this.pivot.x*r.a+this.pivot.y*r.c),r.ty=this.position.y-(this.pivot.x*r.b+this.pivot.y*r.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(r){const e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==r._worldID){const t=r.worldTransform,i=this.worldTransform;i.a=e.a*t.a+e.b*t.c,i.b=e.a*t.b+e.b*t.d,i.c=e.c*t.a+e.d*t.c,i.d=e.c*t.b+e.d*t.d,i.tx=e.tx*t.a+e.ty*t.c+t.tx,i.ty=e.tx*t.b+e.ty*t.d+t.ty,this._parentID=r._worldID,this._worldID++}}setFromMatrix(r){r.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(r){this._rotation!==r&&(this._rotation=r,this.updateSkew())}};Sd.IDENTITY=new Sd;let dp=Sd;dp.prototype.toString=function(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`};var IC=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,PC=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function Ug(r,e,t){const i=r.createShader(e);return r.shaderSource(i,t),r.compileShader(i),i}function Bh(r){const e=new Array(r);for(let t=0;t<e.length;t++)e[t]=!1;return e}function ex(r,e){switch(r){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return Bh(2*e);case"bvec3":return Bh(3*e);case"bvec4":return Bh(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const qn=[{test:r=>r.type==="float"&&r.size===1&&!r.isArray,code:r=>`
            if(uv["${r}"] !== ud["${r}"].value)
            {
                ud["${r}"].value = uv["${r}"]
                gl.uniform1f(ud["${r}"].location, uv["${r}"])
            }
            `},{test:(r,e)=>(r.type==="sampler2D"||r.type==="samplerCube"||r.type==="sampler2DArray")&&r.size===1&&!r.isArray&&(e==null||e.castToBaseTexture!==void 0),code:r=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${r}"], t);

            if(ud["${r}"].value !== t)
            {
                ud["${r}"].value = t;
                gl.uniform1i(ud["${r}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(r,e)=>r.type==="mat3"&&r.size===1&&!r.isArray&&e.a!==void 0,code:r=>`
            gl.uniformMatrix3fv(ud["${r}"].location, false, uv["${r}"].toArray(true));
            `,codeUbo:r=>`
                var ${r}_matrix = uv.${r}.toArray(true);

                data[offset] = ${r}_matrix[0];
                data[offset+1] = ${r}_matrix[1];
                data[offset+2] = ${r}_matrix[2];
        
                data[offset + 4] = ${r}_matrix[3];
                data[offset + 5] = ${r}_matrix[4];
                data[offset + 6] = ${r}_matrix[5];
        
                data[offset + 8] = ${r}_matrix[6];
                data[offset + 9] = ${r}_matrix[7];
                data[offset + 10] = ${r}_matrix[8];
            `},{test:(r,e)=>r.type==="vec2"&&r.size===1&&!r.isArray&&e.x!==void 0,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${r}"].location, v.x, v.y);
                }`,codeUbo:r=>`
                v = uv.${r};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:r=>r.type==="vec2"&&r.size===1&&!r.isArray,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${r}"].location, v[0], v[1]);
                }
            `},{test:(r,e)=>r.type==="vec4"&&r.size===1&&!r.isArray&&e.width!==void 0,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${r}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:r=>`
                    v = uv.${r};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(r,e)=>r.type==="vec4"&&r.size===1&&!r.isArray&&e.red!==void 0,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${r}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:r=>`
                    v = uv.${r};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(r,e)=>r.type==="vec3"&&r.size===1&&!r.isArray&&e.red!==void 0,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${r}"].location, v.red, v.green, v.blue)
                }`,codeUbo:r=>`
                    v = uv.${r};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:r=>r.type==="vec4"&&r.size===1&&!r.isArray,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${r}"].location, v[0], v[1], v[2], v[3])
                }`}],kC={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},MC={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function DC(r,e){var i;const t=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const n in r.uniforms){const s=e[n];if(!s){((i=r.uniforms[n])==null?void 0:i.group)===!0&&(r.uniforms[n].ubo?t.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${n}, '${n}');
                    `):t.push(`
                        renderer.shader.syncUniformGroup(uv.${n}, syncData);
                    `));continue}const o=r.uniforms[n];let a=!1;for(let l=0;l<qn.length;l++)if(qn[l].test(s,o)){t.push(qn[l].code(n,o)),a=!0;break}if(!a){const l=(s.size===1&&!s.isArray?kC:MC)[s.type].replace("location",`ud["${n}"].location`);t.push(`
            cu = ud["${n}"];
            cv = cu.value;
            v = uv["${n}"];
            ${l};`)}}return new Function("ud","uv","renderer","syncData",t.join(`
`))}const tx={};let mn=tx;function NC(){if(mn===tx||mn!=null&&mn.isContextLost()){const r=U.ADAPTER.createCanvas();let e;U.PREFER_ENV>=an.WEBGL2&&(e=r.getContext("webgl2",{})),e||(e=r.getContext("webgl",{})||r.getContext("experimental-webgl",{}),e?e.getExtension("WEBGL_draw_buffers"):e=null),mn=e}return mn}let pa;function OC(){if(!pa){pa=Pt.MEDIUM;const r=NC();if(r&&r.getShaderPrecisionFormat){const e=r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.HIGH_FLOAT);e&&(pa=e.precision?Pt.HIGH:Pt.MEDIUM)}}return pa}function Gg(r,e){const t=r.getShaderSource(e).split(`
`).map((u,h)=>`${h}: ${u}`),i=r.getShaderInfoLog(e),n=i.split(`
`),s={},o=n.map(u=>parseFloat(u.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(u=>u&&!s[u]?(s[u]=!0,!0):!1),a=[""];o.forEach(u=>{t[u-1]=`%c${t[u-1]}%c`,a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const l=t.join(`
`);a[0]=l,console.error(i),console.groupCollapsed("click to view full shader code"),console.warn(...a),console.groupEnd()}function BC(r,e,t,i){r.getProgramParameter(e,r.LINK_STATUS)||(r.getShaderParameter(t,r.COMPILE_STATUS)||Gg(r,t),r.getShaderParameter(i,r.COMPILE_STATUS)||Gg(r,i),console.error("PixiJS Error: Could not initialize shader."),r.getProgramInfoLog(e)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",r.getProgramInfoLog(e)))}const LC={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function rx(r){return LC[r]}let ma=null;const Hg={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function ix(r,e){if(!ma){const t=Object.keys(Hg);ma={};for(let i=0;i<t.length;++i){const n=t[i];ma[r[n]]=Hg[n]}}return ma[e]}function $g(r,e,t){if(r.substring(0,9)!=="precision"){let i=e;return e===Pt.HIGH&&t!==Pt.HIGH&&(i=Pt.MEDIUM),`precision ${i} float;
${r}`}else if(t!==Pt.HIGH&&r.substring(0,15)==="precision highp")return r.replace("precision highp","precision mediump");return r}let Cs;function FC(){if(typeof Cs=="boolean")return Cs;try{Cs=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{Cs=!1}return Cs}let UC=0;const ga={},Ad=class wn{constructor(e,t,i="pixi-shader",n={}){this.extra={},this.id=UC++,this.vertexSrc=e||wn.defaultVertexSrc,this.fragmentSrc=t||wn.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=n,this.vertexSrc.substring(0,8)!=="#version"&&(i=i.replace(/\s+/g,"-"),ga[i]?(ga[i]++,i+=`-${ga[i]}`):ga[i]=1,this.vertexSrc=`#define SHADER_NAME ${i}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${i}
${this.fragmentSrc}`,this.vertexSrc=$g(this.vertexSrc,wn.defaultVertexPrecision,Pt.HIGH),this.fragmentSrc=$g(this.fragmentSrc,wn.defaultFragmentPrecision,OC())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return PC}static get defaultFragmentSrc(){return IC}static from(e,t,i){const n=e+t;let s=Ng[n];return s||(Ng[n]=s=new wn(e,t,i)),s}};Ad.defaultVertexPrecision=Pt.HIGH,Ad.defaultFragmentPrecision=Dr.apple.device?Pt.HIGH:Pt.MEDIUM;let Or=Ad,GC=0;class Kt{constructor(e,t,i){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=GC++,this.static=!!t,this.ubo=!!i,e instanceof ke?(this.buffer=e,this.buffer.type=gr.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=e,this.ubo&&(this.buffer=new ke(new Float32Array(1)),this.buffer.type=gr.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(e,t,i){if(!this.ubo)this.uniforms[e]=new Kt(t,i);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(e,t,i){return new Kt(e,t,i)}static uboFrom(e,t){return new Kt(e,t??!0,!0)}}class yr{constructor(e,t){this.uniformBindCount=0,this.program=e,t?t instanceof Kt?this.uniformGroup=t:this.uniformGroup=new Kt(t):this.uniformGroup=new Kt({}),this.disposeRunner=new qt("disposeShader")}checkUniformExists(e,t){if(t.uniforms[e])return!0;for(const i in t.uniforms){const n=t.uniforms[i];if(n.group===!0&&this.checkUniformExists(e,n))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(e,t,i){const n=Or.from(e,t);return new yr(n,i)}}class HC{constructor(e,t){if(this.vertexSrc=e,this.fragTemplate=t,this.programCache={},this.defaultGroupCache={},!t.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!t.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(e){if(!this.programCache[e]){const i=new Int32Array(e);for(let s=0;s<e;s++)i[s]=s;this.defaultGroupCache[e]=Kt.from({uSamplers:i},!0);let n=this.fragTemplate;n=n.replace(/%count%/gi,`${e}`),n=n.replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new Or(this.vertexSrc,n)}const t={tint:new Float32Array([1,1,1,1]),translationMatrix:new ye,default:this.defaultGroupCache[e]};return new yr(this.programCache[e],t)}generateSampleSrc(e){let t="";t+=`
`,t+=`
`;for(let i=0;i<e;i++)i>0&&(t+=`
else `),i<e-1&&(t+=`if(vTextureId < ${i}.5)`),t+=`
{`,t+=`
	color = texture2D(uSamplers[${i}], vTextureCoord);`,t+=`
}`;return t+=`
`,t+=`
`,t}}class bd{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let e=0;e<this.count;e++)this.elements[e]=null;this.count=0}}function $C(){return!Dr.apple.device}function zC(r){let e=!0;const t=U.ADAPTER.getNavigator();if(Dr.tablet||Dr.phone){if(Dr.apple.device){const i=t.userAgent.match(/OS (\d+)_(\d+)?/);i&&parseInt(i[1],10)<11&&(e=!1)}if(Dr.android.device){const i=t.userAgent.match(/Android\s([0-9.]*)/);i&&parseInt(i[1],10)<7&&(e=!1)}}return e?r:4}class Au{constructor(e){this.renderer=e}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(e){}}var VC=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,XC=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const Os=class Gt extends Au{constructor(e){super(e),this.setShaderGenerator(),this.geometryClass=Q_,this.vertexSize=6,this.state=wr.for2d(),this.size=Gt.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??zC(32),this._defaultMaxTextures}static set defaultMaxTextures(e){this._defaultMaxTextures=e}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??$C(),this._canUploadSameBuffer}static set canUploadSameBuffer(e){this._canUploadSameBuffer=e}get MAX_TEXTURES(){return ee("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return XC}static get defaultFragmentTemplate(){return VC}setShaderGenerator({vertex:e=Gt.defaultVertexSrc,fragment:t=Gt.defaultFragmentTemplate}={}){this.shaderGenerator=new HC(e,t)}contextChange(){const e=this.renderer.gl;U.PREFER_ENV===an.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),Gt.defaultMaxTextures),this.maxTextures=_C(this.maxTextures,e)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:e,_textureArrayPool:t}=Gt,i=this.size/4,n=Math.floor(i/this.maxTextures)+1;for(;e.length<i;)e.push(new Ed);for(;t.length<n;)t.push(new bd);for(let s=0;s<this.maxTextures;s++)this._tempBoundTextures[s]=null}onPrerender(){this._flushId=0}render(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)}buildTexturesAndDrawCalls(){const{_bufferedTextures:e,maxTextures:t}=this,i=Gt._textureArrayPool,n=this.renderer.batch,s=this._tempBoundTextures,o=this.renderer.textureGC.count;let a=++K._globalBatch,l=0,u=i[0],h=0;n.copyBoundTextures(s,t);for(let d=0;d<this._bufferSize;++d){const c=e[d];e[d]=null,c._batchEnabled!==a&&(u.count>=t&&(n.boundArray(u,s,a,t),this.buildDrawCalls(u,h,d),h=d,u=i[++l],++a),c._batchEnabled=a,c.touched=o,u.elements[u.count++]=c)}u.count>0&&(n.boundArray(u,s,a,t),this.buildDrawCalls(u,h,this._bufferSize),++l,++a);for(let d=0;d<s.length;d++)s[d]=null;K._globalBatch=a}buildDrawCalls(e,t,i){const{_bufferedElements:n,_attributeBuffer:s,_indexBuffer:o,vertexSize:a}=this,l=Gt._drawCallPool;let u=this._dcIndex,h=this._aIndex,d=this._iIndex,c=l[u];c.start=this._iIndex,c.texArray=e;for(let f=t;f<i;++f){const p=n[f],v=p._texture.baseTexture,x=Y_[v.alphaMode?1:0][p.blendMode];n[f]=null,t<f&&c.blend!==x&&(c.size=d-c.start,t=f,c=l[++u],c.texArray=e,c.start=d),this.packInterleavedGeometry(p,s,o,h,d),h+=p.vertexData.length/2*a,d+=p.indices.length,c.blend=x}t<i&&(c.size=d-c.start,++u),this._dcIndex=u,this._aIndex=h,this._iIndex=d}bindAndClearTexArray(e){const t=this.renderer.texture;for(let i=0;i<e.count;i++)t.bind(e.elements[i],e.ids[i]),e.elements[i]=null;e.count=0}updateGeometry(){const{_packedGeometries:e,_attributeBuffer:t,_indexBuffer:i}=this;Gt.canUploadSameBuffer?(e[this._flushId]._buffer.update(t.rawBinaryData),e[this._flushId]._indexBuffer.update(i),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(t.rawBinaryData),e[this._flushId]._indexBuffer.update(i),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const e=this._dcIndex,{gl:t,state:i}=this.renderer,n=Gt._drawCallPool;let s=null;for(let o=0;o<e;o++){const{texArray:a,type:l,size:u,start:h,blend:d}=n[o];s!==a&&(s=a,this.bindAndClearTexArray(a)),this.state.blendMode=d,i.set(this.state),t.drawElements(l,u,t.UNSIGNED_SHORT,h*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),Gt.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(e){const t=Fl(Math.ceil(e/8)),i=Mg(t),n=t*8;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);let s=this._aBuffers[n];return s||(this._aBuffers[n]=s=new _d(n*this.vertexSize*4)),s}getIndexBuffer(e){const t=Fl(Math.ceil(e/12)),i=Mg(t),n=t*12;this._iBuffers.length<=i&&(this._iBuffers.length=i+1);let s=this._iBuffers[i];return s||(this._iBuffers[i]=s=new Uint16Array(n)),s}packInterleavedGeometry(e,t,i,n,s){const{uint32View:o,float32View:a}=t,l=n/this.vertexSize,u=e.uvs,h=e.indices,d=e.vertexData,c=e._texture.baseTexture._batchLocation,f=Math.min(e.worldAlpha,1),p=me.shared.setValue(e._tintRGB).toPremultiplied(f,e._texture.baseTexture.alphaMode>0);for(let v=0;v<d.length;v+=2)a[n++]=d[v],a[n++]=d[v+1],a[n++]=u[v],a[n++]=u[v+1],o[n++]=p,a[n++]=c;for(let v=0;v<h.length;v++)i[s++]=l+h[v]}};Os.defaultBatchSize=4096,Os.extension={name:"batch",type:B.RendererPlugin},Os._drawCallPool=[],Os._textureArrayPool=[];let Bi=Os;V.add(Bi);var jC=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,WC=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const Cd=class Bs extends yr{constructor(e,t,i){const n=Or.from(e||Bs.defaultVertexSrc,t||Bs.defaultFragmentSrc);super(n,i),this.padding=0,this.resolution=Bs.defaultResolution,this.multisample=Bs.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new wr}apply(e,t,i,n,s){e.applyFilter(this,t,i,n)}get blendMode(){return this.state.blendMode}set blendMode(e){this.state.blendMode=e}get resolution(){return this._resolution}set resolution(e){this._resolution=e}static get defaultVertexSrc(){return WC}static get defaultFragmentSrc(){return jC}};Cd.defaultResolution=1,Cd.defaultMultisample=Ne.NONE;let nt=Cd;class Hl{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new me(0),this.alpha=1}init(e){this.clearBeforeRender=e.clearBeforeRender;const{backgroundColor:t,background:i,backgroundAlpha:n}=e,s=i??t;s!==void 0&&(this.color=s),this.alpha=n}get color(){return this._backgroundColor.value}set color(e){this._backgroundColor.setValue(e)}get alpha(){return this._backgroundColor.alpha}set alpha(e){this._backgroundColor.setAlpha(e)}get backgroundColor(){return this._backgroundColor}destroy(){}}Hl.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},Hl.extension={type:[B.RendererSystem,B.CanvasRendererSystem],name:"background"};V.add(Hl);class nx{constructor(e){this.renderer=e,this.emptyRenderer=new Au(e),this.currentRenderer=this.emptyRenderer}setObjectRenderer(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(e,t){const{boundTextures:i}=this.renderer.texture;for(let n=t-1;n>=0;--n)e[n]=i[n]||null,e[n]&&(e[n]._batchLocation=n)}boundArray(e,t,i,n){const{elements:s,ids:o,count:a}=e;let l=0;for(let u=0;u<a;u++){const h=s[u],d=h._batchLocation;if(d>=0&&d<n&&t[d]===h){o[u]=d;continue}for(;l<n;){const c=t[l];if(c&&c._batchEnabled===i&&c._batchLocation===l){l++;continue}o[u]=l,h._batchLocation=l,t[l]=h;break}}}destroy(){this.renderer=null}}nx.extension={type:B.RendererSystem,name:"batch"};V.add(nx);let zg=0;class $l{constructor(e){this.renderer=e,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=zg++}init(e){if(e.context)this.initFromContext(e.context);else{const t=this.renderer.background.alpha<1,i=e.premultipliedAlpha;this.preserveDrawingBuffer=e.preserveDrawingBuffer,this.useContextAlpha=e.useContextAlpha,this.powerPreference=e.powerPreference,this.initFromOptions({alpha:t,premultipliedAlpha:i,antialias:e.antialias,stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:e.powerPreference})}}initFromContext(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=zg++,this.renderer.runners.contextChange.emit(e);const t=this.renderer.view;t.addEventListener!==void 0&&(t.addEventListener("webglcontextlost",this.handleContextLost,!1),t.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(e){const t=this.createContext(this.renderer.view,e);this.initFromContext(t)}createContext(e,t){let i;if(U.PREFER_ENV>=an.WEBGL2&&(i=e.getContext("webgl2",t)),i)this.webGLVersion=2;else if(this.webGLVersion=1,i=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),!i)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),this.gl}getExtensions(){const{gl:e}=this,t={loseContext:e.getExtension("WEBGL_lose_context"),anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc"),bptc:e.getExtension("EXT_texture_compression_bptc")};this.webGLVersion===1?Object.assign(this.extensions,t,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,t,{colorBufferFloat:e.getExtension("EXT_color_buffer_float")})}handleContextLost(e){e.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const e=this.renderer.view;this.renderer=null,e.removeEventListener!==void 0&&(e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(e){const t=e.getContextAttributes(),i="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext;i&&(this.webGLVersion=2),t&&!t.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const n=i||!!e.getExtension("OES_element_index_uint");this.supports.uint32Indices=n,n||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}$l.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},$l.extension={type:B.RendererSystem,name:"context"};V.add($l);class Rd{constructor(e,t){if(this.width=Math.round(e),this.height=Math.round(t),!this.width||!this.height)throw new Error("Framebuffer width or height is zero");this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new qt("disposeFramebuffer"),this.multisample=Ne.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(e=0,t){return this.colorTextures[e]=t||new K(null,{scaleMode:Mr.NEAREST,resolution:1,mipmap:_r.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(e){return this.depthTexture=e||new K(null,{scaleMode:Mr.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:_r.OFF,format:O.DEPTH_COMPONENT,type:W.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(e,t){if(e=Math.round(e),t=Math.round(t),!e||!t)throw new Error("Framebuffer width and height must not be zero");if(!(e===this.width&&t===this.height)){this.width=e,this.height=t,this.dirtyId++,this.dirtySize++;for(let i=0;i<this.colorTextures.length;i++){const n=this.colorTextures[i],s=n.resolution;n.setSize(e/s,t/s)}if(this.depthTexture){const i=this.depthTexture.resolution;this.depthTexture.setSize(e/i,t/i)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class sx extends K{constructor(e={}){if(typeof e=="number"){const t=arguments[0],i=arguments[1],n=arguments[2],s=arguments[3];e={width:t,height:i,scaleMode:n,resolution:s}}e.width=e.width??100,e.height=e.height??100,e.multisample??(e.multisample=Ne.NONE),super(null,e),this.mipmap=_r.OFF,this.valid=!0,this._clear=new me([0,0,0,0]),this.framebuffer=new Rd(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=e.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(e){this._clear.setValue(e)}get clearColor(){return this._clear.value}get clear(){return this._clear}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,t){this.framebuffer.resize(e*this.resolution,t*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class zr extends Co{constructor(e){const t=e,i=t.naturalWidth||t.videoWidth||t.displayWidth||t.width,n=t.naturalHeight||t.videoHeight||t.displayHeight||t.height;super(i,n),this.source=e,this.noSubImage=!1}static crossOrigin(e,t,i){i===void 0&&!t.startsWith("data:")?e.crossOrigin=gC(t):i!==!1&&(e.crossOrigin=typeof i=="string"?i:"anonymous")}upload(e,t,i,n){const s=e.gl,o=t.realWidth,a=t.realHeight;if(n=n||this.source,typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement){if(!n.complete||n.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement&&n.readyState<=1)return!1;return s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===ct.UNPACK),!this.noSubImage&&t.target===s.TEXTURE_2D&&i.width===o&&i.height===a?s.texSubImage2D(s.TEXTURE_2D,0,0,0,t.format,i.type,n):(i.width=o,i.height=a,s.texImage2D(t.target,0,i.internalFormat,t.format,i.type,n)),!0}update(){if(this.destroyed)return;const e=this.source,t=e.naturalWidth||e.videoWidth||e.width,i=e.naturalHeight||e.videoHeight||e.height;this.resize(t,i),super.update()}dispose(){this.source=null}}class ox extends zr{constructor(e,t){if(t=t||{},typeof e=="string"){const i=new Image;zr.crossOrigin(i,e,t.crossorigin),i.src=e,e=i}super(e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(t.createBitmap??U.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof t.alphaMode=="number"?t.alphaMode:null,this.bitmap=null,this._load=null,t.autoLoad!==!1&&this.load()}load(e){return this._load?this._load:(e!==void 0&&(this.createBitmap=e),this._load=new Promise((t,i)=>{const n=this.source;this.url=n.src;const s=()=>{this.destroyed||(n.onload=null,n.onerror=null,this.update(),this._load=null,this.createBitmap?t(this.process()):t(this))};n.complete&&n.src?s():(n.onload=s,n.onerror=o=>{i(o),this.onError.emit(o)})}),this._load)}process(){const e=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const t=globalThis.createImageBitmap,i=!e.crossOrigin||e.crossOrigin==="anonymous";return this._process=fetch(e.src,{mode:i?"cors":"no-cors"}).then(n=>n.blob()).then(n=>t(n,0,0,e.width,e.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===ct.UNPACK?"premultiply":"none"})).then(n=>this.destroyed?Promise.reject():(this.bitmap=n,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(e,t,i){if(typeof this.alphaMode=="number"&&(t.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(e,t,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(e,t,i,this.bitmap),!this.preserveBitmap){let n=!0;const s=t._glTextures;for(const o in s){const a=s[o];if(a!==i&&a.dirtyId!==t.dirtyId){n=!1;break}}n&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(e){return typeof HTMLImageElement<"u"&&(typeof e=="string"||e instanceof HTMLImageElement)}}class fp{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(e,t,i){const n=t.width,s=t.height;if(i){const o=e.width/2/n,a=e.height/2/s,l=e.x/n+o,u=e.y/s+a;i=Ee.add(i,Ee.NW),this.x0=l+o*Ee.uX(i),this.y0=u+a*Ee.uY(i),i=Ee.add(i,2),this.x1=l+o*Ee.uX(i),this.y1=u+a*Ee.uY(i),i=Ee.add(i,2),this.x2=l+o*Ee.uX(i),this.y2=u+a*Ee.uY(i),i=Ee.add(i,2),this.x3=l+o*Ee.uX(i),this.y3=u+a*Ee.uY(i)}else this.x0=e.x/n,this.y0=e.y/s,this.x1=(e.x+e.width)/n,this.y1=e.y/s,this.x2=(e.x+e.width)/n,this.y2=(e.y+e.height)/s,this.x3=e.x/n,this.y3=(e.y+e.height)/s;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}}fp.prototype.toString=function(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`};const Vg=new fp;function ya(r){r.destroy=function(){},r.on=function(){},r.once=function(){},r.emit=function(){}}class z extends Oo{constructor(e,t,i,n,s,o,a){if(super(),this.noFrame=!1,t||(this.noFrame=!0,t=new Z(0,0,1,1)),e instanceof z&&(e=e.baseTexture),this.baseTexture=e,this._frame=t,this.trim=n,this.valid=!1,this.destroyed=!1,this._uvs=Vg,this.uvMatrix=null,this.orig=i||t,this._rotate=Number(s||0),s===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=o?new ne(o.x,o.y):new ne(0,0),this.defaultBorders=a,this._updateID=0,this.textureCacheIds=[],e.valid?this.noFrame?e.valid&&this.onBaseTextureUpdated(e):this.frame=t:e.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&e.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(e){if(this.baseTexture){if(e){const{resource:t}=this.baseTexture;t!=null&&t.url&&nr[t.url]&&z.removeFromCache(t.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,z.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}clone(){var n;const e=this._frame.clone(),t=this._frame===this.orig?e:this.orig.clone(),i=new z(this.baseTexture,!this.noFrame&&e,t,(n=this.trim)==null?void 0:n.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(i._frame=e),i}updateUvs(){this._uvs===Vg&&(this._uvs=new fp),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(e,t={},i=U.STRICT_TEXTURE_CACHE){const n=typeof e=="string";let s=null;if(n)s=e;else if(e instanceof K){if(!e.cacheId){const a=(t==null?void 0:t.pixiIdPrefix)||"pixiid";e.cacheId=`${a}-${tn()}`,K.addToCache(e,e.cacheId)}s=e.cacheId}else{if(!e._pixiId){const a=(t==null?void 0:t.pixiIdPrefix)||"pixiid";e._pixiId=`${a}_${tn()}`}s=e._pixiId}let o=nr[s];if(n&&i&&!o)throw new Error(`The cacheId "${s}" does not exist in TextureCache.`);return!o&&!(e instanceof K)?(t.resolution||(t.resolution=$r(e)),o=new z(new K(e,t)),o.baseTexture.cacheId=s,K.addToCache(o.baseTexture,s),z.addToCache(o,s)):!o&&e instanceof K&&(o=new z(e),z.addToCache(o,s)),o}static fromURL(e,t){const i=Object.assign({autoLoad:!1},t==null?void 0:t.resourceOptions),n=z.from(e,Object.assign({resourceOptions:i},t),!1),s=n.baseTexture.resource;return n.baseTexture.valid?Promise.resolve(n):s.load().then(()=>Promise.resolve(n))}static fromBuffer(e,t,i,n){return new z(K.fromBuffer(e,t,i,n))}static fromLoader(e,t,i,n){const s=new K(e,Object.assign({scaleMode:K.defaultOptions.scaleMode,resolution:$r(t)},n)),{resource:o}=s;o instanceof ox&&(o.url=t);const a=new z(s);return i||(i=t),K.addToCache(a.baseTexture,i),z.addToCache(a,i),i!==t&&(K.addToCache(a.baseTexture,t),z.addToCache(a,t)),a.baseTexture.valid?Promise.resolve(a):new Promise(l=>{a.baseTexture.once("loaded",()=>l(a))})}static addToCache(e,t){t&&(e.textureCacheIds.includes(t)||e.textureCacheIds.push(t),nr[t]&&nr[t]!==e&&console.warn(`Texture added to the cache with an id [${t}] that already had an entry`),nr[t]=e)}static removeFromCache(e){if(typeof e=="string"){const t=nr[e];if(t){const i=t.textureCacheIds.indexOf(e);return i>-1&&t.textureCacheIds.splice(i,1),delete nr[e],t}}else if(e!=null&&e.textureCacheIds){for(let t=0;t<e.textureCacheIds.length;++t)nr[e.textureCacheIds[t]]===e&&delete nr[e.textureCacheIds[t]];return e.textureCacheIds.length=0,e}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(e){this._frame=e,this.noFrame=!1;const{x:t,y:i,width:n,height:s}=e,o=t+n>this.baseTexture.width,a=i+s>this.baseTexture.height;if(o||a){const l=o&&a?"and":"or",u=`X: ${t} + ${n} = ${t+n} > ${this.baseTexture.width}`,h=`Y: ${i} + ${s} = ${i+s} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${u} ${l} ${h}`)}this.valid=n&&s&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=e),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return z._EMPTY||(z._EMPTY=new z(new K),ya(z._EMPTY),ya(z._EMPTY.baseTexture)),z._EMPTY}static get WHITE(){if(!z._WHITE){const e=U.ADAPTER.createCanvas(16,16),t=e.getContext("2d");e.width=16,e.height=16,t.fillStyle="white",t.fillRect(0,0,16,16),z._WHITE=new z(K.from(e)),ya(z._WHITE),ya(z._WHITE.baseTexture)}return z._WHITE}}class un extends z{constructor(e,t){super(e,t),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,t,i=!0){const n=this.baseTexture.resolution,s=Math.round(e*n)/n,o=Math.round(t*n)/n;this.valid=s>0&&o>0,this._frame.width=this.orig.width=s,this._frame.height=this.orig.height=o,i&&this.baseTexture.resize(s,o),this.updateUvs()}setResolution(e){const{baseTexture:t}=this;t.resolution!==e&&(t.setResolution(e),this.resize(t.width,t.height,!1))}static create(e){return new un(new sx(e))}}class ax{constructor(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(e,t,i=Ne.NONE){const n=new sx(Object.assign({width:e,height:t,resolution:1,multisample:i},this.textureOptions));return new un(n)}getOptimalTexture(e,t,i=1,n=Ne.NONE){let s;e=Math.max(Math.ceil(e*i-1e-6),1),t=Math.max(Math.ceil(t*i-1e-6),1),!this.enableFullScreen||e!==this._pixelsWidth||t!==this._pixelsHeight?(e=Fl(e),t=Fl(t),s=((e&65535)<<16|t&65535)>>>0,n>1&&(s+=n*4294967296)):s=n>1?-n:-1,this.texturePool[s]||(this.texturePool[s]=[]);let o=this.texturePool[s].pop();return o||(o=this.createTexture(e,t,n)),o.filterPoolKey=s,o.setResolution(i),o}getFilterTexture(e,t,i){const n=this.getOptimalTexture(e.width,e.height,t||e.resolution,i||Ne.NONE);return n.filterFrame=e.filterFrame,n}returnTexture(e){const t=e.filterPoolKey;e.filterFrame=null,this.texturePool[t].push(e)}returnFilterTexture(e){this.returnTexture(e)}clear(e){if(e=e!==!1,e)for(const t in this.texturePool){const i=this.texturePool[t];if(i)for(let n=0;n<i.length;n++)i[n].destroy(!0)}this.texturePool={}}setScreenSize(e){if(!(e.width===this._pixelsWidth&&e.height===this._pixelsHeight)){this.enableFullScreen=e.width>0&&e.height>0;for(const t in this.texturePool){if(!(Number(t)<0))continue;const i=this.texturePool[t];if(i)for(let n=0;n<i.length;n++)i[n].destroy(!0);this.texturePool[t]=[]}this._pixelsWidth=e.width,this._pixelsHeight=e.height}}}ax.SCREEN_KEY=-1;class YC extends _i{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class lx extends _i{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new ke(this.vertices),this.uvBuffer=new ke(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(e,t){let i=0,n=0;return this.uvs[0]=i,this.uvs[1]=n,this.uvs[2]=i+t.width/e.width,this.uvs[3]=n,this.uvs[4]=i+t.width/e.width,this.uvs[5]=n+t.height/e.height,this.uvs[6]=i,this.uvs[7]=n+t.height/e.height,i=t.x,n=t.y,this.vertices[0]=i,this.vertices[1]=n,this.vertices[2]=i+t.width,this.vertices[3]=n,this.vertices[4]=i+t.width,this.vertices[5]=n+t.height,this.vertices[6]=i,this.vertices[7]=n+t.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class qC{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=Ne.NONE,this.sourceFrame=new Z,this.destinationFrame=new Z,this.bindingSourceFrame=new Z,this.bindingDestinationFrame=new Z,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const va=[new ne,new ne,new ne,new ne],Lh=new ye;class ux{constructor(e){this.renderer=e,this.defaultFilterStack=[{}],this.texturePool=new ax,this.statePool=[],this.quad=new YC,this.quadUv=new lx,this.tempRect=new Z,this.activeState={},this.globalUniforms=new Kt({outputFrame:new Z,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(e,t){const i=this.renderer,n=this.defaultFilterStack,s=this.statePool.pop()||new qC,o=i.renderTexture;let a,l;if(o.current){const x=o.current;a=x.resolution,l=x.multisample}else a=i.resolution,l=i.multisample;let u=t[0].resolution||a,h=t[0].multisample??l,d=t[0].padding,c=t[0].autoFit,f=t[0].legacy??!0;for(let x=1;x<t.length;x++){const g=t[x];u=Math.min(u,g.resolution||a),h=Math.min(h,g.multisample??l),d=this.useMaxPadding?Math.max(d,g.padding):d+g.padding,c=c&&g.autoFit,f=f||(g.legacy??!0)}n.length===1&&(this.defaultFilterStack[0].renderTexture=o.current),n.push(s),s.resolution=u,s.multisample=h,s.legacy=f,s.target=e,s.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),s.sourceFrame.pad(d);const p=this.tempRect.copyFrom(o.sourceFrame);i.projection.transform&&this.transformAABB(Lh.copyFrom(i.projection.transform).invert(),p),c?(s.sourceFrame.fit(p),(s.sourceFrame.width<=0||s.sourceFrame.height<=0)&&(s.sourceFrame.width=0,s.sourceFrame.height=0)):s.sourceFrame.intersects(p)||(s.sourceFrame.width=0,s.sourceFrame.height=0),this.roundFrame(s.sourceFrame,o.current?o.current.resolution:i.resolution,o.sourceFrame,o.destinationFrame,i.projection.transform),s.renderTexture=this.getOptimalFilterTexture(s.sourceFrame.width,s.sourceFrame.height,u,h),s.filters=t,s.destinationFrame.width=s.renderTexture.width,s.destinationFrame.height=s.renderTexture.height;const v=this.tempRect;v.x=0,v.y=0,v.width=s.sourceFrame.width,v.height=s.sourceFrame.height,s.renderTexture.filterFrame=s.sourceFrame,s.bindingSourceFrame.copyFrom(o.sourceFrame),s.bindingDestinationFrame.copyFrom(o.destinationFrame),s.transform=i.projection.transform,i.projection.transform=null,o.bind(s.renderTexture,s.sourceFrame,v),i.framebuffer.clear(0,0,0,0)}pop(){const e=this.defaultFilterStack,t=e.pop(),i=t.filters;this.activeState=t;const n=this.globalUniforms.uniforms;n.outputFrame=t.sourceFrame,n.resolution=t.resolution;const s=n.inputSize,o=n.inputPixel,a=n.inputClamp;if(s[0]=t.destinationFrame.width,s[1]=t.destinationFrame.height,s[2]=1/s[0],s[3]=1/s[1],o[0]=Math.round(s[0]*t.resolution),o[1]=Math.round(s[1]*t.resolution),o[2]=1/o[0],o[3]=1/o[1],a[0]=.5*o[2],a[1]=.5*o[3],a[2]=t.sourceFrame.width*s[2]-.5*o[2],a[3]=t.sourceFrame.height*s[3]-.5*o[3],t.legacy){const u=n.filterArea;u[0]=t.destinationFrame.width,u[1]=t.destinationFrame.height,u[2]=t.sourceFrame.x,u[3]=t.sourceFrame.y,n.filterClamp=n.inputClamp}this.globalUniforms.update();const l=e[e.length-1];if(this.renderer.framebuffer.blit(),i.length===1)i[0].apply(this,t.renderTexture,l.renderTexture,hr.BLEND,t),this.returnFilterTexture(t.renderTexture);else{let u=t.renderTexture,h=this.getOptimalFilterTexture(u.width,u.height,t.resolution);h.filterFrame=u.filterFrame;let d=0;for(d=0;d<i.length-1;++d){d===1&&t.multisample>1&&(h=this.getOptimalFilterTexture(u.width,u.height,t.resolution),h.filterFrame=u.filterFrame),i[d].apply(this,u,h,hr.CLEAR,t);const c=u;u=h,h=c}i[d].apply(this,u,l.renderTexture,hr.BLEND,t),d>1&&t.multisample>1&&this.returnFilterTexture(t.renderTexture),this.returnFilterTexture(u),this.returnFilterTexture(h)}t.clear(),this.statePool.push(t)}bindAndClear(e,t=hr.CLEAR){const{renderTexture:i,state:n}=this.renderer;if(e===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,e==null?void 0:e.filterFrame){const o=this.tempRect;o.x=0,o.y=0,o.width=e.filterFrame.width,o.height=e.filterFrame.height,i.bind(e,e.filterFrame,o)}else e!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?i.bind(e):this.renderer.renderTexture.bind(e,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const s=n.stateId&1||this.forceClear;(t===hr.CLEAR||t===hr.BLIT&&s)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(e,t,i,n){const s=this.renderer;s.state.set(e.state),this.bindAndClear(i,n),e.uniforms.uSampler=t,e.uniforms.filterGlobals=this.globalUniforms,s.shader.bind(e),e.legacy=!!e.program.attributeData.aTextureCoord,e.legacy?(this.quadUv.map(t._frame,t.filterFrame),s.geometry.bind(this.quadUv),s.geometry.draw(fr.TRIANGLES)):(s.geometry.bind(this.quad),s.geometry.draw(fr.TRIANGLE_STRIP))}calculateSpriteMatrix(e,t){const{sourceFrame:i,destinationFrame:n}=this.activeState,{orig:s}=t._texture,o=e.set(n.width,0,0,n.height,i.x,i.y),a=t.worldTransform.copyTo(ye.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(t.anchor.x,t.anchor.y),o}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(e,t,i=1,n=Ne.NONE){return this.texturePool.getOptimalTexture(e,t,i,n)}getFilterTexture(e,t,i){if(typeof e=="number"){const s=e;e=t,t=s}e=e||this.activeState.renderTexture;const n=this.texturePool.getOptimalTexture(e.width,e.height,t||e.resolution,i||Ne.NONE);return n.filterFrame=e.filterFrame,n}returnFilterTexture(e){this.texturePool.returnTexture(e)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(e,t){const i=va[0],n=va[1],s=va[2],o=va[3];i.set(t.left,t.top),n.set(t.left,t.bottom),s.set(t.right,t.top),o.set(t.right,t.bottom),e.apply(i,i),e.apply(n,n),e.apply(s,s),e.apply(o,o);const a=Math.min(i.x,n.x,s.x,o.x),l=Math.min(i.y,n.y,s.y,o.y),u=Math.max(i.x,n.x,s.x,o.x),h=Math.max(i.y,n.y,s.y,o.y);t.x=a,t.y=l,t.width=u-a,t.height=h-l}roundFrame(e,t,i,n,s){if(!(e.width<=0||e.height<=0||i.width<=0||i.height<=0)){if(s){const{a:o,b:a,c:l,d:u}=s;if((Math.abs(a)>1e-4||Math.abs(l)>1e-4)&&(Math.abs(o)>1e-4||Math.abs(u)>1e-4))return}s=s?Lh.copyFrom(s):Lh.identity(),s.translate(-i.x,-i.y).scale(n.width/i.width,n.height/i.height).translate(n.x,n.y),this.transformAABB(s,e),e.ceil(t),this.transformAABB(s.invert(),e)}}}ux.extension={type:B.RendererSystem,name:"filter"};V.add(ux);class KC{constructor(e){this.framebuffer=e,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=Ne.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const ZC=new Z;class hx{constructor(e){this.renderer=e,this.managedFramebuffers=[],this.unknownFramebuffer=new Rd(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Z,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let t=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;U.PREFER_ENV===an.WEBGL_LEGACY&&(t=null,i=null),t?e.drawBuffers=n=>t.drawBuffersWEBGL(n):(this.hasMRT=!1,e.drawBuffers=()=>{}),i||(this.writeDepthTexture=!1)}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES)}bind(e,t,i=0){const{gl:n}=this;if(e){const s=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,n.bindFramebuffer(n.FRAMEBUFFER,s.framebuffer)),s.mipLevel!==i&&(e.dirtyId++,e.dirtyFormat++,s.mipLevel=i),s.dirtyId!==e.dirtyId&&(s.dirtyId=e.dirtyId,s.dirtyFormat!==e.dirtyFormat?(s.dirtyFormat=e.dirtyFormat,s.dirtySize=e.dirtySize,this.updateFramebuffer(e,i)):s.dirtySize!==e.dirtySize&&(s.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(let o=0;o<e.colorTextures.length;o++){const a=e.colorTextures[o];this.renderer.texture.unbind(a.parentTextureArray||a)}if(e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),t){const o=t.width>>i,a=t.height>>i,l=o/t.width;this.setViewport(t.x*l,t.y*l,o,a)}else{const o=e.width>>i,a=e.height>>i;this.setViewport(0,0,o,a)}}else this.current&&(this.current=null,n.bindFramebuffer(n.FRAMEBUFFER,null)),t?this.setViewport(t.x,t.y,t.width,t.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(e,t,i,n){const s=this.viewport;e=Math.round(e),t=Math.round(t),i=Math.round(i),n=Math.round(n),(s.width!==i||s.height!==n||s.x!==e||s.y!==t)&&(s.x=e,s.y=t,s.width=i,s.height=n,this.gl.viewport(e,t,i,n))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(e,t,i,n,s=rd.COLOR|rd.DEPTH){const{gl:o}=this;o.clearColor(e,t,i,n),o.clear(s)}initFramebuffer(e){const{gl:t}=this,i=new KC(t.createFramebuffer());return i.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=i,this.managedFramebuffers.push(e),e.disposeRunner.add(this),i}resizeFramebuffer(e){const{gl:t}=this,i=e.glFramebuffers[this.CONTEXT_UID];if(i.stencil){t.bindRenderbuffer(t.RENDERBUFFER,i.stencil);let o;this.renderer.context.webGLVersion===1?o=t.DEPTH_STENCIL:e.depth&&e.stencil?o=t.DEPTH24_STENCIL8:e.depth?o=t.DEPTH_COMPONENT24:o=t.STENCIL_INDEX8,i.msaaBuffer?t.renderbufferStorageMultisample(t.RENDERBUFFER,i.multisample,o,e.width,e.height):t.renderbufferStorage(t.RENDERBUFFER,o,e.width,e.height)}const n=e.colorTextures;let s=n.length;t.drawBuffers||(s=Math.min(s,1));for(let o=0;o<s;o++){const a=n[o],l=a.parentTextureArray||a;this.renderer.texture.bind(l,0),o===0&&i.msaaBuffer&&(t.bindRenderbuffer(t.RENDERBUFFER,i.msaaBuffer),t.renderbufferStorageMultisample(t.RENDERBUFFER,i.multisample,l._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height))}e.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(e.depthTexture,0)}updateFramebuffer(e,t){const{gl:i}=this,n=e.glFramebuffers[this.CONTEXT_UID],s=e.colorTextures;let o=s.length;i.drawBuffers||(o=Math.min(o,1)),n.multisample>1&&this.canMultisampleFramebuffer(e)?n.msaaBuffer=n.msaaBuffer||i.createRenderbuffer():n.msaaBuffer&&(i.deleteRenderbuffer(n.msaaBuffer),n.msaaBuffer=null,n.blitFramebuffer&&(n.blitFramebuffer.dispose(),n.blitFramebuffer=null));const a=[];for(let l=0;l<o;l++){const u=s[l],h=u.parentTextureArray||u;this.renderer.texture.bind(h,0),l===0&&n.msaaBuffer?(i.bindRenderbuffer(i.RENDERBUFFER,n.msaaBuffer),i.renderbufferStorageMultisample(i.RENDERBUFFER,n.multisample,h._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,n.msaaBuffer)):(i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+l,u.target,h._glTextures[this.CONTEXT_UID].texture,t),a.push(i.COLOR_ATTACHMENT0+l))}if(a.length>1&&i.drawBuffers(a),e.depthTexture&&this.writeDepthTexture){const l=e.depthTexture;this.renderer.texture.bind(l,0),i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,l._glTextures[this.CONTEXT_UID].texture,t)}if((e.stencil||e.depth)&&!(e.depthTexture&&this.writeDepthTexture)){n.stencil=n.stencil||i.createRenderbuffer();let l,u;this.renderer.context.webGLVersion===1?(l=i.DEPTH_STENCIL_ATTACHMENT,u=i.DEPTH_STENCIL):e.depth&&e.stencil?(l=i.DEPTH_STENCIL_ATTACHMENT,u=i.DEPTH24_STENCIL8):e.depth?(l=i.DEPTH_ATTACHMENT,u=i.DEPTH_COMPONENT24):(l=i.STENCIL_ATTACHMENT,u=i.STENCIL_INDEX8),i.bindRenderbuffer(i.RENDERBUFFER,n.stencil),n.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,n.multisample,u,e.width,e.height):i.renderbufferStorage(i.RENDERBUFFER,u,e.width,e.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,l,i.RENDERBUFFER,n.stencil)}else n.stencil&&(i.deleteRenderbuffer(n.stencil),n.stencil=null)}canMultisampleFramebuffer(e){return this.renderer.context.webGLVersion!==1&&e.colorTextures.length<=1&&!e.depthTexture}detectSamples(e){const{msaaSamples:t}=this;let i=Ne.NONE;if(e<=1||t===null)return i;for(let n=0;n<t.length;n++)if(t[n]<=e){i=t[n];break}return i===1&&(i=Ne.NONE),i}blit(e,t,i){const{current:n,renderer:s,gl:o,CONTEXT_UID:a}=this;if(s.context.webGLVersion!==2||!n)return;const l=n.glFramebuffers[a];if(!l)return;if(!e){if(!l.msaaBuffer)return;const h=n.colorTextures[0];if(!h)return;l.blitFramebuffer||(l.blitFramebuffer=new Rd(n.width,n.height),l.blitFramebuffer.addColorTexture(0,h)),e=l.blitFramebuffer,e.colorTextures[0]!==h&&(e.colorTextures[0]=h,e.dirtyId++,e.dirtyFormat++),(e.width!==n.width||e.height!==n.height)&&(e.width=n.width,e.height=n.height,e.dirtyId++,e.dirtySize++)}t||(t=ZC,t.width=n.width,t.height=n.height),i||(i=t);const u=t.width===i.width&&t.height===i.height;this.bind(e),o.bindFramebuffer(o.READ_FRAMEBUFFER,l.framebuffer),o.blitFramebuffer(t.left,t.top,t.right,t.bottom,i.left,i.top,i.right,i.bottom,o.COLOR_BUFFER_BIT,u?o.NEAREST:o.LINEAR),o.bindFramebuffer(o.READ_FRAMEBUFFER,e.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(e,t){const i=e.glFramebuffers[this.CONTEXT_UID],n=this.gl;if(!i)return;delete e.glFramebuffers[this.CONTEXT_UID];const s=this.managedFramebuffers.indexOf(e);s>=0&&this.managedFramebuffers.splice(s,1),e.disposeRunner.remove(this),t||(n.deleteFramebuffer(i.framebuffer),i.msaaBuffer&&n.deleteRenderbuffer(i.msaaBuffer),i.stencil&&n.deleteRenderbuffer(i.stencil)),i.blitFramebuffer&&this.disposeFramebuffer(i.blitFramebuffer,t)}disposeAll(e){const t=this.managedFramebuffers;this.managedFramebuffers=[];for(let i=0;i<t.length;i++)this.disposeFramebuffer(t[i],e)}forceStencil(){const e=this.current;if(!e)return;const t=e.glFramebuffers[this.CONTEXT_UID];if(!t||t.stencil&&e.stencil)return;e.stencil=!0;const i=e.width,n=e.height,s=this.gl,o=t.stencil=s.createRenderbuffer();s.bindRenderbuffer(s.RENDERBUFFER,o);let a,l;this.renderer.context.webGLVersion===1?(a=s.DEPTH_STENCIL_ATTACHMENT,l=s.DEPTH_STENCIL):e.depth?(a=s.DEPTH_STENCIL_ATTACHMENT,l=s.DEPTH24_STENCIL8):(a=s.STENCIL_ATTACHMENT,l=s.STENCIL_INDEX8),t.msaaBuffer?s.renderbufferStorageMultisample(s.RENDERBUFFER,t.multisample,l,i,n):s.renderbufferStorage(s.RENDERBUFFER,l,i,n),s.framebufferRenderbuffer(s.FRAMEBUFFER,a,s.RENDERBUFFER,o)}reset(){this.current=this.unknownFramebuffer,this.viewport=new Z}destroy(){this.renderer=null}}hx.extension={type:B.RendererSystem,name:"framebuffer"};V.add(hx);const Fh={5126:4,5123:2,5121:1};class cx{constructor(e){this.renderer=e,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl,t=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,t.webGLVersion!==2){let i=this.renderer.context.extensions.vertexArrayObject;U.PREFER_ENV===an.WEBGL_LEGACY&&(i=null),i?(e.createVertexArray=()=>i.createVertexArrayOES(),e.bindVertexArray=n=>i.bindVertexArrayOES(n),e.deleteVertexArray=n=>i.deleteVertexArrayOES(n)):(this.hasVao=!1,e.createVertexArray=()=>null,e.bindVertexArray=()=>null,e.deleteVertexArray=()=>null)}if(t.webGLVersion!==2){const i=e.getExtension("ANGLE_instanced_arrays");i?(e.vertexAttribDivisor=(n,s)=>i.vertexAttribDivisorANGLE(n,s),e.drawElementsInstanced=(n,s,o,a,l)=>i.drawElementsInstancedANGLE(n,s,o,a,l),e.drawArraysInstanced=(n,s,o,a)=>i.drawArraysInstancedANGLE(n,s,o,a)):this.hasInstance=!1}this.canUseUInt32ElementIndex=t.webGLVersion===2||!!t.extensions.uint32ElementIndex}bind(e,t){t=t||this.renderer.shader.shader;const{gl:i}=this;let n=e.glVertexArrayObjects[this.CONTEXT_UID],s=!1;n||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=n={},s=!0);const o=n[t.program.id]||this.initGeometryVao(e,t,s);this._activeGeometry=e,this._activeVao!==o&&(this._activeVao=o,this.hasVao?i.bindVertexArray(o):this.activateVao(e,t.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const e=this._activeGeometry,t=this.renderer.buffer;for(let i=0;i<e.buffers.length;i++){const n=e.buffers[i];t.update(n)}}checkCompatibility(e,t){const i=e.attributes,n=t.attributeData;for(const s in n)if(!i[s])throw new Error(`shader and geometry incompatible, geometry missing the "${s}" attribute`)}getSignature(e,t){const i=e.attributes,n=t.attributeData,s=["g",e.id];for(const o in i)n[o]&&s.push(o,n[o].location);return s.join("-")}initGeometryVao(e,t,i=!0){const n=this.gl,s=this.CONTEXT_UID,o=this.renderer.buffer,a=t.program;a.glPrograms[s]||this.renderer.shader.generateProgram(t),this.checkCompatibility(e,a);const l=this.getSignature(e,a),u=e.glVertexArrayObjects[this.CONTEXT_UID];let h=u[l];if(h)return u[a.id]=h,h;const d=e.buffers,c=e.attributes,f={},p={};for(const v in d)f[v]=0,p[v]=0;for(const v in c)!c[v].size&&a.attributeData[v]?c[v].size=a.attributeData[v].size:c[v].size||console.warn(`PIXI Geometry attribute '${v}' size cannot be determined (likely the bound shader does not have the attribute)`),f[c[v].buffer]+=c[v].size*Fh[c[v].type];for(const v in c){const x=c[v],g=x.size;x.stride===void 0&&(f[x.buffer]===g*Fh[x.type]?x.stride=0:x.stride=f[x.buffer]),x.start===void 0&&(x.start=p[x.buffer],p[x.buffer]+=g*Fh[x.type])}h=n.createVertexArray(),n.bindVertexArray(h);for(let v=0;v<d.length;v++){const x=d[v];o.bind(x),i&&x._glBuffers[s].refCount++}return this.activateVao(e,a),u[a.id]=h,u[l]=h,n.bindVertexArray(null),o.unbind(gr.ARRAY_BUFFER),h}disposeGeometry(e,t){var a;if(!this.managedGeometries[e.id])return;delete this.managedGeometries[e.id];const i=e.glVertexArrayObjects[this.CONTEXT_UID],n=this.gl,s=e.buffers,o=(a=this.renderer)==null?void 0:a.buffer;if(e.disposeRunner.remove(this),!!i){if(o)for(let l=0;l<s.length;l++){const u=s[l]._glBuffers[this.CONTEXT_UID];u&&(u.refCount--,u.refCount===0&&!t&&o.dispose(s[l],t))}if(!t){for(const l in i)if(l[0]==="g"){const u=i[l];this._activeVao===u&&this.unbind(),n.deleteVertexArray(u)}}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(e){const t=Object.keys(this.managedGeometries);for(let i=0;i<t.length;i++)this.disposeGeometry(this.managedGeometries[t[i]],e)}activateVao(e,t){const i=this.gl,n=this.CONTEXT_UID,s=this.renderer.buffer,o=e.buffers,a=e.attributes;e.indexBuffer&&s.bind(e.indexBuffer);let l=null;for(const u in a){const h=a[u],d=o[h.buffer],c=d._glBuffers[n];if(t.attributeData[u]){l!==c&&(s.bind(d),l=c);const f=t.attributeData[u].location;if(i.enableVertexAttribArray(f),i.vertexAttribPointer(f,h.size,h.type||i.FLOAT,h.normalized,h.stride,h.start),h.instance)if(this.hasInstance)i.vertexAttribDivisor(f,h.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(e,t,i,n){const{gl:s}=this,o=this._activeGeometry;if(o.indexBuffer){const a=o.indexBuffer.data.BYTES_PER_ELEMENT,l=a===2?s.UNSIGNED_SHORT:s.UNSIGNED_INT;a===2||a===4&&this.canUseUInt32ElementIndex?o.instanced?s.drawElementsInstanced(e,t||o.indexBuffer.data.length,l,(i||0)*a,n||1):s.drawElements(e,t||o.indexBuffer.data.length,l,(i||0)*a):console.warn("unsupported index buffer type: uint32")}else o.instanced?s.drawArraysInstanced(e,i,t||o.getSize(),n||1):s.drawArrays(e,i,t||o.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}cx.extension={type:B.RendererSystem,name:"geometry"};V.add(cx);const Xg=new ye;class dx{constructor(e,t){this._texture=e,this.mapCoord=new ye,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof t>"u"?.5:t,this.isSimple=!1}get texture(){return this._texture}set texture(e){this._texture=e,this._textureID=-1}multiplyUvs(e,t){t===void 0&&(t=e);const i=this.mapCoord;for(let n=0;n<e.length;n+=2){const s=e[n],o=e[n+1];t[n]=s*i.a+o*i.c+i.tx,t[n+1]=s*i.b+o*i.d+i.ty}return t}update(e){const t=this._texture;if(!t||!t.valid||!e&&this._textureID===t._updateID)return!1;this._textureID=t._updateID,this._updateID++;const i=t._uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);const n=t.orig,s=t.trim;s&&(Xg.set(n.width/s.width,0,0,n.height/s.height,-s.x/s.width,-s.y/s.height),this.mapCoord.append(Xg));const o=t.baseTexture,a=this.uClampFrame,l=this.clampMargin/o.resolution,u=this.clampOffset;return a[0]=(t._frame.x+l+u)/o.width,a[1]=(t._frame.y+l+u)/o.height,a[2]=(t._frame.x+t._frame.width-l+u)/o.width,a[3]=(t._frame.y+t._frame.height-l+u)/o.height,this.uClampOffset[0]=u/o.realWidth,this.uClampOffset[1]=u/o.realHeight,this.isSimple=t._frame.width===o.width&&t._frame.height===o.height&&t.rotate===0,!0}}var QC=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,JC=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class eR extends nt{constructor(e,t,i){let n=null;typeof e!="string"&&t===void 0&&i===void 0&&(n=e,e=void 0,t=void 0,i=void 0),super(e||JC,t||QC,i),this.maskSprite=n,this.maskMatrix=new ye}get maskSprite(){return this._maskSprite}set maskSprite(e){this._maskSprite=e,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(e,t,i,n){const s=this._maskSprite,o=s._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new dx(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,s).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=s.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,e.applyFilter(this,t,i,n))}}class tR{constructor(e=null){this.type=Fe.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=nt.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(e){e?this._filters?this._filters[0]=e:this._filters=[e]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=Fe.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class fx{constructor(e){this.renderer=e,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)}push(e,t){let i=t;if(!i.isMaskData){const s=this.maskDataPool.pop()||new tR;s.pooled=!0,s.maskObject=t,i=s}const n=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(i.copyCountersOrReset(n),i._colorMask=n?n._colorMask:15,i.autoDetect&&this.detect(i),i._target=e,i.type!==Fe.SPRITE&&this.maskStack.push(i),i.enabled)switch(i.type){case Fe.SCISSOR:this.renderer.scissor.push(i);break;case Fe.STENCIL:this.renderer.stencil.push(i);break;case Fe.SPRITE:i.copyCountersOrReset(null),this.pushSpriteMask(i);break;case Fe.COLOR:this.pushColorMask(i);break}i.type===Fe.SPRITE&&this.maskStack.push(i)}pop(e){const t=this.maskStack.pop();if(!(!t||t._target!==e)){if(t.enabled)switch(t.type){case Fe.SCISSOR:this.renderer.scissor.pop(t);break;case Fe.STENCIL:this.renderer.stencil.pop(t.maskObject);break;case Fe.SPRITE:this.popSpriteMask(t);break;case Fe.COLOR:this.popColorMask(t);break}if(t.reset(),t.pooled&&this.maskDataPool.push(t),this.maskStack.length!==0){const i=this.maskStack[this.maskStack.length-1];i.type===Fe.SPRITE&&i._filters&&(i._filters[0].maskSprite=i.maskObject)}}}detect(e){const t=e.maskObject;t?t.isSprite?e.type=Fe.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(e)?e.type=Fe.SCISSOR:e.type=Fe.STENCIL:e.type=Fe.COLOR}pushSpriteMask(e){const{maskObject:t}=e,i=e._target;let n=e._filters;n||(n=this.alphaMaskPool[this.alphaMaskIndex],n||(n=this.alphaMaskPool[this.alphaMaskIndex]=[new eR])),n[0].resolution=e.resolution,n[0].multisample=e.multisample,n[0].maskSprite=t;const s=i.filterArea;i.filterArea=t.getBounds(!0),this.renderer.filter.push(i,n),i.filterArea=s,e._filters||this.alphaMaskIndex++}popSpriteMask(e){this.renderer.filter.pop(),e._filters?e._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(e){const t=e._colorMask,i=e._colorMask=t&e.colorMask;i!==t&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}popColorMask(e){const t=e._colorMask,i=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;i!==t&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}destroy(){this.renderer=null}}fx.extension={type:B.RendererSystem,name:"mask"};V.add(fx);class px{constructor(e){this.renderer=e,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(e){const{gl:t}=this.renderer,i=this.getStackLength();this.maskStack=e;const n=this.getStackLength();n!==i&&(n===0?t.disable(this.glConst):(t.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const jg=new ye,Wg=[],mx=class Qa extends px{constructor(e){super(e),this.glConst=U.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0}calcScissorRect(e){if(e._scissorRectLocal)return;const t=e._scissorRect,{maskObject:i}=e,{renderer:n}=this,s=n.renderTexture,o=i.getBounds(!0,Wg.pop()??new Z);this.roundFrameToPixels(o,s.current?s.current.resolution:n.resolution,s.sourceFrame,s.destinationFrame,n.projection.transform),t&&o.fit(t),e._scissorRectLocal=o}static isMatrixRotated(e){if(!e)return!1;const{a:t,b:i,c:n,d:s}=e;return(Math.abs(i)>1e-4||Math.abs(n)>1e-4)&&(Math.abs(t)>1e-4||Math.abs(s)>1e-4)}testScissor(e){const{maskObject:t}=e;if(!t.isFastRect||!t.isFastRect()||Qa.isMatrixRotated(t.worldTransform)||Qa.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(e);const i=e._scissorRectLocal;return i.width>0&&i.height>0}roundFrameToPixels(e,t,i,n,s){Qa.isMatrixRotated(s)||(s=s?jg.copyFrom(s):jg.identity(),s.translate(-i.x,-i.y).scale(n.width/i.width,n.height/i.height).translate(n.x,n.y),this.renderer.filter.transformAABB(s,e),e.fit(n),e.x=Math.round(e.x*t),e.y=Math.round(e.y*t),e.width=Math.round(e.width*t),e.height=Math.round(e.height*t))}push(e){e._scissorRectLocal||this.calcScissorRect(e);const{gl:t}=this.renderer;e._scissorRect||t.enable(t.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=e._scissorRectLocal,this._useCurrent()}pop(e){const{gl:t}=this.renderer;e&&Wg.push(e._scissorRectLocal),this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)}_useCurrent(){const e=this.maskStack[this.maskStack.length-1]._scissorRect;let t;this.renderer.renderTexture.current?t=e.y:t=this.renderer.height-e.height-e.y,this.renderer.gl.scissor(e.x,t,e.width,e.height)}};mx.extension={type:B.RendererSystem,name:"scissor"};let rR=mx;V.add(rR);class gx extends px{constructor(e){super(e),this.glConst=U.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0}push(e){const t=e.maskObject,{gl:i}=this.renderer,n=e._stencilCounter;n===0&&(this.renderer.framebuffer.forceStencil(),i.clearStencil(0),i.clear(i.STENCIL_BUFFER_BIT),i.enable(i.STENCIL_TEST)),e._stencilCounter++;const s=e._colorMask;s!==0&&(e._colorMask=0,i.colorMask(!1,!1,!1,!1)),i.stencilFunc(i.EQUAL,n,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.INCR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,s!==0&&(e._colorMask=s,i.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)),this._useCurrent()}pop(e){const t=this.renderer.gl;if(this.getStackLength()===0)t.disable(t.STENCIL_TEST);else{const i=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,n=i?i._colorMask:15;n!==0&&(i._colorMask=0,t.colorMask(!1,!1,!1,!1)),t.stencilOp(t.KEEP,t.KEEP,t.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,n!==0&&(i._colorMask=n,t.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)),this._useCurrent()}}_useCurrent(){const e=this.renderer.gl;e.stencilFunc(e.EQUAL,this.getStackLength(),4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}}gx.extension={type:B.RendererSystem,name:"stencil"};V.add(gx);class yx{constructor(e){this.renderer=e,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return ee("7.0.0","renderer.plugins.extract has moved to renderer.extract"),e.extract}},prepare:{enumerable:!1,get(){return ee("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),e.prepare}},interaction:{enumerable:!1,get(){return ee("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),e.events}}})}init(){const e=this.rendererPlugins;for(const t in e)this.plugins[t]=new e[t](this.renderer)}destroy(){for(const e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null}}yx.extension={type:[B.RendererSystem,B.CanvasRendererSystem],name:"_plugin"};V.add(yx);class vx{constructor(e){this.renderer=e,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new ye,this.transform=null}update(e,t,i,n){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=t||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,i,n),this.transform&&this.projectionMatrix.append(this.transform);const s=this.renderer;s.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,s.globalUniforms.update(),s.shader.shader&&s.shader.syncUniformGroup(s.shader.shader.uniforms.globals)}calculateProjection(e,t,i,n){const s=this.projectionMatrix,o=n?-1:1;s.identity(),s.a=1/t.width*2,s.d=o*(1/t.height*2),s.tx=-1-t.x*s.a,s.ty=-o-t.y*s.d}setTransform(e){}destroy(){this.renderer=null}}vx.extension={type:B.RendererSystem,name:"projection"};V.add(vx);const iR=new dp,Yg=new Z;class _x{constructor(e){this.renderer=e,this._tempMatrix=new ye}generateTexture(e,t){const{region:i,...n}=t||{},s=(i==null?void 0:i.copyTo(Yg))||e.getLocalBounds(Yg,!0),o=n.resolution||this.renderer.resolution;s.width=Math.max(s.width,1/o),s.height=Math.max(s.height,1/o),n.width=s.width,n.height=s.height,n.resolution=o,n.multisample??(n.multisample=this.renderer.multisample);const a=un.create(n);this._tempMatrix.tx=-s.x,this._tempMatrix.ty=-s.y;const l=e.transform;return e.transform=iR,this.renderer.render(e,{renderTexture:a,transform:this._tempMatrix,skipUpdateTransform:!!e.parent,blit:!0}),e.transform=l,a}destroy(){}}_x.extension={type:[B.RendererSystem,B.CanvasRendererSystem],name:"textureGenerator"};V.add(_x);const Ri=new Z,Rs=new Z;class xx{constructor(e){this.renderer=e,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new Z,this.destinationFrame=new Z,this.viewportFrame=new Z}contextChange(){var t;const e=(t=this.renderer)==null?void 0:t.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}bind(e=null,t,i){const n=this.renderer;this.current=e;let s,o,a;e?(s=e.baseTexture,a=s.resolution,t||(Ri.width=e.frame.width,Ri.height=e.frame.height,t=Ri),i||(Rs.x=e.frame.x,Rs.y=e.frame.y,Rs.width=t.width,Rs.height=t.height,i=Rs),o=s.framebuffer):(a=n.resolution,t||(Ri.width=n._view.screen.width,Ri.height=n._view.screen.height,t=Ri),i||(i=Ri,i.width=t.width,i.height=t.height));const l=this.viewportFrame;l.x=i.x*a,l.y=i.y*a,l.width=i.width*a,l.height=i.height*a,e||(l.y=n.view.height-(l.y+l.height)),l.ceil(),this.renderer.framebuffer.bind(o,l),this.renderer.projection.update(i,t,a,!o),e?this.renderer.mask.setMaskStack(s.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(t),this.destinationFrame.copyFrom(i)}clear(e,t){const i=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,n=me.shared.setValue(e||i);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&n.premultiply(n.alpha);const s=this.destinationFrame,o=this.current?this.current.baseTexture:this.renderer._view.screen,a=s.width!==o.width||s.height!==o.height;if(a){let{x:l,y:u,width:h,height:d}=this.viewportFrame;l=Math.round(l),u=Math.round(u),h=Math.round(h),d=Math.round(d),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(l,u,h,d)}this.renderer.framebuffer.clear(n.red,n.green,n.blue,n.alpha,t),a&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}xx.extension={type:B.RendererSystem,name:"renderTexture"};V.add(xx);class nR{constructor(e,t){this.program=e,this.uniformData=t,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function sR(r,e){const t={},i=e.getProgramParameter(r,e.ACTIVE_ATTRIBUTES);for(let n=0;n<i;n++){const s=e.getActiveAttrib(r,n);if(s.name.startsWith("gl_"))continue;const o=ix(e,s.type),a={type:o,name:s.name,size:rx(o),location:e.getAttribLocation(r,s.name)};t[s.name]=a}return t}function oR(r,e){const t={},i=e.getProgramParameter(r,e.ACTIVE_UNIFORMS);for(let n=0;n<i;n++){const s=e.getActiveUniform(r,n),o=s.name.replace(/\[.*?\]$/,""),a=!!s.name.match(/\[.*?\]$/),l=ix(e,s.type);t[o]={name:o,index:n,type:l,size:s.size,isArray:a,value:ex(l,s.size)}}return t}function aR(r,e){var a;const t=Ug(r,r.VERTEX_SHADER,e.vertexSrc),i=Ug(r,r.FRAGMENT_SHADER,e.fragmentSrc),n=r.createProgram();r.attachShader(n,t),r.attachShader(n,i);const s=(a=e.extra)==null?void 0:a.transformFeedbackVaryings;if(s&&(typeof r.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):r.transformFeedbackVaryings(n,s.names,s.bufferMode==="separate"?r.SEPARATE_ATTRIBS:r.INTERLEAVED_ATTRIBS)),r.linkProgram(n),r.getProgramParameter(n,r.LINK_STATUS)||BC(r,n,t,i),e.attributeData=sR(n,r),e.uniformData=oR(n,r),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertexSrc)){const l=Object.keys(e.attributeData);l.sort((u,h)=>u>h?1:-1);for(let u=0;u<l.length;u++)e.attributeData[l[u]].location=u,r.bindAttribLocation(n,u,l[u]);r.linkProgram(n)}r.deleteShader(t),r.deleteShader(i);const o={};for(const l in e.uniformData){const u=e.uniformData[l];o[l]={location:r.getUniformLocation(n,l),value:ex(u.type,u.size)}}return new nR(n,o)}function lR(r,e,t,i,n){t.buffer.update(n)}const uR={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},wx={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function hR(r){const e=r.map(s=>({data:s,offset:0,dataLen:0,dirty:0}));let t=0,i=0,n=0;for(let s=0;s<e.length;s++){const o=e[s];if(t=wx[o.data.type],o.data.size>1&&(t=Math.max(t,16)*o.data.size),o.dataLen=t,i%t!==0&&i<16){const a=i%t%16;i+=a,n+=a}i+t>16?(n=Math.ceil(n/16)*16,o.offset=n,n+=t,i=t):(o.offset=n,i+=t,n+=t)}return n=Math.ceil(n/16)*16,{uboElements:e,size:n}}function cR(r,e){const t=[];for(const i in r)e[i]&&t.push(e[i]);return t.sort((i,n)=>i.index-n.index),t}function dR(r,e){if(!r.autoManage)return{size:0,syncFunc:lR};const t=cR(r.uniforms,e),{uboElements:i,size:n}=hR(t),s=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let o=0;o<i.length;o++){const a=i[o],l=r.uniforms[a.data.name],u=a.data.name;let h=!1;for(let d=0;d<qn.length;d++){const c=qn[d];if(c.codeUbo&&c.test(a.data,l)){s.push(`offset = ${a.offset/4};`,qn[d].codeUbo(a.data.name,l)),h=!0;break}}if(!h)if(a.data.size>1){const d=rx(a.data.type),c=Math.max(wx[a.data.type]/16,1),f=d/c,p=(4-f%4)%4;s.push(`
                cv = ud.${u}.value;
                v = uv.${u};
                offset = ${a.offset/4};

                t = 0;

                for(var i=0; i < ${a.data.size*c}; i++)
                {
                    for(var j = 0; j < ${f}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${p};
                }

                `)}else{const d=uR[a.data.type];s.push(`
                cv = ud.${u}.value;
                v = uv.${u};
                offset = ${a.offset/4};
                ${d};
                `)}}return s.push(`
       renderer.buffer.update(buffer);
    `),{size:n,syncFunc:new Function("ud","uv","renderer","syncData","buffer",s.join(`
`))}}let fR=0;const _a={textureCount:0,uboCount:0};class Ex{constructor(e){this.destroyed=!1,this.renderer=e,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=fR++}systemCheck(){if(!FC())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(e){this.gl=e,this.reset()}bind(e,t){e.disposeRunner.add(this),e.uniforms.globals=this.renderer.globalUniforms;const i=e.program,n=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(e);return this.shader=e,this.program!==i&&(this.program=i,this.gl.useProgram(n.program)),t||(_a.textureCount=0,_a.uboCount=0,this.syncUniformGroup(e.uniformGroup,_a)),n}setUniforms(e){const t=this.shader.program,i=t.glPrograms[this.renderer.CONTEXT_UID];t.syncUniforms(i.uniformData,e,this.renderer)}syncUniformGroup(e,t){const i=this.getGlProgram();(!e.static||e.dirtyId!==i.uniformDirtyGroups[e.id])&&(i.uniformDirtyGroups[e.id]=e.dirtyId,this.syncUniforms(e,i,t))}syncUniforms(e,t,i){(e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e))(t.uniformData,e.uniforms,this.renderer,i)}createSyncGroups(e){const t=this.getSignature(e,this.shader.program.uniformData,"u");return this.cache[t]||(this.cache[t]=DC(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[t],e.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(e,t){const i=this.getGlProgram();if(!e.static||e.dirtyId!==0||!i.uniformGroups[e.id]){e.dirtyId=0;const n=i.uniformGroups[e.id]||this.createSyncBufferGroup(e,i,t);e.buffer.update(),n(i.uniformData,e.uniforms,this.renderer,_a,e.buffer)}this.renderer.buffer.bindBufferBase(e.buffer,i.uniformBufferBindings[t])}createSyncBufferGroup(e,t,i){const{gl:n}=this.renderer;this.renderer.buffer.bind(e.buffer);const s=this.gl.getUniformBlockIndex(t.program,i);t.uniformBufferBindings[i]=this.shader.uniformBindCount,n.uniformBlockBinding(t.program,s,this.shader.uniformBindCount),this.shader.uniformBindCount++;const o=this.getSignature(e,this.shader.program.uniformData,"ubo");let a=this._uboCache[o];if(a||(a=this._uboCache[o]=dR(e,this.shader.program.uniformData)),e.autoManage){const l=new Float32Array(a.size/4);e.buffer.update(l)}return t.uniformGroups[e.id]=a.syncFunc,t.uniformGroups[e.id]}getSignature(e,t,i){const n=e.uniforms,s=[`${i}-`];for(const o in n)s.push(o),t[o]&&s.push(t[o].type);return s.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(e){const t=this.gl,i=e.program,n=aR(t,i);return i.glPrograms[this.renderer.CONTEXT_UID]=n,n}reset(){this.program=null,this.shader=null}disposeShader(e){this.shader===e&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}Ex.extension={type:B.RendererSystem,name:"shader"};V.add(Ex);class zl{constructor(e){this.renderer=e}run(e){const{renderer:t}=this;t.runners.init.emit(t.options),e.hello&&console.log(`PixiJS 7.4.3 - ${t.rendererLogId} - https://pixijs.com`),t.resize(t.screen.width,t.screen.height)}destroy(){}}zl.defaultOptions={hello:!1},zl.extension={type:[B.RendererSystem,B.CanvasRendererSystem],name:"startup"};V.add(zl);function pR(r,e=[]){return e[q.NORMAL]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[q.ADD]=[r.ONE,r.ONE],e[q.MULTIPLY]=[r.DST_COLOR,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA],e[q.SCREEN]=[r.ONE,r.ONE_MINUS_SRC_COLOR,r.ONE,r.ONE_MINUS_SRC_ALPHA],e[q.OVERLAY]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[q.DARKEN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[q.LIGHTEN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[q.COLOR_DODGE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[q.COLOR_BURN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[q.HARD_LIGHT]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[q.SOFT_LIGHT]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[q.DIFFERENCE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[q.EXCLUSION]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[q.HUE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[q.SATURATION]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[q.COLOR]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[q.LUMINOSITY]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[q.NONE]=[0,0],e[q.NORMAL_NPM]=[r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA],e[q.ADD_NPM]=[r.SRC_ALPHA,r.ONE,r.ONE,r.ONE],e[q.SCREEN_NPM]=[r.SRC_ALPHA,r.ONE_MINUS_SRC_COLOR,r.ONE,r.ONE_MINUS_SRC_ALPHA],e[q.SRC_IN]=[r.DST_ALPHA,r.ZERO],e[q.SRC_OUT]=[r.ONE_MINUS_DST_ALPHA,r.ZERO],e[q.SRC_ATOP]=[r.DST_ALPHA,r.ONE_MINUS_SRC_ALPHA],e[q.DST_OVER]=[r.ONE_MINUS_DST_ALPHA,r.ONE],e[q.DST_IN]=[r.ZERO,r.SRC_ALPHA],e[q.DST_OUT]=[r.ZERO,r.ONE_MINUS_SRC_ALPHA],e[q.DST_ATOP]=[r.ONE_MINUS_DST_ALPHA,r.SRC_ALPHA],e[q.XOR]=[r.ONE_MINUS_DST_ALPHA,r.ONE_MINUS_SRC_ALPHA],e[q.SUBTRACT]=[r.ONE,r.ONE,r.ONE,r.ONE,r.FUNC_REVERSE_SUBTRACT,r.FUNC_ADD],e}const mR=0,gR=1,yR=2,vR=3,_R=4,xR=5,Tx=class Id{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=q.NONE,this._blendEq=!1,this.map=[],this.map[mR]=this.setBlend,this.map[gR]=this.setOffset,this.map[yR]=this.setCullFace,this.map[vR]=this.setDepthTest,this.map[_R]=this.setFrontFace,this.map[xR]=this.setDepthMask,this.checks=[],this.defaultState=new wr,this.defaultState.blend=!0}contextChange(e){this.gl=e,this.blendModes=pR(e),this.set(this.defaultState),this.reset()}set(e){if(e=e||this.defaultState,this.stateId!==e.data){let t=this.stateId^e.data,i=0;for(;t;)t&1&&this.map[i].call(this,!!(e.data&1<<i)),t=t>>1,i++;this.stateId=e.data}for(let t=0;t<this.checks.length;t++)this.checks[t](this,e)}forceState(e){e=e||this.defaultState;for(let t=0;t<this.map.length;t++)this.map[t].call(this,!!(e.data&1<<t));for(let t=0;t<this.checks.length;t++)this.checks[t](this,e);this.stateId=e.data}setBlend(e){this.updateCheck(Id.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)}setOffset(e){this.updateCheck(Id.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(e){this.gl.depthMask(e)}setCullFace(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])}setBlendMode(e){if(e===this.blendMode)return;this.blendMode=e;const t=this.blendModes[e],i=this.gl;t.length===2?i.blendFunc(t[0],t[1]):i.blendFuncSeparate(t[0],t[1],t[2],t[3]),t.length===6?(this._blendEq=!0,i.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}setPolygonOffset(e,t){this.gl.polygonOffset(e,t)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(e,t){const i=this.checks.indexOf(e);t&&i===-1?this.checks.push(e):!t&&i!==-1&&this.checks.splice(i,1)}static checkBlendMode(e,t){e.setBlendMode(t.blendMode)}static checkPolygonOffset(e,t){e.setPolygonOffset(1,t.polygonOffset)}destroy(){this.gl=null}};Tx.extension={type:B.RendererSystem,name:"state"};let wR=Tx;V.add(wR);class ER extends Oo{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(e){this.addRunners(...e.runners);const t=(e.priority??[]).filter(n=>e.systems[n]),i=[...t,...Object.keys(e.systems).filter(n=>!t.includes(n))];for(const n of i)this.addSystem(e.systems[n],n)}addRunners(...e){e.forEach(t=>{this.runners[t]=new qt(t)})}addSystem(e,t){const i=new e(this);if(this[t])throw new Error(`Whoops! The name "${t}" is already in use`);this[t]=i,this._systemsHash[t]=i;for(const n in this.runners)this.runners[n].add(i);return this}emitWithCustomOptions(e,t){const i=Object.keys(this._systemsHash);e.items.forEach(n=>{const s=i.find(o=>this._systemsHash[o]===n);n[e.name](t[s])})}destroy(){Object.values(this.runners).forEach(e=>{e.destroy()}),this._systemsHash={}}}const Ls=class Ja{constructor(e){this.renderer=e,this.count=0,this.checkCount=0,this.maxIdle=Ja.defaultMaxIdle,this.checkCountMax=Ja.defaultCheckCountMax,this.mode=Ja.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==np.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const e=this.renderer.texture,t=e.managedTextures;let i=!1;for(let n=0;n<t.length;n++){const s=t[n];s.resource&&this.count-s.touched>this.maxIdle&&(e.destroyTexture(s,!0),t[n]=null,i=!0)}if(i){let n=0;for(let s=0;s<t.length;s++)t[s]!==null&&(t[n++]=t[s]);t.length=n}}unload(e){const t=this.renderer.texture,i=e._texture;i&&!i.framebuffer&&t.destroyTexture(i);for(let n=e.children.length-1;n>=0;n--)this.unload(e.children[n])}destroy(){this.renderer=null}};Ls.defaultMode=np.AUTO,Ls.defaultMaxIdle=60*60,Ls.defaultCheckCountMax=60*10,Ls.extension={type:B.RendererSystem,name:"textureGC"};let Li=Ls;V.add(Li);class Uh{constructor(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=W.UNSIGNED_BYTE,this.internalFormat=O.RGBA,this.samplerType=0}}function TR(r){let e;return"WebGL2RenderingContext"in globalThis&&r instanceof globalThis.WebGL2RenderingContext?e={[r.RGB]:F.FLOAT,[r.RGBA]:F.FLOAT,[r.ALPHA]:F.FLOAT,[r.LUMINANCE]:F.FLOAT,[r.LUMINANCE_ALPHA]:F.FLOAT,[r.R8]:F.FLOAT,[r.R8_SNORM]:F.FLOAT,[r.RG8]:F.FLOAT,[r.RG8_SNORM]:F.FLOAT,[r.RGB8]:F.FLOAT,[r.RGB8_SNORM]:F.FLOAT,[r.RGB565]:F.FLOAT,[r.RGBA4]:F.FLOAT,[r.RGB5_A1]:F.FLOAT,[r.RGBA8]:F.FLOAT,[r.RGBA8_SNORM]:F.FLOAT,[r.RGB10_A2]:F.FLOAT,[r.RGB10_A2UI]:F.FLOAT,[r.SRGB8]:F.FLOAT,[r.SRGB8_ALPHA8]:F.FLOAT,[r.R16F]:F.FLOAT,[r.RG16F]:F.FLOAT,[r.RGB16F]:F.FLOAT,[r.RGBA16F]:F.FLOAT,[r.R32F]:F.FLOAT,[r.RG32F]:F.FLOAT,[r.RGB32F]:F.FLOAT,[r.RGBA32F]:F.FLOAT,[r.R11F_G11F_B10F]:F.FLOAT,[r.RGB9_E5]:F.FLOAT,[r.R8I]:F.INT,[r.R8UI]:F.UINT,[r.R16I]:F.INT,[r.R16UI]:F.UINT,[r.R32I]:F.INT,[r.R32UI]:F.UINT,[r.RG8I]:F.INT,[r.RG8UI]:F.UINT,[r.RG16I]:F.INT,[r.RG16UI]:F.UINT,[r.RG32I]:F.INT,[r.RG32UI]:F.UINT,[r.RGB8I]:F.INT,[r.RGB8UI]:F.UINT,[r.RGB16I]:F.INT,[r.RGB16UI]:F.UINT,[r.RGB32I]:F.INT,[r.RGB32UI]:F.UINT,[r.RGBA8I]:F.INT,[r.RGBA8UI]:F.UINT,[r.RGBA16I]:F.INT,[r.RGBA16UI]:F.UINT,[r.RGBA32I]:F.INT,[r.RGBA32UI]:F.UINT,[r.DEPTH_COMPONENT16]:F.FLOAT,[r.DEPTH_COMPONENT24]:F.FLOAT,[r.DEPTH_COMPONENT32F]:F.FLOAT,[r.DEPTH_STENCIL]:F.FLOAT,[r.DEPTH24_STENCIL8]:F.FLOAT,[r.DEPTH32F_STENCIL8]:F.FLOAT}:e={[r.RGB]:F.FLOAT,[r.RGBA]:F.FLOAT,[r.ALPHA]:F.FLOAT,[r.LUMINANCE]:F.FLOAT,[r.LUMINANCE_ALPHA]:F.FLOAT,[r.DEPTH_STENCIL]:F.FLOAT},e}function SR(r){let e;return"WebGL2RenderingContext"in globalThis&&r instanceof globalThis.WebGL2RenderingContext?e={[W.UNSIGNED_BYTE]:{[O.RGBA]:r.RGBA8,[O.RGB]:r.RGB8,[O.RG]:r.RG8,[O.RED]:r.R8,[O.RGBA_INTEGER]:r.RGBA8UI,[O.RGB_INTEGER]:r.RGB8UI,[O.RG_INTEGER]:r.RG8UI,[O.RED_INTEGER]:r.R8UI,[O.ALPHA]:r.ALPHA,[O.LUMINANCE]:r.LUMINANCE,[O.LUMINANCE_ALPHA]:r.LUMINANCE_ALPHA},[W.BYTE]:{[O.RGBA]:r.RGBA8_SNORM,[O.RGB]:r.RGB8_SNORM,[O.RG]:r.RG8_SNORM,[O.RED]:r.R8_SNORM,[O.RGBA_INTEGER]:r.RGBA8I,[O.RGB_INTEGER]:r.RGB8I,[O.RG_INTEGER]:r.RG8I,[O.RED_INTEGER]:r.R8I},[W.UNSIGNED_SHORT]:{[O.RGBA_INTEGER]:r.RGBA16UI,[O.RGB_INTEGER]:r.RGB16UI,[O.RG_INTEGER]:r.RG16UI,[O.RED_INTEGER]:r.R16UI,[O.DEPTH_COMPONENT]:r.DEPTH_COMPONENT16},[W.SHORT]:{[O.RGBA_INTEGER]:r.RGBA16I,[O.RGB_INTEGER]:r.RGB16I,[O.RG_INTEGER]:r.RG16I,[O.RED_INTEGER]:r.R16I},[W.UNSIGNED_INT]:{[O.RGBA_INTEGER]:r.RGBA32UI,[O.RGB_INTEGER]:r.RGB32UI,[O.RG_INTEGER]:r.RG32UI,[O.RED_INTEGER]:r.R32UI,[O.DEPTH_COMPONENT]:r.DEPTH_COMPONENT24},[W.INT]:{[O.RGBA_INTEGER]:r.RGBA32I,[O.RGB_INTEGER]:r.RGB32I,[O.RG_INTEGER]:r.RG32I,[O.RED_INTEGER]:r.R32I},[W.FLOAT]:{[O.RGBA]:r.RGBA32F,[O.RGB]:r.RGB32F,[O.RG]:r.RG32F,[O.RED]:r.R32F,[O.DEPTH_COMPONENT]:r.DEPTH_COMPONENT32F},[W.HALF_FLOAT]:{[O.RGBA]:r.RGBA16F,[O.RGB]:r.RGB16F,[O.RG]:r.RG16F,[O.RED]:r.R16F},[W.UNSIGNED_SHORT_5_6_5]:{[O.RGB]:r.RGB565},[W.UNSIGNED_SHORT_4_4_4_4]:{[O.RGBA]:r.RGBA4},[W.UNSIGNED_SHORT_5_5_5_1]:{[O.RGBA]:r.RGB5_A1},[W.UNSIGNED_INT_2_10_10_10_REV]:{[O.RGBA]:r.RGB10_A2,[O.RGBA_INTEGER]:r.RGB10_A2UI},[W.UNSIGNED_INT_10F_11F_11F_REV]:{[O.RGB]:r.R11F_G11F_B10F},[W.UNSIGNED_INT_5_9_9_9_REV]:{[O.RGB]:r.RGB9_E5},[W.UNSIGNED_INT_24_8]:{[O.DEPTH_STENCIL]:r.DEPTH24_STENCIL8},[W.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[O.DEPTH_STENCIL]:r.DEPTH32F_STENCIL8}}:e={[W.UNSIGNED_BYTE]:{[O.RGBA]:r.RGBA,[O.RGB]:r.RGB,[O.ALPHA]:r.ALPHA,[O.LUMINANCE]:r.LUMINANCE,[O.LUMINANCE_ALPHA]:r.LUMINANCE_ALPHA},[W.UNSIGNED_SHORT_5_6_5]:{[O.RGB]:r.RGB},[W.UNSIGNED_SHORT_4_4_4_4]:{[O.RGBA]:r.RGBA},[W.UNSIGNED_SHORT_5_5_5_1]:{[O.RGBA]:r.RGBA}},e}class Sx{constructor(e){this.renderer=e,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new K,this.hasIntegerTextures=!1}contextChange(){const e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=SR(e),this.samplerTypes=TR(e);const t=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=t;for(let n=0;n<t;n++)this.boundTextures[n]=null;this.emptyTextures={};const i=new Uh(e.createTexture());e.bindTexture(e.TEXTURE_2D,i.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=i,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new Uh(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture);for(let n=0;n<6;n++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR);for(let n=0;n<this.boundTextures.length;n++)this.bind(null,n)}bind(e,t=0){const{gl:i}=this;if(e=e==null?void 0:e.castToBaseTexture(),(e==null?void 0:e.valid)&&!e.parentTextureArray){e.touched=this.renderer.textureGC.count;const n=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[t]!==e&&(this.currentLocation!==t&&(this.currentLocation=t,i.activeTexture(i.TEXTURE0+t)),i.bindTexture(e.target,n.texture)),n.dirtyId!==e.dirtyId?(this.currentLocation!==t&&(this.currentLocation=t,i.activeTexture(i.TEXTURE0+t)),this.updateTexture(e)):n.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(e),this.boundTextures[t]=e}else this.currentLocation!==t&&(this.currentLocation=t,i.activeTexture(i.TEXTURE0+t)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[t]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture}unbind(e){const{gl:t,boundTextures:i}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let n=0;n<i.length;n++)i[n]===this.unknownTexture&&this.bind(null,n)}for(let n=0;n<i.length;n++)i[n]===e&&(this.currentLocation!==n&&(t.activeTexture(t.TEXTURE0+n),this.currentLocation=n),t.bindTexture(e.target,this.emptyTextures[e.target].texture),i[n]=null)}ensureSamplerType(e){const{boundTextures:t,hasIntegerTextures:i,CONTEXT_UID:n}=this;if(i)for(let s=e-1;s>=0;--s){const o=t[s];o&&o._glTextures[n].samplerType!==F.FLOAT&&this.renderer.texture.unbind(o)}}initTexture(e){const t=new Uh(this.gl.createTexture());return t.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=t,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),t}initTextureType(e,t){var i;t.internalFormat=((i=this.internalFormats[e.type])==null?void 0:i[e.format])??e.format,t.samplerType=this.samplerTypes[t.internalFormat]??F.FLOAT,this.webGLVersion===2&&e.type===W.HALF_FLOAT?t.type=this.gl.HALF_FLOAT:t.type=e.type}updateTexture(e){var n;const t=e._glTextures[this.CONTEXT_UID];if(!t)return;const i=this.renderer;if(this.initTextureType(e,t),(n=e.resource)==null?void 0:n.upload(i,e,t))t.samplerType!==F.FLOAT&&(this.hasIntegerTextures=!0);else{const s=e.realWidth,o=e.realHeight,a=i.gl;(t.width!==s||t.height!==o||t.dirtyId<0)&&(t.width=s,t.height=o,a.texImage2D(e.target,0,t.internalFormat,s,o,0,e.format,t.type,null))}e.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(e),t.dirtyId=e.dirtyId}destroyTexture(e,t){const{gl:i}=this;if(e=e.castToBaseTexture(),e._glTextures[this.CONTEXT_UID]&&(this.unbind(e),i.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!t)){const n=this.managedTextures.indexOf(e);n!==-1&&Yn(this.managedTextures,n,1)}}updateTextureStyle(e){var i;const t=e._glTextures[this.CONTEXT_UID];t&&((e.mipmap===_r.POW2||this.webGLVersion!==2)&&!e.isPowerOfTwo?t.mipmap=!1:t.mipmap=e.mipmap>=1,this.webGLVersion!==2&&!e.isPowerOfTwo?t.wrapMode=mi.CLAMP:t.wrapMode=e.wrapMode,(i=e.resource)!=null&&i.style(this.renderer,e,t)||this.setStyle(e,t),t.dirtyStyleId=e.dirtyStyleId)}setStyle(e,t){const i=this.gl;if(t.mipmap&&e.mipmap!==_r.ON_MANUAL&&i.generateMipmap(e.target),i.texParameteri(e.target,i.TEXTURE_WRAP_S,t.wrapMode),i.texParameteri(e.target,i.TEXTURE_WRAP_T,t.wrapMode),t.mipmap){i.texParameteri(e.target,i.TEXTURE_MIN_FILTER,e.scaleMode===Mr.LINEAR?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);const n=this.renderer.context.extensions.anisotropicFiltering;if(n&&e.anisotropicLevel>0&&e.scaleMode===Mr.LINEAR){const s=Math.min(e.anisotropicLevel,i.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(e.target,n.TEXTURE_MAX_ANISOTROPY_EXT,s)}}else i.texParameteri(e.target,i.TEXTURE_MIN_FILTER,e.scaleMode===Mr.LINEAR?i.LINEAR:i.NEAREST);i.texParameteri(e.target,i.TEXTURE_MAG_FILTER,e.scaleMode===Mr.LINEAR?i.LINEAR:i.NEAREST)}destroy(){this.renderer=null}}Sx.extension={type:B.RendererSystem,name:"texture"};V.add(Sx);class Ax{constructor(e){this.renderer=e}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:t,CONTEXT_UID:i}=this,n=e._glTransformFeedbacks[i]||this.createGLTransformFeedback(e);t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,n)}unbind(){const{gl:e}=this;e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(e,t){const{gl:i,renderer:n}=this;t&&n.shader.bind(t),i.beginTransformFeedback(e)}endTransformFeedback(){const{gl:e}=this;e.endTransformFeedback()}createGLTransformFeedback(e){const{gl:t,renderer:i,CONTEXT_UID:n}=this,s=t.createTransformFeedback();e._glTransformFeedbacks[n]=s,t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,s);for(let o=0;o<e.buffers.length;o++){const a=e.buffers[o];a&&(i.buffer.update(a),a._glBuffers[n].refCount++,t.bindBufferBase(t.TRANSFORM_FEEDBACK_BUFFER,o,a._glBuffers[n].buffer||null))}return t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null),e.disposeRunner.add(this),s}disposeTransformFeedback(e,t){const i=e._glTransformFeedbacks[this.CONTEXT_UID],n=this.gl;e.disposeRunner.remove(this);const s=this.renderer.buffer;if(s)for(let o=0;o<e.buffers.length;o++){const a=e.buffers[o];if(!a)continue;const l=a._glBuffers[this.CONTEXT_UID];l&&(l.refCount--,l.refCount===0&&!t&&s.dispose(a,t))}i&&(t||n.deleteTransformFeedback(i),delete e._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}Ax.extension={type:B.RendererSystem,name:"transformFeedback"};V.add(Ax);class Vl{constructor(e){this.renderer=e}init(e){this.screen=new Z(0,0,e.width,e.height),this.element=e.view||U.ADAPTER.createCanvas(),this.resolution=e.resolution||U.RESOLUTION,this.autoDensity=!!e.autoDensity}resizeView(e,t){this.element.width=Math.round(e*this.resolution),this.element.height=Math.round(t*this.resolution);const i=this.element.width/this.resolution,n=this.element.height/this.resolution;this.screen.width=i,this.screen.height=n,this.autoDensity&&(this.element.style.width=`${i}px`,this.element.style.height=`${n}px`),this.renderer.emit("resize",i,n),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(e){var t;e&&((t=this.element.parentNode)==null||t.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}Vl.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},Vl.extension={type:[B.RendererSystem,B.CanvasRendererSystem],name:"_view"};V.add(Vl);U.PREFER_ENV=an.WEBGL2;U.STRICT_TEXTURE_CACHE=!1;U.RENDER_OPTIONS={...$l.defaultOptions,...Hl.defaultOptions,...Vl.defaultOptions,...zl.defaultOptions};Object.defineProperties(U,{WRAP_MODE:{get(){return K.defaultOptions.wrapMode},set(r){ee("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),K.defaultOptions.wrapMode=r}},SCALE_MODE:{get(){return K.defaultOptions.scaleMode},set(r){ee("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),K.defaultOptions.scaleMode=r}},MIPMAP_TEXTURES:{get(){return K.defaultOptions.mipmap},set(r){ee("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),K.defaultOptions.mipmap=r}},ANISOTROPIC_LEVEL:{get(){return K.defaultOptions.anisotropicLevel},set(r){ee("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),K.defaultOptions.anisotropicLevel=r}},FILTER_RESOLUTION:{get(){return ee("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),nt.defaultResolution},set(r){nt.defaultResolution=r}},FILTER_MULTISAMPLE:{get(){return ee("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),nt.defaultMultisample},set(r){nt.defaultMultisample=r}},SPRITE_MAX_TEXTURES:{get(){return Bi.defaultMaxTextures},set(r){ee("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),Bi.defaultMaxTextures=r}},SPRITE_BATCH_SIZE:{get(){return Bi.defaultBatchSize},set(r){ee("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),Bi.defaultBatchSize=r}},CAN_UPLOAD_SAME_BUFFER:{get(){return Bi.canUploadSameBuffer},set(r){ee("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),Bi.canUploadSameBuffer=r}},GC_MODE:{get(){return Li.defaultMode},set(r){ee("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),Li.defaultMode=r}},GC_MAX_IDLE:{get(){return Li.defaultMaxIdle},set(r){ee("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),Li.defaultMaxIdle=r}},GC_MAX_CHECK_COUNT:{get(){return Li.defaultCheckCountMax},set(r){ee("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),Li.defaultCheckCountMax=r}},PRECISION_VERTEX:{get(){return Or.defaultVertexPrecision},set(r){ee("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),Or.defaultVertexPrecision=r}},PRECISION_FRAGMENT:{get(){return Or.defaultFragmentPrecision},set(r){ee("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),Or.defaultFragmentPrecision=r}}});var rn=(r=>(r[r.INTERACTION=50]="INTERACTION",r[r.HIGH=25]="HIGH",r[r.NORMAL=0]="NORMAL",r[r.LOW=-25]="LOW",r[r.UTILITY=-50]="UTILITY",r))(rn||{});class Gh{constructor(e,t=null,i=0,n=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=e,this.context=t,this.priority=i,this.once=n}match(e,t=null){return this.fn===e&&this.context===t}emit(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));const t=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),t}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const t=this.next;return this.next=e?null:t,this.previous=null,t}}const bx=class gt{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Gh(null,null,1/0),this.deltaMS=1/gt.targetFPMS,this.elapsedMS=1/gt.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,t,i=rn.NORMAL){return this._addListener(new Gh(e,t,i))}addOnce(e,t,i=rn.NORMAL){return this._addListener(new Gh(e,t,i,!0))}_addListener(e){let t=this._head.next,i=this._head;if(!t)e.connect(i);else{for(;t;){if(e.priority>t.priority){e.connect(i);break}i=t,t=t.next}e.previous||e.connect(i)}return this._startIfPossible(),this}remove(e,t){let i=this._head.next;for(;i;)i.match(e,t)?i=i.destroy():i=i.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,t=this._head;for(;t=t.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let t;if(e>this.lastTime){if(t=this.elapsedMS=e-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){const s=e-this._lastFrame|0;if(s<this._minElapsedMS)return;this._lastFrame=e-s%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*gt.targetFPMS;const i=this._head;let n=i.next;for(;n;)n=n.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const t=Math.min(this.maxFPS,e),i=Math.min(Math.max(0,t)/1e3,gt.targetFPMS);this._maxElapsedMS=1/i}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{const t=Math.max(this.minFPS,e);this._minElapsedMS=1/(t/1e3)}}static get shared(){if(!gt._shared){const e=gt._shared=new gt;e.autoStart=!0,e._protected=!0}return gt._shared}static get system(){if(!gt._system){const e=gt._system=new gt;e.autoStart=!0,e._protected=!0}return gt._system}};bx.targetFPMS=.06;let _t=bx;Object.defineProperties(U,{TARGET_FPMS:{get(){return _t.targetFPMS},set(r){ee("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),_t.targetFPMS=r}}});class Cx{static init(e){e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,rn.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?_t.shared:new _t,e.autoStart&&this.start()}static destroy(){if(this._ticker){const e=this._ticker;this.ticker=null,e.destroy()}}}Cx.extension=B.Application;V.add(Cx);const Rx=[];V.handleByList(B.Renderer,Rx);function AR(r){for(const e of Rx)if(e.test(r))return new e(r);throw new Error("Unable to auto-detect a suitable renderer.")}var bR=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,CR=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const RR=bR,Ix=CR;class Px{constructor(e){this.renderer=e}contextChange(e){let t;if(this.renderer.context.webGLVersion===1){const i=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,null),t=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.FRAMEBUFFER,i)}else{const i=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING);e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),t=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,i)}t>=Ne.HIGH?this.multisample=Ne.HIGH:t>=Ne.MEDIUM?this.multisample=Ne.MEDIUM:t>=Ne.LOW?this.multisample=Ne.LOW:this.multisample=Ne.NONE}destroy(){}}Px.extension={type:B.RendererSystem,name:"_multisample"};V.add(Px);class IR{constructor(e){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class kx{constructor(e){this.renderer=e,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:t,CONTEXT_UID:i}=this,n=e._glBuffers[i]||this.createGLBuffer(e);t.bindBuffer(e.type,n.buffer)}unbind(e){const{gl:t}=this;t.bindBuffer(e,null)}bindBufferBase(e,t){const{gl:i,CONTEXT_UID:n}=this;if(this.boundBufferBases[t]!==e){const s=e._glBuffers[n]||this.createGLBuffer(e);this.boundBufferBases[t]=e,i.bindBufferBase(i.UNIFORM_BUFFER,t,s.buffer)}}bindBufferRange(e,t,i){const{gl:n,CONTEXT_UID:s}=this;i=i||0;const o=e._glBuffers[s]||this.createGLBuffer(e);n.bindBufferRange(n.UNIFORM_BUFFER,t||0,o.buffer,i*256,256)}update(e){const{gl:t,CONTEXT_UID:i}=this,n=e._glBuffers[i]||this.createGLBuffer(e);if(e._updateID!==n.updateID)if(n.updateID=e._updateID,t.bindBuffer(e.type,n.buffer),n.byteLength>=e.data.byteLength)t.bufferSubData(e.type,0,e.data);else{const s=e.static?t.STATIC_DRAW:t.DYNAMIC_DRAW;n.byteLength=e.data.byteLength,t.bufferData(e.type,e.data,s)}}dispose(e,t){if(!this.managedBuffers[e.id])return;delete this.managedBuffers[e.id];const i=e._glBuffers[this.CONTEXT_UID],n=this.gl;e.disposeRunner.remove(this),i&&(t||n.deleteBuffer(i.buffer),delete e._glBuffers[this.CONTEXT_UID])}disposeAll(e){const t=Object.keys(this.managedBuffers);for(let i=0;i<t.length;i++)this.dispose(this.managedBuffers[t[i]],e)}createGLBuffer(e){const{CONTEXT_UID:t,gl:i}=this;return e._glBuffers[t]=new IR(i.createBuffer()),this.managedBuffers[e.id]=e,e.disposeRunner.add(this),e._glBuffers[t]}}kx.extension={type:B.RendererSystem,name:"buffer"};V.add(kx);class Mx{constructor(e){this.renderer=e}render(e,t){const i=this.renderer;let n,s,o,a;if(t&&(n=t.renderTexture,s=t.clear,o=t.transform,a=t.skipUpdateTransform),this.renderingToScreen=!n,i.runners.prerender.emit(),i.emit("prerender"),i.projection.transform=o,!i.context.isLost){if(n||(this.lastObjectRendered=e),!a){const l=e.enableTempParent();e.updateTransform(),e.disableTempParent(l)}i.renderTexture.bind(n),i.batch.currentRenderer.start(),(s??i.background.clearBeforeRender)&&i.renderTexture.clear(),e.render(i),i.batch.currentRenderer.flush(),n&&(t.blit&&i.framebuffer.blit(),n.baseTexture.update()),i.runners.postrender.emit(),i.projection.transform=null,i.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}Mx.extension={type:B.RendererSystem,name:"objectRenderer"};V.add(Mx);const el=class Pd extends ER{constructor(e){super(),this.type=m_.WEBGL,e=Object.assign({},U.RENDER_OPTIONS,e),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new Kt({projectionMatrix:new ye},!0);const t={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:Pd.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(t),"useContextAlpha"in e&&(ee("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),e.premultipliedAlpha=e.useContextAlpha&&e.useContextAlpha!=="notMultiplied",e.backgroundAlpha=e.useContextAlpha===!1?1:e.backgroundAlpha),this._plugin.rendererPlugins=Pd.__plugins,this.options=e,this.startup.run(this.options)}static test(e){return e!=null&&e.forceCanvas?!1:Qb()}render(e,t){this.objectRenderer.render(e,t)}resize(e,t){this._view.resizeView(e,t)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(e=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:e}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(e){this._view.resolution=e,this.runners.resolutionChange.emit(e)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return ee("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return ee("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return ee("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return ee("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(e){ee("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=e}get backgroundAlpha(){return ee("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(e){ee("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=e}get powerPreference(){return ee("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(e,t){return this.textureGenerator.generateTexture(e,t)}};el.extension={type:B.Renderer,priority:1},el.__plugins={},el.__systems={};let pp=el;V.handleByMap(B.RendererPlugin,pp.__plugins);V.handleByMap(B.RendererSystem,pp.__systems);V.add(pp);class Dx extends Co{constructor(e,t){const{width:i,height:n}=t||{};super(i,n),this.items=[],this.itemDirtyIds=[];for(let s=0;s<e;s++){const o=new K;this.items.push(o),this.itemDirtyIds.push(-2)}this.length=e,this._load=null,this.baseTexture=null}initFromArray(e,t){for(let i=0;i<this.length;i++)e[i]&&(e[i].castToBaseTexture?this.addBaseTextureAt(e[i].castToBaseTexture(),i):e[i]instanceof Co?this.addResourceAt(e[i],i):this.addResourceAt(Z_(e[i],t),i))}dispose(){for(let e=0,t=this.length;e<t;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(e,t){if(!this.items[t])throw new Error(`Index ${t} is out of bounds`);return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[t].setResource(e),this}bind(e){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(e);for(let t=0;t<this.length;t++)this.items[t].parentTextureArray=e,this.items[t].on("update",e.update,e)}unbind(e){super.unbind(e);for(let t=0;t<this.length;t++)this.items[t].parentTextureArray=null,this.items[t].off("update",e.update,e)}load(){if(this._load)return this._load;const e=this.items.map(t=>t.resource).filter(t=>t).map(t=>t.load());return this._load=Promise.all(e).then(()=>{const{realWidth:t,realHeight:i}=this.items[0];return this.resize(t,i),this.update(),Promise.resolve(this)}),this._load}}class PR extends Dx{constructor(e,t){const{width:i,height:n}=t||{};let s,o;Array.isArray(e)?(s=e,o=e.length):o=e,super(o,{width:i,height:n}),s&&this.initFromArray(s,t)}addBaseTextureAt(e,t){if(e.resource)this.addResourceAt(e.resource,t);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(e){super.bind(e),e.target=Xn.TEXTURE_2D_ARRAY}upload(e,t,i){const{length:n,itemDirtyIds:s,items:o}=this,{gl:a}=e;i.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,i.internalFormat,this._width,this._height,n,0,t.format,i.type,null);for(let l=0;l<n;l++){const u=o[l];s[l]<u.dirtyId&&(s[l]=u.dirtyId,u.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,l,u.resource.width,u.resource.height,1,t.format,i.type,u.resource.source))}return!0}}class kR extends zr{constructor(e){super(e)}static test(e){const{OffscreenCanvas:t}=globalThis;return t&&e instanceof t?!0:globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement}}const Nx=class Fs extends Dx{constructor(e,t){const{width:i,height:n,autoLoad:s,linkBaseTexture:o}=t||{};if(e&&e.length!==Fs.SIDES)throw new Error(`Invalid length. Got ${e.length}, expected 6`);super(6,{width:i,height:n});for(let a=0;a<Fs.SIDES;a++)this.items[a].target=Xn.TEXTURE_CUBE_MAP_POSITIVE_X+a;this.linkBaseTexture=o!==!1,e&&this.initFromArray(e,t),s!==!1&&this.load()}bind(e){super.bind(e),e.target=Xn.TEXTURE_CUBE_MAP}addBaseTextureAt(e,t,i){if(i===void 0&&(i=this.linkBaseTexture),!this.items[t])throw new Error(`Index ${t} is out of bounds`);if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0)if(e.resource)this.addResourceAt(e.resource,t);else throw new Error("CubeResource does not support copying of renderTexture.");else e.target=Xn.TEXTURE_CUBE_MAP_POSITIVE_X+t,e.parentTextureArray=this.baseTexture,this.items[t]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[t]=e,this}upload(e,t,i){const n=this.itemDirtyIds;for(let s=0;s<Fs.SIDES;s++){const o=this.items[s];(n[s]<o.dirtyId||i.dirtyId<t.dirtyId)&&(o.valid&&o.resource?(o.resource.upload(e,o,i),n[s]=o.dirtyId):n[s]<-1&&(e.gl.texImage2D(o.target,0,i.internalFormat,t.realWidth,t.realHeight,0,t.format,i.type,null),n[s]=-1))}return!0}static test(e){return Array.isArray(e)&&e.length===Fs.SIDES}};Nx.SIDES=6;let MR=Nx;class Fn extends zr{constructor(e,t){t=t||{};let i,n,s;typeof e=="string"?(i=Fn.EMPTY,n=e,s=!0):(i=e,n=null,s=!1),super(i),this.url=n,this.crossOrigin=t.crossOrigin??!0,this.alphaMode=typeof t.alphaMode=="number"?t.alphaMode:null,this.ownsImageBitmap=t.ownsImageBitmap??s,this._load=null,t.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(e,t)=>{if(this.url===null){e(this);return}try{const i=await U.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const n=await i.blob();if(this.destroyed)return;const s=await createImageBitmap(n,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===ct.UNPACK?"premultiply":"none"});if(this.destroyed){s.close();return}this.source=s,this.update(),e(this)}catch(i){if(this.destroyed)return;t(i),this.onError.emit(i)}}),this._load)}upload(e,t,i){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(t.alphaMode=this.alphaMode),super.upload(e,t,i)):(this.load(),!1)}dispose(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(e){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof e=="string"||e instanceof ImageBitmap)}static get EMPTY(){return Fn._EMPTY=Fn._EMPTY??U.ADAPTER.createCanvas(0,0),Fn._EMPTY}}const kd=class tl extends zr{constructor(e,t){t=t||{},super(U.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=e,this.scale=t.scale||1,this._overrideWidth=t.width,this._overrideHeight=t.height,this._resolve=null,this._crossorigin=t.crossorigin,this._load=null,t.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(e=>{if(this._resolve=()=>{this.update(),e(this)},tl.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const e=new Image;zr.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=t=>{this._resolve&&(e.onerror=null,this.onError.emit(t))},e.onload=()=>{if(!this._resolve)return;const t=e.width,i=e.height;if(!t||!i)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let n=t*this.scale,s=i*this.scale;(this._overrideWidth||this._overrideHeight)&&(n=this._overrideWidth||this._overrideHeight/i*t,s=this._overrideHeight||this._overrideWidth/t*i),n=Math.round(n),s=Math.round(s);const o=this.source;o.width=n,o.height=s,o._pixiId=`canvas_${tn()}`,o.getContext("2d").drawImage(e,0,0,t,i,0,0,n,s),this._resolve(),this._resolve=null}}static getSize(e){const t=tl.SVG_SIZE.exec(e),i={};return t&&(i[t[1]]=Math.round(parseFloat(t[3])),i[t[5]]=Math.round(parseFloat(t[7]))),i}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(e,t){return t==="svg"||typeof e=="string"&&e.startsWith("data:image/svg+xml")||typeof e=="string"&&tl.SVG_XML.test(e)}};kd.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,kd.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;let Md=kd;class DR extends zr{constructor(e){super(e)}static test(e){return!!globalThis.VideoFrame&&e instanceof globalThis.VideoFrame}}const Dd=class Nd extends zr{constructor(e,t){if(t=t||{},!(e instanceof HTMLVideoElement)){const i=document.createElement("video");t.autoLoad!==!1&&i.setAttribute("preload","auto"),t.playsinline!==!1&&(i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline","")),t.muted===!0&&(i.setAttribute("muted",""),i.muted=!0),t.loop===!0&&i.setAttribute("loop",""),t.autoPlay!==!1&&i.setAttribute("autoplay",""),typeof e=="string"&&(e=[e]);const n=e[0].src||e[0];zr.crossOrigin(i,n,t.crossorigin);for(let s=0;s<e.length;++s){const o=document.createElement("source");let{src:a,mime:l}=e[s];if(a=a||e[s],a.startsWith("data:"))l=a.slice(5,a.indexOf(";"));else if(!a.startsWith("blob:")){const u=a.split("?").shift().toLowerCase(),h=u.slice(u.lastIndexOf(".")+1);l=l||Nd.MIME_TYPES[h]||`video/${h}`}o.src=a,l&&(o.type=l),i.appendChild(o)}e=i}super(e),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),t.autoLoad!==!1&&this.load()}update(e=0){if(!this.destroyed){if(this._updateFPS){const t=_t.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t)}(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}_videoFrameRequestCallback(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}load(){if(this._load)return this._load;const e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart),e.addEventListener("pause",this._onPlayStop),e.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((t,i)=>{this.valid?t(this):(this._resolve=t,this._reject=i,e.load())}),this._load}_onError(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}_isSourcePlaying(){const e=this.source;return!e.paused&&!e.ended}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0)}_onCanPlay(){const e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);const t=this.valid;this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!t&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()}dispose(){this._configureAutoUpdate();const e=this.source;e&&(e.removeEventListener("play",this._onPlayStart),e.removeEventListener("pause",this._onPlayStop),e.removeEventListener("seeked",this._onSeeked),e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay),e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(_t.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(_t.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(_t.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(e,t){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement||Nd.TYPES.includes(t)}};Dd.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],Dd.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let Ox=Dd;xd.push(Fn,ox,kR,Ox,DR,Md,wu,MR,PR);class Xl{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(e){return this.minX>this.maxX||this.minY>this.maxY?Z.EMPTY:(e=e||new Z(0,0,1,1),e.x=this.minX,e.y=this.minY,e.width=this.maxX-this.minX,e.height=this.maxY-this.minY,e)}addPoint(e){this.minX=Math.min(this.minX,e.x),this.maxX=Math.max(this.maxX,e.x),this.minY=Math.min(this.minY,e.y),this.maxY=Math.max(this.maxY,e.y)}addPointMatrix(e,t){const{a:i,b:n,c:s,d:o,tx:a,ty:l}=e,u=i*t.x+s*t.y+a,h=n*t.x+o*t.y+l;this.minX=Math.min(this.minX,u),this.maxX=Math.max(this.maxX,u),this.minY=Math.min(this.minY,h),this.maxY=Math.max(this.maxY,h)}addQuad(e){let t=this.minX,i=this.minY,n=this.maxX,s=this.maxY,o=e[0],a=e[1];t=o<t?o:t,i=a<i?a:i,n=o>n?o:n,s=a>s?a:s,o=e[2],a=e[3],t=o<t?o:t,i=a<i?a:i,n=o>n?o:n,s=a>s?a:s,o=e[4],a=e[5],t=o<t?o:t,i=a<i?a:i,n=o>n?o:n,s=a>s?a:s,o=e[6],a=e[7],t=o<t?o:t,i=a<i?a:i,n=o>n?o:n,s=a>s?a:s,this.minX=t,this.minY=i,this.maxX=n,this.maxY=s}addFrame(e,t,i,n,s){this.addFrameMatrix(e.worldTransform,t,i,n,s)}addFrameMatrix(e,t,i,n,s){const o=e.a,a=e.b,l=e.c,u=e.d,h=e.tx,d=e.ty;let c=this.minX,f=this.minY,p=this.maxX,v=this.maxY,x=o*t+l*i+h,g=a*t+u*i+d;c=x<c?x:c,f=g<f?g:f,p=x>p?x:p,v=g>v?g:v,x=o*n+l*i+h,g=a*n+u*i+d,c=x<c?x:c,f=g<f?g:f,p=x>p?x:p,v=g>v?g:v,x=o*t+l*s+h,g=a*t+u*s+d,c=x<c?x:c,f=g<f?g:f,p=x>p?x:p,v=g>v?g:v,x=o*n+l*s+h,g=a*n+u*s+d,c=x<c?x:c,f=g<f?g:f,p=x>p?x:p,v=g>v?g:v,this.minX=c,this.minY=f,this.maxX=p,this.maxY=v}addVertexData(e,t,i){let n=this.minX,s=this.minY,o=this.maxX,a=this.maxY;for(let l=t;l<i;l+=2){const u=e[l],h=e[l+1];n=u<n?u:n,s=h<s?h:s,o=u>o?u:o,a=h>a?h:a}this.minX=n,this.minY=s,this.maxX=o,this.maxY=a}addVertices(e,t,i,n){this.addVerticesMatrix(e.worldTransform,t,i,n)}addVerticesMatrix(e,t,i,n,s=0,o=s){const a=e.a,l=e.b,u=e.c,h=e.d,d=e.tx,c=e.ty;let f=this.minX,p=this.minY,v=this.maxX,x=this.maxY;for(let g=i;g<n;g+=2){const y=t[g],m=t[g+1],_=a*y+u*m+d,w=h*m+l*y+c;f=Math.min(f,_-s),v=Math.max(v,_+s),p=Math.min(p,w-o),x=Math.max(x,w+o)}this.minX=f,this.minY=p,this.maxX=v,this.maxY=x}addBounds(e){const t=this.minX,i=this.minY,n=this.maxX,s=this.maxY;this.minX=e.minX<t?e.minX:t,this.minY=e.minY<i?e.minY:i,this.maxX=e.maxX>n?e.maxX:n,this.maxY=e.maxY>s?e.maxY:s}addBoundsMask(e,t){const i=e.minX>t.minX?e.minX:t.minX,n=e.minY>t.minY?e.minY:t.minY,s=e.maxX<t.maxX?e.maxX:t.maxX,o=e.maxY<t.maxY?e.maxY:t.maxY;if(i<=s&&n<=o){const a=this.minX,l=this.minY,u=this.maxX,h=this.maxY;this.minX=i<a?i:a,this.minY=n<l?n:l,this.maxX=s>u?s:u,this.maxY=o>h?o:h}}addBoundsMatrix(e,t){this.addFrameMatrix(t,e.minX,e.minY,e.maxX,e.maxY)}addBoundsArea(e,t){const i=e.minX>t.x?e.minX:t.x,n=e.minY>t.y?e.minY:t.y,s=e.maxX<t.x+t.width?e.maxX:t.x+t.width,o=e.maxY<t.y+t.height?e.maxY:t.y+t.height;if(i<=s&&n<=o){const a=this.minX,l=this.minY,u=this.maxX,h=this.maxY;this.minX=i<a?i:a,this.minY=n<l?n:l,this.maxX=s>u?s:u,this.maxY=o>h?o:h}}pad(e=0,t=e){this.isEmpty()||(this.minX-=e,this.maxX+=e,this.minY-=t,this.maxY+=t)}addFramePad(e,t,i,n,s,o){e-=s,t-=o,i+=s,n+=o,this.minX=this.minX<e?this.minX:e,this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<t?this.minY:t,this.maxY=this.maxY>n?this.maxY:n}}class Ce extends Oo{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new dp,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new Xl,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(e){const t=Object.keys(e);for(let i=0;i<t.length;++i){const n=t[i];Object.defineProperty(Ce.prototype,n,Object.getOwnPropertyDescriptor(e,n))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(e,t){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),t||(this._boundsRect||(this._boundsRect=new Z),t=this._boundsRect),this._bounds.getRectangle(t)}getLocalBounds(e){e||(this._localBoundsRect||(this._localBoundsRect=new Z),e=this._localBoundsRect),this._localBounds||(this._localBounds=new Xl);const t=this.transform,i=this.parent;this.parent=null,this._tempDisplayObjectParent.worldAlpha=(i==null?void 0:i.worldAlpha)??1,this.transform=this._tempDisplayObjectParent.transform;const n=this._bounds,s=this._boundsID;this._bounds=this._localBounds;const o=this.getBounds(!1,e);return this.parent=i,this.transform=t,this._bounds=n,this._bounds.updateID+=this._boundsID-s,o}toGlobal(e,t,i=!1){return i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,t)}toLocal(e,t,i,n){return t&&(e=t.toGlobal(e,i,n)),n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,i)}setParent(e){if(!e||!e.addChild)throw new Error("setParent: Argument must be a Container");return e.addChild(this),e}removeFromParent(){var e;(e=this.parent)==null||e.removeChild(this)}setTransform(e=0,t=0,i=1,n=1,s=0,o=0,a=0,l=0,u=0){return this.position.x=e,this.position.y=t,this.scale.x=i||1,this.scale.y=n||1,this.rotation=s,this.skew.x=o,this.skew.y=a,this.pivot.x=l,this.pivot.y=u,this}destroy(e){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new NR),this.tempDisplayObjectParent}enableTempParent(){const e=this.parent;return this.parent=this._tempDisplayObjectParent,e}disableTempParent(e){this.parent=e}get x(){return this.position.x}set x(e){this.transform.position.x=e}get y(){return this.position.y}set y(e){this.transform.position.y=e}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(e){this.transform.position.copyFrom(e)}get scale(){return this.transform.scale}set scale(e){this.transform.scale.copyFrom(e)}get pivot(){return this.transform.pivot}set pivot(e){this.transform.pivot.copyFrom(e)}get skew(){return this.transform.skew}set skew(e){this.transform.skew.copyFrom(e)}get rotation(){return this.transform.rotation}set rotation(e){this.transform.rotation=e}get angle(){return this.transform.rotation*bC}set angle(e){this.transform.rotation=e*CC}get zIndex(){return this._zIndex}set zIndex(e){this._zIndex!==e&&(this._zIndex=e,this.parent&&(this.parent.sortDirty=!0))}get worldVisible(){let e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0}get mask(){return this._mask}set mask(e){if(this._mask!==e){if(this._mask){const t=this._mask.isMaskData?this._mask.maskObject:this._mask;t&&(t._maskRefCount--,t._maskRefCount===0&&(t.renderable=!0,t.isMask=!1))}if(this._mask=e,this._mask){const t=this._mask.isMaskData?this._mask.maskObject:this._mask;t&&(t._maskRefCount===0&&(t.renderable=!1,t.isMask=!0),t._maskRefCount++)}}}}class NR extends Ce{constructor(){super(...arguments),this.sortDirty=null}}Ce.prototype.displayObjectUpdateTransform=Ce.prototype.updateTransform;const OR=new ye;function BR(r,e){return r.zIndex===e.zIndex?r._lastSortedIndex-e._lastSortedIndex:r.zIndex-e.zIndex}const Bx=class Od extends Ce{constructor(){super(),this.children=[],this.sortableChildren=Od.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(e){}addChild(...e){if(e.length>1)for(let t=0;t<e.length;t++)this.addChild(e[t]);else{const t=e[0];t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this)}return e[0]}addChildAt(e,t){if(t<0||t>this.children.length)throw new Error(`${e}addChildAt: The index ${t} supplied is out of bounds ${this.children.length}`);return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(t,0,e),this._boundsID++,this.onChildrenChange(t),e.emit("added",this),this.emit("childAdded",e,this,t),e}swapChildren(e,t){if(e===t)return;const i=this.getChildIndex(e),n=this.getChildIndex(t);this.children[i]=t,this.children[n]=e,this.onChildrenChange(i<n?i:n)}getChildIndex(e){const t=this.children.indexOf(e);if(t===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return t}setChildIndex(e,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);const i=this.getChildIndex(e);Yn(this.children,i,1),this.children.splice(t,0,e),this.onChildrenChange(t)}getChildAt(e){if(e<0||e>=this.children.length)throw new Error(`getChildAt: Index (${e}) does not exist.`);return this.children[e]}removeChild(...e){if(e.length>1)for(let t=0;t<e.length;t++)this.removeChild(e[t]);else{const t=e[0],i=this.children.indexOf(t);if(i===-1)return null;t.parent=null,t.transform._parentID=-1,Yn(this.children,i,1),this._boundsID++,this.onChildrenChange(i),t.emit("removed",this),this.emit("childRemoved",t,this,i)}return e[0]}removeChildAt(e){const t=this.getChildAt(e);return t.parent=null,t.transform._parentID=-1,Yn(this.children,e,1),this._boundsID++,this.onChildrenChange(e),t.emit("removed",this),this.emit("childRemoved",t,this,e),t}removeChildren(e=0,t=this.children.length){const i=e,n=t,s=n-i;let o;if(s>0&&s<=n){o=this.children.splice(i,s);for(let a=0;a<o.length;++a)o[a].parent=null,o[a].transform&&(o[a].transform._parentID=-1);this._boundsID++,this.onChildrenChange(e);for(let a=0;a<o.length;++a)o[a].emit("removed",this),this.emit("childRemoved",o[a],this,a);return o}else if(s===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let e=!1;for(let t=0,i=this.children.length;t<i;++t){const n=this.children[t];n._lastSortedIndex=t,!e&&n.zIndex!==0&&(e=!0)}e&&this.children.length>1&&this.children.sort(BR),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let e=0,t=this.children.length;e<t;++e){const i=this.children[e];i.visible&&i.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let e=0;e<this.children.length;e++){const t=this.children[e];if(!(!t.visible||!t.renderable))if(t.calculateBounds(),t._mask){const i=t._mask.isMaskData?t._mask.maskObject:t._mask;i?(i.calculateBounds(),this._bounds.addBoundsMask(t._bounds,i._bounds)):this._bounds.addBounds(t._bounds)}else t.filterArea?this._bounds.addBoundsArea(t._bounds,t.filterArea):this._bounds.addBounds(t._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(e,t=!1){const i=super.getLocalBounds(e);if(!t)for(let n=0,s=this.children.length;n<s;++n){const o=this.children[n];o.visible&&o.updateTransform()}return i}_calculateBounds(){}_renderWithCulling(e){const t=e.renderTexture.sourceFrame;if(!(t.width>0&&t.height>0))return;let i,n;this.cullArea?(i=this.cullArea,n=this.worldTransform):this._render!==Od.prototype._render&&(i=this.getBounds(!0));const s=e.projection.transform;if(s&&(n?(n=OR.copyFrom(n),n.prepend(s)):n=s),i&&t.intersects(i,n))this._render(e);else if(this.cullArea)return;for(let o=0,a=this.children.length;o<a;++o){const l=this.children[o],u=l.cullable;l.cullable=u||!this.cullArea,l.render(e),l.cullable=u}}render(e){var t;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(t=this.filters)!=null&&t.length)this.renderAdvanced(e);else if(this.cullable)this._renderWithCulling(e);else{this._render(e);for(let i=0,n=this.children.length;i<n;++i)this.children[i].render(e)}}renderAdvanced(e){var s,o,a;const t=this.filters,i=this._mask;if(t){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let l=0;l<t.length;l++)t[l].enabled&&this._enabledFilters.push(t[l])}const n=t&&((s=this._enabledFilters)==null?void 0:s.length)||i&&(!i.isMaskData||i.enabled&&(i.autoDetect||i.type!==Fe.NONE));if(n&&e.batch.flush(),t&&((o=this._enabledFilters)!=null&&o.length)&&e.filter.push(this,this._enabledFilters),i&&e.mask.push(this,this._mask),this.cullable)this._renderWithCulling(e);else{this._render(e);for(let l=0,u=this.children.length;l<u;++l)this.children[l].render(e)}n&&e.batch.flush(),i&&e.mask.pop(this),t&&((a=this._enabledFilters)!=null&&a.length)&&e.filter.pop()}_render(e){}destroy(e){super.destroy(),this.sortDirty=!1;const t=typeof e=="boolean"?e:e==null?void 0:e.children,i=this.removeChildren(0,this.children.length);if(t)for(let n=0;n<i.length;++n)i[n].destroy(e)}get width(){return this.scale.x*this.getLocalBounds().width}set width(e){const t=this.getLocalBounds().width;t!==0?this.scale.x=e/t:this.scale.x=1,this._width=e}get height(){return this.scale.y*this.getLocalBounds().height}set height(e){const t=this.getLocalBounds().height;t!==0?this.scale.y=e/t:this.scale.y=1,this._height=e}};Bx.defaultSortableChildren=!1;let Qt=Bx;Qt.prototype.containerUpdateTransform=Qt.prototype.updateTransform;Object.defineProperties(U,{SORTABLE_CHILDREN:{get(){return Qt.defaultSortableChildren},set(r){ee("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),Qt.defaultSortableChildren=r}}});const Is=new ne,LR=new Uint16Array([0,1,2,0,2,3]);class xi extends Qt{constructor(e){super(),this._anchor=new Nr(this._onAnchorUpdate,this,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new me(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=q.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=e||z.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=LR,this.pluginName="batch",this.isSprite=!0,this._roundPixels=U.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=si(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=si(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const e=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===e._updateID)return;this._textureID!==e._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=e._updateID;const t=this.transform.worldTransform,i=t.a,n=t.b,s=t.c,o=t.d,a=t.tx,l=t.ty,u=this.vertexData,h=e.trim,d=e.orig,c=this._anchor;let f=0,p=0,v=0,x=0;if(h?(p=h.x-c._x*d.width,f=p+h.width,x=h.y-c._y*d.height,v=x+h.height):(p=-c._x*d.width,f=p+d.width,x=-c._y*d.height,v=x+d.height),u[0]=i*p+s*x+a,u[1]=o*x+n*p+l,u[2]=i*f+s*x+a,u[3]=o*x+n*f+l,u[4]=i*f+s*v+a,u[5]=o*v+n*f+l,u[6]=i*p+s*v+a,u[7]=o*v+n*p+l,this._roundPixels){const g=U.RESOLUTION;for(let y=0;y<u.length;++y)u[y]=Math.round(u[y]*g)/g}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const e=this._texture,t=this.vertexTrimmedData,i=e.orig,n=this._anchor,s=this.transform.worldTransform,o=s.a,a=s.b,l=s.c,u=s.d,h=s.tx,d=s.ty,c=-n._x*i.width,f=c+i.width,p=-n._y*i.height,v=p+i.height;if(t[0]=o*c+l*p+h,t[1]=u*p+a*c+d,t[2]=o*f+l*p+h,t[3]=u*p+a*f+d,t[4]=o*f+l*v+h,t[5]=u*v+a*f+d,t[6]=o*c+l*v+h,t[7]=u*v+a*c+d,this._roundPixels){const x=U.RESOLUTION;for(let g=0;g<t.length;++g)t[g]=Math.round(t[g]*x)/x}}_render(e){this.calculateVertices(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)}_calculateBounds(){const e=this._texture.trim,t=this._texture.orig;!e||e.width===t.width&&e.height===t.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(e){return this.children.length===0?(this._localBounds||(this._localBounds=new Xl),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new Z),e=this._localBoundsRect),this._localBounds.getRectangle(e)):super.getLocalBounds.call(this,e)}containsPoint(e){this.worldTransform.applyInverse(e,Is);const t=this._texture.orig.width,i=this._texture.orig.height,n=-t*this.anchor.x;let s=0;return Is.x>=n&&Is.x<n+t&&(s=-i*this.anchor.y,Is.y>=s&&Is.y<s+i)}destroy(e){if(super.destroy(e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof e=="boolean"?e:e==null?void 0:e.texture){const t=typeof e=="boolean"?e:e==null?void 0:e.baseTexture;this._texture.destroy(!!t)}this._texture=null}static from(e,t){const i=e instanceof z?e:z.from(e,t);return new xi(i)}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1,this._transformTrimmedID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){const t=si(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){const t=si(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e}get anchor(){return this._anchor}set anchor(e){this._anchor.copyFrom(e)}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(e){this._texture!==e&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=e||z.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e&&(e.baseTexture.valid?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)))}}const Lx=new ye;Ce.prototype._cacheAsBitmap=!1;Ce.prototype._cacheData=null;Ce.prototype._cacheAsBitmapResolution=null;Ce.prototype._cacheAsBitmapMultisample=null;class FR{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(Ce.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(r){r!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=r,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(r){r!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=r,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(r){if(this._cacheAsBitmap===r)return;this._cacheAsBitmap=r;let e;r?(this._cacheData||(this._cacheData=new FR),e=this._cacheData,e.originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(e=this._cacheData,e.sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea)}}});Ce.prototype._renderCached=function(r){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(r),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(r))};Ce.prototype._initCachedDisplayObject=function(r){var c,f;if((c=this._cacheData)!=null&&c.sprite)return;const e=this.alpha;this.alpha=1,r.batch.flush();const t=this.getLocalBounds(new Z,!0);if((f=this.filters)!=null&&f.length){const p=this.filters[0].padding;t.pad(p)}const i=this.cacheAsBitmapResolution||r.resolution;t.ceil(i),t.width=Math.max(t.width,1/i),t.height=Math.max(t.height,1/i);const n=r.renderTexture.current,s=r.renderTexture.sourceFrame.clone(),o=r.renderTexture.destinationFrame.clone(),a=r.projection.transform,l=un.create({width:t.width,height:t.height,resolution:i,multisample:this.cacheAsBitmapMultisample??r.multisample}),u=`cacheAsBitmap_${tn()}`;this._cacheData.textureCacheId=u,K.addToCache(l.baseTexture,u),z.addToCache(l,u);const h=this.transform.localTransform.copyTo(Lx).invert().translate(-t.x,-t.y);this.render=this._cacheData.originalRender,r.render(this,{renderTexture:l,clear:!0,transform:h,skipUpdateTransform:!1}),r.framebuffer.blit(),r.projection.transform=a,r.renderTexture.bind(n,s,o),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;const d=new xi(l);d.transform.worldTransform=this.transform.worldTransform,d.anchor.x=-(t.x/t.width),d.anchor.y=-(t.y/t.height),d.alpha=e,d._bounds=this._bounds,this._cacheData.sprite=d,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=d.containsPoint.bind(d)};Ce.prototype._renderCachedCanvas=function(r){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(r),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(r))};Ce.prototype._initCachedDisplayObjectCanvas=function(r){var h;if((h=this._cacheData)!=null&&h.sprite)return;const e=this.getLocalBounds(new Z,!0),t=this.alpha;this.alpha=1;const i=r.canvasContext.activeContext,n=r._projTransform,s=this.cacheAsBitmapResolution||r.resolution;e.ceil(s),e.width=Math.max(e.width,1/s),e.height=Math.max(e.height,1/s);const o=un.create({width:e.width,height:e.height,resolution:s}),a=`cacheAsBitmap_${tn()}`;this._cacheData.textureCacheId=a,K.addToCache(o.baseTexture,a),z.addToCache(o,a);const l=Lx;this.transform.localTransform.copyTo(l),l.invert(),l.tx-=e.x,l.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,r.render(this,{renderTexture:o,clear:!0,transform:l,skipUpdateTransform:!1}),r.canvasContext.activeContext=i,r._projTransform=n,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=t;const u=new xi(o);u.transform.worldTransform=this.transform.worldTransform,u.anchor.x=-(e.x/e.width),u.anchor.y=-(e.y/e.height),u.alpha=t,u._bounds=this._bounds,this._cacheData.sprite=u,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=r._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=u.containsPoint.bind(u)};Ce.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};Ce.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};Ce.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,K.removeFromCache(this._cacheData.textureCacheId),z.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};Ce.prototype._cacheAsBitmapDestroy=function(r){this.cacheAsBitmap=!1,this.destroy(r)};Ce.prototype.name=null;Qt.prototype.getChildByName=function(r,e){for(let t=0,i=this.children.length;t<i;t++)if(this.children[t].name===r)return this.children[t];if(e)for(let t=0,i=this.children.length;t<i;t++){const n=this.children[t];if(!n.getChildByName)continue;const s=n.getChildByName(r,!0);if(s)return s}return null};Ce.prototype.getGlobalPosition=function(r=new ne,e=!1){return this.parent?this.parent.toGlobal(this.position,r,e):(r.x=this.position.x,r.y=this.position.y),r};var UR=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class GR extends nt{constructor(e=1){super(RR,UR,{uAlpha:1}),this.alpha=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}const HR={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},$R=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function zR(r){const e=HR[r],t=e.length;let i=$R,n="";const s="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let o;for(let a=0;a<r;a++){let l=s.replace("%index%",a.toString());o=a,a>=t&&(o=r-a-1),l=l.replace("%value%",e[o].toString()),n+=l,n+=`
`}return i=i.replace("%blur%",n),i=i.replace("%size%",r.toString()),i}const VR=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function XR(r,e){const t=Math.ceil(r/2);let i=VR,n="",s;e?s="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":s="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let o=0;o<r;o++){let a=s.replace("%index%",o.toString());a=a.replace("%sampleIndex%",`${o-(t-1)}.0`),n+=a,n+=`
`}return i=i.replace("%blur%",n),i=i.replace("%size%",r.toString()),i}class Bd extends nt{constructor(e,t=8,i=4,n=nt.defaultResolution,s=5){const o=XR(s,e),a=zR(s);super(o,a),this.horizontal=e,this.resolution=n,this._quality=0,this.quality=i,this.blur=t}apply(e,t,i,n){if(i?this.horizontal?this.uniforms.strength=1/i.width*(i.width/t.width):this.uniforms.strength=1/i.height*(i.height/t.height):this.horizontal?this.uniforms.strength=1/e.renderer.width*(e.renderer.width/t.width):this.uniforms.strength=1/e.renderer.height*(e.renderer.height/t.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)e.applyFilter(this,t,i,n);else{const s=e.getFilterTexture(),o=e.renderer;let a=t,l=s;this.state.blend=!1,e.applyFilter(this,a,l,hr.CLEAR);for(let u=1;u<this.passes-1;u++){e.bindAndClear(a,hr.BLIT),this.uniforms.uSampler=l;const h=l;l=a,a=h,o.shader.bind(this),o.geometry.draw(5)}this.state.blend=!0,e.applyFilter(this,l,i,n),e.returnFilterTexture(s)}}get blur(){return this.strength}set blur(e){this.padding=1+Math.abs(e)*2,this.strength=e}get quality(){return this._quality}set quality(e){this._quality=e,this.passes=e}}class jR extends nt{constructor(e=8,t=4,i=nt.defaultResolution,n=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new Bd(!0,e,t,i,n),this.blurYFilter=new Bd(!1,e,t,i,n),this.resolution=i,this.quality=t,this.blur=e,this.repeatEdgePixels=!1}apply(e,t,i,n){const s=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(s&&o){const a=e.getFilterTexture();this.blurXFilter.apply(e,t,a,hr.CLEAR),this.blurYFilter.apply(e,a,i,n),e.returnFilterTexture(a)}else o?this.blurYFilter.apply(e,t,i,n):this.blurXFilter.apply(e,t,i,n)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(e){this.blurXFilter.quality=this.blurYFilter.quality=e}get blurX(){return this.blurXFilter.blur}set blurX(e){this.blurXFilter.blur=e,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(e){this.blurYFilter.blur=e,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(e){this.blurYFilter.blendMode=e}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(e){this._repeatEdgePixels=e,this.updatePadding()}}var WR=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class Ld extends nt{constructor(){const e={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(Ix,WR,e),this.alpha=1}_loadMatrix(e,t=!1){let i=e;t&&(this._multiply(i,this.uniforms.m,e),i=this._colorMatrix(i)),this.uniforms.m=i}_multiply(e,t,i){return e[0]=t[0]*i[0]+t[1]*i[5]+t[2]*i[10]+t[3]*i[15],e[1]=t[0]*i[1]+t[1]*i[6]+t[2]*i[11]+t[3]*i[16],e[2]=t[0]*i[2]+t[1]*i[7]+t[2]*i[12]+t[3]*i[17],e[3]=t[0]*i[3]+t[1]*i[8]+t[2]*i[13]+t[3]*i[18],e[4]=t[0]*i[4]+t[1]*i[9]+t[2]*i[14]+t[3]*i[19]+t[4],e[5]=t[5]*i[0]+t[6]*i[5]+t[7]*i[10]+t[8]*i[15],e[6]=t[5]*i[1]+t[6]*i[6]+t[7]*i[11]+t[8]*i[16],e[7]=t[5]*i[2]+t[6]*i[7]+t[7]*i[12]+t[8]*i[17],e[8]=t[5]*i[3]+t[6]*i[8]+t[7]*i[13]+t[8]*i[18],e[9]=t[5]*i[4]+t[6]*i[9]+t[7]*i[14]+t[8]*i[19]+t[9],e[10]=t[10]*i[0]+t[11]*i[5]+t[12]*i[10]+t[13]*i[15],e[11]=t[10]*i[1]+t[11]*i[6]+t[12]*i[11]+t[13]*i[16],e[12]=t[10]*i[2]+t[11]*i[7]+t[12]*i[12]+t[13]*i[17],e[13]=t[10]*i[3]+t[11]*i[8]+t[12]*i[13]+t[13]*i[18],e[14]=t[10]*i[4]+t[11]*i[9]+t[12]*i[14]+t[13]*i[19]+t[14],e[15]=t[15]*i[0]+t[16]*i[5]+t[17]*i[10]+t[18]*i[15],e[16]=t[15]*i[1]+t[16]*i[6]+t[17]*i[11]+t[18]*i[16],e[17]=t[15]*i[2]+t[16]*i[7]+t[17]*i[12]+t[18]*i[17],e[18]=t[15]*i[3]+t[16]*i[8]+t[17]*i[13]+t[18]*i[18],e[19]=t[15]*i[4]+t[16]*i[9]+t[17]*i[14]+t[18]*i[19]+t[19],e}_colorMatrix(e){const t=new Float32Array(e);return t[4]/=255,t[9]/=255,t[14]/=255,t[19]/=255,t}brightness(e,t){const i=[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0];this._loadMatrix(i,t)}tint(e,t){const[i,n,s]=me.shared.setValue(e).toArray(),o=[i,0,0,0,0,0,n,0,0,0,0,0,s,0,0,0,0,0,1,0];this._loadMatrix(o,t)}greyscale(e,t){const i=[e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0];this._loadMatrix(i,t)}blackAndWhite(e){const t=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(t,e)}hue(e,t){e=(e||0)/180*Math.PI;const i=Math.cos(e),n=Math.sin(e),s=Math.sqrt,o=1/3,a=s(o),l=i+(1-i)*o,u=o*(1-i)-a*n,h=o*(1-i)+a*n,d=o*(1-i)+a*n,c=i+o*(1-i),f=o*(1-i)-a*n,p=o*(1-i)-a*n,v=o*(1-i)+a*n,x=i+o*(1-i),g=[l,u,h,0,0,d,c,f,0,0,p,v,x,0,0,0,0,0,1,0];this._loadMatrix(g,t)}contrast(e,t){const i=(e||0)+1,n=-.5*(i-1),s=[i,0,0,0,n,0,i,0,0,n,0,0,i,0,n,0,0,0,1,0];this._loadMatrix(s,t)}saturate(e=0,t){const i=e*2/3+1,n=(i-1)*-.5,s=[i,n,n,0,0,n,i,n,0,0,n,n,i,0,0,0,0,0,1,0];this._loadMatrix(s,t)}desaturate(){this.saturate(-1)}negative(e){const t=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(t,e)}sepia(e){const t=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(t,e)}technicolor(e){const t=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(t,e)}polaroid(e){const t=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(t,e)}toBGR(e){const t=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(t,e)}kodachrome(e){const t=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(t,e)}browni(e){const t=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(t,e)}vintage(e){const t=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(t,e)}colorTone(e,t,i,n,s){e=e||.2,t=t||.15,i=i||16770432,n=n||3375104;const o=me.shared,[a,l,u]=o.setValue(i).toArray(),[h,d,c]=o.setValue(n).toArray(),f=[.3,.59,.11,0,0,a,l,u,e,0,h,d,c,t,0,a-h,l-d,u-c,0,0];this._loadMatrix(f,s)}night(e,t){e=e||.1;const i=[e*-2,-e,0,0,0,-e,0,e,0,0,0,e,e*2,0,0,0,0,0,1,0];this._loadMatrix(i,t)}predator(e,t){const i=[11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0];this._loadMatrix(i,t)}lsd(e){const t=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(t,e)}reset(){const e=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(e,!1)}get matrix(){return this.uniforms.m}set matrix(e){this.uniforms.m=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}Ld.prototype.grayscale=Ld.prototype.greyscale;var YR=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,qR=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class KR extends nt{constructor(e,t){const i=new ye;e.renderable=!1,super(qR,YR,{mapSampler:e._texture,filterMatrix:i,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=e,this.maskMatrix=i,t==null&&(t=20),this.scale=new ne(t,t)}apply(e,t,i,n){this.uniforms.filterMatrix=e.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const s=this.maskSprite.worldTransform,o=Math.sqrt(s.a*s.a+s.b*s.b),a=Math.sqrt(s.c*s.c+s.d*s.d);o!==0&&a!==0&&(this.uniforms.rotation[0]=s.a/o,this.uniforms.rotation[1]=s.b/o,this.uniforms.rotation[2]=s.c/a,this.uniforms.rotation[3]=s.d/a),e.applyFilter(this,t,i,n)}get map(){return this.uniforms.mapSampler}set map(e){this.uniforms.mapSampler=e}}var ZR=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,QR=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class JR extends nt{constructor(){super(QR,ZR)}}var eI=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class tI extends nt{constructor(e=.5,t=Math.random()){super(Ix,eI,{uNoise:0,uSeed:0}),this.noise=e,this.seed=t}get noise(){return this.uniforms.uNoise}set noise(e){this.uniforms.uNoise=e}get seed(){return this.uniforms.uSeed}set seed(e){this.uniforms.uSeed=e}}const qg={AlphaFilter:GR,BlurFilter:jR,BlurFilterPass:Bd,ColorMatrixFilter:Ld,DisplacementFilter:KR,FXAAFilter:JR,NoiseFilter:tI};Object.entries(qg).forEach(([r,e])=>{Object.defineProperty(qg,r,{get(){return ee("7.1.0",`filters.${r} has moved to ${r}`),e}})});class rI{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(e){this.removeTickerListener(),this.events=e,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(e){this._pauseUpdate=e}addTickerListener(){this.tickerAdded||!this.domElement||(_t.system.add(this.tickerUpdate,this,rn.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(_t.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}const e=this.events.rootPointerEvent;this.events.supportsTouchEvents&&e.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:e.clientX,clientY:e.clientY}))}tickerUpdate(e){this._deltaTime+=e,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}}const ti=new rI;class Uo{constructor(e){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=Uo.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new ne,this.page=new ne,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(e,t,i){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(e,t,i,n,s){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class jl extends Uo{constructor(){super(...arguments),this.client=new ne,this.movement=new ne,this.offset=new ne,this.global=new ne,this.screen=new ne}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(e,t,i){return e.worldTransform.applyInverse(i||this.global,t)}getModifierState(e){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(e)}initMouseEvent(e,t,i,n,s,o,a,l,u,h,d,c,f,p,v){throw new Error("Method not implemented.")}}class Ht extends jl{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class Kn extends jl{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}Kn.DOM_DELTA_PIXEL=0,Kn.DOM_DELTA_LINE=1,Kn.DOM_DELTA_PAGE=2;const iI=2048,nI=new ne,Hh=new ne;class sI{constructor(e){this.dispatch=new Oo,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=e,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(e,t){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:t,priority:0}),this.mappingTable[e].sort((i,n)=>i.priority-n.priority)}dispatchEvent(e,t){e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,t),this.dispatch.emit(t||e.type,e)}mapEvent(e){if(!this.rootTarget)return;const t=this.mappingTable[e.type];if(t)for(let i=0,n=t.length;i<n;i++)t[i].fn(e);else console.warn(`[EventBoundary]: Event mapping not defined for ${e.type}`)}hitTest(e,t){ti.pauseUpdate=!0;const i=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",n=this[i](this.rootTarget,this.rootTarget.eventMode,nI.set(e,t),this.hitTestFn,this.hitPruneFn);return n&&n[0]}propagate(e,t){if(!e.target)return;const i=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(let n=0,s=i.length-1;n<s;n++)if(e.currentTarget=i[n],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,t),!(e.propagationStopped||e.propagationImmediatelyStopped)){e.eventPhase=e.BUBBLING_PHASE;for(let n=i.length-2;n>=0;n--)if(e.currentTarget=i[n],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return}}all(e,t,i=this._allInteractiveElements){if(i.length===0)return;e.eventPhase=e.BUBBLING_PHASE;const n=Array.isArray(t)?t:[t];for(let s=i.length-1;s>=0;s--)n.forEach(o=>{e.currentTarget=i[s],this.notifyTarget(e,o)})}propagationPath(e){const t=[e];for(let i=0;i<iI&&e!==this.rootTarget;i++){if(!e.parent)throw new Error("Cannot find propagation path to disconnected target");t.push(e.parent),e=e.parent}return t.reverse(),t}hitTestMoveRecursive(e,t,i,n,s,o=!1){let a=!1;if(this._interactivePrune(e))return null;if((e.eventMode==="dynamic"||t==="dynamic")&&(ti.pauseUpdate=!1),e.interactiveChildren&&e.children){const h=e.children;for(let d=h.length-1;d>=0;d--){const c=h[d],f=this.hitTestMoveRecursive(c,this._isInteractive(t)?t:c.eventMode,i,n,s,o||s(e,i));if(f){if(f.length>0&&!f[f.length-1].parent)continue;const p=e.isInteractive();(f.length>0||p)&&(p&&this._allInteractiveElements.push(e),f.push(e)),this._hitElements.length===0&&(this._hitElements=f),a=!0}}}const l=this._isInteractive(t),u=e.isInteractive();return l&&u&&this._allInteractiveElements.push(e),o||this._hitElements.length>0?null:a?this._hitElements:l&&!s(e,i)&&n(e,i)?u?[e]:[]:null}hitTestRecursive(e,t,i,n,s){if(this._interactivePrune(e)||s(e,i))return null;if((e.eventMode==="dynamic"||t==="dynamic")&&(ti.pauseUpdate=!1),e.interactiveChildren&&e.children){const l=e.children;for(let u=l.length-1;u>=0;u--){const h=l[u],d=this.hitTestRecursive(h,this._isInteractive(t)?t:h.eventMode,i,n,s);if(d){if(d.length>0&&!d[d.length-1].parent)continue;const c=e.isInteractive();return(d.length>0||c)&&d.push(e),d}}}const o=this._isInteractive(t),a=e.isInteractive();return o&&n(e,i)?a?[e]:[]:null}_isInteractive(e){return e==="static"||e==="dynamic"}_interactivePrune(e){return!!(!e||e.isMask||!e.visible||!e.renderable||e.eventMode==="none"||e.eventMode==="passive"&&!e.interactiveChildren||e.isMask)}hitPruneFn(e,t){var i;if(e.hitArea&&(e.worldTransform.applyInverse(t,Hh),!e.hitArea.contains(Hh.x,Hh.y)))return!0;if(e._mask){const n=e._mask.isMaskData?e._mask.maskObject:e._mask;if(n&&!((i=n.containsPoint)!=null&&i.call(n,t)))return!0}return!1}hitTestFn(e,t){return e.eventMode==="passive"?!1:e.hitArea?!0:e.containsPoint?e.containsPoint(t):!1}notifyTarget(e,t){var s,o;t=t??e.type;const i=`on${t}`;(o=(s=e.currentTarget)[i])==null||o.call(s,e);const n=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?`${t}capture`:t;this.notifyListeners(e,n),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,t)}mapPointerDown(e){if(!(e instanceof Ht)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const t=this.createPointerEvent(e);if(this.dispatchEvent(t,"pointerdown"),t.pointerType==="touch")this.dispatchEvent(t,"touchstart");else if(t.pointerType==="mouse"||t.pointerType==="pen"){const n=t.button===2;this.dispatchEvent(t,n?"rightdown":"mousedown")}const i=this.trackingData(e.pointerId);i.pressTargetsByButton[e.button]=t.composedPath(),this.freeEvent(t)}mapPointerMove(e){var l,u;if(!(e instanceof Ht)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const t=this.createPointerEvent(e);this._isPointerMoveEvent=!1;const i=t.pointerType==="mouse"||t.pointerType==="pen",n=this.trackingData(e.pointerId),s=this.findMountedTarget(n.overTargets);if(((l=n.overTargets)==null?void 0:l.length)>0&&s!==t.target){const h=e.type==="mousemove"?"mouseout":"pointerout",d=this.createPointerEvent(e,h,s);if(this.dispatchEvent(d,"pointerout"),i&&this.dispatchEvent(d,"mouseout"),!t.composedPath().includes(s)){const c=this.createPointerEvent(e,"pointerleave",s);for(c.eventPhase=c.AT_TARGET;c.target&&!t.composedPath().includes(c.target);)c.currentTarget=c.target,this.notifyTarget(c),i&&this.notifyTarget(c,"mouseleave"),c.target=c.target.parent;this.freeEvent(c)}this.freeEvent(d)}if(s!==t.target){const h=e.type==="mousemove"?"mouseover":"pointerover",d=this.clonePointerEvent(t,h);this.dispatchEvent(d,"pointerover"),i&&this.dispatchEvent(d,"mouseover");let c=s==null?void 0:s.parent;for(;c&&c!==this.rootTarget.parent&&c!==t.target;)c=c.parent;if(!c||c===this.rootTarget.parent){const f=this.clonePointerEvent(t,"pointerenter");for(f.eventPhase=f.AT_TARGET;f.target&&f.target!==s&&f.target!==this.rootTarget.parent;)f.currentTarget=f.target,this.notifyTarget(f),i&&this.notifyTarget(f,"mouseenter"),f.target=f.target.parent;this.freeEvent(f)}this.freeEvent(d)}const o=[],a=this.enableGlobalMoveEvents??!0;this.moveOnAll?o.push("pointermove"):this.dispatchEvent(t,"pointermove"),a&&o.push("globalpointermove"),t.pointerType==="touch"&&(this.moveOnAll?o.splice(1,0,"touchmove"):this.dispatchEvent(t,"touchmove"),a&&o.push("globaltouchmove")),i&&(this.moveOnAll?o.splice(1,0,"mousemove"):this.dispatchEvent(t,"mousemove"),a&&o.push("globalmousemove"),this.cursor=(u=t.target)==null?void 0:u.cursor),o.length>0&&this.all(t,o),this._allInteractiveElements.length=0,this._hitElements.length=0,n.overTargets=t.composedPath(),this.freeEvent(t)}mapPointerOver(e){var o;if(!(e instanceof Ht)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const t=this.trackingData(e.pointerId),i=this.createPointerEvent(e),n=i.pointerType==="mouse"||i.pointerType==="pen";this.dispatchEvent(i,"pointerover"),n&&this.dispatchEvent(i,"mouseover"),i.pointerType==="mouse"&&(this.cursor=(o=i.target)==null?void 0:o.cursor);const s=this.clonePointerEvent(i,"pointerenter");for(s.eventPhase=s.AT_TARGET;s.target&&s.target!==this.rootTarget.parent;)s.currentTarget=s.target,this.notifyTarget(s),n&&this.notifyTarget(s,"mouseenter"),s.target=s.target.parent;t.overTargets=i.composedPath(),this.freeEvent(i),this.freeEvent(s)}mapPointerOut(e){if(!(e instanceof Ht)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const t=this.trackingData(e.pointerId);if(t.overTargets){const i=e.pointerType==="mouse"||e.pointerType==="pen",n=this.findMountedTarget(t.overTargets),s=this.createPointerEvent(e,"pointerout",n);this.dispatchEvent(s),i&&this.dispatchEvent(s,"mouseout");const o=this.createPointerEvent(e,"pointerleave",n);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),i&&this.notifyTarget(o,"mouseleave"),o.target=o.target.parent;t.overTargets=null,this.freeEvent(s),this.freeEvent(o)}this.cursor=null}mapPointerUp(e){if(!(e instanceof Ht)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const t=performance.now(),i=this.createPointerEvent(e);if(this.dispatchEvent(i,"pointerup"),i.pointerType==="touch")this.dispatchEvent(i,"touchend");else if(i.pointerType==="mouse"||i.pointerType==="pen"){const a=i.button===2;this.dispatchEvent(i,a?"rightup":"mouseup")}const n=this.trackingData(e.pointerId),s=this.findMountedTarget(n.pressTargetsByButton[e.button]);let o=s;if(s&&!i.composedPath().includes(s)){let a=s;for(;a&&!i.composedPath().includes(a);){if(i.currentTarget=a,this.notifyTarget(i,"pointerupoutside"),i.pointerType==="touch")this.notifyTarget(i,"touchendoutside");else if(i.pointerType==="mouse"||i.pointerType==="pen"){const l=i.button===2;this.notifyTarget(i,l?"rightupoutside":"mouseupoutside")}a=a.parent}delete n.pressTargetsByButton[e.button],o=a}if(o){const a=this.clonePointerEvent(i,"click");a.target=o,a.path=null,n.clicksByButton[e.button]||(n.clicksByButton[e.button]={clickCount:0,target:a.target,timeStamp:t});const l=n.clicksByButton[e.button];if(l.target===a.target&&t-l.timeStamp<200?++l.clickCount:l.clickCount=1,l.target=a.target,l.timeStamp=t,a.detail=l.clickCount,a.pointerType==="mouse"){const u=a.button===2;this.dispatchEvent(a,u?"rightclick":"click")}else a.pointerType==="touch"&&this.dispatchEvent(a,"tap");this.dispatchEvent(a,"pointertap"),this.freeEvent(a)}this.freeEvent(i)}mapPointerUpOutside(e){if(!(e instanceof Ht)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const t=this.trackingData(e.pointerId),i=this.findMountedTarget(t.pressTargetsByButton[e.button]),n=this.createPointerEvent(e);if(i){let s=i;for(;s;)n.currentTarget=s,this.notifyTarget(n,"pointerupoutside"),n.pointerType==="touch"?this.notifyTarget(n,"touchendoutside"):(n.pointerType==="mouse"||n.pointerType==="pen")&&this.notifyTarget(n,n.button===2?"rightupoutside":"mouseupoutside"),s=s.parent;delete t.pressTargetsByButton[e.button]}this.freeEvent(n)}mapWheel(e){if(!(e instanceof Kn)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const t=this.createWheelEvent(e);this.dispatchEvent(t),this.freeEvent(t)}findMountedTarget(e){if(!e)return null;let t=e[0];for(let i=1;i<e.length&&e[i].parent===t;i++)t=e[i];return t}createPointerEvent(e,t,i){const n=this.allocateEvent(Ht);return this.copyPointerData(e,n),this.copyMouseData(e,n),this.copyData(e,n),n.nativeEvent=e.nativeEvent,n.originalEvent=e,n.target=i??this.hitTest(n.global.x,n.global.y)??this._hitElements[0],typeof t=="string"&&(n.type=t),n}createWheelEvent(e){const t=this.allocateEvent(Kn);return this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.nativeEvent=e.nativeEvent,t.originalEvent=e,t.target=this.hitTest(t.global.x,t.global.y),t}clonePointerEvent(e,t){const i=this.allocateEvent(Ht);return i.nativeEvent=e.nativeEvent,i.originalEvent=e.originalEvent,this.copyPointerData(e,i),this.copyMouseData(e,i),this.copyData(e,i),i.target=e.target,i.path=e.composedPath().slice(),i.type=t??i.type,i}copyWheelData(e,t){t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ}copyPointerData(e,t){e instanceof Ht&&t instanceof Ht&&(t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist)}copyMouseData(e,t){e instanceof jl&&t instanceof jl&&(t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.copyFrom(e.client),t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.copyFrom(e.movement),t.screen.copyFrom(e.screen),t.shiftKey=e.shiftKey,t.global.copyFrom(e.global))}copyData(e,t){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.detail=e.detail,t.view=e.view,t.which=e.which,t.layer.copyFrom(e.layer),t.page.copyFrom(e.page)}trackingData(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]}allocateEvent(e){this.eventPool.has(e)||this.eventPool.set(e,[]);const t=this.eventPool.get(e).pop()||new e(this);return t.eventPhase=t.NONE,t.currentTarget=null,t.path=null,t.target=null,t}freeEvent(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const t=e.constructor;this.eventPool.has(t)||this.eventPool.set(t,[]),this.eventPool.get(t).push(e)}notifyListeners(e,t){const i=e.currentTarget._events[t];if(i&&e.currentTarget.isInteractive())if("fn"in i)i.once&&e.currentTarget.removeListener(t,i.fn,void 0,!0),i.fn.call(i.context,e);else for(let n=0,s=i.length;n<s&&!e.propagationImmediatelyStopped;n++)i[n].once&&e.currentTarget.removeListener(t,i[n].fn,void 0,!0),i[n].fn.call(i[n].context,e)}}const oI=1,aI={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},Fd=class Ud{constructor(e){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=e,this.rootBoundary=new sI(null),ti.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new Ht(null),this.rootWheelEvent=new Kn(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...Ud.defaultEventFeatures},{set:(t,i,n)=>(i==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=n),t[i]=n,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(e){const{view:t,resolution:i}=this.renderer;this.setTargetElement(t),this.resolution=i,Ud._defaultEventMode=e.eventMode??"auto",Object.assign(this.features,e.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(e){this.resolution=e}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(e){e=e||"default";let t=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(t=!1),this.currentCursor===e)return;this.currentCursor=e;const i=this.cursorStyles[e];if(i)switch(typeof i){case"string":t&&(this.domElement.style.cursor=i);break;case"function":i(e);break;case"object":t&&Object.assign(this.domElement.style,i);break}else t&&typeof e=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.domElement.style.cursor=e)}get pointer(){return this.rootPointerEvent}onPointerDown(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const t=this.normalizeToPointerData(e);this.autoPreventDefault&&t[0].isNormalized&&(e.cancelable||!("cancelable"in e))&&e.preventDefault();for(let i=0,n=t.length;i<n;i++){const s=t[i],o=this.bootstrapEvent(this.rootPointerEvent,s);this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(e){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,ti.pointerMoved();const t=this.normalizeToPointerData(e);for(let i=0,n=t.length;i<n;i++){const s=this.bootstrapEvent(this.rootPointerEvent,t[i]);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let t=e.target;e.composedPath&&e.composedPath().length>0&&(t=e.composedPath()[0]);const i=t!==this.domElement?"outside":"",n=this.normalizeToPointerData(e);for(let s=0,o=n.length;s<o;s++){const a=this.bootstrapEvent(this.rootPointerEvent,n[s]);a.type+=i,this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const t=this.normalizeToPointerData(e);for(let i=0,n=t.length;i<n;i++){const s=this.bootstrapEvent(this.rootPointerEvent,t[i]);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}onWheel(e){if(!this.features.wheel)return;const t=this.normalizeWheelEvent(e);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(t)}setTargetElement(e){this.removeEvents(),this.domElement=e,ti.domElement=e,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;ti.addTickerListener();const e=this.domElement.style;e&&(globalThis.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;ti.removeTickerListener();const e=this.domElement.style;globalThis.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(e,t,i){const n=this.domElement.isConnected?this.domElement.getBoundingClientRect():{width:this.domElement.width,height:this.domElement.height,left:0,top:0},s=1/this.resolution;e.x=(t-n.left)*(this.domElement.width/n.width)*s,e.y=(i-n.top)*(this.domElement.height/n.height)*s}normalizeToPointerData(e){const t=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(let i=0,n=e.changedTouches.length;i<n;i++){const s=e.changedTouches[i];typeof s.button>"u"&&(s.button=0),typeof s.buttons>"u"&&(s.buttons=1),typeof s.isPrimary>"u"&&(s.isPrimary=e.touches.length===1&&e.type==="touchstart"),typeof s.width>"u"&&(s.width=s.radiusX||1),typeof s.height>"u"&&(s.height=s.radiusY||1),typeof s.tiltX>"u"&&(s.tiltX=0),typeof s.tiltY>"u"&&(s.tiltY=0),typeof s.pointerType>"u"&&(s.pointerType="touch"),typeof s.pointerId>"u"&&(s.pointerId=s.identifier||0),typeof s.pressure>"u"&&(s.pressure=s.force||.5),typeof s.twist>"u"&&(s.twist=0),typeof s.tangentialPressure>"u"&&(s.tangentialPressure=0),typeof s.layerX>"u"&&(s.layerX=s.offsetX=s.clientX),typeof s.layerY>"u"&&(s.layerY=s.offsetY=s.clientY),s.isNormalized=!0,s.type=e.type,t.push(s)}else if(!globalThis.MouseEvent||e instanceof MouseEvent&&(!this.supportsPointerEvents||!(e instanceof globalThis.PointerEvent))){const i=e;typeof i.isPrimary>"u"&&(i.isPrimary=!0),typeof i.width>"u"&&(i.width=1),typeof i.height>"u"&&(i.height=1),typeof i.tiltX>"u"&&(i.tiltX=0),typeof i.tiltY>"u"&&(i.tiltY=0),typeof i.pointerType>"u"&&(i.pointerType="mouse"),typeof i.pointerId>"u"&&(i.pointerId=oI),typeof i.pressure>"u"&&(i.pressure=.5),typeof i.twist>"u"&&(i.twist=0),typeof i.tangentialPressure>"u"&&(i.tangentialPressure=0),i.isNormalized=!0,t.push(i)}else t.push(e);return t}normalizeWheelEvent(e){const t=this.rootWheelEvent;return this.transferMouseData(t,e),t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ,t.deltaMode=e.deltaMode,this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.nativeEvent=e,t.type=e.type,t}bootstrapEvent(e,t){return e.originalEvent=null,e.nativeEvent=t,e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist,this.transferMouseData(e,t),this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.isTrusted=t.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=aI[e.type]||e.type),e}transferMouseData(e,t){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.relatedTarget=null,e.shiftKey=t.shiftKey}};Fd.extension={name:"events",type:[B.RendererSystem,B.CanvasRendererSystem]},Fd.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};let Gd=Fd;V.add(Gd);function Kg(r){return r==="dynamic"||r==="static"}const lI={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??Kg(Gd.defaultEventMode)},set interactive(r){ee("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=r,this.eventMode=r?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??Gd.defaultEventMode},set eventMode(r){this._internalInteractive=Kg(r),this._internalEventMode=r},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(r,e,t){const i=typeof t=="boolean"&&t||typeof t=="object"&&t.capture,n=typeof t=="object"?t.signal:void 0,s=typeof t=="object"?t.once===!0:!1,o=typeof e=="function"?void 0:e;r=i?`${r}capture`:r;const a=typeof e=="function"?e:e.handleEvent,l=this;n&&n.addEventListener("abort",()=>{l.off(r,a,o)}),s?l.once(r,a,o):l.on(r,a,o)},removeEventListener(r,e,t){const i=typeof t=="boolean"&&t||typeof t=="object"&&t.capture,n=typeof e=="function"?void 0:e;r=i?`${r}capture`:r,e=typeof e=="function"?e:e.handleEvent,this.off(r,e,n)},dispatchEvent(r){if(!(r instanceof Uo))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return r.defaultPrevented=!1,r.path=null,r.target=this,r.manager.dispatchEvent(r),!r.defaultPrevented}};Ce.mixin(lI);const uI={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};Ce.mixin(uI);const hI=9,xa=100,cI=0,dI=0,Zg=2,Qg=1,fI=-1e3,pI=-1e3,mI=2;class Fx{constructor(e){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(Dr.tablet||Dr.phone)&&this.createTouchHook();const t=document.createElement("div");t.style.width=`${xa}px`,t.style.height=`${xa}px`,t.style.position="absolute",t.style.top=`${cI}px`,t.style.left=`${dI}px`,t.style.zIndex=Zg.toString(),this.div=t,this.renderer=e,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const e=document.createElement("button");e.style.width=`${Qg}px`,e.style.height=`${Qg}px`,e.style.position="absolute",e.style.top=`${fI}px`,e.style.left=`${pI}px`,e.style.zIndex=mI.toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(e),this._hookDiv=e}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var e;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(e=this.renderer.view.parentNode)==null||e.appendChild(this.div))}deactivate(){var e;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(e=this.div.parentNode)==null||e.removeChild(this.div))}updateAccessibleObjects(e){if(!e.visible||!e.accessibleChildren)return;e.accessible&&e.isInteractive()&&(e._accessibleActive||this.addChild(e),e.renderId=this.renderId);const t=e.children;if(t)for(let i=0;i<t.length;i++)this.updateAccessibleObjects(t[i])}update(){const e=performance.now();if(Dr.android.device&&e<this.androidUpdateCount||(this.androidUpdateCount=e+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:t,y:i,width:n,height:s}=this.renderer.view.getBoundingClientRect(),{width:o,height:a,resolution:l}=this.renderer,u=n/o*l,h=s/a*l;let d=this.div;d.style.left=`${t}px`,d.style.top=`${i}px`,d.style.width=`${o}px`,d.style.height=`${a}px`;for(let c=0;c<this.children.length;c++){const f=this.children[c];if(f.renderId!==this.renderId)f._accessibleActive=!1,Yn(this.children,c,1),this.div.removeChild(f._accessibleDiv),this.pool.push(f._accessibleDiv),f._accessibleDiv=null,c--;else{d=f._accessibleDiv;let p=f.hitArea;const v=f.worldTransform;f.hitArea?(d.style.left=`${(v.tx+p.x*v.a)*u}px`,d.style.top=`${(v.ty+p.y*v.d)*h}px`,d.style.width=`${p.width*v.a*u}px`,d.style.height=`${p.height*v.d*h}px`):(p=f.getBounds(),this.capHitArea(p),d.style.left=`${p.x*u}px`,d.style.top=`${p.y*h}px`,d.style.width=`${p.width*u}px`,d.style.height=`${p.height*h}px`,d.title!==f.accessibleTitle&&f.accessibleTitle!==null&&(d.title=f.accessibleTitle),d.getAttribute("aria-label")!==f.accessibleHint&&f.accessibleHint!==null&&d.setAttribute("aria-label",f.accessibleHint)),(f.accessibleTitle!==d.title||f.tabIndex!==d.tabIndex)&&(d.title=f.accessibleTitle,d.tabIndex=f.tabIndex,this.debug&&this.updateDebugHTML(d))}}this.renderId++}updateDebugHTML(e){e.innerHTML=`type: ${e.type}</br> title : ${e.title}</br> tabIndex: ${e.tabIndex}`}capHitArea(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0);const{width:t,height:i}=this.renderer;e.x+e.width>t&&(e.width=t-e.x),e.y+e.height>i&&(e.height=i-e.y)}addChild(e){let t=this.pool.pop();t||(t=document.createElement("button"),t.style.width=`${xa}px`,t.style.height=`${xa}px`,t.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",t.style.position="absolute",t.style.zIndex=Zg.toString(),t.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?t.setAttribute("aria-live","off"):t.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?t.setAttribute("aria-relevant","additions"):t.setAttribute("aria-relevant","text"),t.addEventListener("click",this._onClick.bind(this)),t.addEventListener("focus",this._onFocus.bind(this)),t.addEventListener("focusout",this._onFocusOut.bind(this))),t.style.pointerEvents=e.accessiblePointerEvents,t.type=e.accessibleType,e.accessibleTitle&&e.accessibleTitle!==null?t.title=e.accessibleTitle:(!e.accessibleHint||e.accessibleHint===null)&&(t.title=`displayObject ${e.tabIndex}`),e.accessibleHint&&e.accessibleHint!==null&&t.setAttribute("aria-label",e.accessibleHint),this.debug&&this.updateDebugHTML(t),e._accessibleActive=!0,e._accessibleDiv=t,t.displayObject=e,this.children.push(e),this.div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex}_dispatchEvent(e,t){const{displayObject:i}=e.target,n=this.renderer.events.rootBoundary,s=Object.assign(new Uo(n),{target:i});n.rootTarget=this.renderer.lastObjectRendered,t.forEach(o=>n.dispatchEvent(s,o))}_onClick(e){this._dispatchEvent(e,["click","pointertap","tap"])}_onFocus(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive"),this._dispatchEvent(e,["mouseover"])}_onFocusOut(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite"),this._dispatchEvent(e,["mouseout"])}_onKeyDown(e){e.keyCode===hI&&this.activate()}_onMouseMove(e){e.movementX===0&&e.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}Fx.extension={name:"accessibility",type:[B.RendererPlugin,B.CanvasRendererPlugin]};V.add(Fx);const Ux=class Hd{constructor(e){this.stage=new Qt,e=Object.assign({forceCanvas:!1},e),this.renderer=AR(e),Hd._plugins.forEach(t=>{t.init.call(this,e)})}render(){this.renderer.render(this.stage)}get view(){var e;return(e=this.renderer)==null?void 0:e.view}get screen(){var e;return(e=this.renderer)==null?void 0:e.screen}destroy(e,t){const i=Hd._plugins.slice(0);i.reverse(),i.forEach(n=>{n.destroy.call(this)}),this.stage.destroy(t),this.stage=null,this.renderer.destroy(e),this.renderer=null}};Ux._plugins=[];let Gx=Ux;V.handleByList(B.Application,Gx._plugins);class Hx{static init(e){Object.defineProperty(this,"resizeTo",{set(t){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=t,t&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let t,i;if(this._resizeTo===globalThis.window)t=globalThis.innerWidth,i=globalThis.innerHeight;else{const{clientWidth:n,clientHeight:s}=this._resizeTo;t=n,i=s}this.renderer.resize(t,i),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}Hx.extension=B.Application;V.add(Hx);const Jg={loader:B.LoadParser,resolver:B.ResolveParser,cache:B.CacheParser,detection:B.DetectionParser};V.handle(B.Asset,r=>{const e=r.ref;Object.entries(Jg).filter(([t])=>!!e[t]).forEach(([t,i])=>V.add(Object.assign(e[t],{extension:e[t].extension??i})))},r=>{const e=r.ref;Object.keys(Jg).filter(t=>!!e[t]).forEach(t=>V.remove(e[t]))});class gI{constructor(e,t=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=t}add(e){e.forEach(t=>{this._assetList.push(t)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const e=[],t=Math.min(this._assetList.length,this._maxConcurrent);for(let i=0;i<t;i++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}function fs(r,e){if(Array.isArray(e)){for(const t of e)if(r.startsWith(`data:${t}`))return!0;return!1}return r.startsWith(`data:${e}`)}function Ci(r,e){const t=r.split("?")[0],i=je.extname(t).toLowerCase();return Array.isArray(e)?e.includes(i):i===e}const jt=(r,e,t=!1)=>(Array.isArray(r)||(r=[r]),e?r.map(i=>typeof i=="string"||t?e(i):i):r),$d=(r,e)=>{const t=e.split("?")[1];return t&&(r+=`?${t}`),r};function $x(r,e,t,i,n){const s=e[t];for(let o=0;o<s.length;o++){const a=s[o];t<e.length-1?$x(r.replace(i[t],a),e,t+1,i,n):n.push(r.replace(i[t],a))}}function yI(r){const e=/\{(.*?)\}/g,t=r.match(e),i=[];if(t){const n=[];t.forEach(s=>{const o=s.substring(1,s.length-1).split(",");n.push(o)}),$x(r,n,0,t,i)}else i.push(r);return i}const Wl=r=>!Array.isArray(r);class vI{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){const t=this._cache.get(e);return t||console.warn(`[Assets] Asset id ${e} was not found in the Cache`),t}set(e,t){const i=jt(e);let n;for(let a=0;a<this.parsers.length;a++){const l=this.parsers[a];if(l.test(t)){n=l.getCacheableAssets(i,t);break}}n||(n={},i.forEach(a=>{n[a]=t}));const s=Object.keys(n),o={cacheKeys:s,keys:i};if(i.forEach(a=>{this._cacheMap.set(a,o)}),s.forEach(a=>{const l=n?n[a]:t;this._cache.has(a)&&this._cache.get(a)!==l&&console.warn("[Cache] already has key:",a),this._cache.set(a,n[a])}),t instanceof z){const a=t;i.forEach(l=>{a.baseTexture!==z.EMPTY.baseTexture&&K.addToCache(a.baseTexture,l),z.addToCache(a,l)})}}remove(e){if(!this._cacheMap.has(e)){console.warn(`[Assets] Asset id ${e} was not found in the Cache`);return}const t=this._cacheMap.get(e);t.cacheKeys.forEach(i=>{this._cache.delete(i)}),t.keys.forEach(i=>{this._cacheMap.delete(i)})}get parsers(){return this._parsers}}const Ui=new vI;class _I{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,t,i)=>(this._parsersValidated=!1,e[t]=i,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,t){const i={promise:null,parser:null};return i.promise=(async()=>{var o,a;let n=null,s=null;if(t.loadParser&&(s=this._parserHash[t.loadParser],s||console.warn(`[Assets] specified load parser "${t.loadParser}" not found while loading ${e}`)),!s){for(let l=0;l<this.parsers.length;l++){const u=this.parsers[l];if(u.load&&((o=u.test)!=null&&o.call(u,e,t,this))){s=u;break}}if(!s)return console.warn(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}n=await s.load(e,t,this),i.parser=s;for(let l=0;l<this.parsers.length;l++){const u=this.parsers[l];u.parse&&u.parse&&await((a=u.testParse)==null?void 0:a.call(u,n,t,this))&&(n=await u.parse(n,t,this)||n,i.parser=u)}return n})(),i}async load(e,t){this._parsersValidated||this._validateParsers();let i=0;const n={},s=Wl(e),o=jt(e,u=>({alias:[u],src:u})),a=o.length,l=o.map(async u=>{const h=je.toAbsolute(u.src);if(!n[u.src])try{this.promiseCache[h]||(this.promiseCache[h]=this._getLoadPromiseAndParser(h,u)),n[u.src]=await this.promiseCache[h].promise,t&&t(++i/a)}catch(d){throw delete this.promiseCache[h],delete n[u.src],new Error(`[Loader.load] Failed to load ${h}.
${d}`)}});return await Promise.all(l),s?n[o[0].src]:n}async unload(e){const t=jt(e,i=>({alias:[i],src:i})).map(async i=>{var o,a;const n=je.toAbsolute(i.src),s=this.promiseCache[n];if(s){const l=await s.promise;delete this.promiseCache[n],(a=(o=s.parser)==null?void 0:o.unload)==null||a.call(o,l,i,this)}});await Promise.all(t)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(e=>e.name).reduce((e,t)=>(e[t.name]&&console.warn(`[Assets] loadParser name conflict "${t.name}"`),{...e,[t.name]:t}),{})}}var Jt=(r=>(r[r.Low=0]="Low",r[r.Normal=1]="Normal",r[r.High=2]="High",r))(Jt||{});const xI=".json",wI="application/json",EI={extension:{type:B.LoadParser,priority:Jt.Low},name:"loadJson",test(r){return fs(r,wI)||Ci(r,xI)},async load(r){return await(await U.ADAPTER.fetch(r)).json()}};V.add(EI);const TI=".txt",SI="text/plain",AI={name:"loadTxt",extension:{type:B.LoadParser,priority:Jt.Low},test(r){return fs(r,SI)||Ci(r,TI)},async load(r){return await(await U.ADAPTER.fetch(r)).text()}};V.add(AI);const bI=["normal","bold","100","200","300","400","500","600","700","800","900"],CI=[".ttf",".otf",".woff",".woff2"],RI=["font/ttf","font/otf","font/woff","font/woff2"],II=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function PI(r){const e=je.extname(r),t=je.basename(r,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map(s=>s.charAt(0).toUpperCase()+s.slice(1));let i=t.length>0;for(const s of t)if(!s.match(II)){i=!1;break}let n=t.join(" ");return i||(n=`"${n.replace(/[\\"]/g,"\\$&")}"`),n}const kI=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function MI(r){return kI.test(r)?r:encodeURI(r)}const DI={extension:{type:B.LoadParser,priority:Jt.Low},name:"loadWebFont",test(r){return fs(r,RI)||Ci(r,CI)},async load(r,e){var i,n,s;const t=U.ADAPTER.getFontFaceSet();if(t){const o=[],a=((i=e.data)==null?void 0:i.family)??PI(r),l=((s=(n=e.data)==null?void 0:n.weights)==null?void 0:s.filter(h=>bI.includes(h)))??["normal"],u=e.data??{};for(let h=0;h<l.length;h++){const d=l[h],c=new FontFace(a,`url(${MI(r)})`,{...u,weight:d});await c.load(),t.add(c),o.push(c)}return o.length===1?o[0]:o}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(r){(Array.isArray(r)?r:[r]).forEach(e=>U.ADAPTER.getFontFaceSet().delete(e))}};V.add(DI);const NI=`(function() {
  "use strict";
  const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
  async function checkImageBitmap() {
    try {
      if (typeof createImageBitmap != "function")
        return !1;
      const imageBlob = await (await fetch(WHITE_PNG)).blob(), imageBitmap = await createImageBitmap(imageBlob);
      return imageBitmap.width === 1 && imageBitmap.height === 1;
    } catch {
      return !1;
    }
  }
  checkImageBitmap().then((result) => {
    self.postMessage(result);
  });
})();
`;let Zn=null,zd=class{constructor(){Zn||(Zn=URL.createObjectURL(new Blob([NI],{type:"application/javascript"}))),this.worker=new Worker(Zn)}};zd.revokeObjectURL=function(){Zn&&(URL.revokeObjectURL(Zn),Zn=null)};const OI=`(function() {
  "use strict";
  async function loadImageBitmap(url) {
    const response = await fetch(url);
    if (!response.ok)
      throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
    const imageBlob = await response.blob();
    return await createImageBitmap(imageBlob);
  }
  self.onmessage = async (event) => {
    try {
      const imageBitmap = await loadImageBitmap(event.data.data[0]);
      self.postMessage({
        data: imageBitmap,
        uuid: event.data.uuid,
        id: event.data.id
      }, [imageBitmap]);
    } catch (e) {
      self.postMessage({
        error: e,
        uuid: event.data.uuid,
        id: event.data.id
      });
    }
  };
})();
`;let Qn=null;class zx{constructor(){Qn||(Qn=URL.createObjectURL(new Blob([OI],{type:"application/javascript"}))),this.worker=new Worker(Qn)}}zx.revokeObjectURL=function(){Qn&&(URL.revokeObjectURL(Qn),Qn=null)};let ey=0,$h;class BI{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(e=>{const{worker:t}=new zd;t.addEventListener("message",i=>{t.terminate(),zd.revokeObjectURL(),e(i.data)})}),this._isImageBitmapSupported)}loadImageBitmap(e){return this._run("loadImageBitmap",[e])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){$h===void 0&&($h=navigator.hardwareConcurrency||4);let e=this.workerPool.pop();return!e&&this._createdWorkers<$h&&(this._createdWorkers++,e=new zx().worker,e.addEventListener("message",t=>{this.complete(t.data),this.returnWorker(t.target),this.next()})),e}returnWorker(e){this.workerPool.push(e)}complete(e){e.error!==void 0?this.resolveHash[e.uuid].reject(e.error):this.resolveHash[e.uuid].resolve(e.data),this.resolveHash[e.uuid]=null}async _run(e,t){await this._initWorkers();const i=new Promise((n,s)=>{this.queue.push({id:e,arguments:t,resolve:n,reject:s})});return this.next(),i}next(){if(!this.queue.length)return;const e=this.getWorker();if(!e)return;const t=this.queue.pop(),i=t.id;this.resolveHash[ey]={resolve:t.resolve,reject:t.reject},e.postMessage({data:t.arguments,uuid:ey++,id:i})}}const ty=new BI;function Go(r,e,t){r.resource.internal=!0;const i=new z(r),n=()=>{delete e.promiseCache[t],Ui.has(t)&&Ui.remove(t)};return i.baseTexture.once("destroyed",()=>{t in e.promiseCache&&(console.warn("[Assets] A BaseTexture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the BaseTexture."),n())}),i.once("destroyed",()=>{r.destroyed||(console.warn("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),n())}),i}const LI=[".jpeg",".jpg",".png",".webp",".avif"],FI=["image/jpeg","image/png","image/webp","image/avif"];async function UI(r){const e=await U.ADAPTER.fetch(r);if(!e.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${r}: ${e.status} ${e.statusText}`);const t=await e.blob();return await createImageBitmap(t)}const bu={name:"loadTextures",extension:{type:B.LoadParser,priority:Jt.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(r){return fs(r,FI)||Ci(r,LI)},async load(r,e,t){var a;const i=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap;let n;i?this.config.preferWorkers&&await ty.isImageBitmapSupported()?n=await ty.loadImageBitmap(r):n=await UI(r):n=await new Promise((l,u)=>{const h=new Image;h.crossOrigin=this.config.crossOrigin,h.src=r,h.complete?l(h):(h.onload=()=>l(h),h.onerror=d=>u(d))});const s={...e.data};s.resolution??(s.resolution=$r(r)),i&&((a=s.resourceOptions)==null?void 0:a.ownsImageBitmap)===void 0&&(s.resourceOptions={...s.resourceOptions},s.resourceOptions.ownsImageBitmap=!0);const o=new K(n,s);return o.resource.src=r,Go(o,t,r)},unload(r){r.destroy(!0)}};V.add(bu);const GI=".svg",HI="image/svg+xml",$I={extension:{type:B.LoadParser,priority:Jt.High},name:"loadSVG",test(r){return fs(r,HI)||Ci(r,GI)},async testParse(r){return Md.test(r)},async parse(r,e,t){var s;const i=new Md(r,(s=e==null?void 0:e.data)==null?void 0:s.resourceOptions);await i.load();const n=new K(i,{resolution:$r(r),...e==null?void 0:e.data});return n.resource.src=e.src,Go(n,t,e.src)},async load(r,e){return(await U.ADAPTER.fetch(r)).text()},unload:bu.unload};V.add($I);const zI=[".mp4",".m4v",".webm",".ogv"],VI=["video/mp4","video/webm","video/ogg"],XI={name:"loadVideo",extension:{type:B.LoadParser,priority:Jt.High},config:{defaultAutoPlay:!0,defaultUpdateFPS:0,defaultLoop:!1,defaultMuted:!1,defaultPlaysinline:!0},test(r){return fs(r,VI)||Ci(r,zI)},async load(r,e,t){var o;let i;const n=await(await U.ADAPTER.fetch(r)).blob(),s=URL.createObjectURL(n);try{const a={autoPlay:this.config.defaultAutoPlay,updateFPS:this.config.defaultUpdateFPS,loop:this.config.defaultLoop,muted:this.config.defaultMuted,playsinline:this.config.defaultPlaysinline,...(o=e==null?void 0:e.data)==null?void 0:o.resourceOptions,autoLoad:!0},l=new Ox(s,a);await l.load();const u=new K(l,{alphaMode:await Zb(),resolution:$r(r),...e==null?void 0:e.data});u.resource.src=r,i=Go(u,t,r),i.baseTexture.once("destroyed",()=>{URL.revokeObjectURL(s)})}catch(a){throw URL.revokeObjectURL(s),a}return i},unload(r){r.destroy(!0)}};V.add(XI);class jI{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,t)=>`${e}${this._bundleIdConnector}${t}`,extractAssetIdFromBundle:(e,t)=>t.replace(`${e}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach(t=>{this._preferredOrder.push(t),t.priority||(t.priority=Object.keys(t.params))}),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){if(typeof e=="string")this._defaultSearchParams=e;else{const t=e;this._defaultSearchParams=Object.keys(t).map(i=>`${encodeURIComponent(i)}=${encodeURIComponent(t[i])}`).join("&")}}getAlias(e){const{alias:t,name:i,src:n,srcs:s}=e;return jt(t||i||n||s,o=>typeof o=="string"?o:Array.isArray(o)?o.map(a=>(a==null?void 0:a.src)??(a==null?void 0:a.srcs)??a):o!=null&&o.src||o!=null&&o.srcs?o.src??o.srcs:o,!0)}addManifest(e){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(t=>{this.addBundle(t.name,t.assets)})}addBundle(e,t){const i=[];Array.isArray(t)?t.forEach(n=>{const s=n.src??n.srcs,o=n.alias??n.name;let a;if(typeof o=="string"){const l=this._createBundleAssetId(e,o);i.push(l),a=[o,l]}else{const l=o.map(u=>this._createBundleAssetId(e,u));i.push(...l),a=[...o,...l]}this.add({...n,alias:a,src:s})}):Object.keys(t).forEach(n=>{const s=[n,this._createBundleAssetId(e,n)];if(typeof t[n]=="string")this.add({alias:s,src:t[n]});else if(Array.isArray(t[n]))this.add({alias:s,src:t[n]});else{const o=t[n],a=o.src??o.srcs;this.add({...o,alias:s,src:Array.isArray(a)?a:[a]})}i.push(...s)}),this._bundles[e]=i}add(e,t,i,n,s){const o=[];typeof e=="string"||Array.isArray(e)&&typeof e[0]=="string"?(ee("7.2.0",`Assets.add now uses an object instead of individual parameters.
Please use Assets.add({ alias, src, data, format, loadParser }) instead.`),o.push({alias:e,src:t,data:i,format:n,loadParser:s})):Array.isArray(e)?o.push(...e):o.push(e);let a;a=l=>{this.hasKey(l)&&console.warn(`[Resolver] already has key: ${l} overwriting`)},jt(o).forEach(l=>{const{src:u,srcs:h}=l;let{data:d,format:c,loadParser:f}=l;const p=jt(u||h).map(g=>typeof g=="string"?yI(g):Array.isArray(g)?g:[g]),v=this.getAlias(l);Array.isArray(v)?v.forEach(a):a(v);const x=[];p.forEach(g=>{g.forEach(y=>{let m={};if(typeof y!="object"){m.src=y;for(let _=0;_<this._parsers.length;_++){const w=this._parsers[_];if(w.test(y)){m=w.parse(y);break}}}else d=y.data??d,c=y.format??c,f=y.loadParser??f,m={...m,...y};if(!v)throw new Error(`[Resolver] alias is undefined for this asset: ${m.src}`);m=this.buildResolvedAsset(m,{aliases:v,data:d,format:c,loadParser:f}),x.push(m)})}),v.forEach(g=>{this._assetMap[g]=x})})}resolveBundle(e){const t=Wl(e);e=jt(e);const i={};return e.forEach(n=>{const s=this._bundles[n];if(s){const o=this.resolve(s),a={};for(const l in o){const u=o[l];a[this._extractAssetIdFromBundle(n,l)]=u}i[n]=a}}),t?i[e[0]]:i}resolveUrl(e){const t=this.resolve(e);if(typeof e!="string"){const i={};for(const n in t)i[n]=t[n].src;return i}return t.src}resolve(e){const t=Wl(e);e=jt(e);const i={};return e.forEach(n=>{if(!this._resolverHash[n])if(this._assetMap[n]){let s=this._assetMap[n];const o=s[0],a=this._getPreferredOrder(s);a==null||a.priority.forEach(l=>{a.params[l].forEach(u=>{const h=s.filter(d=>d[l]?d[l]===u:!1);h.length&&(s=h)})}),this._resolverHash[n]=s[0]??o}else this._resolverHash[n]=this.buildResolvedAsset({alias:[n],src:n},{});i[n]=this._resolverHash[n]}),t?i[e[0]]:i}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(e){for(let t=0;t<e.length;t++){const i=e[0],n=this._preferredOrder.find(s=>s.params.format.includes(i.format));if(n)return n}return this._preferredOrder[0]}_appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;const t=/\?/.test(e)?"&":"?";return`${e}${t}${this._defaultSearchParams}`}buildResolvedAsset(e,t){const{aliases:i,data:n,loadParser:s,format:o}=t;return(this._basePath||this._rootPath)&&(e.src=je.toAbsolute(e.src,this._basePath,this._rootPath)),e.alias=i??e.alias??[e.src],e.src=this._appendDefaultSearchParams(e.src),e.data={...n||{},...e.data},e.loadParser=s??e.loadParser,e.format=o??e.format??je.extname(e.src).slice(1),e.srcs=e.src,e.name=e.alias,e}}class WI{constructor(){this._detections=[],this._initialized=!1,this.resolver=new jI,this.loader=new _I,this.cache=Ui,this._backgroundLoader=new gI(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){var s,o;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let a=e.manifest;typeof a=="string"&&(a=await this.load(a)),this.resolver.addManifest(a)}const t=((s=e.texturePreference)==null?void 0:s.resolution)??1,i=typeof t=="number"?[t]:t,n=await this._detectFormats({preferredFormats:(o=e.texturePreference)==null?void 0:o.format,skipDetections:e.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:n,resolution:i}}),e.preferences&&this.setPreferences(e.preferences)}add(e,t,i,n,s){this.resolver.add(e,t,i,n,s)}async load(e,t){this._initialized||await this.init();const i=Wl(e),n=jt(e).map(a=>{if(typeof a!="string"){const l=this.resolver.getAlias(a);return l.some(u=>!this.resolver.hasKey(u))&&this.add(a),Array.isArray(l)?l[0]:l}return this.resolver.hasKey(a)||this.add({alias:a,src:a}),a}),s=this.resolver.resolve(n),o=await this._mapLoadToResolve(s,t);return i?o[n[0]]:o}addBundle(e,t){this.resolver.addBundle(e,t)}async loadBundle(e,t){this._initialized||await this.init();let i=!1;typeof e=="string"&&(i=!0,e=[e]);const n=this.resolver.resolveBundle(e),s={},o=Object.keys(n);let a=0,l=0;const u=()=>{t==null||t(++a/l)},h=o.map(d=>{const c=n[d];return l+=Object.keys(c).length,this._mapLoadToResolve(c,u).then(f=>{s[d]=f})});return await Promise.all(h),i?s[e[0]]:s}async backgroundLoad(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const t=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(t))}async backgroundLoadBundle(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const t=this.resolver.resolveBundle(e);Object.values(t).forEach(i=>{this._backgroundLoader.add(Object.values(i))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if(typeof e=="string")return Ui.get(e);const t={};for(let i=0;i<e.length;i++)t[i]=Ui.get(e[i]);return t}async _mapLoadToResolve(e,t){const i=Object.values(e),n=Object.keys(e);this._backgroundLoader.active=!1;const s=await this.loader.load(i,t);this._backgroundLoader.active=!0;const o={};return i.forEach((a,l)=>{const u=s[a.src],h=[a.src];a.alias&&h.push(...a.alias),o[n[l]]=u,Ui.set(h,u)}),o}async unload(e){this._initialized||await this.init();const t=jt(e).map(n=>typeof n!="string"?n.src:n),i=this.resolver.resolve(t);await this._unloadFromResolved(i)}async unloadBundle(e){this._initialized||await this.init(),e=jt(e);const t=this.resolver.resolveBundle(e),i=Object.keys(t).map(n=>this._unloadFromResolved(t[n]));await Promise.all(i)}async _unloadFromResolved(e){const t=Object.values(e);t.forEach(i=>{Ui.remove(i.src)}),await this.loader.unload(t)}async _detectFormats(e){let t=[];e.preferredFormats&&(t=Array.isArray(e.preferredFormats)?e.preferredFormats:[e.preferredFormats]);for(const i of e.detections)e.skipDetections||await i.test()?t=await i.add(t):e.skipDetections||(t=await i.remove(t));return t=t.filter((i,n)=>t.indexOf(i)===n),t}get detections(){return this._detections}get preferWorkers(){return bu.config.preferWorkers}set preferWorkers(e){ee("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:e})}setPreferences(e){this.loader.parsers.forEach(t=>{t.config&&Object.keys(t.config).filter(i=>i in e).forEach(i=>{t.config[i]=e[i]})})}}const wa=new WI;V.handleByList(B.LoadParser,wa.loader.parsers).handleByList(B.ResolveParser,wa.resolver.parsers).handleByList(B.CacheParser,wa.cache.parsers).handleByList(B.DetectionParser,wa.detections);const YI={extension:B.CacheParser,test:r=>Array.isArray(r)&&r.every(e=>e instanceof z),getCacheableAssets:(r,e)=>{const t={};return r.forEach(i=>{e.forEach((n,s)=>{t[i+(s===0?"":s+1)]=n})}),t}};V.add(YI);async function Vx(r){if("Image"in globalThis)return new Promise(e=>{const t=new Image;t.onload=()=>{e(!0)},t.onerror=()=>{e(!1)},t.src=r});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const e=await(await fetch(r)).blob();await createImageBitmap(e)}catch{return!1}return!0}return!1}const qI={extension:{type:B.DetectionParser,priority:1},test:async()=>Vx("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async r=>[...r,"avif"],remove:async r=>r.filter(e=>e!=="avif")};V.add(qI);const KI={extension:{type:B.DetectionParser,priority:0},test:async()=>Vx("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async r=>[...r,"webp"],remove:async r=>r.filter(e=>e!=="webp")};V.add(KI);const ry=["png","jpg","jpeg"],ZI={extension:{type:B.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async r=>[...r,...ry],remove:async r=>r.filter(e=>!ry.includes(e))};V.add(ZI);const QI="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function mp(r){return QI?!1:document.createElement("video").canPlayType(r)!==""}const JI={extension:{type:B.DetectionParser,priority:0},test:async()=>mp("video/webm"),add:async r=>[...r,"webm"],remove:async r=>r.filter(e=>e!=="webm")};V.add(JI);const eP={extension:{type:B.DetectionParser,priority:0},test:async()=>mp("video/mp4"),add:async r=>[...r,"mp4","m4v"],remove:async r=>r.filter(e=>e!=="mp4"&&e!=="m4v")};V.add(eP);const tP={extension:{type:B.DetectionParser,priority:0},test:async()=>mp("video/ogg"),add:async r=>[...r,"ogv"],remove:async r=>r.filter(e=>e!=="ogv")};V.add(tP);const rP={extension:B.ResolveParser,test:bu.test,parse:r=>{var e;return{resolution:parseFloat(((e=U.RETINA_PREFIX.exec(r))==null?void 0:e[1])??"1"),format:je.extname(r).slice(1),src:r}}};V.add(rP);var Ye=(r=>(r[r.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",r[r.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",r[r.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",r[r.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",r[r.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",r[r.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",r[r.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",r[r.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",r[r.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",r[r.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",r[r.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",r[r.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",r[r.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",r[r.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",r[r.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",r[r.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",r[r.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",r[r.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",r[r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",r[r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",r[r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",r[r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",r[r.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",r[r.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",r[r.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35987]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",r[r.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",r[r.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",r[r.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",r[r.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",r[r.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",r[r.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",r))(Ye||{});const Yl={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35987:1,34798:1,37808:1,36492:1,36493:1,36494:1,36495:1};let sr,En;function iy(){En={bptc:sr.getExtension("EXT_texture_compression_bptc"),astc:sr.getExtension("WEBGL_compressed_texture_astc"),etc:sr.getExtension("WEBGL_compressed_texture_etc"),s3tc:sr.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:sr.getExtension("WEBGL_compressed_texture_s3tc_srgb"),pvrtc:sr.getExtension("WEBGL_compressed_texture_pvrtc")||sr.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),etc1:sr.getExtension("WEBGL_compressed_texture_etc1"),atc:sr.getExtension("WEBGL_compressed_texture_atc")}}const iP={extension:{type:B.DetectionParser,priority:2},test:async()=>{const r=U.ADAPTER.createCanvas().getContext("webgl");return r?(sr=r,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async r=>{En||iy();const e=[];for(const t in En)En[t]&&e.push(t);return[...e,...r]},remove:async r=>(En||iy(),r.filter(e=>!(e in En)))};V.add(iP);class nP extends wu{constructor(e,t={width:1,height:1,autoLoad:!0}){let i,n;typeof e=="string"?(i=e,n=new Uint8Array):(i=null,n=e),super(n,t),this.origin=i,this.buffer=n?new _d(n):null,this._load=null,this.loaded=!1,this.origin!==null&&t.autoLoad!==!1&&this.load(),this.origin===null&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(e){}load(){return this._load?this._load:(this._load=fetch(this.origin).then(e=>e.blob()).then(e=>e.arrayBuffer()).then(e=>(this.data=new Uint32Array(e),this.buffer=new _d(e),this.loaded=!0,this.onBlobLoaded(e),this.update(),this)),this._load)}}class Wi extends nP{constructor(e,t){super(e,t),this.format=t.format,this.levels=t.levels||1,this._width=t.width,this._height=t.height,this._extension=Wi._formatToExtension(this.format),(t.levelBuffers||this.buffer)&&(this._levelBuffers=t.levelBuffers||Wi._createLevelBuffers(e instanceof Uint8Array?e:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(e,t,i){const n=e.gl;if(!e.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;n.pixelStorei(n.UNPACK_ALIGNMENT,4);for(let s=0,o=this.levels;s<o;s++){const{levelID:a,levelWidth:l,levelHeight:u,levelBuffer:h}=this._levelBuffers[s];n.compressedTexImage2D(n.TEXTURE_2D,a,this.format,l,u,0,h)}return!0}onBlobLoaded(){this._levelBuffers=Wi._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(e){if(e>=33776&&e<=33779)return"s3tc";if(e>=35916&&e<=35919)return"s3tc_sRGB";if(e>=37488&&e<=37497)return"etc";if(e>=35840&&e<=35843)return"pvrtc";if(e===36196)return"etc1";if(e===35986||e===35987||e===34798)return"atc";if(e>=36492&&e<=36495)return"bptc";if(e===37808)return"astc";throw new Error(`Invalid (compressed) texture format given: ${e}`)}static _createLevelBuffers(e,t,i,n,s,o,a){const l=new Array(i);let u=e.byteOffset,h=o,d=a,c=h+n-1&~(n-1),f=d+s-1&~(s-1),p=c*f*Yl[t];for(let v=0;v<i;v++)l[v]={levelID:v,levelWidth:i>1?h:c,levelHeight:i>1?d:f,levelBuffer:new Uint8Array(e.buffer,u,p)},u+=p,h=h>>1||1,d=d>>1||1,c=h+n-1&~(n-1),f=d+s-1&~(s-1),p=c*f*Yl[t];return l}}const zh=4,Ea=124,sP=32,ny=20,oP=542327876,Ta={HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},aP={FOURCC:2},Sa={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3},lP=1,uP=2,hP=4,cP=64,dP=512,fP=131072,pP=827611204,mP=861165636,gP=894720068,yP=808540228,vP=4,_P={[pP]:Ye.COMPRESSED_RGBA_S3TC_DXT1_EXT,[mP]:Ye.COMPRESSED_RGBA_S3TC_DXT3_EXT,[gP]:Ye.COMPRESSED_RGBA_S3TC_DXT5_EXT},xP={70:Ye.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:Ye.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:Ye.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:Ye.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:Ye.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:Ye.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:Ye.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:Ye.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:Ye.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,96:Ye.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT,95:Ye.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT,98:Ye.COMPRESSED_RGBA_BPTC_UNORM_EXT,99:Ye.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT};function wP(r){const e=new Uint32Array(r);if(e[0]!==oP)throw new Error("Invalid DDS file magic word");const t=new Uint32Array(r,0,Ea/Uint32Array.BYTES_PER_ELEMENT),i=t[Ta.HEIGHT],n=t[Ta.WIDTH],s=t[Ta.MIPMAP_COUNT],o=new Uint32Array(r,Ta.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,sP/Uint32Array.BYTES_PER_ELEMENT),a=o[lP];if(a&hP){const l=o[aP.FOURCC];if(l!==yP){const y=_P[l],m=zh+Ea,_=new Uint8Array(r,m);return[new Wi(_,{format:y,width:n,height:i,levels:s})]}const u=zh+Ea,h=new Uint32Array(e.buffer,u,ny/Uint32Array.BYTES_PER_ELEMENT),d=h[Sa.DXGI_FORMAT],c=h[Sa.RESOURCE_DIMENSION],f=h[Sa.MISC_FLAG],p=h[Sa.ARRAY_SIZE],v=xP[d];if(v===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${d}`);if(f===vP)throw new Error("DDSParser does not support cubemap textures");if(c===6)throw new Error("DDSParser does not supported 3D texture data");const x=new Array,g=zh+Ea+ny;if(p===1)x.push(new Uint8Array(r,g));else{const y=Yl[v];let m=0,_=n,w=i;for(let E=0;E<s;E++){const T=Math.max(1,_+3&-4),b=Math.max(1,w+3&-4),A=T*b*y;m+=A,_=_>>>1,w=w>>>1}let S=g;for(let E=0;E<p;E++)x.push(new Uint8Array(r,S,m)),S+=m}return x.map(y=>new Wi(y,{format:v,width:n,height:i,levels:s}))}throw a&cP?new Error("DDSParser does not support uncompressed texture data."):a&dP?new Error("DDSParser does not supported YUV uncompressed texture data."):a&fP?new Error("DDSParser does not support single-channel (lumninance) texture data!"):a&uP?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const sy=[171,75,84,88,32,49,49,187,13,10,26,10],EP=67305985,Ut={ENDIANNESS:12,GL_TYPE:16,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},Vd=64,oy={[W.UNSIGNED_BYTE]:1,[W.UNSIGNED_SHORT]:2,[W.INT]:4,[W.UNSIGNED_INT]:4,[W.FLOAT]:4,[W.HALF_FLOAT]:8},TP={[O.RGBA]:4,[O.RGB]:3,[O.RG]:2,[O.RED]:1,[O.LUMINANCE]:1,[O.LUMINANCE_ALPHA]:2,[O.ALPHA]:1},SP={[W.UNSIGNED_SHORT_4_4_4_4]:2,[W.UNSIGNED_SHORT_5_5_5_1]:2,[W.UNSIGNED_SHORT_5_6_5]:2};function AP(r,e,t=!1){const i=new DataView(e);if(!bP(r,i))return null;const n=i.getUint32(Ut.ENDIANNESS,!0)===EP,s=i.getUint32(Ut.GL_TYPE,n),o=i.getUint32(Ut.GL_FORMAT,n),a=i.getUint32(Ut.GL_INTERNAL_FORMAT,n),l=i.getUint32(Ut.PIXEL_WIDTH,n),u=i.getUint32(Ut.PIXEL_HEIGHT,n)||1,h=i.getUint32(Ut.PIXEL_DEPTH,n)||1,d=i.getUint32(Ut.NUMBER_OF_ARRAY_ELEMENTS,n)||1,c=i.getUint32(Ut.NUMBER_OF_FACES,n),f=i.getUint32(Ut.NUMBER_OF_MIPMAP_LEVELS,n),p=i.getUint32(Ut.BYTES_OF_KEY_VALUE_DATA,n);if(u===0||h!==1)throw new Error("Only 2D textures are supported");if(c!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(d!==1)throw new Error("WebGL does not support array textures");const v=4,x=4,g=l+3&-4,y=u+3&-4,m=new Array(d);let _=l*u;s===0&&(_=g*y);let w;if(s!==0?oy[s]?w=oy[s]*TP[o]:w=SP[s]:w=Yl[a],w===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const S=t?RP(i,p,n):null;let E=_*w,T=l,b=u,A=g,I=y,D=Vd+p;for(let C=0;C<f;C++){const k=i.getUint32(D,n);let L=D+4;for(let Y=0;Y<d;Y++){let $=m[Y];$||($=m[Y]=new Array(f)),$[C]={levelID:C,levelWidth:f>1||s!==0?T:A,levelHeight:f>1||s!==0?b:I,levelBuffer:new Uint8Array(e,L,E)},L+=E}D+=k+4,D=D%4!==0?D+4-D%4:D,T=T>>1||1,b=b>>1||1,A=T+v-1&-4,I=b+x-1&-4,E=A*I*w}return s!==0?{uncompressed:m.map(C=>{let k=C[0].levelBuffer,L=!1;return s===W.FLOAT?k=new Float32Array(C[0].levelBuffer.buffer,C[0].levelBuffer.byteOffset,C[0].levelBuffer.byteLength/4):s===W.UNSIGNED_INT?(L=!0,k=new Uint32Array(C[0].levelBuffer.buffer,C[0].levelBuffer.byteOffset,C[0].levelBuffer.byteLength/4)):s===W.INT&&(L=!0,k=new Int32Array(C[0].levelBuffer.buffer,C[0].levelBuffer.byteOffset,C[0].levelBuffer.byteLength/4)),{resource:new wu(k,{width:C[0].levelWidth,height:C[0].levelHeight}),type:s,format:L?CP(o):o}}),kvData:S}:{compressed:m.map(C=>new Wi(null,{format:a,width:l,height:u,levels:f,levelBuffers:C})),kvData:S}}function bP(r,e){for(let t=0;t<sy.length;t++)if(e.getUint8(t)!==sy[t])return console.error(`${r} is not a valid *.ktx file!`),!1;return!0}function CP(r){switch(r){case O.RGBA:return O.RGBA_INTEGER;case O.RGB:return O.RGB_INTEGER;case O.RG:return O.RG_INTEGER;case O.RED:return O.RED_INTEGER;default:return r}}function RP(r,e,t){const i=new Map;let n=0;for(;n<e;){const s=r.getUint32(Vd+n,t),o=Vd+n+4,a=3-(s+3)%4;if(s===0||s>e-n){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let l=0;for(;l<s&&r.getUint8(o+l)!==0;l++);if(l===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const u=new TextDecoder().decode(new Uint8Array(r.buffer,o,l)),h=new DataView(r.buffer,o+l+1,s-l-1);i.set(u,h),n+=4+s+a}return i}const IP={extension:{type:B.LoadParser,priority:Jt.High},name:"loadDDS",test(r){return Ci(r,".dds")},async load(r,e,t){const i=await(await U.ADAPTER.fetch(r)).arrayBuffer(),n=wP(i).map(s=>{const o=new K(s,{mipmap:_r.OFF,alphaMode:ct.NO_PREMULTIPLIED_ALPHA,resolution:$r(r),...e.data});return Go(o,t,r)});return n.length===1?n[0]:n},unload(r){Array.isArray(r)?r.forEach(e=>e.destroy(!0)):r.destroy(!0)}};V.add(IP);const PP={extension:{type:B.LoadParser,priority:Jt.High},name:"loadKTX",test(r){return Ci(r,".ktx")},async load(r,e,t){const i=await(await U.ADAPTER.fetch(r)).arrayBuffer(),{compressed:n,uncompressed:s,kvData:o}=AP(r,i),a=n??s,l={mipmap:_r.OFF,alphaMode:ct.NO_PREMULTIPLIED_ALPHA,resolution:$r(r),...e.data},u=a.map(h=>{a===s&&Object.assign(l,{type:h.type,format:h.format});const d=h.resource??h,c=new K(d,l);return c.ktxKeyValueData=o,Go(c,t,r)});return u.length===1?u[0]:u},unload(r){Array.isArray(r)?r.forEach(e=>e.destroy(!0)):r.destroy(!0)}};V.add(PP);const kP=["s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"],MP={extension:B.ResolveParser,test:r=>{const e=je.extname(r).slice(1);return["basis","ktx","dds"].includes(e)},parse:r=>{var i,n;const e=r.split("."),t=e.pop();if(["ktx","dds"].includes(t)){const s=e.pop();if(kP.includes(s))return{resolution:parseFloat(((i=U.RETINA_PREFIX.exec(r))==null?void 0:i[1])??"1"),format:s,src:r}}return{resolution:parseFloat(((n=U.RETINA_PREFIX.exec(r))==null?void 0:n[1])??"1"),format:t,src:r}}};V.add(MP);const Aa=new Z,DP=4,Xx=class Us{constructor(e){this.renderer=e,this._rendererPremultipliedAlpha=!1}contextChange(){var t;const e=(t=this.renderer)==null?void 0:t.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}async image(e,t,i,n){const s=new Image;return s.src=await this.base64(e,t,i,n),s}async base64(e,t,i,n){const s=this.canvas(e,n);if(s.toBlob!==void 0)return new Promise((o,a)=>{s.toBlob(l=>{if(!l){a(new Error("ICanvas.toBlob failed!"));return}const u=new FileReader;u.onload=()=>o(u.result),u.onerror=a,u.readAsDataURL(l)},t,i)});if(s.toDataURL!==void 0)return s.toDataURL(t,i);if(s.convertToBlob!==void 0){const o=await s.convertToBlob({type:t,quality:i});return new Promise((a,l)=>{const u=new FileReader;u.onload=()=>a(u.result),u.onerror=l,u.readAsDataURL(o)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(e,t){const{pixels:i,width:n,height:s,flipY:o,premultipliedAlpha:a}=this._rawPixels(e,t);o&&Us._flipY(i,n,s),a&&Us._unpremultiplyAlpha(i);const l=new fC(n,s,1),u=new ImageData(new Uint8ClampedArray(i.buffer),n,s);return l.context.putImageData(u,0,0),l.canvas}pixels(e,t){const{pixels:i,width:n,height:s,flipY:o,premultipliedAlpha:a}=this._rawPixels(e,t);return o&&Us._flipY(i,n,s),a&&Us._unpremultiplyAlpha(i),i}_rawPixels(e,t){const i=this.renderer;if(!i)throw new Error("The Extract has already been destroyed");let n,s=!1,o=!1,a,l=!1;e&&(e instanceof un?a=e:(a=i.generateTexture(e,{region:t,resolution:i.resolution,multisample:i.multisample}),l=!0,t&&(Aa.width=t.width,Aa.height=t.height,t=Aa)));const u=i.gl;if(a){if(n=a.baseTexture.resolution,t=t??a.frame,s=!1,o=a.baseTexture.alphaMode>0&&a.baseTexture.format===O.RGBA,!l){i.renderTexture.bind(a);const f=a.framebuffer.glFramebuffers[i.CONTEXT_UID];f.blitFramebuffer&&i.framebuffer.bind(f.blitFramebuffer)}}else n=i.resolution,t||(t=Aa,t.width=i.width/n,t.height=i.height/n),s=!0,o=this._rendererPremultipliedAlpha,i.renderTexture.bind();const h=Math.max(Math.round(t.width*n),1),d=Math.max(Math.round(t.height*n),1),c=new Uint8Array(DP*h*d);return u.readPixels(Math.round(t.x*n),Math.round(t.y*n),h,d,u.RGBA,u.UNSIGNED_BYTE,c),l&&(a==null||a.destroy(!0)),{pixels:c,width:h,height:d,flipY:s,premultipliedAlpha:o}}destroy(){this.renderer=null}static _flipY(e,t,i){const n=t<<2,s=i>>1,o=new Uint8Array(n);for(let a=0;a<s;a++){const l=a*n,u=(i-a-1)*n;o.set(e.subarray(l,l+n)),e.copyWithin(l,u,u+n),e.set(o,u)}}static _unpremultiplyAlpha(e){e instanceof Uint8ClampedArray&&(e=new Uint8Array(e.buffer));const t=e.length;for(let i=0;i<t;i+=4){const n=e[i+3];if(n!==0){const s=255.001/n;e[i]=e[i]*s+.5,e[i+1]=e[i+1]*s+.5,e[i+2]=e[i+2]*s+.5}}}};Xx.extension={name:"extract",type:B.RendererSystem};let NP=Xx;V.add(NP);const ql={build(r){const e=r.points;let t,i,n,s,o,a;if(r.type===Ke.CIRC){const p=r.shape;t=p.x,i=p.y,o=a=p.radius,n=s=0}else if(r.type===Ke.ELIP){const p=r.shape;t=p.x,i=p.y,o=p.width,a=p.height,n=s=0}else{const p=r.shape,v=p.width/2,x=p.height/2;t=p.x+v,i=p.y+x,o=a=Math.max(0,Math.min(p.radius,Math.min(v,x))),n=v-o,s=x-a}if(!(o>=0&&a>=0&&n>=0&&s>=0)){e.length=0;return}const l=Math.ceil(2.3*Math.sqrt(o+a)),u=l*8+(n?4:0)+(s?4:0);if(e.length=u,u===0)return;if(l===0){e.length=8,e[0]=e[6]=t+n,e[1]=e[3]=i+s,e[2]=e[4]=t-n,e[5]=e[7]=i-s;return}let h=0,d=l*4+(n?2:0)+2,c=d,f=u;{const p=n+o,v=s,x=t+p,g=t-p,y=i+v;if(e[h++]=x,e[h++]=y,e[--d]=y,e[--d]=g,s){const m=i-v;e[c++]=g,e[c++]=m,e[--f]=m,e[--f]=x}}for(let p=1;p<l;p++){const v=Math.PI/2*(p/l),x=n+Math.cos(v)*o,g=s+Math.sin(v)*a,y=t+x,m=t-x,_=i+g,w=i-g;e[h++]=y,e[h++]=_,e[--d]=_,e[--d]=m,e[c++]=m,e[c++]=w,e[--f]=w,e[--f]=y}{const p=n,v=s+a,x=t+p,g=t-p,y=i+v,m=i-v;e[h++]=x,e[h++]=y,e[--f]=m,e[--f]=x,n&&(e[h++]=g,e[h++]=y,e[--f]=m,e[--f]=g)}},triangulate(r,e){const t=r.points,i=e.points,n=e.indices;if(t.length===0)return;let s=i.length/2;const o=s;let a,l;if(r.type!==Ke.RREC){const h=r.shape;a=h.x,l=h.y}else{const h=r.shape;a=h.x+h.width/2,l=h.y+h.height/2}const u=r.matrix;i.push(r.matrix?u.a*a+u.c*l+u.tx:a,r.matrix?u.b*a+u.d*l+u.ty:l),s++,i.push(t[0],t[1]);for(let h=2;h<t.length;h+=2)i.push(t[h],t[h+1]),n.push(s++,o,s);n.push(o+1,o,s)}};function ay(r,e=!1){const t=r.length;if(t<6)return;let i=0;for(let n=0,s=r[t-2],o=r[t-1];n<t;n+=2){const a=r[n],l=r[n+1];i+=(a-s)*(l+o),s=a,o=l}if(!e&&i>0||e&&i<=0){const n=t/2;for(let s=n+n%2;s<t;s+=2){const o=t-s-2,a=t-s-1,l=s,u=s+1;[r[o],r[l]]=[r[l],r[o]],[r[a],r[u]]=[r[u],r[a]]}}}const jx={build(r){r.points=r.shape.points.slice()},triangulate(r,e){let t=r.points;const i=r.holes,n=e.points,s=e.indices;if(t.length>=6){ay(t,!1);const o=[];for(let u=0;u<i.length;u++){const h=i[u];ay(h.points,!0),o.push(t.length/2),t=t.concat(h.points)}const a=LT(t,o,2);if(!a)return;const l=n.length/2;for(let u=0;u<a.length;u+=3)s.push(a[u]+l),s.push(a[u+1]+l),s.push(a[u+2]+l);for(let u=0;u<t.length;u++)n.push(t[u])}}},OP={build(r){const e=r.shape,t=e.x,i=e.y,n=e.width,s=e.height,o=r.points;o.length=0,n>=0&&s>=0&&o.push(t,i,t+n,i,t+n,i+s,t,i+s)},triangulate(r,e){const t=r.points,i=e.points;if(t.length===0)return;const n=i.length/2;i.push(t[0],t[1],t[2],t[3],t[6],t[7],t[4],t[5]),e.indices.push(n,n+1,n+2,n+1,n+2,n+3)}},BP={build(r){ql.build(r)},triangulate(r,e){ql.triangulate(r,e)}};var At=(r=>(r.MITER="miter",r.BEVEL="bevel",r.ROUND="round",r))(At||{}),oi=(r=>(r.BUTT="butt",r.ROUND="round",r.SQUARE="square",r))(oi||{});const ls={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(r,e=20){if(!this.adaptive||!r||isNaN(r))return e;let t=Math.ceil(r/this.maxLength);return t<this.minSegments?t=this.minSegments:t>this.maxSegments&&(t=this.maxSegments),t}};class ly{static curveTo(e,t,i,n,s,o){const a=o[o.length-2],l=o[o.length-1]-t,u=a-e,h=n-t,d=i-e,c=Math.abs(l*d-u*h);if(c<1e-8||s===0)return(o[o.length-2]!==e||o[o.length-1]!==t)&&o.push(e,t),null;const f=l*l+u*u,p=h*h+d*d,v=l*h+u*d,x=s*Math.sqrt(f)/c,g=s*Math.sqrt(p)/c,y=x*v/f,m=g*v/p,_=x*d+g*u,w=x*h+g*l,S=u*(g+y),E=l*(g+y),T=d*(x+m),b=h*(x+m),A=Math.atan2(E-w,S-_),I=Math.atan2(b-w,T-_);return{cx:_+e,cy:w+t,radius:s,startAngle:A,endAngle:I,anticlockwise:u*h>d*l}}static arc(e,t,i,n,s,o,a,l,u){const h=a-o,d=ls._segmentsCount(Math.abs(h)*s,Math.ceil(Math.abs(h)/Gl)*40),c=h/(d*2),f=c*2,p=Math.cos(c),v=Math.sin(c),x=d-1,g=x%1/x;for(let y=0;y<=x;++y){const m=y+g*y,_=c+o+f*m,w=Math.cos(_),S=-Math.sin(_);u.push((p*w+v*S)*s+i,(p*-S+v*w)*s+n)}}}class LP{constructor(){this.reset()}begin(e,t,i){this.reset(),this.style=e,this.start=t,this.attribStart=i}end(e,t){this.attribSize=t-this.attribStart,this.size=e-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class gp{static curveLength(e,t,i,n,s,o,a,l){let u=0,h=0,d=0,c=0,f=0,p=0,v=0,x=0,g=0,y=0,m=0,_=e,w=t;for(let S=1;S<=10;++S)h=S/10,d=h*h,c=d*h,f=1-h,p=f*f,v=p*f,x=v*e+3*p*h*i+3*f*d*s+c*a,g=v*t+3*p*h*n+3*f*d*o+c*l,y=_-x,m=w-g,_=x,w=g,u+=Math.sqrt(y*y+m*m);return u}static curveTo(e,t,i,n,s,o,a){const l=a[a.length-2],u=a[a.length-1];a.length-=2;const h=ls._segmentsCount(gp.curveLength(l,u,e,t,i,n,s,o));let d=0,c=0,f=0,p=0,v=0;a.push(l,u);for(let x=1,g=0;x<=h;++x)g=x/h,d=1-g,c=d*d,f=c*d,p=g*g,v=p*g,a.push(f*l+3*c*g*e+3*d*p*i+v*s,f*u+3*c*g*t+3*d*p*n+v*o)}}function uy(r,e,t,i,n,s,o,a){const l=r-t*n,u=e-i*n,h=r+t*s,d=e+i*s;let c,f;o?(c=i,f=-t):(c=-i,f=t);const p=l+c,v=u+f,x=h+c,g=d+f;return a.push(p,v,x,g),2}function Ii(r,e,t,i,n,s,o,a){const l=t-r,u=i-e;let h=Math.atan2(l,u),d=Math.atan2(n-r,s-e);a&&h<d?h+=Math.PI*2:!a&&h>d&&(d+=Math.PI*2);let c=h;const f=d-h,p=Math.abs(f),v=Math.sqrt(l*l+u*u),x=(15*p*Math.sqrt(v)/Math.PI>>0)+1,g=f/x;if(c+=g,a){o.push(r,e,t,i);for(let y=1,m=c;y<x;y++,m+=g)o.push(r,e,r+Math.sin(m)*v,e+Math.cos(m)*v);o.push(r,e,n,s)}else{o.push(t,i,r,e);for(let y=1,m=c;y<x;y++,m+=g)o.push(r+Math.sin(m)*v,e+Math.cos(m)*v,r,e);o.push(n,s,r,e)}return x*2}function FP(r,e){const t=r.shape;let i=r.points||t.points.slice();const n=e.closePointEps;if(i.length===0)return;const s=r.lineStyle,o=new ne(i[0],i[1]),a=new ne(i[i.length-2],i[i.length-1]),l=t.type!==Ke.POLY||t.closeStroke,u=Math.abs(o.x-a.x)<n&&Math.abs(o.y-a.y)<n;if(l){i=i.slice(),u&&(i.pop(),i.pop(),a.set(i[i.length-2],i[i.length-1]));const $=(o.x+a.x)*.5,P=(a.y+o.y)*.5;i.unshift($,P),i.push($,P)}const h=e.points,d=i.length/2;let c=i.length;const f=h.length/2,p=s.width/2,v=p*p,x=s.miterLimit*s.miterLimit;let g=i[0],y=i[1],m=i[2],_=i[3],w=0,S=0,E=-(y-_),T=g-m,b=0,A=0,I=Math.sqrt(E*E+T*T);E/=I,T/=I,E*=p,T*=p;const D=s.alignment,C=(1-D)*2,k=D*2;l||(s.cap===oi.ROUND?c+=Ii(g-E*(C-k)*.5,y-T*(C-k)*.5,g-E*C,y-T*C,g+E*k,y+T*k,h,!0)+2:s.cap===oi.SQUARE&&(c+=uy(g,y,E,T,C,k,!0,h))),h.push(g-E*C,y-T*C,g+E*k,y+T*k);for(let $=1;$<d-1;++$){g=i[($-1)*2],y=i[($-1)*2+1],m=i[$*2],_=i[$*2+1],w=i[($+1)*2],S=i[($+1)*2+1],E=-(y-_),T=g-m,I=Math.sqrt(E*E+T*T),E/=I,T/=I,E*=p,T*=p,b=-(_-S),A=m-w,I=Math.sqrt(b*b+A*A),b/=I,A/=I,b*=p,A*=p;const P=m-g,G=y-_,R=m-w,M=S-_,j=P*R+G*M,Q=G*R-M*P,J=Q<0;if(Math.abs(Q)<.001*Math.abs(j)){h.push(m-E*C,_-T*C,m+E*k,_+T*k),j>=0&&(s.join===At.ROUND?c+=Ii(m,_,m-E*C,_-T*C,m-b*C,_-A*C,h,!1)+4:c+=2,h.push(m-b*k,_-A*k,m+b*C,_+A*C));continue}const fe=(-E+g)*(-T+_)-(-E+m)*(-T+y),oe=(-b+w)*(-A+_)-(-b+m)*(-A+S),he=(P*oe-R*fe)/Q,De=(M*fe-G*oe)/Q,We=(he-m)*(he-m)+(De-_)*(De-_),He=m+(he-m)*C,ce=_+(De-_)*C,we=m-(he-m)*k,le=_-(De-_)*k,St=Math.min(P*P+G*G,R*R+M*M),mt=J?C:k,Xr=St+mt*mt*v,Ho=We<=Xr;let ve=s.join;if(ve===At.MITER&&We/v>x&&(ve=At.BEVEL),Ho)switch(ve){case At.MITER:{h.push(He,ce,we,le);break}case At.BEVEL:{J?h.push(He,ce,m+E*k,_+T*k,He,ce,m+b*k,_+A*k):h.push(m-E*C,_-T*C,we,le,m-b*C,_-A*C,we,le),c+=2;break}case At.ROUND:{J?(h.push(He,ce,m+E*k,_+T*k),c+=Ii(m,_,m+E*k,_+T*k,m+b*k,_+A*k,h,!0)+4,h.push(He,ce,m+b*k,_+A*k)):(h.push(m-E*C,_-T*C,we,le),c+=Ii(m,_,m-E*C,_-T*C,m-b*C,_-A*C,h,!1)+4,h.push(m-b*C,_-A*C,we,le));break}}else{switch(h.push(m-E*C,_-T*C,m+E*k,_+T*k),ve){case At.MITER:{J?h.push(we,le,we,le):h.push(He,ce,He,ce),c+=2;break}case At.ROUND:{J?c+=Ii(m,_,m+E*k,_+T*k,m+b*k,_+A*k,h,!0)+2:c+=Ii(m,_,m-E*C,_-T*C,m-b*C,_-A*C,h,!1)+2;break}}h.push(m-b*C,_-A*C,m+b*k,_+A*k),c+=2}}g=i[(d-2)*2],y=i[(d-2)*2+1],m=i[(d-1)*2],_=i[(d-1)*2+1],E=-(y-_),T=g-m,I=Math.sqrt(E*E+T*T),E/=I,T/=I,E*=p,T*=p,h.push(m-E*C,_-T*C,m+E*k,_+T*k),l||(s.cap===oi.ROUND?c+=Ii(m-E*(C-k)*.5,_-T*(C-k)*.5,m-E*C,_-T*C,m+E*k,_+T*k,h,!1)+2:s.cap===oi.SQUARE&&(c+=uy(m,_,E,T,C,k,!1,h)));const L=e.indices,Y=ls.epsilon*ls.epsilon;for(let $=f;$<c+f-2;++$)g=h[$*2],y=h[$*2+1],m=h[($+1)*2],_=h[($+1)*2+1],w=h[($+2)*2],S=h[($+2)*2+1],!(Math.abs(g*(_-S)+m*(S-y)+w*(y-_))<Y)&&L.push($,$+1,$+2)}function UP(r,e){let t=0;const i=r.shape,n=r.points||i.points,s=i.type!==Ke.POLY||i.closeStroke;if(n.length===0)return;const o=e.points,a=e.indices,l=n.length/2,u=o.length/2;let h=u;for(o.push(n[0],n[1]),t=1;t<l;t++)o.push(n[t*2],n[t*2+1]),a.push(h,h+1),h++;s&&a.push(h,u)}function hy(r,e){r.lineStyle.native?UP(r,e):FP(r,e)}class yp{static curveLength(e,t,i,n,s,o){const a=e-2*i+s,l=t-2*n+o,u=2*i-2*e,h=2*n-2*t,d=4*(a*a+l*l),c=4*(a*u+l*h),f=u*u+h*h,p=2*Math.sqrt(d+c+f),v=Math.sqrt(d),x=2*d*v,g=2*Math.sqrt(f),y=c/v;return(x*p+v*c*(p-g)+(4*f*d-c*c)*Math.log((2*v+y+p)/(y+g)))/(4*x)}static curveTo(e,t,i,n,s){const o=s[s.length-2],a=s[s.length-1],l=ls._segmentsCount(yp.curveLength(o,a,e,t,i,n));let u=0,h=0;for(let d=1;d<=l;++d){const c=d/l;u=o+(e-o)*c,h=a+(t-a)*c,s.push(u+(e+(i-e)*c-u)*c,h+(t+(n-t)*c-h)*c)}}}const Vh={[Ke.POLY]:jx,[Ke.CIRC]:ql,[Ke.ELIP]:ql,[Ke.RECT]:OP,[Ke.RREC]:BP},cy=[],ba=[];class Kl{constructor(e,t=null,i=null,n=null){this.points=[],this.holes=[],this.shape=e,this.lineStyle=i,this.fillStyle=t,this.matrix=n,this.type=e.type}clone(){return new Kl(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const gn=new ne,Wx=class Yx extends Q_{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new Xl,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),ba.push(this.drawCalls[e]);this.drawCalls.length=0;for(let e=0;e<this.batches.length;e++){const t=this.batches[e];t.reset(),cy.push(t)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(e,t=null,i=null,n=null){const s=new Kl(e,t,i,n);return this.graphicsData.push(s),this.dirty++,this}drawHole(e,t=null){if(!this.graphicsData.length)return null;const i=new Kl(e,null,null,t),n=this.graphicsData[this.graphicsData.length-1];return i.lineStyle=n.lineStyle,n.holes.push(i),this.dirty++,this}destroy(){super.destroy();for(let e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(e){const t=this.graphicsData;for(let i=0;i<t.length;++i){const n=t[i];if(n.fillStyle.visible&&n.shape&&(n.matrix?n.matrix.applyInverse(e,gn):gn.copyFrom(e),n.shape.contains(gn.x,gn.y))){let s=!1;if(n.holes){for(let o=0;o<n.holes.length;o++)if(n.holes[o].shape.contains(gn.x,gn.y)){s=!0;break}}if(!s)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const e=this.uvs,t=this.graphicsData;let i=null,n=null;this.batches.length>0&&(i=this.batches[this.batches.length-1],n=i.style);for(let l=this.shapeIndex;l<t.length;l++){this.shapeIndex++;const u=t[l],h=u.fillStyle,d=u.lineStyle;Vh[u.type].build(u),u.matrix&&this.transformPoints(u.points,u.matrix),(h.visible||d.visible)&&this.processHoles(u.holes);for(let c=0;c<2;c++){const f=c===0?h:d;if(!f.visible)continue;const p=f.texture.baseTexture,v=this.indices.length,x=this.points.length/2;p.wrapMode=mi.REPEAT,c===0?this.processFill(u):this.processLine(u);const g=this.points.length/2-x;g!==0&&(i&&!this._compareStyles(n,f)&&(i.end(v,x),i=null),i||(i=cy.pop()||new LP,i.begin(f,v,x),this.batches.push(i),n=f),this.addUvs(this.points,e,f.texture,x,g,f.matrix))}}const s=this.indices.length,o=this.points.length/2;if(i&&i.end(s,o),this.batches.length===0){this.batchable=!0;return}const a=o>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&a===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=a?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(e,t){return!(!e||!t||e.texture.baseTexture!==t.texture.baseTexture||e.color+e.alpha!==t.color+t.alpha||!!e.native!=!!t.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let e=0,t=this.graphicsData.length;e<t;e++){const i=this.graphicsData[e],n=i.fillStyle,s=i.lineStyle;if(n&&!n.texture.baseTexture.valid||s&&!s.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const e=this.batches;for(let t=0,i=e.length;t<i;t++){const n=e[t];for(let s=0;s<n.size;s++){const o=n.start+s;this.indicesUint16[o]=this.indicesUint16[o]-n.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const e=this.batches;for(let t=0;t<e.length;t++)if(e[t].style.native)return!1;return this.points.length<Yx.BATCHABLE_SIZE*2}buildDrawCalls(){let e=++K._globalBatch;for(let d=0;d<this.drawCalls.length;d++)this.drawCalls[d].texArray.clear(),ba.push(this.drawCalls[d]);this.drawCalls.length=0;const t=this.colors,i=this.textureIds;let n=ba.pop();n||(n=new Ed,n.texArray=new bd),n.texArray.count=0,n.start=0,n.size=0,n.type=fr.TRIANGLES;let s=0,o=null,a=0,l=!1,u=fr.TRIANGLES,h=0;this.drawCalls.push(n);for(let d=0;d<this.batches.length;d++){const c=this.batches[d],f=8,p=c.style,v=p.texture.baseTexture;l!==!!p.native&&(l=!!p.native,u=l?fr.LINES:fr.TRIANGLES,o=null,s=f,e++),o!==v&&(o=v,v._batchEnabled!==e&&(s===f&&(e++,s=0,n.size>0&&(n=ba.pop(),n||(n=new Ed,n.texArray=new bd),this.drawCalls.push(n)),n.start=h,n.size=0,n.texArray.count=0,n.type=u),v.touched=1,v._batchEnabled=e,v._batchLocation=s,v.wrapMode=mi.REPEAT,n.texArray.elements[n.texArray.count++]=v,s++)),n.size+=c.size,h+=c.size,a=v._batchLocation,this.addColors(t,p.color,p.alpha,c.attribSize,c.attribStart),this.addTextureIds(i,a,c.attribSize,c.attribStart)}K._globalBatch=e,this.packAttributes()}packAttributes(){const e=this.points,t=this.uvs,i=this.colors,n=this.textureIds,s=new ArrayBuffer(e.length*3*4),o=new Float32Array(s),a=new Uint32Array(s);let l=0;for(let u=0;u<e.length/2;u++)o[l++]=e[u*2],o[l++]=e[u*2+1],o[l++]=t[u*2],o[l++]=t[u*2+1],a[l++]=i[u],o[l++]=n[u];this._buffer.update(s),this._indexBuffer.update(this.indicesUint16)}processFill(e){e.holes.length?jx.triangulate(e,this):Vh[e.type].triangulate(e,this)}processLine(e){hy(e,this);for(let t=0;t<e.holes.length;t++)hy(e.holes[t],this)}processHoles(e){for(let t=0;t<e.length;t++){const i=e[t];Vh[i.type].build(i),i.matrix&&this.transformPoints(i.points,i.matrix)}}calculateBounds(){const e=this._bounds;e.clear(),e.addVertexData(this.points,0,this.points.length),e.pad(this.boundsPadding,this.boundsPadding)}transformPoints(e,t){for(let i=0;i<e.length/2;i++){const n=e[i*2],s=e[i*2+1];e[i*2]=t.a*n+t.c*s+t.tx,e[i*2+1]=t.b*n+t.d*s+t.ty}}addColors(e,t,i,n,s=0){const o=me.shared.setValue(t).toLittleEndianNumber(),a=me.shared.setValue(o).toPremultiplied(i);e.length=Math.max(e.length,s+n);for(let l=0;l<n;l++)e[s+l]=a}addTextureIds(e,t,i,n=0){e.length=Math.max(e.length,n+i);for(let s=0;s<i;s++)e[n+s]=t}addUvs(e,t,i,n,s,o=null){let a=0;const l=t.length,u=i.frame;for(;a<s;){let d=e[(n+a)*2],c=e[(n+a)*2+1];if(o){const f=o.a*d+o.c*c+o.tx;c=o.b*d+o.d*c+o.ty,d=f}a++,t.push(d/u.width,c/u.height)}const h=i.baseTexture;(u.width<h.width||u.height<h.height)&&this.adjustUvs(t,i,l,s)}adjustUvs(e,t,i,n){const s=t.baseTexture,o=1e-6,a=i+n*2,l=t.frame,u=l.width/s.width,h=l.height/s.height;let d=l.x/l.width,c=l.y/l.height,f=Math.floor(e[i]+o),p=Math.floor(e[i+1]+o);for(let v=i+2;v<a;v+=2)f=Math.min(f,Math.floor(e[v]+o)),p=Math.min(p,Math.floor(e[v+1]+o));d-=f,c-=p;for(let v=i;v<a;v+=2)e[v]=(e[v]+d)*u,e[v+1]=(e[v+1]+c)*h}};Wx.BATCHABLE_SIZE=100;let GP=Wx;class Cu{constructor(){this.color=16777215,this.alpha=1,this.texture=z.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const e=new Cu;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e}reset(){this.color=16777215,this.alpha=1,this.texture=z.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class vp extends Cu{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=oi.BUTT,this.join=At.MITER,this.miterLimit=10}clone(){const e=new vp;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e.width=this.width,e.alignment=this.alignment,e.native=this.native,e.cap=this.cap,e.join=this.join,e.miterLimit=this.miterLimit,e}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1,this.cap=oi.BUTT,this.join=At.MITER,this.miterLimit=10}}const Xh={},Xd=class rl extends Qt{constructor(e=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new Cu,this._lineStyle=new vp,this._matrix=null,this._holeMode=!1,this.state=wr.for2d(),this._geometry=e||new GP,this._geometry.refCount++,this._transformID=-1,this._tintColor=new me(16777215),this.blendMode=q.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new rl(this._geometry)}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(e=null,t=0,i,n=.5,s=!1){return typeof e=="number"&&(e={width:e,color:t,alpha:i,alignment:n,native:s}),this.lineTextureStyle(e)}lineTextureStyle(e){const t={width:0,texture:z.WHITE,color:e!=null&&e.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:oi.BUTT,join:At.MITER,miterLimit:10};e=Object.assign(t,e),this.normalizeColor(e),this.currentPath&&this.startPoly();const i=e.width>0&&e.alpha>0;return i?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:i},e)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const e=this.currentPath.points,t=this.currentPath.points.length;t>2&&(this.drawShape(this.currentPath),this.currentPath=new ji,this.currentPath.closeStroke=!1,this.currentPath.points.push(e[t-2],e[t-1]))}else this.currentPath=new ji,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(e,t){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=t,this}lineTo(e,t){this.currentPath||this.moveTo(0,0);const i=this.currentPath.points,n=i[i.length-2],s=i[i.length-1];return(n!==e||s!==t)&&i.push(e,t),this}_initCurve(e=0,t=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[e,t]):this.moveTo(e,t)}quadraticCurveTo(e,t,i,n){this._initCurve();const s=this.currentPath.points;return s.length===0&&this.moveTo(0,0),yp.curveTo(e,t,i,n,s),this}bezierCurveTo(e,t,i,n,s,o){return this._initCurve(),gp.curveTo(e,t,i,n,s,o,this.currentPath.points),this}arcTo(e,t,i,n,s){this._initCurve(e,t);const o=this.currentPath.points,a=ly.curveTo(e,t,i,n,s,o);if(a){const{cx:l,cy:u,radius:h,startAngle:d,endAngle:c,anticlockwise:f}=a;this.arc(l,u,h,d,c,f)}return this}arc(e,t,i,n,s,o=!1){if(n===s)return this;if(!o&&s<=n?s+=Gl:o&&n<=s&&(n+=Gl),s-n===0)return this;const a=e+Math.cos(n)*i,l=t+Math.sin(n)*i,u=this._geometry.closePointEps;let h=this.currentPath?this.currentPath.points:null;if(h){const d=Math.abs(h[h.length-2]-a),c=Math.abs(h[h.length-1]-l);d<u&&c<u||h.push(a,l)}else this.moveTo(a,l),h=this.currentPath.points;return ly.arc(a,l,e,t,i,n,s,o,h),this}beginFill(e=0,t){return this.beginTextureFill({texture:z.WHITE,color:e,alpha:t})}normalizeColor(e){const t=me.shared.setValue(e.color??0);e.color=t.toNumber(),e.alpha??(e.alpha=t.alpha)}beginTextureFill(e){const t={texture:z.WHITE,color:16777215,matrix:null};e=Object.assign(t,e),this.normalizeColor(e),this.currentPath&&this.startPoly();const i=e.alpha>0;return i?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:i},e)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(e,t,i,n){return this.drawShape(new Z(e,t,i,n))}drawRoundedRect(e,t,i,n,s){return this.drawShape(new Su(e,t,i,n,s))}drawCircle(e,t,i){return this.drawShape(new Eu(e,t,i))}drawEllipse(e,t,i,n){return this.drawShape(new Tu(e,t,i,n))}drawPolygon(...e){let t,i=!0;const n=e[0];n.points?(i=n.closeStroke,t=n.points):Array.isArray(e[0])?t=e[0]:t=e;const s=new ji(t);return s.closeStroke=i,this.drawShape(s),this}drawShape(e){return this._holeMode?this._geometry.drawHole(e,this._matrix):this._geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const e=this._geometry.graphicsData;return e.length===1&&e[0].shape.type===Ke.RECT&&!e[0].matrix&&!e[0].holes.length&&!(e[0].lineStyle.visible&&e[0].lineStyle.width)}_render(e){this.finishPoly();const t=this._geometry;t.updateBatches(),t.batchable?(this.batchDirty!==t.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))}_populateBatches(){const e=this._geometry,t=this.blendMode,i=e.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.batches.length=i,this.vertexData=new Float32Array(e.points);for(let n=0;n<i;n++){const s=e.batches[n],o=s.style.color,a=new Float32Array(this.vertexData.buffer,s.attribStart*4*2,s.attribSize*2),l=new Float32Array(e.uvsFloat32.buffer,s.attribStart*4*2,s.attribSize*2),u=new Uint16Array(e.indicesUint16.buffer,s.start*2,s.size),h={vertexData:a,blendMode:t,indices:u,uvs:l,_batchRGB:me.shared.setValue(o).toRgbArray(),_tintRGB:o,_texture:s.style.texture,alpha:s.style.alpha,worldAlpha:1};this.batches[n]=h}}_renderBatched(e){if(this.batches.length){e.batch.setObjectRenderer(e.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let t=0,i=this.batches.length;t<i;t++){const n=this.batches[t];n.worldAlpha=this.worldAlpha*n.alpha,e.plugins[this.pluginName].render(n)}}}_renderDirect(e){const t=this._resolveDirectShader(e),i=this._geometry,n=this.worldAlpha,s=t.uniforms,o=i.drawCalls;s.translationMatrix=this.transform.worldTransform,me.shared.setValue(this._tintColor).premultiply(n).toArray(s.tint),e.shader.bind(t),e.geometry.bind(i,t),e.state.set(this.state);for(let a=0,l=o.length;a<l;a++)this._renderDrawCallDirect(e,i.drawCalls[a])}_renderDrawCallDirect(e,t){const{texArray:i,type:n,size:s,start:o}=t,a=i.count;for(let l=0;l<a;l++)e.texture.bind(i.elements[l],l);e.geometry.draw(n,s,o)}_resolveDirectShader(e){let t=this.shader;const i=this.pluginName;if(!t){if(!Xh[i]){const{maxTextures:n}=e.plugins[i],s=new Int32Array(n);for(let l=0;l<n;l++)s[l]=l;const o={tint:new Float32Array([1,1,1,1]),translationMatrix:new ye,default:Kt.from({uSamplers:s},!0)},a=e.plugins[i]._shader.program;Xh[i]=new yr(a,o)}t=Xh[i]}return t}_calculateBounds(){this.finishPoly();const e=this._geometry;if(!e.graphicsData.length)return;const{minX:t,minY:i,maxX:n,maxY:s}=e.bounds;this._bounds.addFrame(this.transform,t,i,n,s)}containsPoint(e){return this.worldTransform.applyInverse(e,rl._TEMP_POINT),this._geometry.containsPoint(rl._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let e=0;e<this.batches.length;e++){const t=this.batches[e];t._tintRGB=me.shared.setValue(this._tintColor).multiply(t._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const e=this.transform._worldID;if(this._transformID===e)return;this._transformID=e;const t=this.transform.worldTransform,i=t.a,n=t.b,s=t.c,o=t.d,a=t.tx,l=t.ty,u=this._geometry.points,h=this.vertexData;let d=0;for(let c=0;c<u.length;c+=2){const f=u[c],p=u[c+1];h[d++]=i*f+s*p+a,h[d++]=o*p+n*f+l}}closePath(){const e=this.currentPath;return e&&(e.closeStroke=!0,this.finishPoly()),this}setMatrix(e){return this._matrix=e,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(e){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(e)}};Xd.curves=ls,Xd._TEMP_POINT=new ne;let wi=Xd;class HP{constructor(e,t){this.uvBuffer=e,this.uvMatrix=t,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(e){if(!e&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const t=this.uvBuffer.data;(!this.data||this.data.length!==t.length)&&(this.data=new Float32Array(t.length)),this.uvMatrix.multiplyUvs(t,this.data),this._updateID++}}const jh=new ne,dy=new ji,qx=class Kx extends Qt{constructor(e,t,i,n=fr.TRIANGLES){super(),this.geometry=e,this.shader=t,this.state=i||wr.for2d(),this.drawMode=n,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=U.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(e){this._geometry!==e&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=e,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(e){this.shader=e}get material(){return this.shader}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(e){this.shader.tint=e}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(e){this.shader.texture=e}_render(e){const t=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===fr.TRIANGLES&&t.length<Kx.BATCHABLE_SIZE*2?this._renderToBatch(e):this._renderDefault(e)}_renderDefault(e){const t=this.shader;t.alpha=this.worldAlpha,t.update&&t.update(),e.batch.flush(),t.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),e.shader.bind(t),e.state.set(this.state),e.geometry.bind(this.geometry,t),e.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(e){const t=this.geometry,i=this.shader;i.uvMatrix&&(i.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=t.indexBuffer.data,this._tintRGB=i._tintRGB,this._texture=i.texture;const n=this.material.pluginName;e.batch.setObjectRenderer(e.plugins[n]),e.plugins[n].render(this)}calculateVertices(){const e=this.geometry.buffers[0],t=e.data,i=e._updateID;if(i===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==t.length&&(this.vertexData=new Float32Array(t.length));const n=this.transform.worldTransform,s=n.a,o=n.b,a=n.c,l=n.d,u=n.tx,h=n.ty,d=this.vertexData;for(let c=0;c<d.length/2;c++){const f=t[c*2],p=t[c*2+1];d[c*2]=s*f+a*p+u,d[c*2+1]=o*f+l*p+h}if(this._roundPixels){const c=U.RESOLUTION;for(let f=0;f<d.length;++f)d[f]=Math.round(d[f]*c)/c}this.vertexDirty=i}calculateUvs(){const e=this.geometry.buffers[1],t=this.shader;t.uvMatrix.isSimple?this.uvs=e.data:(this.batchUvs||(this.batchUvs=new HP(e,t.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(e){if(!this.getBounds().contains(e.x,e.y))return!1;this.worldTransform.applyInverse(e,jh);const t=this.geometry.getBuffer("aVertexPosition").data,i=dy.points,n=this.geometry.getIndex().data,s=n.length,o=this.drawMode===4?3:1;for(let a=0;a+2<s;a+=o){const l=n[a]*2,u=n[a+1]*2,h=n[a+2]*2;if(i[0]=t[l],i[1]=t[l+1],i[2]=t[u],i[3]=t[u+1],i[4]=t[h],i[5]=t[h+1],dy.contains(jh.x,jh.y))return!0}return!1}destroy(e){super.destroy(e),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};qx.BATCHABLE_SIZE=100;let fy=qx;class $P extends _i{constructor(e,t,i){super();const n=new ke(e),s=new ke(t,!0),o=new ke(i,!0,!0);this.addAttribute("aVertexPosition",n,2,!1,W.FLOAT).addAttribute("aTextureCoord",s,2,!1,W.FLOAT).addIndex(o),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var zP=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,VP=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class py extends yr{constructor(e,t){const i={uSampler:e,alpha:1,uTextureMatrix:ye.IDENTITY,uColor:new Float32Array([1,1,1,1])};t=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},t),t.uniforms&&Object.assign(i,t.uniforms),super(t.program||Or.from(VP,zP),i),this._colorDirty=!1,this.uvMatrix=new dx(e),this.batchable=t.program===void 0,this.pluginName=t.pluginName,this._tintColor=new me(t.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=t.alpha}get texture(){return this.uniforms.uSampler}set texture(e){this.uniforms.uSampler!==e&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!e.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=e,this.uvMatrix.texture=e)}set alpha(e){e!==this._alpha&&(this._alpha=e,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(e){e!==this.tint&&(this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const e=this.texture.baseTexture.alphaMode;me.shared.setValue(this._tintColor).premultiply(this._alpha,e).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class my{constructor(e,t,i){this.geometry=new _i,this.indexBuffer=null,this.size=i,this.dynamicProperties=[],this.staticProperties=[];for(let n=0;n<e.length;++n){let s=e[n];s={attributeName:s.attributeName,size:s.size,uploadFunction:s.uploadFunction,type:s.type||W.FLOAT,offset:s.offset},t[n]?this.dynamicProperties.push(s):this.staticProperties.push(s)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const e=this.geometry;let t=0;this.indexBuffer=new ke(cC(this.size),!0,!0),e.addIndex(this.indexBuffer),this.dynamicStride=0;for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];a.offset=t,t+=a.size,this.dynamicStride+=a.size}const i=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(i),this.dynamicDataUint32=new Uint32Array(i),this.dynamicBuffer=new ke(this.dynamicData,!1,!1);let n=0;this.staticStride=0;for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];a.offset=n,n+=a.size,this.staticStride+=a.size}const s=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(s),this.staticDataUint32=new Uint32Array(s),this.staticBuffer=new ke(this.staticData,!0,!1);for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];e.addAttribute(a.attributeName,this.dynamicBuffer,0,a.type===W.UNSIGNED_BYTE,a.type,this.dynamicStride*4,a.offset*4)}for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];e.addAttribute(a.attributeName,this.staticBuffer,0,a.type===W.UNSIGNED_BYTE,a.type,this.staticStride*4,a.offset*4)}}uploadDynamic(e,t,i){for(let n=0;n<this.dynamicProperties.length;n++){const s=this.dynamicProperties[n];s.uploadFunction(e,t,i,s.type===W.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,s.offset)}this.dynamicBuffer._updateID++}uploadStatic(e,t,i){for(let n=0;n<this.staticProperties.length;n++){const s=this.staticProperties[n];s.uploadFunction(e,t,i,s.type===W.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,s.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var XP=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,jP=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class Zx extends Au{constructor(e){super(e),this.shader=null,this.properties=null,this.tempMatrix=new ye,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:W.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=yr.from(jP,XP,{}),this.state=wr.for2d()}render(e){const t=e.children,i=e._maxSize,n=e._batchSize,s=this.renderer;let o=t.length;if(o===0)return;o>i&&!e.autoResize&&(o=i);let a=e._buffers;a||(a=e._buffers=this.generateBuffers(e));const l=t[0]._texture.baseTexture,u=l.alphaMode>0;this.state.blendMode=q_(e.blendMode,u),s.state.set(this.state);const h=s.gl,d=e.worldTransform.copyTo(this.tempMatrix);d.prepend(s.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=d.toArray(!0),this.shader.uniforms.uColor=me.shared.setValue(e.tintRgb).premultiply(e.worldAlpha,u).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=l,this.renderer.shader.bind(this.shader);let c=!1;for(let f=0,p=0;f<o;f+=n,p+=1){let v=o-f;v>n&&(v=n),p>=a.length&&a.push(this._generateOneMoreBuffer(e));const x=a[p];x.uploadDynamic(t,f,v);const g=e._bufferUpdateIDs[p]||0;c=c||x._updateID<g,c&&(x._updateID=e._updateID,x.uploadStatic(t,f,v)),s.geometry.bind(x.geometry),h.drawElements(h.TRIANGLES,v*6,h.UNSIGNED_SHORT,0)}}generateBuffers(e){const t=[],i=e._maxSize,n=e._batchSize,s=e._properties;for(let o=0;o<i;o+=n)t.push(new my(this.properties,s,n));return t}_generateOneMoreBuffer(e){const t=e._batchSize,i=e._properties;return new my(this.properties,i,t)}uploadVertices(e,t,i,n,s,o){let a=0,l=0,u=0,h=0;for(let d=0;d<i;++d){const c=e[t+d],f=c._texture,p=c.scale.x,v=c.scale.y,x=f.trim,g=f.orig;x?(l=x.x-c.anchor.x*g.width,a=l+x.width,h=x.y-c.anchor.y*g.height,u=h+x.height):(a=g.width*(1-c.anchor.x),l=g.width*-c.anchor.x,u=g.height*(1-c.anchor.y),h=g.height*-c.anchor.y),n[o]=l*p,n[o+1]=h*v,n[o+s]=a*p,n[o+s+1]=h*v,n[o+s*2]=a*p,n[o+s*2+1]=u*v,n[o+s*3]=l*p,n[o+s*3+1]=u*v,o+=s*4}}uploadPosition(e,t,i,n,s,o){for(let a=0;a<i;a++){const l=e[t+a].position;n[o]=l.x,n[o+1]=l.y,n[o+s]=l.x,n[o+s+1]=l.y,n[o+s*2]=l.x,n[o+s*2+1]=l.y,n[o+s*3]=l.x,n[o+s*3+1]=l.y,o+=s*4}}uploadRotation(e,t,i,n,s,o){for(let a=0;a<i;a++){const l=e[t+a].rotation;n[o]=l,n[o+s]=l,n[o+s*2]=l,n[o+s*3]=l,o+=s*4}}uploadUvs(e,t,i,n,s,o){for(let a=0;a<i;++a){const l=e[t+a]._texture._uvs;l?(n[o]=l.x0,n[o+1]=l.y0,n[o+s]=l.x1,n[o+s+1]=l.y1,n[o+s*2]=l.x2,n[o+s*2+1]=l.y2,n[o+s*3]=l.x3,n[o+s*3+1]=l.y3,o+=s*4):(n[o]=0,n[o+1]=0,n[o+s]=0,n[o+s+1]=0,n[o+s*2]=0,n[o+s*2+1]=0,n[o+s*3]=0,n[o+s*3+1]=0,o+=s*4)}}uploadTint(e,t,i,n,s,o){for(let a=0;a<i;++a){const l=e[t+a],u=me.shared.setValue(l._tintRGB).toPremultiplied(l.alpha,l.texture.baseTexture.alphaMode>0);n[o]=u,n[o+s]=u,n[o+s*2]=u,n[o+s*3]=u,o+=s*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}Zx.extension={name:"particle",type:B.RendererPlugin};V.add(Zx);var Ru=(r=>(r[r.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",r[r.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",r))(Ru||{});const Ca={willReadFrequently:!0},or=class X{static get experimentalLetterSpacingSupported(){let e=X._experimentalLetterSpacingSupported;if(e!==void 0){const t=U.ADAPTER.getCanvasRenderingContext2D().prototype;e=X._experimentalLetterSpacingSupported="letterSpacing"in t||"textLetterSpacing"in t}return e}constructor(e,t,i,n,s,o,a,l,u){this.text=e,this.style=t,this.width=i,this.height=n,this.lines=s,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=l,this.fontProperties=u}static measureText(e,t,i,n=X._canvas){i=i??t.wordWrap;const s=t.toFontString(),o=X.measureFont(s);o.fontSize===0&&(o.fontSize=t.fontSize,o.ascent=t.fontSize);const a=n.getContext("2d",Ca);a.font=s;const l=(i?X.wordWrap(e,t,n):e).split(/(?:\r\n|\r|\n)/),u=new Array(l.length);let h=0;for(let p=0;p<l.length;p++){const v=X._measureText(l[p],t.letterSpacing,a);u[p]=v,h=Math.max(h,v)}let d=h+t.strokeThickness;t.dropShadow&&(d+=t.dropShadowDistance);const c=t.lineHeight||o.fontSize+t.strokeThickness;let f=Math.max(c,o.fontSize+t.strokeThickness*2)+t.leading+(l.length-1)*(c+t.leading);return t.dropShadow&&(f+=t.dropShadowDistance),new X(e,t,d,f,l,u,c+t.leading,h,o)}static _measureText(e,t,i){let n=!1;X.experimentalLetterSpacingSupported&&(X.experimentalLetterSpacing?(i.letterSpacing=`${t}px`,i.textLetterSpacing=`${t}px`,n=!0):(i.letterSpacing="0px",i.textLetterSpacing="0px"));let s=i.measureText(e).width;return s>0&&(n?s-=t:s+=(X.graphemeSegmenter(e).length-1)*t),s}static wordWrap(e,t,i=X._canvas){const n=i.getContext("2d",Ca);let s=0,o="",a="";const l=Object.create(null),{letterSpacing:u,whiteSpace:h}=t,d=X.collapseSpaces(h),c=X.collapseNewlines(h);let f=!d;const p=t.wordWrapWidth+u,v=X.tokenize(e);for(let x=0;x<v.length;x++){let g=v[x];if(X.isNewline(g)){if(!c){a+=X.addLine(o),f=!d,o="",s=0;continue}g=" "}if(d){const m=X.isBreakingSpace(g),_=X.isBreakingSpace(o[o.length-1]);if(m&&_)continue}const y=X.getFromCache(g,u,l,n);if(y>p)if(o!==""&&(a+=X.addLine(o),o="",s=0),X.canBreakWords(g,t.breakWords)){const m=X.wordWrapSplit(g);for(let _=0;_<m.length;_++){let w=m[_],S=w,E=1;for(;m[_+E];){const b=m[_+E];if(!X.canBreakChars(S,b,g,_,t.breakWords))w+=b;else break;S=b,E++}_+=E-1;const T=X.getFromCache(w,u,l,n);T+s>p&&(a+=X.addLine(o),f=!1,o="",s=0),o+=w,s+=T}}else{o.length>0&&(a+=X.addLine(o),o="",s=0);const m=x===v.length-1;a+=X.addLine(g,!m),f=!1,o="",s=0}else y+s>p&&(f=!1,a+=X.addLine(o),o="",s=0),(o.length>0||!X.isBreakingSpace(g)||f)&&(o+=g,s+=y)}return a+=X.addLine(o,!1),a}static addLine(e,t=!0){return e=X.trimRight(e),e=t?`${e}
`:e,e}static getFromCache(e,t,i,n){let s=i[e];return typeof s!="number"&&(s=X._measureText(e,t,n)+t,i[e]=s),s}static collapseSpaces(e){return e==="normal"||e==="pre-line"}static collapseNewlines(e){return e==="normal"}static trimRight(e){if(typeof e!="string")return"";for(let t=e.length-1;t>=0;t--){const i=e[t];if(!X.isBreakingSpace(i))break;e=e.slice(0,-1)}return e}static isNewline(e){return typeof e!="string"?!1:X._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,t){return typeof e!="string"?!1:X._breakingSpaces.includes(e.charCodeAt(0))}static tokenize(e){const t=[];let i="";if(typeof e!="string")return t;for(let n=0;n<e.length;n++){const s=e[n],o=e[n+1];if(X.isBreakingSpace(s,o)||X.isNewline(s)){i!==""&&(t.push(i),i=""),t.push(s);continue}i+=s}return i!==""&&t.push(i),t}static canBreakWords(e,t){return t}static canBreakChars(e,t,i,n,s){return!0}static wordWrapSplit(e){return X.graphemeSegmenter(e)}static measureFont(e){if(X._fonts[e])return X._fonts[e];const t={ascent:0,descent:0,fontSize:0},i=X._canvas,n=X._context;n.font=e;const s=X.METRICS_STRING+X.BASELINE_SYMBOL,o=Math.ceil(n.measureText(s).width);let a=Math.ceil(n.measureText(X.BASELINE_SYMBOL).width);const l=Math.ceil(X.HEIGHT_MULTIPLIER*a);if(a=a*X.BASELINE_MULTIPLIER|0,o===0||l===0)return X._fonts[e]=t,t;i.width=o,i.height=l,n.fillStyle="#f00",n.fillRect(0,0,o,l),n.font=e,n.textBaseline="alphabetic",n.fillStyle="#000",n.fillText(s,0,a);const u=n.getImageData(0,0,o,l).data,h=u.length,d=o*4;let c=0,f=0,p=!1;for(c=0;c<a;++c){for(let v=0;v<d;v+=4)if(u[f+v]!==255){p=!0;break}if(!p)f+=d;else break}for(t.ascent=a-c,f=h-d,p=!1,c=l;c>a;--c){for(let v=0;v<d;v+=4)if(u[f+v]!==255){p=!0;break}if(!p)f-=d;else break}return t.descent=c-a,t.fontSize=t.ascent+t.descent,X._fonts[e]=t,t}static clearMetrics(e=""){e?delete X._fonts[e]:X._fonts={}}static get _canvas(){var e;if(!X.__canvas){let t;try{const i=new OffscreenCanvas(0,0);if((e=i.getContext("2d",Ca))!=null&&e.measureText)return X.__canvas=i,i;t=U.ADAPTER.createCanvas()}catch{t=U.ADAPTER.createCanvas()}t.width=t.height=10,X.__canvas=t}return X.__canvas}static get _context(){return X.__context||(X.__context=X._canvas.getContext("2d",Ca)),X.__context}};or.METRICS_STRING="|q",or.BASELINE_SYMBOL="M",or.BASELINE_MULTIPLIER=1.4,or.HEIGHT_MULTIPLIER=2,or.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const r=new Intl.Segmenter;return e=>[...r.segment(e)].map(t=>t.segment)}return r=>[...r]})(),or.experimentalLetterSpacing=!1,or._fonts={},or._newlines=[10,13],or._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];let Qr=or;const WP=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],Qx=class Gs{constructor(e){this.styleID=0,this.reset(),Yh(this,e,e)}clone(){const e={};return Yh(e,this,Gs.defaultStyle),new Gs(e)}reset(){Yh(this,Gs.defaultStyle,Gs.defaultStyle)}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords!==e&&(this._breakWords=e,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(e){this._dropShadow!==e&&(this._dropShadow=e,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(e){this._dropShadowAlpha!==e&&(this._dropShadowAlpha=e,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(e){this._dropShadowAngle!==e&&(this._dropShadowAngle=e,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(e){this._dropShadowBlur!==e&&(this._dropShadowBlur=e,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(e){const t=Wh(e);this._dropShadowColor!==t&&(this._dropShadowColor=t,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(e){this._dropShadowDistance!==e&&(this._dropShadowDistance=e,this.styleID++)}get fill(){return this._fill}set fill(e){const t=Wh(e);this._fill!==t&&(this._fill=t,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(e){this._fillGradientType!==e&&(this._fillGradientType=e,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(e){YP(this._fillGradientStops,e)||(this._fillGradientStops=e,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(e){this.fontFamily!==e&&(this._fontFamily=e,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant!==e&&(this._fontVariant=e,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this.styleID++)}get leading(){return this._leading}set leading(e){this._leading!==e&&(this._leading=e,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(e){this._lineJoin!==e&&(this._lineJoin=e,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(e){this._miterLimit!==e&&(this._miterLimit=e,this.styleID++)}get padding(){return this._padding}set padding(e){this._padding!==e&&(this._padding=e,this.styleID++)}get stroke(){return this._stroke}set stroke(e){const t=Wh(e);this._stroke!==t&&(this._stroke=t,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(e){this._strokeThickness!==e&&(this._strokeThickness=e,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline!==e&&(this._textBaseline=e,this.styleID++)}get trim(){return this._trim}set trim(e){this._trim!==e&&(this._trim=e,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap!==e&&(this._wordWrap=e,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.styleID++)}toFontString(){const e=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let t=this.fontFamily;Array.isArray(this.fontFamily)||(t=this.fontFamily.split(","));for(let i=t.length-1;i>=0;i--){let n=t[i].trim();!/([\"\'])[^\'\"]+\1/.test(n)&&!WP.includes(n)&&(n=`"${n}"`),t[i]=n}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${e} ${t.join(",")}`}};Qx.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:Ru.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let Ei=Qx;function Wh(r){const e=me.shared,t=i=>{const n=e.setValue(i);return n.alpha===1?n.toHex():n.toRgbaString()};return Array.isArray(r)?r.map(t):t(r)}function YP(r,e){if(!Array.isArray(r)||!Array.isArray(e)||r.length!==e.length)return!1;for(let t=0;t<r.length;++t)if(r[t]!==e[t])return!1;return!0}function Yh(r,e,t){for(const i in t)Array.isArray(e[i])?r[i]=e[i].slice():r[i]=e[i]}const qP={texture:!0,children:!1,baseTexture:!0},Jx=class jd extends xi{constructor(e,t,i){let n=!1;i||(i=U.ADAPTER.createCanvas(),n=!0),i.width=3,i.height=3;const s=z.from(i);s.orig=new Z,s.trim=new Z,super(s),this._ownCanvas=n,this.canvas=i,this.context=i.getContext("2d",{willReadFrequently:!0}),this._resolution=jd.defaultResolution??U.RESOLUTION,this._autoResolution=jd.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=e,this.style=t,this.localStyleID=-1}static get experimentalLetterSpacing(){return Qr.experimentalLetterSpacing}static set experimentalLetterSpacing(e){ee("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),Qr.experimentalLetterSpacing=e}updateText(e){const t=this._style;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&e)return;this._font=this._style.toFontString();const i=this.context,n=Qr.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),s=n.width,o=n.height,a=n.lines,l=n.lineHeight,u=n.lineWidths,h=n.maxLineWidth,d=n.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,s)+t.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,o)+t.padding*2)*this._resolution),i.scale(this._resolution,this._resolution),i.clearRect(0,0,this.canvas.width,this.canvas.height),i.font=this._font,i.lineWidth=t.strokeThickness,i.textBaseline=t.textBaseline,i.lineJoin=t.lineJoin,i.miterLimit=t.miterLimit;let c,f;const p=t.dropShadow?2:1;for(let v=0;v<p;++v){const x=t.dropShadow&&v===0,g=x?Math.ceil(Math.max(1,o)+t.padding*2):0,y=g*this._resolution;if(x){i.fillStyle="black",i.strokeStyle="black";const _=t.dropShadowColor,w=t.dropShadowBlur*this._resolution,S=t.dropShadowDistance*this._resolution;i.shadowColor=me.shared.setValue(_).setAlpha(t.dropShadowAlpha).toRgbaString(),i.shadowBlur=w,i.shadowOffsetX=Math.cos(t.dropShadowAngle)*S,i.shadowOffsetY=Math.sin(t.dropShadowAngle)*S+y}else i.fillStyle=this._generateFillStyle(t,a,n),i.strokeStyle=t.stroke,i.shadowColor="black",i.shadowBlur=0,i.shadowOffsetX=0,i.shadowOffsetY=0;let m=(l-d.fontSize)/2;l-d.fontSize<0&&(m=0);for(let _=0;_<a.length;_++)c=t.strokeThickness/2,f=t.strokeThickness/2+_*l+d.ascent+m,t.align==="right"?c+=h-u[_]:t.align==="center"&&(c+=(h-u[_])/2),t.stroke&&t.strokeThickness&&this.drawLetterSpacing(a[_],c+t.padding,f+t.padding-g,!0),t.fill&&this.drawLetterSpacing(a[_],c+t.padding,f+t.padding-g)}this.updateTexture()}drawLetterSpacing(e,t,i,n=!1){const s=this._style.letterSpacing;let o=!1;if(Qr.experimentalLetterSpacingSupported&&(Qr.experimentalLetterSpacing?(this.context.letterSpacing=`${s}px`,this.context.textLetterSpacing=`${s}px`,o=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),s===0||o){n?this.context.strokeText(e,t,i):this.context.fillText(e,t,i);return}let a=t;const l=Qr.graphemeSegmenter(e);let u=this.context.measureText(e).width,h=0;for(let d=0;d<l.length;++d){const c=l[d];n?this.context.strokeText(c,a,i):this.context.fillText(c,a,i);let f="";for(let p=d+1;p<l.length;++p)f+=l[p];h=this.context.measureText(f).width,a+=u-h+s,u=h}}updateTexture(){const e=this.canvas;if(this._style.trim){const o=mC(e);o.data&&(e.width=o.width,e.height=o.height,this.context.putImageData(o.data,0,0))}const t=this._texture,i=this._style,n=i.trim?0:i.padding,s=t.baseTexture;t.trim.width=t._frame.width=e.width/this._resolution,t.trim.height=t._frame.height=e.height/this._resolution,t.trim.x=-n,t.trim.y=-n,t.orig.width=t._frame.width-n*2,t.orig.height=t._frame.height-n*2,this._onTextureUpdate(),s.setRealSize(e.width,e.height,this._resolution),t.updateUvs(),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(e,t){return this.updateText(!0),this._textureID===-1&&(e=!1),super.getBounds(e,t)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds.call(this,e)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(e,t,i){const n=e.fill;if(Array.isArray(n)){if(n.length===1)return n[0]}else return n;let s;const o=e.dropShadow?e.dropShadowDistance:0,a=e.padding||0,l=this.canvas.width/this._resolution-o-a*2,u=this.canvas.height/this._resolution-o-a*2,h=n.slice(),d=e.fillGradientStops.slice();if(!d.length){const c=h.length+1;for(let f=1;f<c;++f)d.push(f/c)}if(h.unshift(n[0]),d.unshift(0),h.push(n[n.length-1]),d.push(1),e.fillGradientType===Ru.LINEAR_VERTICAL){s=this.context.createLinearGradient(l/2,a,l/2,u+a);const c=i.fontProperties.fontSize+e.strokeThickness;for(let f=0;f<t.length;f++){const p=i.lineHeight*(f-1)+c,v=i.lineHeight*f;let x=v;f>0&&p>v&&(x=(v+p)/2);const g=v+c,y=i.lineHeight*(f+1);let m=g;f+1<t.length&&y<g&&(m=(g+y)/2);const _=(m-x)/u;for(let w=0;w<h.length;w++){let S=0;typeof d[w]=="number"?S=d[w]:S=w/h.length;let E=Math.min(1,Math.max(0,x/u+S*_));E=Number(E.toFixed(5)),s.addColorStop(E,h[w])}}}else{s=this.context.createLinearGradient(a,u/2,l+a,u/2);const c=h.length+1;let f=1;for(let p=0;p<h.length;p++){let v;typeof d[p]=="number"?v=d[p]:v=f/c,s.addColorStop(v,h[p]),f++}}return s}destroy(e){typeof e=="boolean"&&(e={children:e}),e=Object.assign({},qP,e),super.destroy(e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this.updateText(!0);const t=si(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this.updateText(!0);const t=si(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e}get style(){return this._style}set style(e){e=e||{},e instanceof Ei?this._style=e:this._style=new Ei(e),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}};Jx.defaultAutoResolution=!0;let _p=Jx;class KP{constructor(e){this.maxItemsPerFrame=e,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function ZP(r,e){var i;let t=!1;if((i=r==null?void 0:r._textures)!=null&&i.length){for(let n=0;n<r._textures.length;n++)if(r._textures[n]instanceof z){const s=r._textures[n].baseTexture;e.includes(s)||(e.push(s),t=!0)}}return t}function QP(r,e){if(r.baseTexture instanceof K){const t=r.baseTexture;return e.includes(t)||e.push(t),!0}return!1}function JP(r,e){if(r._texture&&r._texture instanceof z){const t=r._texture.baseTexture;return e.includes(t)||e.push(t),!0}return!1}function e2(r,e){return e instanceof _p?(e.updateText(!0),!0):!1}function t2(r,e){if(e instanceof Ei){const t=e.toFontString();return Qr.measureFont(t),!0}return!1}function r2(r,e){if(r instanceof _p){e.includes(r.style)||e.push(r.style),e.includes(r)||e.push(r);const t=r._texture.baseTexture;return e.includes(t)||e.push(t),!0}return!1}function i2(r,e){return r instanceof Ei?(e.includes(r)||e.push(r),!0):!1}const e1=class t1{constructor(e){this.limiter=new KP(t1.uploadsPerFrame),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(r2),this.registerFindHook(i2),this.registerFindHook(ZP),this.registerFindHook(QP),this.registerFindHook(JP),this.registerUploadHook(e2),this.registerUploadHook(t2)}upload(e){return new Promise(t=>{e&&this.add(e),this.queue.length?(this.completes.push(t),this.ticking||(this.ticking=!0,_t.system.addOnce(this.tick,this,rn.UTILITY))):t()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const e=this.queue[0];let t=!1;if(e&&!e._destroyed){for(let i=0,n=this.uploadHooks.length;i<n;i++)if(this.uploadHooks[i](this.uploadHookHelper,e)){this.queue.shift(),t=!0;break}}t||this.queue.shift()}if(this.queue.length)_t.system.addOnce(this.tick,this,rn.UTILITY);else{this.ticking=!1;const e=this.completes.slice(0);this.completes.length=0;for(let t=0,i=e.length;t<i;t++)e[t]()}}registerFindHook(e){return e&&this.addHooks.push(e),this}registerUploadHook(e){return e&&this.uploadHooks.push(e),this}add(e){for(let t=0,i=this.addHooks.length;t<i&&!this.addHooks[t](e,this.queue);t++);if(e instanceof Qt)for(let t=e.children.length-1;t>=0;t--)this.add(e.children[t]);return this}destroy(){this.ticking&&_t.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};e1.uploadsPerFrame=4;let Wd=e1;Object.defineProperties(U,{UPLOADS_PER_FRAME:{get(){return Wd.uploadsPerFrame},set(r){ee("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),Wd.uploadsPerFrame=r}}});function r1(r,e){return e instanceof K?(e._glTextures[r.CONTEXT_UID]||r.texture.bind(e),!0):!1}function n2(r,e){if(!(e instanceof wi))return!1;const{geometry:t}=e;e.finishPoly(),t.updateBatches();const{batches:i}=t;for(let n=0;n<i.length;n++){const{texture:s}=i[n].style;s&&r1(r,s.baseTexture)}return t.batchable||r.geometry.bind(t,e._resolveDirectShader(r)),!0}function s2(r,e){return r instanceof wi?(e.push(r),!0):!1}class i1 extends Wd{constructor(e){super(e),this.uploadHookHelper=this.renderer,this.registerFindHook(s2),this.registerUploadHook(r1),this.registerUploadHook(n2)}}i1.extension={name:"prepare",type:B.RendererSystem};V.add(i1);var o2=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,a2=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,l2=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,gy=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,u2=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const Ra=new ye;class n1 extends Au{constructor(e){super(e),e.runners.contextChange.add(this),this.quad=new lx,this.state=wr.for2d()}contextChange(){const e=this.renderer,t={globals:e.globalUniforms};this.simpleShader=yr.from(gy,u2,t),this.shader=e.context.webGLVersion>1?yr.from(a2,o2,t):yr.from(gy,l2,t)}render(e){const t=this.renderer,i=this.quad;let n=i.vertices;n[0]=n[6]=e._width*-e.anchor.x,n[1]=n[3]=e._height*-e.anchor.y,n[2]=n[4]=e._width*(1-e.anchor.x),n[5]=n[7]=e._height*(1-e.anchor.y);const s=e.uvRespectAnchor?e.anchor.x:0,o=e.uvRespectAnchor?e.anchor.y:0;n=i.uvs,n[0]=n[6]=-s,n[1]=n[3]=-o,n[2]=n[4]=1-s,n[5]=n[7]=1-o,i.invalidate();const a=e._texture,l=a.baseTexture,u=l.alphaMode>0,h=e.tileTransform.localTransform,d=e.uvMatrix;let c=l.isPowerOfTwo&&a.frame.width===l.width&&a.frame.height===l.height;c&&(l._glTextures[t.CONTEXT_UID]?c=l.wrapMode!==mi.CLAMP:l.wrapMode===mi.CLAMP&&(l.wrapMode=mi.REPEAT));const f=c?this.simpleShader:this.shader,p=a.width,v=a.height,x=e._width,g=e._height;Ra.set(h.a*p/x,h.b*p/g,h.c*v/x,h.d*v/g,h.tx/x,h.ty/g),Ra.invert(),c?Ra.prepend(d.mapCoord):(f.uniforms.uMapCoord=d.mapCoord.toArray(!0),f.uniforms.uClampFrame=d.uClampFrame,f.uniforms.uClampOffset=d.uClampOffset),f.uniforms.uTransform=Ra.toArray(!0),f.uniforms.uColor=me.shared.setValue(e.tint).premultiply(e.worldAlpha,u).toArray(f.uniforms.uColor),f.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),f.uniforms.uSampler=a,t.shader.bind(f),t.geometry.bind(i),this.state.blendMode=q_(e.blendMode,u),t.state.set(this.state),t.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}n1.extension={name:"tilingSprite",type:B.RendererPlugin};V.add(n1);const s1=class Hs{constructor(e,t,i){this.linkedSheets=[],(e instanceof K||e instanceof z)&&(e={texture:e,data:t,resolutionFilename:i});const{texture:n,data:s,resolutionFilename:o=null,cachePrefix:a=""}=e;this.cachePrefix=a,this._texture=n instanceof z?n:null,this.baseTexture=n instanceof K?n:this._texture.baseTexture,this.textures={},this.animations={},this.data=s;const l=this.baseTexture.resource;this.resolution=this._updateResolution(o||(l?l.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(e=null){const{scale:t}=this.data.meta;let i=$r(e,null);return i===null&&(i=typeof t=="number"?t:parseFloat(t??"1")),i!==1&&this.baseTexture.setResolution(i),i}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=Hs.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let t=e;const i=Hs.BATCH_SIZE;for(;t-e<i&&t<this._frameKeys.length;){const n=this._frameKeys[t],s=this._frames[n],o=s.frame;if(o){let a=null,l=null;const u=s.trimmed!==!1&&s.sourceSize?s.sourceSize:s.frame,h=new Z(0,0,Math.floor(u.w)/this.resolution,Math.floor(u.h)/this.resolution);s.rotated?a=new Z(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):a=new Z(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),s.trimmed!==!1&&s.spriteSourceSize&&(l=new Z(Math.floor(s.spriteSourceSize.x)/this.resolution,Math.floor(s.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[n]=new z(this.baseTexture,a,h,l,s.rotated?2:0,s.anchor,s.borders),z.addToCache(this.textures[n],this.cachePrefix+n.toString())}t++}}_processAnimations(){const e=this.data.animations||{};for(const t in e){this.animations[t]=[];for(let i=0;i<e[t].length;i++){const n=e[t][i];this.animations[t].push(this.textures[n])}}}_parseComplete(){const e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*Hs.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*Hs.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){var t;for(const i in this.textures)this.textures[i].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&((t=this._texture)==null||t.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};s1.BATCH_SIZE=1e3;let yy=s1;const h2=["jpg","png","jpeg","avif","webp","s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"];function o1(r,e,t){const i={};if(r.forEach(n=>{i[n]=e}),Object.keys(e.textures).forEach(n=>{i[`${e.cachePrefix}${n}`]=e.textures[n]}),!t){const n=je.dirname(r[0]);e.linkedSheets.forEach((s,o)=>{Object.assign(i,o1([`${n}/${e.data.meta.related_multi_packs[o]}`],s,!0))})}return i}const c2={extension:B.Asset,cache:{test:r=>r instanceof yy,getCacheableAssets:(r,e)=>o1(r,e,!1)},resolver:{test:r=>{const e=r.split("?")[0].split("."),t=e.pop(),i=e.pop();return t==="json"&&h2.includes(i)},parse:r=>{var t;const e=r.split(".");return{resolution:parseFloat(((t=U.RETINA_PREFIX.exec(r))==null?void 0:t[1])??"1"),format:e[e.length-2],src:r}}},loader:{name:"spritesheetLoader",extension:{type:B.LoadParser,priority:Jt.Normal},async testParse(r,e){return je.extname(e.src).toLowerCase()===".json"&&!!r.frames},async parse(r,e,t){var h,d;const{texture:i,imageFilename:n,cachePrefix:s}=(e==null?void 0:e.data)??{};let o=je.dirname(e.src);o&&o.lastIndexOf("/")!==o.length-1&&(o+="/");let a;if(i&&i.baseTexture)a=i;else{const c=$d(o+(n??r.meta.image),e.src);a=(await t.load([c]))[c]}const l=new yy({texture:a.baseTexture,data:r,resolutionFilename:e.src,cachePrefix:s});await l.parse();const u=(h=r==null?void 0:r.meta)==null?void 0:h.related_multi_packs;if(Array.isArray(u)){const c=[];for(const p of u){if(typeof p!="string")continue;let v=o+p;(d=e.data)!=null&&d.ignoreMultiPack||(v=$d(v,e.src),c.push(t.load({src:v,data:{ignoreMultiPack:!0}})))}const f=await Promise.all(c);l.linkedSheets=f,f.forEach(p=>{p.linkedSheets=[l].concat(l.linkedSheets.filter(v=>v!==p))})}return l},unload(r){r.destroy(!0)}}};V.add(c2);class Zl{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class il{static test(e){return typeof e=="string"&&e.startsWith("info face=")}static parse(e){const t=e.match(/^[a-z]+\s+.+$/gm),i={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const s in t){const o=t[s].match(/^[a-z]+/gm)[0],a=t[s].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),l={};for(const u in a){const h=a[u].split("="),d=h[0],c=h[1].replace(/"/gm,""),f=parseFloat(c),p=isNaN(f)?c:f;l[d]=p}i[o].push(l)}const n=new Zl;return i.info.forEach(s=>n.info.push({face:s.face,size:parseInt(s.size,10)})),i.common.forEach(s=>n.common.push({lineHeight:parseInt(s.lineHeight,10)})),i.page.forEach(s=>n.page.push({id:parseInt(s.id,10),file:s.file})),i.char.forEach(s=>n.char.push({id:parseInt(s.id,10),page:parseInt(s.page,10),x:parseInt(s.x,10),y:parseInt(s.y,10),width:parseInt(s.width,10),height:parseInt(s.height,10),xoffset:parseInt(s.xoffset,10),yoffset:parseInt(s.yoffset,10),xadvance:parseInt(s.xadvance,10)})),i.kerning.forEach(s=>n.kerning.push({first:parseInt(s.first,10),second:parseInt(s.second,10),amount:parseInt(s.amount,10)})),i.distanceField.forEach(s=>n.distanceField.push({distanceRange:parseInt(s.distanceRange,10),fieldType:s.fieldType})),n}}class Yd{static test(e){const t=e;return typeof e!="string"&&"getElementsByTagName"in e&&t.getElementsByTagName("page").length&&t.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(e){const t=new Zl,i=e.getElementsByTagName("info"),n=e.getElementsByTagName("common"),s=e.getElementsByTagName("page"),o=e.getElementsByTagName("char"),a=e.getElementsByTagName("kerning"),l=e.getElementsByTagName("distanceField");for(let u=0;u<i.length;u++)t.info.push({face:i[u].getAttribute("face"),size:parseInt(i[u].getAttribute("size"),10)});for(let u=0;u<n.length;u++)t.common.push({lineHeight:parseInt(n[u].getAttribute("lineHeight"),10)});for(let u=0;u<s.length;u++)t.page.push({id:parseInt(s[u].getAttribute("id"),10)||0,file:s[u].getAttribute("file")});for(let u=0;u<o.length;u++){const h=o[u];t.char.push({id:parseInt(h.getAttribute("id"),10),page:parseInt(h.getAttribute("page"),10)||0,x:parseInt(h.getAttribute("x"),10),y:parseInt(h.getAttribute("y"),10),width:parseInt(h.getAttribute("width"),10),height:parseInt(h.getAttribute("height"),10),xoffset:parseInt(h.getAttribute("xoffset"),10),yoffset:parseInt(h.getAttribute("yoffset"),10),xadvance:parseInt(h.getAttribute("xadvance"),10)})}for(let u=0;u<a.length;u++)t.kerning.push({first:parseInt(a[u].getAttribute("first"),10),second:parseInt(a[u].getAttribute("second"),10),amount:parseInt(a[u].getAttribute("amount"),10)});for(let u=0;u<l.length;u++)t.distanceField.push({fieldType:l[u].getAttribute("fieldType"),distanceRange:parseInt(l[u].getAttribute("distanceRange"),10)});return t}}class qd{static test(e){return typeof e=="string"&&e.includes("<font>")?Yd.test(U.ADAPTER.parseXML(e)):!1}static parse(e){return Yd.parse(U.ADAPTER.parseXML(e))}}const qh=[il,Yd,qd];function d2(r){for(let e=0;e<qh.length;e++)if(qh[e].test(r))return qh[e];return null}function f2(r,e,t,i,n,s){const o=t.fill;if(Array.isArray(o)){if(o.length===1)return o[0]}else return o;let a;const l=t.dropShadow?t.dropShadowDistance:0,u=t.padding||0,h=r.width/i-l-u*2,d=r.height/i-l-u*2,c=o.slice(),f=t.fillGradientStops.slice();if(!f.length){const p=c.length+1;for(let v=1;v<p;++v)f.push(v/p)}if(c.unshift(o[0]),f.unshift(0),c.push(o[o.length-1]),f.push(1),t.fillGradientType===Ru.LINEAR_VERTICAL){a=e.createLinearGradient(h/2,u,h/2,d+u);let p=0;const v=(s.fontProperties.fontSize+t.strokeThickness)/d;for(let x=0;x<n.length;x++){const g=s.lineHeight*x;for(let y=0;y<c.length;y++){let m=0;typeof f[y]=="number"?m=f[y]:m=y/c.length;const _=g/d+m*v;let w=Math.max(p,_);w=Math.min(w,1),a.addColorStop(w,c[y]),p=w}}}else{a=e.createLinearGradient(u,d/2,h+u,d/2);const p=c.length+1;let v=1;for(let x=0;x<c.length;x++){let g;typeof f[x]=="number"?g=f[x]:g=v/p,a.addColorStop(g,c[x]),v++}}return a}function p2(r,e,t,i,n,s,o){const a=t.text,l=t.fontProperties;e.translate(i,n),e.scale(s,s);const u=o.strokeThickness/2,h=-(o.strokeThickness/2);if(e.font=o.toFontString(),e.lineWidth=o.strokeThickness,e.textBaseline=o.textBaseline,e.lineJoin=o.lineJoin,e.miterLimit=o.miterLimit,e.fillStyle=f2(r,e,o,s,[a],t),e.strokeStyle=o.stroke,o.dropShadow){const d=o.dropShadowColor,c=o.dropShadowBlur*s,f=o.dropShadowDistance*s;e.shadowColor=me.shared.setValue(d).setAlpha(o.dropShadowAlpha).toRgbaString(),e.shadowBlur=c,e.shadowOffsetX=Math.cos(o.dropShadowAngle)*f,e.shadowOffsetY=Math.sin(o.dropShadowAngle)*f}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;o.stroke&&o.strokeThickness&&e.strokeText(a,u,h+t.lineHeight-l.descent),o.fill&&e.fillText(a,u,h+t.lineHeight-l.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)"}function nl(r){return r.codePointAt?r.codePointAt(0):r.charCodeAt(0)}function a1(r){return Array.from?Array.from(r):r.split("")}function m2(r){typeof r=="string"&&(r=[r]);const e=[];for(let t=0,i=r.length;t<i;t++){const n=r[t];if(Array.isArray(n)){if(n.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${n.length}.`);const s=n[0].charCodeAt(0),o=n[1].charCodeAt(0);if(o<s)throw new Error("[BitmapFont]: Invalid character range.");for(let a=s,l=o;a<=l;a++)e.push(String.fromCharCode(a))}else e.push(...a1(n))}if(e.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}const Yr=class ar{constructor(e,t,i){var h;const[n]=e.info,[s]=e.common,[o]=e.page,[a]=e.distanceField,l=$r(o.file),u={};this._ownsTextures=i,this.font=n.face,this.size=n.size,this.lineHeight=s.lineHeight/l,this.chars={},this.pageTextures=u;for(let d=0;d<e.page.length;d++){const{id:c,file:f}=e.page[d];u[c]=t instanceof Array?t[d]:t[f],a!=null&&a.fieldType&&a.fieldType!=="none"&&(u[c].baseTexture.alphaMode=ct.NO_PREMULTIPLIED_ALPHA,u[c].baseTexture.mipmap=_r.OFF)}for(let d=0;d<e.char.length;d++){const{id:c,page:f}=e.char[d];let{x:p,y:v,width:x,height:g,xoffset:y,yoffset:m,xadvance:_}=e.char[d];p/=l,v/=l,x/=l,g/=l,y/=l,m/=l,_/=l;const w=new Z(p+u[f].frame.x/l,v+u[f].frame.y/l,x,g);this.chars[c]={xOffset:y,yOffset:m,xAdvance:_,kerning:{},texture:new z(u[f].baseTexture,w),page:f}}for(let d=0;d<e.kerning.length;d++){let{first:c,second:f,amount:p}=e.kerning[d];c/=l,f/=l,p/=l,this.chars[f]&&(this.chars[f].kerning[c]=p)}this.distanceFieldRange=a==null?void 0:a.distanceRange,this.distanceFieldType=((h=a==null?void 0:a.fieldType)==null?void 0:h.toLowerCase())??"none"}destroy(){for(const e in this.chars)this.chars[e].texture.destroy(),this.chars[e].texture=null;for(const e in this.pageTextures)this._ownsTextures&&this.pageTextures[e].destroy(!0),this.pageTextures[e]=null;this.chars=null,this.pageTextures=null}static install(e,t,i){let n;if(e instanceof Zl)n=e;else{const o=d2(e);if(!o)throw new Error("Unrecognized data format for font.");n=o.parse(e)}t instanceof z&&(t=[t]);const s=new ar(n,t,i);return ar.available[s.font]=s,s}static uninstall(e){const t=ar.available[e];if(!t)throw new Error(`No font found named '${e}'`);t.destroy(),delete ar.available[e]}static from(e,t,i){if(!e)throw new Error("[BitmapFont] Property `name` is required.");const{chars:n,padding:s,resolution:o,textureWidth:a,textureHeight:l,...u}=Object.assign({},ar.defaultOptions,i),h=m2(n),d=t instanceof Ei?t:new Ei(t),c=a,f=new Zl;f.info[0]={face:d.fontFamily,size:d.fontSize},f.common[0]={lineHeight:d.fontSize};let p=0,v=0,x,g,y,m=0;const _=[];for(let S=0;S<h.length;S++){x||(x=U.ADAPTER.createCanvas(),x.width=a,x.height=l,g=x.getContext("2d"),y=new K(x,{resolution:o,...u}),_.push(new z(y)),f.page.push({id:_.length-1,file:""}));const E=h[S],T=Qr.measureText(E,d,!1,x),b=T.width,A=Math.ceil(T.height),I=Math.ceil((d.fontStyle==="italic"?2:1)*b);if(v>=l-A*o){if(v===0)throw new Error(`[BitmapFont] textureHeight ${l}px is too small (fontFamily: '${d.fontFamily}', fontSize: ${d.fontSize}px, char: '${E}')`);--S,x=null,g=null,y=null,v=0,p=0,m=0;continue}if(m=Math.max(A+T.fontProperties.descent,m),I*o+p>=c){if(p===0)throw new Error(`[BitmapFont] textureWidth ${a}px is too small (fontFamily: '${d.fontFamily}', fontSize: ${d.fontSize}px, char: '${E}')`);--S,v+=m*o,v=Math.ceil(v),p=0,m=0;continue}p2(x,g,T,p,v,o,d);const D=nl(T.text);f.char.push({id:D,page:_.length-1,x:p/o,y:v/o,width:I,height:A,xoffset:0,yoffset:0,xadvance:b-(d.dropShadow?d.dropShadowDistance:0)-(d.stroke?d.strokeThickness:0)}),p+=(I+2*s)*o,p=Math.ceil(p)}if(!(i!=null&&i.skipKerning))for(let S=0,E=h.length;S<E;S++){const T=h[S];for(let b=0;b<E;b++){const A=h[b],I=g.measureText(T).width,D=g.measureText(A).width,C=g.measureText(T+A).width-(I+D);C&&f.kerning.push({first:nl(T),second:nl(A),amount:C})}}const w=new ar(f,_,!0);return ar.available[e]!==void 0&&ar.uninstall(e),ar.available[e]=w,w}};Yr.ALPHA=[["a","z"],["A","Z"]," "],Yr.NUMERIC=[["0","9"]],Yr.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],Yr.ASCII=[[" ","~"]],Yr.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:Yr.ALPHANUMERIC},Yr.available={};let qr=Yr;var g2=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`,y2=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const vy=[],_y=[],xy=[],v2=class l1 extends Qt{constructor(e,t={}){super();const{align:i,tint:n,maxWidth:s,letterSpacing:o,fontName:a,fontSize:l}=Object.assign({},l1.styleDefaults,t);if(!qr.available[a])throw new Error(`Missing BitmapFont "${a}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=i,this._tintColor=new me(n),this._font=void 0,this._fontName=a,this._fontSize=l,this.text=e,this._maxWidth=s,this._maxLineHeight=0,this._letterSpacing=o,this._anchor=new Nr(()=>{this.dirty=!0},this,0,0),this._roundPixels=U.ROUND_PIXELS,this.dirty=!0,this._resolution=U.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var I;const e=qr.available[this._fontName],t=this.fontSize,i=t/e.size,n=new ne,s=[],o=[],a=[],l=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",u=a1(l),h=this._maxWidth*e.size/t,d=e.distanceFieldType==="none"?vy:_y;let c=null,f=0,p=0,v=0,x=-1,g=0,y=0,m=0,_=0;for(let D=0;D<u.length;D++){const C=u[D],k=nl(C);if(/(?:\s)/.test(C)&&(x=D,g=f,_++),C==="\r"||C===`
`){o.push(f),a.push(-1),p=Math.max(p,f),++v,++y,n.x=0,n.y+=e.lineHeight,c=null,_=0;continue}const L=e.chars[k];if(!L)continue;c&&L.kerning[c]&&(n.x+=L.kerning[c]);const Y=xy.pop()||{texture:z.EMPTY,line:0,charCode:0,prevSpaces:0,position:new ne};Y.texture=L.texture,Y.line=v,Y.charCode=k,Y.position.x=Math.round(n.x+L.xOffset+this._letterSpacing/2),Y.position.y=Math.round(n.y+L.yOffset),Y.prevSpaces=_,s.push(Y),f=Y.position.x+Math.max(L.xAdvance-L.xOffset,L.texture.orig.width),n.x+=L.xAdvance+this._letterSpacing,m=Math.max(m,L.yOffset+L.texture.height),c=k,x!==-1&&h>0&&n.x>h&&(++y,Yn(s,1+x-y,1+D-x),D=x,x=-1,o.push(g),a.push(s.length>0?s[s.length-1].prevSpaces:0),p=Math.max(p,g),v++,n.x=0,n.y+=e.lineHeight,c=null,_=0)}const w=u[u.length-1];w!=="\r"&&w!==`
`&&(/(?:\s)/.test(w)&&(f=g),o.push(f),p=Math.max(p,f),a.push(-1));const S=[];for(let D=0;D<=v;D++){let C=0;this._align==="right"?C=p-o[D]:this._align==="center"?C=(p-o[D])/2:this._align==="justify"&&(C=a[D]<0?0:(p-o[D])/a[D]),S.push(C)}const E=s.length,T={},b=[],A=this._activePagesMeshData;d.push(...A);for(let D=0;D<E;D++){const C=s[D].texture,k=C.baseTexture.uid;if(!T[k]){let L=d.pop();if(!L){const $=new $P;let P,G;e.distanceFieldType==="none"?(P=new py(z.EMPTY),G=q.NORMAL):(P=new py(z.EMPTY,{program:Or.from(y2,g2),uniforms:{uFWidth:0}}),G=q.NORMAL_NPM);const R=new fy($,P);R.blendMode=G,L={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:R,vertices:null,uvs:null,indices:null}}L.index=0,L.indexCount=0,L.vertexCount=0,L.uvsCount=0,L.total=0;const{_textureCache:Y}=this;Y[k]=Y[k]||new z(C.baseTexture),L.mesh.texture=Y[k],L.mesh.tint=this._tintColor.value,b.push(L),T[k]=L}T[k].total++}for(let D=0;D<A.length;D++)b.includes(A[D])||this.removeChild(A[D].mesh);for(let D=0;D<b.length;D++)b[D].mesh.parent!==this&&this.addChild(b[D].mesh);this._activePagesMeshData=b;for(const D in T){const C=T[D],k=C.total;if(!(((I=C.indices)==null?void 0:I.length)>6*k)||C.vertices.length<fy.BATCHABLE_SIZE*2)C.vertices=new Float32Array(4*2*k),C.uvs=new Float32Array(4*2*k),C.indices=new Uint16Array(6*k);else{const L=C.total,Y=C.vertices;for(let $=L*4*2;$<Y.length;$++)Y[$]=0}C.mesh.size=6*k}for(let D=0;D<E;D++){const C=s[D];let k=C.position.x+S[C.line]*(this._align==="justify"?C.prevSpaces:1);this._roundPixels&&(k=Math.round(k));const L=k*i,Y=C.position.y*i,$=C.texture,P=T[$.baseTexture.uid],G=$.frame,R=$._uvs,M=P.index++;P.indices[M*6+0]=0+M*4,P.indices[M*6+1]=1+M*4,P.indices[M*6+2]=2+M*4,P.indices[M*6+3]=0+M*4,P.indices[M*6+4]=2+M*4,P.indices[M*6+5]=3+M*4,P.vertices[M*8+0]=L,P.vertices[M*8+1]=Y,P.vertices[M*8+2]=L+G.width*i,P.vertices[M*8+3]=Y,P.vertices[M*8+4]=L+G.width*i,P.vertices[M*8+5]=Y+G.height*i,P.vertices[M*8+6]=L,P.vertices[M*8+7]=Y+G.height*i,P.uvs[M*8+0]=R.x0,P.uvs[M*8+1]=R.y0,P.uvs[M*8+2]=R.x1,P.uvs[M*8+3]=R.y1,P.uvs[M*8+4]=R.x2,P.uvs[M*8+5]=R.y2,P.uvs[M*8+6]=R.x3,P.uvs[M*8+7]=R.y3}this._textWidth=p*i,this._textHeight=(n.y+e.lineHeight)*i;for(const D in T){const C=T[D];if(this.anchor.x!==0||this.anchor.y!==0){let $=0;const P=this._textWidth*this.anchor.x,G=this._textHeight*this.anchor.y;for(let R=0;R<C.total;R++)C.vertices[$++]-=P,C.vertices[$++]-=G,C.vertices[$++]-=P,C.vertices[$++]-=G,C.vertices[$++]-=P,C.vertices[$++]-=G,C.vertices[$++]-=P,C.vertices[$++]-=G}this._maxLineHeight=m*i;const k=C.mesh.geometry.getBuffer("aVertexPosition"),L=C.mesh.geometry.getBuffer("aTextureCoord"),Y=C.mesh.geometry.getIndex();k.data=C.vertices,L.data=C.uvs,Y.data=C.indices,k.update(),L.update(),Y.update()}for(let D=0;D<s.length;D++)xy.push(s[D]);this._font=e,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0);const{distanceFieldRange:t,distanceFieldType:i,size:n}=qr.available[this._fontName];if(i!=="none"){const{a:s,b:o,c:a,d:l}=this.worldTransform,u=Math.sqrt(s*s+o*o),h=Math.sqrt(a*a+l*l),d=(Math.abs(u)+Math.abs(h))/2,c=this.fontSize/n,f=e._view.resolution;for(const p of this._activePagesMeshData)p.mesh.shader.uniforms.uFWidth=d*t*c*f}super._render(e)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const e=qr.available[this._fontName];if(!e)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==e&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(e){if(this.tint!==e){this._tintColor.setValue(e);for(let t=0;t<this._activePagesMeshData.length;t++)this._activePagesMeshData[t].mesh.tint=e}}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.dirty=!0)}get fontName(){return this._fontName}set fontName(e){if(!qr.available[e])throw new Error(`Missing BitmapFont "${e}"`);this._fontName!==e&&(this._fontName=e,this.dirty=!0)}get fontSize(){return this._fontSize??qr.available[this._fontName].size}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.dirty=!0)}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(e){e!==this._roundPixels&&(this._roundPixels=e,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}destroy(e){const{_textureCache:t}=this,i=qr.available[this._fontName].distanceFieldType==="none"?vy:_y;i.push(...this._activePagesMeshData);for(const n of this._activePagesMeshData)this.removeChild(n.mesh);this._activePagesMeshData=[],i.filter(n=>t[n.mesh.texture.baseTexture.uid]).forEach(n=>{n.mesh.texture=z.EMPTY});for(const n in t)t[n].destroy(),delete t[n];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(e)}};v2.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};const _2=[".xml",".fnt"],x2={extension:{type:B.LoadParser,priority:Jt.Normal},name:"loadBitmapFont",test(r){return _2.includes(je.extname(r).toLowerCase())},async testParse(r){return il.test(r)||qd.test(r)},async parse(r,e,t){const i=il.test(r)?il.parse(r):qd.parse(r),{src:n}=e,{page:s}=i,o=[];for(let u=0;u<s.length;++u){const h=s[u].file;let d=je.join(je.dirname(n),h);d=$d(d,n),o.push(d)}const a=await t.load(o),l=o.map(u=>a[u]);return qr.install(i,l,!0)},async load(r,e){return(await U.ADAPTER.fetch(r)).text()},unload(r){r.destroy()}};V.add(x2);const Kd=class Tn extends Ei{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(e){return new Tn(Object.keys(Tn.defaultOptions).reduce((t,i)=>({...t,[i]:e[i]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(e=>{URL.revokeObjectURL(e.src),e.refs--,e.refs===0&&(e.fontFace&&document.fonts.delete(e.fontFace),delete Tn.availableFonts[e.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(e,t={}){const{availableFonts:i}=Tn;if(i[e]){const n=i[e];return this._fonts.push(n),n.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return U.ADAPTER.fetch(e).then(n=>n.blob()).then(async n=>new Promise((s,o)=>{const a=URL.createObjectURL(n),l=new FileReader;l.onload=()=>s([a,l.result]),l.onerror=o,l.readAsDataURL(n)})).then(async([n,s])=>{const o=Object.assign({family:je.basename(e,je.extname(e)),weight:"normal",style:"normal",display:"auto",src:n,dataSrc:s,refs:1,originalUrl:e,fontFace:null},t);i[e]=o,this._fonts.push(o),this.styleID++;const a=new FontFace(o.family,`url(${o.src})`,{weight:o.weight,style:o.style,display:o.display});o.fontFace=a,await a.load(),document.fonts.add(a),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(...e){const t=e.filter(i=>!this._overrides.includes(i));t.length>0&&(this._overrides.push(...t),this.styleID++)}removeOverride(...e){const t=e.filter(i=>this._overrides.includes(i));t.length>0&&(this._overrides=this._overrides.filter(i=>!t.includes(i)),this.styleID++)}toCSS(e){return[`transform: scale(${e})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((e,t)=>`${e}
            @font-face {
                font-family: "${t.family}";
                src: url('${t.dataSrc}');
                font-weight: ${t.weight};
                font-style: ${t.style};
                font-display: ${t.display};
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(e){this._stylesheet!==e&&(this._stylesheet=e,this.styleID++)}normalizeColor(e){return Array.isArray(e)&&(e=uC(e)),typeof e=="number"?lC(e):e}dropShadowToCSS(){let e=this.normalizeColor(this.dropShadowColor);const t=this.dropShadowAlpha,i=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),n=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);e.startsWith("#")&&t<1&&(e+=(t*255|0).toString(16).padStart(2,"0"));const s=`${i}px ${n}px`;return this.dropShadowBlur>0?`text-shadow: ${s} ${this.dropShadowBlur}px ${e}`:`text-shadow: ${s} ${e}`}reset(){Object.assign(this,Tn.defaultOptions)}onBeforeDraw(){const{fontsDirty:e}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&e?new Promise(t=>setTimeout(t,100)):Promise.resolve()}get isSafari(){const{userAgent:e}=U.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(e)}set fillGradientStops(e){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(e){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(e){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(e){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(e){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(e){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(e){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};Kd.availableFonts={},Kd.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};let Kh=Kd;const Ia=class Sn extends xi{constructor(e="",t={}){super(z.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this.localStyleID=-1,this.dirty=!1,this._updateID=0,this.ownsStyle=!1;const i=new Image,n=z.from(i,{scaleMode:U.SCALE_MODE,resourceOptions:{autoLoad:!1}});n.orig=new Z,n.trim=new Z,this.texture=n;const s="http://www.w3.org/2000/svg",o="http://www.w3.org/1999/xhtml",a=document.createElementNS(s,"svg"),l=document.createElementNS(s,"foreignObject"),u=document.createElementNS(o,"div"),h=document.createElementNS(o,"style");l.setAttribute("width","10000"),l.setAttribute("height","10000"),l.style.overflow="hidden",a.appendChild(l),this.maxWidth=Sn.defaultMaxWidth,this.maxHeight=Sn.defaultMaxHeight,this._domElement=u,this._styleElement=h,this._svgRoot=a,this._foreignObject=l,this._foreignObject.appendChild(h),this._foreignObject.appendChild(u),this._image=i,this._loadImage=new Image,this._autoResolution=Sn.defaultAutoResolution,this._resolution=Sn.defaultResolution??U.RESOLUTION,this.text=e,this.style=t}measureText(e){var h,d;const{text:t,style:i,resolution:n}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},e);Object.assign(this._domElement,{innerHTML:t,style:i.toCSS(n)}),this._styleElement.textContent=i.toGlobalCSS(),document.body.appendChild(this._svgRoot);const s=this._domElement.getBoundingClientRect();this._svgRoot.remove();const{width:o,height:a}=s;(o>this.maxWidth||a>this.maxHeight)&&console.warn("[HTMLText] Large expanse of text, increase HTMLText.maxWidth or HTMLText.maxHeight property.");const l=Math.min(this.maxWidth,Math.ceil(o)),u=Math.min(this.maxHeight,Math.ceil(a));return this._svgRoot.setAttribute("width",l.toString()),this._svgRoot.setAttribute("height",u.toString()),t!==this._text&&(this._domElement.innerHTML=this._text),i!==this._style&&(Object.assign(this._domElement,{style:(h=this._style)==null?void 0:h.toCSS(n)}),this._styleElement.textContent=(d=this._style)==null?void 0:d.toGlobalCSS()),{width:l+i.padding*2,height:u+i.padding*2}}async updateText(e=!0){const{style:t,_image:i,_loadImage:n}=this;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&e)return;const{width:s,height:o}=this.measureText();i.width=n.width=Math.ceil(Math.max(1,s)),i.height=n.height=Math.ceil(Math.max(1,o)),this._updateID++;const a=this._updateID;await new Promise(l=>{n.onload=async()=>{if(a<this._updateID){l();return}await t.onBeforeDraw(),i.src=n.src,n.onload=null,n.src="",this.updateTexture(),l()};const u=new XMLSerializer().serializeToString(this._svgRoot);n.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(u)}`})}get source(){return this._image}updateTexture(){const{style:e,texture:t,_image:i,resolution:n}=this,{padding:s}=e,{baseTexture:o}=t;t.trim.width=t._frame.width=i.width/n,t.trim.height=t._frame.height=i.height/n,t.trim.x=-s,t.trim.y=-s,t.orig.width=t._frame.width-s*2,t.orig.height=t._frame.height-s*2,this._onTextureUpdate(),o.setRealSize(i.width,i.height,n),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}_renderCanvas(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(e)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds(e)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(e){var i,n,s,o,a;typeof e=="boolean"&&(e={children:e}),e=Object.assign({},Sn.defaultDestroyOptions,e),super.destroy(e);const t=null;this.ownsStyle&&((i=this._style)==null||i.cleanFonts()),this._style=t,(n=this._svgRoot)==null||n.remove(),this._svgRoot=t,(s=this._domElement)==null||s.remove(),this._domElement=t,(o=this._foreignObject)==null||o.remove(),this._foreignObject=t,(a=this._styleElement)==null||a.remove(),this._styleElement=t,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=t,this._image.src="",this._image=t}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(e){this.updateText(!0);const t=si(this.scale.x)||1;this.scale.x=t*e/this._image.width/this.resolution,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(e){this.updateText(!0);const t=si(this.scale.y)||1;this.scale.y=t*e/this._image.height/this.resolution,this._height=e}get style(){return this._style}set style(e){this._style!==e&&(e=e||{},e instanceof Kh?(this.ownsStyle=!1,this._style=e):e instanceof Ei?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=Kh.from(e)):(this.ownsStyle=!0,this._style=new Kh(e)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(e){e=String(e===""||e===null||e===void 0?" ":e),e=this.sanitiseText(e),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}sanitiseText(e){return e.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};Ia.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},Ia.defaultMaxWidth=2024,Ia.defaultMaxHeight=2024,Ia.defaultAutoResolution=!0;const xr=Object.create(null);xr.open="0";xr.close="1";xr.ping="2";xr.pong="3";xr.message="4";xr.upgrade="5";xr.noop="6";const sl=Object.create(null);Object.keys(xr).forEach(r=>{sl[xr[r]]=r});const Zd={type:"error",data:"parser error"},u1=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",h1=typeof ArrayBuffer=="function",c1=r=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r&&r.buffer instanceof ArrayBuffer,xp=({type:r,data:e},t,i)=>u1&&e instanceof Blob?t?i(e):wy(e,i):h1&&(e instanceof ArrayBuffer||c1(e))?t?i(e):wy(new Blob([e]),i):i(xr[r]+(e||"")),wy=(r,e)=>{const t=new FileReader;return t.onload=function(){const i=t.result.split(",")[1];e("b"+(i||""))},t.readAsDataURL(r)};function Ey(r){return r instanceof Uint8Array?r:r instanceof ArrayBuffer?new Uint8Array(r):new Uint8Array(r.buffer,r.byteOffset,r.byteLength)}let Zh;function w2(r,e){if(u1&&r.data instanceof Blob)return r.data.arrayBuffer().then(Ey).then(e);if(h1&&(r.data instanceof ArrayBuffer||c1(r.data)))return e(Ey(r.data));xp(r,!1,t=>{Zh||(Zh=new TextEncoder),e(Zh.encode(t))})}const Ty="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",$s=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let r=0;r<Ty.length;r++)$s[Ty.charCodeAt(r)]=r;const E2=r=>{let e=r.length*.75,t=r.length,i,n=0,s,o,a,l;r[r.length-1]==="="&&(e--,r[r.length-2]==="="&&e--);const u=new ArrayBuffer(e),h=new Uint8Array(u);for(i=0;i<t;i+=4)s=$s[r.charCodeAt(i)],o=$s[r.charCodeAt(i+1)],a=$s[r.charCodeAt(i+2)],l=$s[r.charCodeAt(i+3)],h[n++]=s<<2|o>>4,h[n++]=(o&15)<<4|a>>2,h[n++]=(a&3)<<6|l&63;return u},T2=typeof ArrayBuffer=="function",wp=(r,e)=>{if(typeof r!="string")return{type:"message",data:d1(r,e)};const t=r.charAt(0);return t==="b"?{type:"message",data:S2(r.substring(1),e)}:sl[t]?r.length>1?{type:sl[t],data:r.substring(1)}:{type:sl[t]}:Zd},S2=(r,e)=>{if(T2){const t=E2(r);return d1(t,e)}else return{base64:!0,data:r}},d1=(r,e)=>{switch(e){case"blob":return r instanceof Blob?r:new Blob([r]);case"arraybuffer":default:return r instanceof ArrayBuffer?r:r.buffer}},f1="",A2=(r,e)=>{const t=r.length,i=new Array(t);let n=0;r.forEach((s,o)=>{xp(s,!1,a=>{i[o]=a,++n===t&&e(i.join(f1))})})},b2=(r,e)=>{const t=r.split(f1),i=[];for(let n=0;n<t.length;n++){const s=wp(t[n],e);if(i.push(s),s.type==="error")break}return i};function C2(){return new TransformStream({transform(r,e){w2(r,t=>{const i=t.length;let n;if(i<126)n=new Uint8Array(1),new DataView(n.buffer).setUint8(0,i);else if(i<65536){n=new Uint8Array(3);const s=new DataView(n.buffer);s.setUint8(0,126),s.setUint16(1,i)}else{n=new Uint8Array(9);const s=new DataView(n.buffer);s.setUint8(0,127),s.setBigUint64(1,BigInt(i))}r.data&&typeof r.data!="string"&&(n[0]|=128),e.enqueue(n),e.enqueue(t)})}})}let Qh;function Pa(r){return r.reduce((e,t)=>e+t.length,0)}function ka(r,e){if(r[0].length===e)return r.shift();const t=new Uint8Array(e);let i=0;for(let n=0;n<e;n++)t[n]=r[0][i++],i===r[0].length&&(r.shift(),i=0);return r.length&&i<r[0].length&&(r[0]=r[0].slice(i)),t}function R2(r,e){Qh||(Qh=new TextDecoder);const t=[];let i=0,n=-1,s=!1;return new TransformStream({transform(o,a){for(t.push(o);;){if(i===0){if(Pa(t)<1)break;const l=ka(t,1);s=(l[0]&128)===128,n=l[0]&127,n<126?i=3:n===126?i=1:i=2}else if(i===1){if(Pa(t)<2)break;const l=ka(t,2);n=new DataView(l.buffer,l.byteOffset,l.length).getUint16(0),i=3}else if(i===2){if(Pa(t)<8)break;const l=ka(t,8),u=new DataView(l.buffer,l.byteOffset,l.length),h=u.getUint32(0);if(h>Math.pow(2,21)-1){a.enqueue(Zd);break}n=h*Math.pow(2,32)+u.getUint32(4),i=3}else{if(Pa(t)<n)break;const l=ka(t,n);a.enqueue(wp(s?l:Qh.decode(l),e)),i=0}if(n===0||n>r){a.enqueue(Zd);break}}}})}const p1=4;function Be(r){if(r)return I2(r)}function I2(r){for(var e in Be.prototype)r[e]=Be.prototype[e];return r}Be.prototype.on=Be.prototype.addEventListener=function(r,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+r]=this._callbacks["$"+r]||[]).push(e),this};Be.prototype.once=function(r,e){function t(){this.off(r,t),e.apply(this,arguments)}return t.fn=e,this.on(r,t),this};Be.prototype.off=Be.prototype.removeListener=Be.prototype.removeAllListeners=Be.prototype.removeEventListener=function(r,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+r];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+r],this;for(var i,n=0;n<t.length;n++)if(i=t[n],i===e||i.fn===e){t.splice(n,1);break}return t.length===0&&delete this._callbacks["$"+r],this};Be.prototype.emit=function(r){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+r],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(t){t=t.slice(0);for(var i=0,n=t.length;i<n;++i)t[i].apply(this,e)}return this};Be.prototype.emitReserved=Be.prototype.emit;Be.prototype.listeners=function(r){return this._callbacks=this._callbacks||{},this._callbacks["$"+r]||[]};Be.prototype.hasListeners=function(r){return!!this.listeners(r).length};const Iu=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,t)=>t(e,0),Rt=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),P2="arraybuffer";function m1(r,...e){return e.reduce((t,i)=>(r.hasOwnProperty(i)&&(t[i]=r[i]),t),{})}const k2=Rt.setTimeout,M2=Rt.clearTimeout;function Pu(r,e){e.useNativeTimers?(r.setTimeoutFn=k2.bind(Rt),r.clearTimeoutFn=M2.bind(Rt)):(r.setTimeoutFn=Rt.setTimeout.bind(Rt),r.clearTimeoutFn=Rt.clearTimeout.bind(Rt))}const D2=1.33;function N2(r){return typeof r=="string"?O2(r):Math.ceil((r.byteLength||r.size)*D2)}function O2(r){let e=0,t=0;for(let i=0,n=r.length;i<n;i++)e=r.charCodeAt(i),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(i++,t+=4);return t}function g1(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function B2(r){let e="";for(let t in r)r.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(r[t]));return e}function L2(r){let e={},t=r.split("&");for(let i=0,n=t.length;i<n;i++){let s=t[i].split("=");e[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return e}class F2 extends Error{constructor(e,t,i){super(e),this.description=t,this.context=i,this.type="TransportError"}}class Ep extends Be{constructor(e){super(),this.writable=!1,Pu(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,i){return super.emitReserved("error",new F2(e,t,i)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=wp(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const t=B2(e);return t.length?"?"+t:""}}class U2 extends Ep{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let i=0;this._polling&&(i++,this.once("pollComplete",function(){--i||t()})),this.writable||(i++,this.once("drain",function(){--i||t()}))}else t()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const t=i=>{if(this.readyState==="opening"&&i.type==="open"&&this.onOpen(),i.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(i)};b2(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,A2(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=g1()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.createUri(e,t)}}let y1=!1;try{y1=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const G2=y1;function H2(){}class $2 extends U2{constructor(e){if(super(e),typeof location<"u"){const t=location.protocol==="https:";let i=location.port;i||(i=t?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||i!==e.port}}doWrite(e,t){const i=this.request({method:"POST",data:e});i.on("success",t),i.on("error",(n,s)=>{this.onError("xhr post error",n,s)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,i)=>{this.onError("xhr poll error",t,i)}),this.pollXhr=e}}class vr extends Be{constructor(e,t,i){super(),this.createRequest=e,Pu(this,i),this._opts=i,this._method=i.method||"GET",this._uri=t,this._data=i.data!==void 0?i.data:null,this._create()}_create(){var e;const t=m1(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;const i=this._xhr=this.createRequest(t);try{i.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){i.setDisableHeaderCheck&&i.setDisableHeaderCheck(!0);for(let n in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(n)&&i.setRequestHeader(n,this._opts.extraHeaders[n])}}catch{}if(this._method==="POST")try{i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{i.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(i),"withCredentials"in i&&(i.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(i.timeout=this._opts.requestTimeout),i.onreadystatechange=()=>{var n;i.readyState===3&&((n=this._opts.cookieJar)===null||n===void 0||n.parseCookies(i.getResponseHeader("set-cookie"))),i.readyState===4&&(i.status===200||i.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof i.status=="number"?i.status:0)},0))},i.send(this._data)}catch(n){this.setTimeoutFn(()=>{this._onError(n)},0);return}typeof document<"u"&&(this._index=vr.requestsCount++,vr.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=H2,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete vr.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}vr.requestsCount=0;vr.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Sy);else if(typeof addEventListener=="function"){const r="onpagehide"in Rt?"pagehide":"unload";addEventListener(r,Sy,!1)}}function Sy(){for(let r in vr.requests)vr.requests.hasOwnProperty(r)&&vr.requests[r].abort()}const z2=function(){const r=v1({xdomain:!1});return r&&r.responseType!==null}();class V2 extends $2{constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=z2&&!t}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new vr(v1,this.uri(),e)}}function v1(r){const e=r.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||G2))return new XMLHttpRequest}catch{}if(!e)try{return new Rt[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const _1=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class X2 extends Ep{get name(){return"websocket"}doOpen(){const e=this.uri(),t=this.opts.protocols,i=_1?{}:m1(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(i.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,i)}catch(n){return this.emitReserved("error",n)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const i=e[t],n=t===e.length-1;xp(i,this.supportsBinary,s=>{try{this.doWrite(i,s)}catch{}n&&Iu(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=g1()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}const Jh=Rt.WebSocket||Rt.MozWebSocket;class j2 extends X2{createSocket(e,t,i){return _1?new Jh(e,t,i):t?new Jh(e,t):new Jh(e)}doWrite(e,t){this.ws.send(t)}}class W2 extends Ep{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const t=R2(Number.MAX_SAFE_INTEGER,this.socket.binaryType),i=e.readable.pipeThrough(t).getReader(),n=C2();n.readable.pipeTo(e.writable),this._writer=n.writable.getWriter();const s=()=>{i.read().then(({done:a,value:l})=>{a||(this.onPacket(l),s())}).catch(a=>{})};s();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const i=e[t],n=t===e.length-1;this._writer.write(i).then(()=>{n&&Iu(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const Y2={websocket:j2,webtransport:W2,polling:V2},q2=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,K2=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Qd(r){if(r.length>8e3)throw"URI too long";const e=r,t=r.indexOf("["),i=r.indexOf("]");t!=-1&&i!=-1&&(r=r.substring(0,t)+r.substring(t,i).replace(/:/g,";")+r.substring(i,r.length));let n=q2.exec(r||""),s={},o=14;for(;o--;)s[K2[o]]=n[o]||"";return t!=-1&&i!=-1&&(s.source=e,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s.pathNames=Z2(s,s.path),s.queryKey=Q2(s,s.query),s}function Z2(r,e){const t=/\/{2,9}/g,i=e.replace(t,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&i.splice(0,1),e.slice(-1)=="/"&&i.splice(i.length-1,1),i}function Q2(r,e){const t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(i,n,s){n&&(t[n]=s)}),t}const Jd=typeof addEventListener=="function"&&typeof removeEventListener=="function",ol=[];Jd&&addEventListener("offline",()=>{ol.forEach(r=>r())},!1);class gi extends Be{constructor(e,t){if(super(),this.binaryType=P2,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(t=e,e=null),e){const i=Qd(e);t.hostname=i.host,t.secure=i.protocol==="https"||i.protocol==="wss",t.port=i.port,i.query&&(t.query=i.query)}else t.host&&(t.hostname=Qd(t.host).host);Pu(this,t),this.secure=t.secure!=null?t.secure:typeof location<"u"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=t.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(i=>{const n=i.prototype.name;this.transports.push(n),this._transportsByName[n]=i}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=L2(this.opts.query)),Jd&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},ol.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=p1,t.transport=e,this.id&&(t.sid=this.id);const i=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](i)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&gi.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",t=>this._onClose("transport close",t))}onOpen(){this.readyState="open",gi.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let i=0;i<this.writeBuffer.length;i++){const n=this.writeBuffer[i].data;if(n&&(t+=N2(n)),i>0&&t>this._maxPayload)return this.writeBuffer.slice(0,i);t+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,Iu(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,i){return this._sendPacket("message",e,t,i),this}send(e,t,i){return this._sendPacket("message",e,t,i),this}_sendPacket(e,t,i,n){if(typeof t=="function"&&(n=t,t=void 0),typeof i=="function"&&(n=i,i=null),this.readyState==="closing"||this.readyState==="closed")return;i=i||{},i.compress=i.compress!==!1;const s={type:e,data:t,options:i};this.emitReserved("packetCreate",s),this.writeBuffer.push(s),n&&this.once("flush",n),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},i=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?i():e()}):this.upgrading?i():e()),this}_onError(e){if(gi.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Jd&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const i=ol.indexOf(this._offlineEventListener);i!==-1&&ol.splice(i,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}gi.protocol=p1;class J2 extends gi{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let t=this.createTransport(e),i=!1;gi.priorWebsocketSuccess=!1;const n=()=>{i||(t.send([{type:"ping",data:"probe"}]),t.once("packet",d=>{if(!i)if(d.type==="pong"&&d.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;gi.priorWebsocketSuccess=t.name==="websocket",this.transport.pause(()=>{i||this.readyState!=="closed"&&(h(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const c=new Error("probe error");c.transport=t.name,this.emitReserved("upgradeError",c)}}))};function s(){i||(i=!0,h(),t.close(),t=null)}const o=d=>{const c=new Error("probe error: "+d);c.transport=t.name,s(),this.emitReserved("upgradeError",c)};function a(){o("transport closed")}function l(){o("socket closed")}function u(d){t&&d.name!==t.name&&s()}const h=()=>{t.removeListener("open",n),t.removeListener("error",o),t.removeListener("close",a),this.off("close",l),this.off("upgrading",u)};t.once("open",n),t.once("error",o),t.once("close",a),this.once("close",l),this.once("upgrading",u),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{i||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const t=[];for(let i=0;i<e.length;i++)~this.transports.indexOf(e[i])&&t.push(e[i]);return t}}let ek=class extends J2{constructor(e,t={}){const i=typeof e=="object"?e:t;(!i.transports||i.transports&&typeof i.transports[0]=="string")&&(i.transports=(i.transports||["polling","websocket","webtransport"]).map(n=>Y2[n]).filter(n=>!!n)),super(e,i)}};function tk(r,e="",t){let i=r;t=t||typeof location<"u"&&location,r==null&&(r=t.protocol+"//"+t.host),typeof r=="string"&&(r.charAt(0)==="/"&&(r.charAt(1)==="/"?r=t.protocol+r:r=t.host+r),/^(https?|wss?):\/\//.test(r)||(typeof t<"u"?r=t.protocol+"//"+r:r="https://"+r),i=Qd(r)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";const s=i.host.indexOf(":")!==-1?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+s+":"+i.port+e,i.href=i.protocol+"://"+s+(t&&t.port===i.port?"":":"+i.port),i}const rk=typeof ArrayBuffer=="function",ik=r=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r.buffer instanceof ArrayBuffer,x1=Object.prototype.toString,nk=typeof Blob=="function"||typeof Blob<"u"&&x1.call(Blob)==="[object BlobConstructor]",sk=typeof File=="function"||typeof File<"u"&&x1.call(File)==="[object FileConstructor]";function Tp(r){return rk&&(r instanceof ArrayBuffer||ik(r))||nk&&r instanceof Blob||sk&&r instanceof File}function al(r,e){if(!r||typeof r!="object")return!1;if(Array.isArray(r)){for(let t=0,i=r.length;t<i;t++)if(al(r[t]))return!0;return!1}if(Tp(r))return!0;if(r.toJSON&&typeof r.toJSON=="function"&&arguments.length===1)return al(r.toJSON(),!0);for(const t in r)if(Object.prototype.hasOwnProperty.call(r,t)&&al(r[t]))return!0;return!1}function ok(r){const e=[],t=r.data,i=r;return i.data=ef(t,e),i.attachments=e.length,{packet:i,buffers:e}}function ef(r,e){if(!r)return r;if(Tp(r)){const t={_placeholder:!0,num:e.length};return e.push(r),t}else if(Array.isArray(r)){const t=new Array(r.length);for(let i=0;i<r.length;i++)t[i]=ef(r[i],e);return t}else if(typeof r=="object"&&!(r instanceof Date)){const t={};for(const i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=ef(r[i],e));return t}return r}function ak(r,e){return r.data=tf(r.data,e),delete r.attachments,r}function tf(r,e){if(!r)return r;if(r&&r._placeholder===!0){if(typeof r.num=="number"&&r.num>=0&&r.num<e.length)return e[r.num];throw new Error("illegal attachments")}else if(Array.isArray(r))for(let t=0;t<r.length;t++)r[t]=tf(r[t],e);else if(typeof r=="object")for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&(r[t]=tf(r[t],e));return r}const lk=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],uk=5;var ie;(function(r){r[r.CONNECT=0]="CONNECT",r[r.DISCONNECT=1]="DISCONNECT",r[r.EVENT=2]="EVENT",r[r.ACK=3]="ACK",r[r.CONNECT_ERROR=4]="CONNECT_ERROR",r[r.BINARY_EVENT=5]="BINARY_EVENT",r[r.BINARY_ACK=6]="BINARY_ACK"})(ie||(ie={}));class hk{constructor(e){this.replacer=e}encode(e){return(e.type===ie.EVENT||e.type===ie.ACK)&&al(e)?this.encodeAsBinary({type:e.type===ie.EVENT?ie.BINARY_EVENT:ie.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===ie.BINARY_EVENT||e.type===ie.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=ok(e),i=this.encodeAsString(t.packet),n=t.buffers;return n.unshift(i),n}}function Ay(r){return Object.prototype.toString.call(r)==="[object Object]"}class Sp extends Be{constructor(e){super(),this.reviver=e}add(e){let t;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const i=t.type===ie.BINARY_EVENT;i||t.type===ie.BINARY_ACK?(t.type=i?ie.EVENT:ie.ACK,this.reconstructor=new ck(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(Tp(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0;const i={type:Number(e.charAt(0))};if(ie[i.type]===void 0)throw new Error("unknown packet type "+i.type);if(i.type===ie.BINARY_EVENT||i.type===ie.BINARY_ACK){const s=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);const o=e.substring(s,t);if(o!=Number(o)||e.charAt(t)!=="-")throw new Error("Illegal attachments");i.attachments=Number(o)}if(e.charAt(t+1)==="/"){const s=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););i.nsp=e.substring(s,t)}else i.nsp="/";const n=e.charAt(t+1);if(n!==""&&Number(n)==n){const s=t+1;for(;++t;){const o=e.charAt(t);if(o==null||Number(o)!=o){--t;break}if(t===e.length)break}i.id=Number(e.substring(s,t+1))}if(e.charAt(++t)){const s=this.tryParse(e.substr(t));if(Sp.isPayloadValid(i.type,s))i.data=s;else throw new Error("invalid payload")}return i}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,t){switch(e){case ie.CONNECT:return Ay(t);case ie.DISCONNECT:return t===void 0;case ie.CONNECT_ERROR:return typeof t=="string"||Ay(t);case ie.EVENT:case ie.BINARY_EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&lk.indexOf(t[0])===-1);case ie.ACK:case ie.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class ck{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const t=ak(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const dk=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Sp,Encoder:hk,get PacketType(){return ie},protocol:uk},Symbol.toStringTag,{value:"Module"}));function Vt(r,e,t){return r.on(e,t),function(){r.off(e,t)}}const fk=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class w1 extends Be{constructor(e,t,i){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,i&&i.auth&&(this.auth=i.auth),this._opts=Object.assign({},i),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[Vt(e,"open",this.onopen.bind(this)),Vt(e,"packet",this.onpacket.bind(this)),Vt(e,"error",this.onerror.bind(this)),Vt(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){var i,n,s;if(fk.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const o={type:ie.EVENT,data:t};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){const h=this.ids++,d=t.pop();this._registerAckCallback(h,d),o.id=h}const a=(n=(i=this.io.engine)===null||i===void 0?void 0:i.transport)===null||n===void 0?void 0:n.writable,l=this.connected&&!(!((s=this.io.engine)===null||s===void 0)&&s._hasPingExpired());return this.flags.volatile&&!a||(l?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(e,t){var i;const n=(i=this.flags.timeout)!==null&&i!==void 0?i:this._opts.ackTimeout;if(n===void 0){this.acks[e]=t;return}const s=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let a=0;a<this.sendBuffer.length;a++)this.sendBuffer[a].id===e&&this.sendBuffer.splice(a,1);t.call(this,new Error("operation has timed out"))},n),o=(...a)=>{this.io.clearTimeoutFn(s),t.apply(this,a)};o.withError=!0,this.acks[e]=o}emitWithAck(e,...t){return new Promise((i,n)=>{const s=(o,a)=>o?n(o):i(a);s.withError=!0,t.push(s),this.emit(e,...t)})}_addToQueue(e){let t;typeof e[e.length-1]=="function"&&(t=e.pop());const i={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((n,...s)=>i!==this._queue[0]?void 0:(n!==null?i.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(n)):(this._queue.shift(),t&&t(null,...s)),i.pending=!1,this._drainQueue())),this._queue.push(i),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:ie.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(i=>String(i.id)===e)){const i=this.acks[e];delete this.acks[e],i.withError&&i.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case ie.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case ie.EVENT:case ie.BINARY_EVENT:this.onevent(e);break;case ie.ACK:case ie.BINARY_ACK:this.onack(e);break;case ie.DISCONNECT:this.ondisconnect();break;case ie.CONNECT_ERROR:this.destroy();const i=new Error(e.data.message);i.data=e.data.data,this.emitReserved("connect_error",i);break}}onevent(e){const t=e.data||[];e.id!=null&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const i of t)i.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let i=!1;return function(...n){i||(i=!0,t.packet({type:ie.ACK,id:e,data:n}))}}onack(e){const t=this.acks[e.id];typeof t=="function"&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:ie.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let i=0;i<t.length;i++)if(e===t[i])return t.splice(i,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let i=0;i<t.length;i++)if(e===t[i])return t.splice(i,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const i of t)i.apply(this,e.data)}}}function ps(r){r=r||{},this.ms=r.min||100,this.max=r.max||1e4,this.factor=r.factor||2,this.jitter=r.jitter>0&&r.jitter<=1?r.jitter:0,this.attempts=0}ps.prototype.duration=function(){var r=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*r);r=Math.floor(e*10)&1?r+t:r-t}return Math.min(r,this.max)|0};ps.prototype.reset=function(){this.attempts=0};ps.prototype.setMin=function(r){this.ms=r};ps.prototype.setMax=function(r){this.max=r};ps.prototype.setJitter=function(r){this.jitter=r};class rf extends Be{constructor(e,t){var i;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,Pu(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((i=t.randomizationFactor)!==null&&i!==void 0?i:.5),this.backoff=new ps({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;const n=t.parser||dk;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new ek(this.uri,this.opts);const t=this.engine,i=this;this._readyState="opening",this.skipReconnect=!1;const n=Vt(t,"open",function(){i.onopen(),e&&e()}),s=a=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",a),e?e(a):this.maybeReconnectOnOpen()},o=Vt(t,"error",s);if(this._timeout!==!1){const a=this._timeout,l=this.setTimeoutFn(()=>{n(),s(new Error("timeout")),t.close()},a);this.opts.autoUnref&&l.unref(),this.subs.push(()=>{this.clearTimeoutFn(l)})}return this.subs.push(n),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(Vt(e,"ping",this.onping.bind(this)),Vt(e,"data",this.ondata.bind(this)),Vt(e,"error",this.onerror.bind(this)),Vt(e,"close",this.onclose.bind(this)),Vt(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){Iu(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let i=this.nsps[e];return i?this._autoConnect&&!i.active&&i.connect():(i=new w1(this,e,t),this.nsps[e]=i),i}_destroy(e){const t=Object.keys(this.nsps);for(const i of t)if(this.nsps[i].active)return;this._close()}_packet(e){const t=this.encoder.encode(e);for(let i=0;i<t.length;i++)this.engine.write(t[i],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var i;this.cleanup(),(i=this.engine)===null||i===void 0||i.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const i=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(n=>{n?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",n)):e.onreconnect()}))},t);this.opts.autoUnref&&i.unref(),this.subs.push(()=>{this.clearTimeoutFn(i)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const Ps={};function ll(r,e){typeof r=="object"&&(e=r,r=void 0),e=e||{};const t=tk(r,e.path||"/socket.io"),i=t.source,n=t.id,s=t.path,o=Ps[n]&&s in Ps[n].nsps,a=e.forceNew||e["force new connection"]||e.multiplex===!1||o;let l;return a?l=new rf(i,e):(Ps[n]||(Ps[n]=new rf(i,e)),l=Ps[n]),t.query&&!e.query&&(e.query=t.queryKey),l.socket(t.path,e)}Object.assign(ll,{Manager:rf,Socket:w1,io:ll,connect:ll});function pk(r,e,t=60){if(!e||typeof e.x!="number"||typeof e.y!="number")return;const i=t*.2,n=t*2-i,s=t*1.3-i,o=new wi;o.beginFill(6737151),o.drawEllipse(e.x,e.y,n/2,s/2),o.endFill(),o.zIndex=.5,r.stage.addChild(o)}function mk(r,{innerBoundary:e,outerBoundary:t,rotatedCenterline:i,startLineAt:n}){r.stage.removeChildren(),r.stage.sortableChildren=!0;const s=new wi;s.beginFill(10053171),t.forEach((d,c)=>c===0?s.moveTo(d.x,d.y):s.lineTo(d.x,d.y));for(let d=e.length-1;d>=0;d--)s.lineTo(e[d].x,e[d].y);if(s.endFill(),s.lineStyle(2,10066329),t.forEach((d,c)=>c===0?s.moveTo(d.x,d.y):s.lineTo(d.x,d.y)),s.lineTo(t[0].x,t[0].y),e.forEach((d,c)=>c===0?s.moveTo(d.x,d.y):s.lineTo(d.x,d.y)),s.lineTo(e[0].x,e[0].y),r.stage.addChild(s),n&&i.length>1){const d=i[0],c=i[1],f=c.x-d.x,p=c.y-d.y,v=Math.sqrt(f*f+p*p),x=-p/v,g=f/v,y=new wi;y.lineStyle(4,65280),y.moveTo(n.x+x*60,n.y+g*60),y.lineTo(n.x-x*60,n.y-g*60),r.stage.addChild(y)}const o=e.reduce((d,c)=>({minX:Math.min(d.minX,c.x),maxX:Math.max(d.maxX,c.x),minY:Math.min(d.minY,c.y),maxY:Math.max(d.maxY,c.y)}),{minX:1/0,maxX:-1/0,minY:1/0,maxY:-1/0}),a=60,l=10,u=o.minX+a+l,h=o.minY+a+l;pk(r,{x:u,y:h},a)}function gk({app:r,debugVisible:e,debugDotsRef:t,debugPathLinesRef:i,startDotsRef:n,finishDotsRef:s,labelSpritesRef:o}){const a=(l,u)=>{l.forEach(h=>{u&&!r.stage.children.includes(h)?r.stage.addChild(h):!u&&r.stage.children.includes(h)&&r.stage.removeChild(h)})};a(t.current,e),a(i.current,e),a(n.current,e),a(s.current,e),o.current.forEach(l=>{e&&!r.stage.children.includes(l)?r.stage.addChild(l):!e&&r.stage.children.includes(l)&&r.stage.removeChild(l)})}async function yk({width:r,height:e,startAtPercent:t,setRaceReady:i,setCanGenerate:n}){try{await fetch("/api/admin/start",{method:"POST",headers:{"Content-Type":"application/json","x-admin-pass":"6a2e8819c6fb4c15"},body:JSON.stringify({startAtPercent:t,width:r,height:e})})}catch(s){console.error("[KD]  Error triggering race:",s)}}const vk=9e-5;function nf({app:r,horseSprites:e,horsePaths:t,labelSprites:i,finishedHorses:n,horses:s,onRaceEnd:o,speedMultiplier:a=1}){const l=new Set,u=[];let h=!1;const d=new Map,c=new Map,f=new Map;console.log("[KD]  Starting race via playRace"),console.log("[KD]  Horses in race:",[...e.keys()]),r.__raceTicker&&(r.ticker.remove(r.__raceTicker),r.__raceTicker=null);const p=v=>{const x=performance.now(),g=Array.from(e.values()).map(m=>m.__progress||0),y=g.sort()[Math.floor(g.length/2)];e.forEach((m,_)=>{var Ho;const w=t[_];if(!(w!=null&&w.path)||w.path.length<2||n.has(_))return;const S=w.path,E=w.speedMap||[],T=(Ho=w.debug)==null?void 0:Ho.finishIndex;if(T==null)return;if(!m.__started){m.__started=!0,m.__progress=.001;const ve=S[0],Bt=S[1];m.position.set(ve.x,ve.y),m.__rotation=Math.atan2(Bt.y-ve.y,Bt.x-ve.x),m.rotation=m.__rotation;const Er=i.get(_);Er&&Er.position.set(ve.x,ve.y);const lt={base:1+(Math.random()*.1-.05),variance:.15+Math.random()*.1,burstChance:.002+Math.random()*.002,fatigueChance:.002+Math.random()*.002,burstMultiplier:1.3,fatigueMultiplier:.7,curveHandling:.7+Math.random()*.6,rotationResponsiveness:1+Math.random()*.5,stamina:100+Math.random()*50,fatigueLevel:0,fatigueRecoveryRate:1+Math.random()};d.set(_,lt),c.set(_,{burst:0,fatigue:0}),f.set(_,[]);return}const b=d.get(_),A=c.get(_),I=Math.floor(m.__progress*S.length),D=E[I]??1;if(A.burst<=0&&A.fatigue<=0){const ve=Math.random();ve<b.burstChance&&b.stamina>40?A.burst=20+Math.floor(Math.random()*20):ve<b.burstChance+b.fatigueChance&&b.stamina<60&&(A.fatigue=20+Math.floor(Math.random()*20))}let C=b.base,k=!1,L=!1;A.burst>0?(C*=b.burstMultiplier,A.burst--,k=!0,b.stamina-=2):A.fatigue>0?(C*=b.fatigueMultiplier,A.fatigue--,L=!0,b.stamina+=b.fatigueRecoveryRate):b.stamina=Math.max(0,Math.min(120,b.stamina+b.fatigueRecoveryRate));let Y=1;if(I>0&&I<S.length-2){const ve=S[I-1],Bt=S[I],Er=S[I+1],lt=Math.atan2(Bt.y-ve.y,Bt.x-ve.x),gs=Math.atan2(Er.y-Bt.y,Er.x-Bt.x);let $o=Math.abs(gs-lt);$o>Math.PI&&($o=Math.abs($o-2*Math.PI)),Y=1+$o/Math.PI*.04}const $=m.__progress-y;let P=1;$>.05?P=.98:$<-.05&&(P=1.02);const G=(Math.random()*2-1)*b.variance,R=vk*C*D*Y*P*(1+G);m.__progress+=R*v*a;const M=Math.floor(m.__progress*S.length),j=Math.min(M,S.length-2),Q=S[j],J=S[j+1],fe=m.__progress*S.length-j,oe=Q.x+(J.x-Q.x)*fe,he=Q.y+(J.y-Q.y)*fe;if(!l.has(_)&&I>=T){l.add(_),n.add(_);const ve=s.find(lt=>lt.id===_),Bt=(ve==null?void 0:ve.name)??"Unknown",Er=(ve==null?void 0:ve.id)??_;console.log(`[KD]  Finished: ${Bt} ID: ${Er}, localId=${_}`),h||(console.log(`[KD]  Winner: ${Bt} ID: ${Er}, localId=${_}`),h=!0),u.push({name:Bt,dbId:Er,localId:_,frames:f.get(_)}),l.size===s.length&&(console.log("[KD]  All horses finished!"),u.forEach((lt,gs)=>{console.log(`[KD] ${gs+1}st: ${lt.name} ID: ${lt.dbId}, localId=${lt.localId}`)}),typeof nf.onReplayReady=="function"&&nf.onReplayReady({horses:u.map((lt,gs)=>({place:gs+1,name:lt.name,dbId:lt.dbId,localId:lt.localId,frames:lt.frames}))}),typeof o=="function"&&setTimeout(()=>o(),100))}m.position.set(oe,he);const De=J.x-Q.x,We=J.y-Q.y;if(Math.sqrt(De*De+We*We)<.01)return;const ce=Math.atan2(We,De);let we=m.__rotation??0,le=ce-we;for(;le>Math.PI;)le-=2*Math.PI;for(;le<-Math.PI;)le+=2*Math.PI;const St=R*1500*b.rotationResponsiveness,mt=Math.min(.2,Math.max(.005,St));le=Math.max(-mt,Math.min(mt,le)),m.__rotation=we+le,m.rotation=m.__rotation;const Xr=i.get(_);Xr&&Xr.position.set(oe,he),f.get(_).push({pct:m.__progress,timeMs:x,speed:R,fatigue:b.stamina,isBursting:k,isFatigued:L})})};r.ticker.add(p),r.__raceTicker=p}function _k({appRef:r,horsesRef:e,horsePathsRef:t,horseSpritesRef:i,labelSpritesRef:n,finishedHorsesRef:s,debugPathLinesRef:o,finishDotsRef:a,setRaceReady:l,setCanGenerate:u,speedMultiplier:h}){const d=r.current;if(!d||!e.current.length){console.warn("[KD]  No app or horses available to start race");return}if(!e.current.every(f=>{var p,v;return((v=(p=t.current[f.id])==null?void 0:p.path)==null?void 0:v.length)>1})){console.warn("[KD]  Some horses are missing path data  race not started.");return}l(!1),nf({app:d,horseSprites:i.current,horsePaths:t.current,labelSprites:n.current,finishedHorses:s.current,horses:e.current,onRaceEnd:()=>u(!0),speedMultiplier:h})}function ms(r){let e=r.length;for(;--e>=0;)r[e]=0}const xk=3,wk=258,E1=29,Ek=256,Tk=Ek+1+E1,T1=30,Sk=512,Ak=new Array((Tk+2)*2);ms(Ak);const bk=new Array(T1*2);ms(bk);const Ck=new Array(Sk);ms(Ck);const Rk=new Array(wk-xk+1);ms(Rk);const Ik=new Array(E1);ms(Ik);const Pk=new Array(T1);ms(Pk);const kk=(r,e,t,i)=>{let n=r&65535|0,s=r>>>16&65535|0,o=0;for(;t!==0;){o=t>2e3?2e3:t,t-=o;do n=n+e[i++]|0,s=s+n|0;while(--o);n%=65521,s%=65521}return n|s<<16|0};var sf=kk;const Mk=()=>{let r,e=[];for(var t=0;t<256;t++){r=t;for(var i=0;i<8;i++)r=r&1?3988292384^r>>>1:r>>>1;e[t]=r}return e},Dk=new Uint32Array(Mk()),Nk=(r,e,t,i)=>{const n=Dk,s=i+t;r^=-1;for(let o=i;o<s;o++)r=r>>>8^n[(r^e[o])&255];return r^-1};var rr=Nk,of={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},S1={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const Ok=(r,e)=>Object.prototype.hasOwnProperty.call(r,e);var Bk=function(r){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const t=e.shift();if(t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(const i in t)Ok(t,i)&&(r[i]=t[i])}}return r},Lk=r=>{let e=0;for(let i=0,n=r.length;i<n;i++)e+=r[i].length;const t=new Uint8Array(e);for(let i=0,n=0,s=r.length;i<s;i++){let o=r[i];t.set(o,n),n+=o.length}return t},A1={assign:Bk,flattenChunks:Lk};let b1=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{b1=!1}const Ro=new Uint8Array(256);for(let r=0;r<256;r++)Ro[r]=r>=252?6:r>=248?5:r>=240?4:r>=224?3:r>=192?2:1;Ro[254]=Ro[254]=1;var Fk=r=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(r);let e,t,i,n,s,o=r.length,a=0;for(n=0;n<o;n++)t=r.charCodeAt(n),(t&64512)===55296&&n+1<o&&(i=r.charCodeAt(n+1),(i&64512)===56320&&(t=65536+(t-55296<<10)+(i-56320),n++)),a+=t<128?1:t<2048?2:t<65536?3:4;for(e=new Uint8Array(a),s=0,n=0;s<a;n++)t=r.charCodeAt(n),(t&64512)===55296&&n+1<o&&(i=r.charCodeAt(n+1),(i&64512)===56320&&(t=65536+(t-55296<<10)+(i-56320),n++)),t<128?e[s++]=t:t<2048?(e[s++]=192|t>>>6,e[s++]=128|t&63):t<65536?(e[s++]=224|t>>>12,e[s++]=128|t>>>6&63,e[s++]=128|t&63):(e[s++]=240|t>>>18,e[s++]=128|t>>>12&63,e[s++]=128|t>>>6&63,e[s++]=128|t&63);return e};const Uk=(r,e)=>{if(e<65534&&r.subarray&&b1)return String.fromCharCode.apply(null,r.length===e?r:r.subarray(0,e));let t="";for(let i=0;i<e;i++)t+=String.fromCharCode(r[i]);return t};var Gk=(r,e)=>{const t=e||r.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(r.subarray(0,e));let i,n;const s=new Array(t*2);for(n=0,i=0;i<t;){let o=r[i++];if(o<128){s[n++]=o;continue}let a=Ro[o];if(a>4){s[n++]=65533,i+=a-1;continue}for(o&=a===2?31:a===3?15:7;a>1&&i<t;)o=o<<6|r[i++]&63,a--;if(a>1){s[n++]=65533;continue}o<65536?s[n++]=o:(o-=65536,s[n++]=55296|o>>10&1023,s[n++]=56320|o&1023)}return Uk(s,n)},Hk=(r,e)=>{e=e||r.length,e>r.length&&(e=r.length);let t=e-1;for(;t>=0&&(r[t]&192)===128;)t--;return t<0||t===0?e:t+Ro[r[t]]>e?t:e},af={string2buf:Fk,buf2string:Gk,utf8border:Hk};function $k(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var zk=$k;const Ma=16209,Vk=16191;var Xk=function(e,t){let i,n,s,o,a,l,u,h,d,c,f,p,v,x,g,y,m,_,w,S,E,T,b,A;const I=e.state;i=e.next_in,b=e.input,n=i+(e.avail_in-5),s=e.next_out,A=e.output,o=s-(t-e.avail_out),a=s+(e.avail_out-257),l=I.dmax,u=I.wsize,h=I.whave,d=I.wnext,c=I.window,f=I.hold,p=I.bits,v=I.lencode,x=I.distcode,g=(1<<I.lenbits)-1,y=(1<<I.distbits)-1;e:do{p<15&&(f+=b[i++]<<p,p+=8,f+=b[i++]<<p,p+=8),m=v[f&g];t:for(;;){if(_=m>>>24,f>>>=_,p-=_,_=m>>>16&255,_===0)A[s++]=m&65535;else if(_&16){w=m&65535,_&=15,_&&(p<_&&(f+=b[i++]<<p,p+=8),w+=f&(1<<_)-1,f>>>=_,p-=_),p<15&&(f+=b[i++]<<p,p+=8,f+=b[i++]<<p,p+=8),m=x[f&y];r:for(;;){if(_=m>>>24,f>>>=_,p-=_,_=m>>>16&255,_&16){if(S=m&65535,_&=15,p<_&&(f+=b[i++]<<p,p+=8,p<_&&(f+=b[i++]<<p,p+=8)),S+=f&(1<<_)-1,S>l){e.msg="invalid distance too far back",I.mode=Ma;break e}if(f>>>=_,p-=_,_=s-o,S>_){if(_=S-_,_>h&&I.sane){e.msg="invalid distance too far back",I.mode=Ma;break e}if(E=0,T=c,d===0){if(E+=u-_,_<w){w-=_;do A[s++]=c[E++];while(--_);E=s-S,T=A}}else if(d<_){if(E+=u+d-_,_-=d,_<w){w-=_;do A[s++]=c[E++];while(--_);if(E=0,d<w){_=d,w-=_;do A[s++]=c[E++];while(--_);E=s-S,T=A}}}else if(E+=d-_,_<w){w-=_;do A[s++]=c[E++];while(--_);E=s-S,T=A}for(;w>2;)A[s++]=T[E++],A[s++]=T[E++],A[s++]=T[E++],w-=3;w&&(A[s++]=T[E++],w>1&&(A[s++]=T[E++]))}else{E=s-S;do A[s++]=A[E++],A[s++]=A[E++],A[s++]=A[E++],w-=3;while(w>2);w&&(A[s++]=A[E++],w>1&&(A[s++]=A[E++]))}}else if(_&64){e.msg="invalid distance code",I.mode=Ma;break e}else{m=x[(m&65535)+(f&(1<<_)-1)];continue r}break}}else if(_&64)if(_&32){I.mode=Vk;break e}else{e.msg="invalid literal/length code",I.mode=Ma;break e}else{m=v[(m&65535)+(f&(1<<_)-1)];continue t}break}}while(i<n&&s<a);w=p>>3,i-=w,p-=w<<3,f&=(1<<p)-1,e.next_in=i,e.next_out=s,e.avail_in=i<n?5+(n-i):5-(i-n),e.avail_out=s<a?257+(a-s):257-(s-a),I.hold=f,I.bits=p};const yn=15,by=852,Cy=592,Ry=0,ec=1,Iy=2,jk=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Wk=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Yk=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),qk=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Kk=(r,e,t,i,n,s,o,a)=>{const l=a.bits;let u=0,h=0,d=0,c=0,f=0,p=0,v=0,x=0,g=0,y=0,m,_,w,S,E,T=null,b;const A=new Uint16Array(yn+1),I=new Uint16Array(yn+1);let D=null,C,k,L;for(u=0;u<=yn;u++)A[u]=0;for(h=0;h<i;h++)A[e[t+h]]++;for(f=l,c=yn;c>=1&&A[c]===0;c--);if(f>c&&(f=c),c===0)return n[s++]=1<<24|64<<16|0,n[s++]=1<<24|64<<16|0,a.bits=1,0;for(d=1;d<c&&A[d]===0;d++);for(f<d&&(f=d),x=1,u=1;u<=yn;u++)if(x<<=1,x-=A[u],x<0)return-1;if(x>0&&(r===Ry||c!==1))return-1;for(I[1]=0,u=1;u<yn;u++)I[u+1]=I[u]+A[u];for(h=0;h<i;h++)e[t+h]!==0&&(o[I[e[t+h]]++]=h);if(r===Ry?(T=D=o,b=20):r===ec?(T=jk,D=Wk,b=257):(T=Yk,D=qk,b=0),y=0,h=0,u=d,E=s,p=f,v=0,w=-1,g=1<<f,S=g-1,r===ec&&g>by||r===Iy&&g>Cy)return 1;for(;;){C=u-v,o[h]+1<b?(k=0,L=o[h]):o[h]>=b?(k=D[o[h]-b],L=T[o[h]-b]):(k=96,L=0),m=1<<u-v,_=1<<p,d=_;do _-=m,n[E+(y>>v)+_]=C<<24|k<<16|L|0;while(_!==0);for(m=1<<u-1;y&m;)m>>=1;if(m!==0?(y&=m-1,y+=m):y=0,h++,--A[u]===0){if(u===c)break;u=e[t+o[h]]}if(u>f&&(y&S)!==w){for(v===0&&(v=f),E+=d,p=u-v,x=1<<p;p+v<c&&(x-=A[p+v],!(x<=0));)p++,x<<=1;if(g+=1<<p,r===ec&&g>by||r===Iy&&g>Cy)return 1;w=y&S,n[w]=f<<24|p<<16|E-s|0}}return y!==0&&(n[E+y]=u-v<<24|64<<16|0),a.bits=f,0};var no=Kk;const Zk=0,C1=1,R1=2,{Z_FINISH:Py,Z_BLOCK:Qk,Z_TREES:Da,Z_OK:nn,Z_STREAM_END:Jk,Z_NEED_DICT:eM,Z_STREAM_ERROR:Ot,Z_DATA_ERROR:I1,Z_MEM_ERROR:P1,Z_BUF_ERROR:tM,Z_DEFLATED:ky}=S1,ku=16180,My=16181,Dy=16182,Ny=16183,Oy=16184,By=16185,Ly=16186,Fy=16187,Uy=16188,Gy=16189,Ql=16190,Ar=16191,tc=16192,Hy=16193,rc=16194,$y=16195,zy=16196,Vy=16197,Xy=16198,Na=16199,Oa=16200,jy=16201,Wy=16202,Yy=16203,qy=16204,Ky=16205,ic=16206,Zy=16207,Qy=16208,_e=16209,k1=16210,M1=16211,rM=852,iM=592,nM=15,sM=nM,Jy=r=>(r>>>24&255)+(r>>>8&65280)+((r&65280)<<8)+((r&255)<<24);function oM(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const hn=r=>{if(!r)return 1;const e=r.state;return!e||e.strm!==r||e.mode<ku||e.mode>M1?1:0},D1=r=>{if(hn(r))return Ot;const e=r.state;return r.total_in=r.total_out=e.total=0,r.msg="",e.wrap&&(r.adler=e.wrap&1),e.mode=ku,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(rM),e.distcode=e.distdyn=new Int32Array(iM),e.sane=1,e.back=-1,nn},N1=r=>{if(hn(r))return Ot;const e=r.state;return e.wsize=0,e.whave=0,e.wnext=0,D1(r)},O1=(r,e)=>{let t;if(hn(r))return Ot;const i=r.state;return e<0?(t=0,e=-e):(t=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?Ot:(i.window!==null&&i.wbits!==e&&(i.window=null),i.wrap=t,i.wbits=e,N1(r))},B1=(r,e)=>{if(!r)return Ot;const t=new oM;r.state=t,t.strm=r,t.window=null,t.mode=ku;const i=O1(r,e);return i!==nn&&(r.state=null),i},aM=r=>B1(r,sM);let e0=!0,nc,sc;const lM=r=>{if(e0){nc=new Int32Array(512),sc=new Int32Array(32);let e=0;for(;e<144;)r.lens[e++]=8;for(;e<256;)r.lens[e++]=9;for(;e<280;)r.lens[e++]=7;for(;e<288;)r.lens[e++]=8;for(no(C1,r.lens,0,288,nc,0,r.work,{bits:9}),e=0;e<32;)r.lens[e++]=5;no(R1,r.lens,0,32,sc,0,r.work,{bits:5}),e0=!1}r.lencode=nc,r.lenbits=9,r.distcode=sc,r.distbits=5},L1=(r,e,t,i)=>{let n;const s=r.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),i>=s.wsize?(s.window.set(e.subarray(t-s.wsize,t),0),s.wnext=0,s.whave=s.wsize):(n=s.wsize-s.wnext,n>i&&(n=i),s.window.set(e.subarray(t-i,t-i+n),s.wnext),i-=n,i?(s.window.set(e.subarray(t-i,t),0),s.wnext=i,s.whave=s.wsize):(s.wnext+=n,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=n))),0},uM=(r,e)=>{let t,i,n,s,o,a,l,u,h,d,c,f,p,v,x=0,g,y,m,_,w,S,E,T;const b=new Uint8Array(4);let A,I;const D=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(hn(r)||!r.output||!r.input&&r.avail_in!==0)return Ot;t=r.state,t.mode===Ar&&(t.mode=tc),o=r.next_out,n=r.output,l=r.avail_out,s=r.next_in,i=r.input,a=r.avail_in,u=t.hold,h=t.bits,d=a,c=l,T=nn;e:for(;;)switch(t.mode){case ku:if(t.wrap===0){t.mode=tc;break}for(;h<16;){if(a===0)break e;a--,u+=i[s++]<<h,h+=8}if(t.wrap&2&&u===35615){t.wbits===0&&(t.wbits=15),t.check=0,b[0]=u&255,b[1]=u>>>8&255,t.check=rr(t.check,b,2,0),u=0,h=0,t.mode=My;break}if(t.head&&(t.head.done=!1),!(t.wrap&1)||(((u&255)<<8)+(u>>8))%31){r.msg="incorrect header check",t.mode=_e;break}if((u&15)!==ky){r.msg="unknown compression method",t.mode=_e;break}if(u>>>=4,h-=4,E=(u&15)+8,t.wbits===0&&(t.wbits=E),E>15||E>t.wbits){r.msg="invalid window size",t.mode=_e;break}t.dmax=1<<t.wbits,t.flags=0,r.adler=t.check=1,t.mode=u&512?Gy:Ar,u=0,h=0;break;case My:for(;h<16;){if(a===0)break e;a--,u+=i[s++]<<h,h+=8}if(t.flags=u,(t.flags&255)!==ky){r.msg="unknown compression method",t.mode=_e;break}if(t.flags&57344){r.msg="unknown header flags set",t.mode=_e;break}t.head&&(t.head.text=u>>8&1),t.flags&512&&t.wrap&4&&(b[0]=u&255,b[1]=u>>>8&255,t.check=rr(t.check,b,2,0)),u=0,h=0,t.mode=Dy;case Dy:for(;h<32;){if(a===0)break e;a--,u+=i[s++]<<h,h+=8}t.head&&(t.head.time=u),t.flags&512&&t.wrap&4&&(b[0]=u&255,b[1]=u>>>8&255,b[2]=u>>>16&255,b[3]=u>>>24&255,t.check=rr(t.check,b,4,0)),u=0,h=0,t.mode=Ny;case Ny:for(;h<16;){if(a===0)break e;a--,u+=i[s++]<<h,h+=8}t.head&&(t.head.xflags=u&255,t.head.os=u>>8),t.flags&512&&t.wrap&4&&(b[0]=u&255,b[1]=u>>>8&255,t.check=rr(t.check,b,2,0)),u=0,h=0,t.mode=Oy;case Oy:if(t.flags&1024){for(;h<16;){if(a===0)break e;a--,u+=i[s++]<<h,h+=8}t.length=u,t.head&&(t.head.extra_len=u),t.flags&512&&t.wrap&4&&(b[0]=u&255,b[1]=u>>>8&255,t.check=rr(t.check,b,2,0)),u=0,h=0}else t.head&&(t.head.extra=null);t.mode=By;case By:if(t.flags&1024&&(f=t.length,f>a&&(f=a),f&&(t.head&&(E=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(i.subarray(s,s+f),E)),t.flags&512&&t.wrap&4&&(t.check=rr(t.check,i,f,s)),a-=f,s+=f,t.length-=f),t.length))break e;t.length=0,t.mode=Ly;case Ly:if(t.flags&2048){if(a===0)break e;f=0;do E=i[s+f++],t.head&&E&&t.length<65536&&(t.head.name+=String.fromCharCode(E));while(E&&f<a);if(t.flags&512&&t.wrap&4&&(t.check=rr(t.check,i,f,s)),a-=f,s+=f,E)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=Fy;case Fy:if(t.flags&4096){if(a===0)break e;f=0;do E=i[s+f++],t.head&&E&&t.length<65536&&(t.head.comment+=String.fromCharCode(E));while(E&&f<a);if(t.flags&512&&t.wrap&4&&(t.check=rr(t.check,i,f,s)),a-=f,s+=f,E)break e}else t.head&&(t.head.comment=null);t.mode=Uy;case Uy:if(t.flags&512){for(;h<16;){if(a===0)break e;a--,u+=i[s++]<<h,h+=8}if(t.wrap&4&&u!==(t.check&65535)){r.msg="header crc mismatch",t.mode=_e;break}u=0,h=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),r.adler=t.check=0,t.mode=Ar;break;case Gy:for(;h<32;){if(a===0)break e;a--,u+=i[s++]<<h,h+=8}r.adler=t.check=Jy(u),u=0,h=0,t.mode=Ql;case Ql:if(t.havedict===0)return r.next_out=o,r.avail_out=l,r.next_in=s,r.avail_in=a,t.hold=u,t.bits=h,eM;r.adler=t.check=1,t.mode=Ar;case Ar:if(e===Qk||e===Da)break e;case tc:if(t.last){u>>>=h&7,h-=h&7,t.mode=ic;break}for(;h<3;){if(a===0)break e;a--,u+=i[s++]<<h,h+=8}switch(t.last=u&1,u>>>=1,h-=1,u&3){case 0:t.mode=Hy;break;case 1:if(lM(t),t.mode=Na,e===Da){u>>>=2,h-=2;break e}break;case 2:t.mode=zy;break;case 3:r.msg="invalid block type",t.mode=_e}u>>>=2,h-=2;break;case Hy:for(u>>>=h&7,h-=h&7;h<32;){if(a===0)break e;a--,u+=i[s++]<<h,h+=8}if((u&65535)!==(u>>>16^65535)){r.msg="invalid stored block lengths",t.mode=_e;break}if(t.length=u&65535,u=0,h=0,t.mode=rc,e===Da)break e;case rc:t.mode=$y;case $y:if(f=t.length,f){if(f>a&&(f=a),f>l&&(f=l),f===0)break e;n.set(i.subarray(s,s+f),o),a-=f,s+=f,l-=f,o+=f,t.length-=f;break}t.mode=Ar;break;case zy:for(;h<14;){if(a===0)break e;a--,u+=i[s++]<<h,h+=8}if(t.nlen=(u&31)+257,u>>>=5,h-=5,t.ndist=(u&31)+1,u>>>=5,h-=5,t.ncode=(u&15)+4,u>>>=4,h-=4,t.nlen>286||t.ndist>30){r.msg="too many length or distance symbols",t.mode=_e;break}t.have=0,t.mode=Vy;case Vy:for(;t.have<t.ncode;){for(;h<3;){if(a===0)break e;a--,u+=i[s++]<<h,h+=8}t.lens[D[t.have++]]=u&7,u>>>=3,h-=3}for(;t.have<19;)t.lens[D[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,A={bits:t.lenbits},T=no(Zk,t.lens,0,19,t.lencode,0,t.work,A),t.lenbits=A.bits,T){r.msg="invalid code lengths set",t.mode=_e;break}t.have=0,t.mode=Xy;case Xy:for(;t.have<t.nlen+t.ndist;){for(;x=t.lencode[u&(1<<t.lenbits)-1],g=x>>>24,y=x>>>16&255,m=x&65535,!(g<=h);){if(a===0)break e;a--,u+=i[s++]<<h,h+=8}if(m<16)u>>>=g,h-=g,t.lens[t.have++]=m;else{if(m===16){for(I=g+2;h<I;){if(a===0)break e;a--,u+=i[s++]<<h,h+=8}if(u>>>=g,h-=g,t.have===0){r.msg="invalid bit length repeat",t.mode=_e;break}E=t.lens[t.have-1],f=3+(u&3),u>>>=2,h-=2}else if(m===17){for(I=g+3;h<I;){if(a===0)break e;a--,u+=i[s++]<<h,h+=8}u>>>=g,h-=g,E=0,f=3+(u&7),u>>>=3,h-=3}else{for(I=g+7;h<I;){if(a===0)break e;a--,u+=i[s++]<<h,h+=8}u>>>=g,h-=g,E=0,f=11+(u&127),u>>>=7,h-=7}if(t.have+f>t.nlen+t.ndist){r.msg="invalid bit length repeat",t.mode=_e;break}for(;f--;)t.lens[t.have++]=E}}if(t.mode===_e)break;if(t.lens[256]===0){r.msg="invalid code -- missing end-of-block",t.mode=_e;break}if(t.lenbits=9,A={bits:t.lenbits},T=no(C1,t.lens,0,t.nlen,t.lencode,0,t.work,A),t.lenbits=A.bits,T){r.msg="invalid literal/lengths set",t.mode=_e;break}if(t.distbits=6,t.distcode=t.distdyn,A={bits:t.distbits},T=no(R1,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,A),t.distbits=A.bits,T){r.msg="invalid distances set",t.mode=_e;break}if(t.mode=Na,e===Da)break e;case Na:t.mode=Oa;case Oa:if(a>=6&&l>=258){r.next_out=o,r.avail_out=l,r.next_in=s,r.avail_in=a,t.hold=u,t.bits=h,Xk(r,c),o=r.next_out,n=r.output,l=r.avail_out,s=r.next_in,i=r.input,a=r.avail_in,u=t.hold,h=t.bits,t.mode===Ar&&(t.back=-1);break}for(t.back=0;x=t.lencode[u&(1<<t.lenbits)-1],g=x>>>24,y=x>>>16&255,m=x&65535,!(g<=h);){if(a===0)break e;a--,u+=i[s++]<<h,h+=8}if(y&&!(y&240)){for(_=g,w=y,S=m;x=t.lencode[S+((u&(1<<_+w)-1)>>_)],g=x>>>24,y=x>>>16&255,m=x&65535,!(_+g<=h);){if(a===0)break e;a--,u+=i[s++]<<h,h+=8}u>>>=_,h-=_,t.back+=_}if(u>>>=g,h-=g,t.back+=g,t.length=m,y===0){t.mode=Ky;break}if(y&32){t.back=-1,t.mode=Ar;break}if(y&64){r.msg="invalid literal/length code",t.mode=_e;break}t.extra=y&15,t.mode=jy;case jy:if(t.extra){for(I=t.extra;h<I;){if(a===0)break e;a--,u+=i[s++]<<h,h+=8}t.length+=u&(1<<t.extra)-1,u>>>=t.extra,h-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=Wy;case Wy:for(;x=t.distcode[u&(1<<t.distbits)-1],g=x>>>24,y=x>>>16&255,m=x&65535,!(g<=h);){if(a===0)break e;a--,u+=i[s++]<<h,h+=8}if(!(y&240)){for(_=g,w=y,S=m;x=t.distcode[S+((u&(1<<_+w)-1)>>_)],g=x>>>24,y=x>>>16&255,m=x&65535,!(_+g<=h);){if(a===0)break e;a--,u+=i[s++]<<h,h+=8}u>>>=_,h-=_,t.back+=_}if(u>>>=g,h-=g,t.back+=g,y&64){r.msg="invalid distance code",t.mode=_e;break}t.offset=m,t.extra=y&15,t.mode=Yy;case Yy:if(t.extra){for(I=t.extra;h<I;){if(a===0)break e;a--,u+=i[s++]<<h,h+=8}t.offset+=u&(1<<t.extra)-1,u>>>=t.extra,h-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){r.msg="invalid distance too far back",t.mode=_e;break}t.mode=qy;case qy:if(l===0)break e;if(f=c-l,t.offset>f){if(f=t.offset-f,f>t.whave&&t.sane){r.msg="invalid distance too far back",t.mode=_e;break}f>t.wnext?(f-=t.wnext,p=t.wsize-f):p=t.wnext-f,f>t.length&&(f=t.length),v=t.window}else v=n,p=o-t.offset,f=t.length;f>l&&(f=l),l-=f,t.length-=f;do n[o++]=v[p++];while(--f);t.length===0&&(t.mode=Oa);break;case Ky:if(l===0)break e;n[o++]=t.length,l--,t.mode=Oa;break;case ic:if(t.wrap){for(;h<32;){if(a===0)break e;a--,u|=i[s++]<<h,h+=8}if(c-=l,r.total_out+=c,t.total+=c,t.wrap&4&&c&&(r.adler=t.check=t.flags?rr(t.check,n,c,o-c):sf(t.check,n,c,o-c)),c=l,t.wrap&4&&(t.flags?u:Jy(u))!==t.check){r.msg="incorrect data check",t.mode=_e;break}u=0,h=0}t.mode=Zy;case Zy:if(t.wrap&&t.flags){for(;h<32;){if(a===0)break e;a--,u+=i[s++]<<h,h+=8}if(t.wrap&4&&u!==(t.total&4294967295)){r.msg="incorrect length check",t.mode=_e;break}u=0,h=0}t.mode=Qy;case Qy:T=Jk;break e;case _e:T=I1;break e;case k1:return P1;case M1:default:return Ot}return r.next_out=o,r.avail_out=l,r.next_in=s,r.avail_in=a,t.hold=u,t.bits=h,(t.wsize||c!==r.avail_out&&t.mode<_e&&(t.mode<ic||e!==Py))&&L1(r,r.output,r.next_out,c-r.avail_out),d-=r.avail_in,c-=r.avail_out,r.total_in+=d,r.total_out+=c,t.total+=c,t.wrap&4&&c&&(r.adler=t.check=t.flags?rr(t.check,n,c,r.next_out-c):sf(t.check,n,c,r.next_out-c)),r.data_type=t.bits+(t.last?64:0)+(t.mode===Ar?128:0)+(t.mode===Na||t.mode===rc?256:0),(d===0&&c===0||e===Py)&&T===nn&&(T=tM),T},hM=r=>{if(hn(r))return Ot;let e=r.state;return e.window&&(e.window=null),r.state=null,nn},cM=(r,e)=>{if(hn(r))return Ot;const t=r.state;return t.wrap&2?(t.head=e,e.done=!1,nn):Ot},dM=(r,e)=>{const t=e.length;let i,n,s;return hn(r)||(i=r.state,i.wrap!==0&&i.mode!==Ql)?Ot:i.mode===Ql&&(n=1,n=sf(n,e,t,0),n!==i.check)?I1:(s=L1(r,e,t,t),s?(i.mode=k1,P1):(i.havedict=1,nn))};var fM=N1,pM=O1,mM=D1,gM=aM,yM=B1,vM=uM,_M=hM,xM=cM,wM=dM,EM="pako inflate (from Nodeca project)",Ir={inflateReset:fM,inflateReset2:pM,inflateResetKeep:mM,inflateInit:gM,inflateInit2:yM,inflate:vM,inflateEnd:_M,inflateGetHeader:xM,inflateSetDictionary:wM,inflateInfo:EM};function TM(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var SM=TM;const F1=Object.prototype.toString,{Z_NO_FLUSH:AM,Z_FINISH:bM,Z_OK:Io,Z_STREAM_END:oc,Z_NEED_DICT:ac,Z_STREAM_ERROR:CM,Z_DATA_ERROR:t0,Z_MEM_ERROR:RM}=S1;function Mu(r){this.options=A1.assign({chunkSize:1024*64,windowBits:15,to:""},r||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(r&&r.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zk,this.strm.avail_out=0;let t=Ir.inflateInit2(this.strm,e.windowBits);if(t!==Io)throw new Error(of[t]);if(this.header=new SM,Ir.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=af.string2buf(e.dictionary):F1.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(t=Ir.inflateSetDictionary(this.strm,e.dictionary),t!==Io)))throw new Error(of[t])}Mu.prototype.push=function(r,e){const t=this.strm,i=this.options.chunkSize,n=this.options.dictionary;let s,o,a;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?bM:AM,F1.call(r)==="[object ArrayBuffer]"?t.input=new Uint8Array(r):t.input=r,t.next_in=0,t.avail_in=t.input.length;;){for(t.avail_out===0&&(t.output=new Uint8Array(i),t.next_out=0,t.avail_out=i),s=Ir.inflate(t,o),s===ac&&n&&(s=Ir.inflateSetDictionary(t,n),s===Io?s=Ir.inflate(t,o):s===t0&&(s=ac));t.avail_in>0&&s===oc&&t.state.wrap>0&&r[t.next_in]!==0;)Ir.inflateReset(t),s=Ir.inflate(t,o);switch(s){case CM:case t0:case ac:case RM:return this.onEnd(s),this.ended=!0,!1}if(a=t.avail_out,t.next_out&&(t.avail_out===0||s===oc))if(this.options.to==="string"){let l=af.utf8border(t.output,t.next_out),u=t.next_out-l,h=af.buf2string(t.output,l);t.next_out=u,t.avail_out=i-u,u&&t.output.set(t.output.subarray(l,l+u),0),this.onData(h)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(!(s===Io&&a===0)){if(s===oc)return s=Ir.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(t.avail_in===0)break}}return!0};Mu.prototype.onData=function(r){this.chunks.push(r)};Mu.prototype.onEnd=function(r){r===Io&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=A1.flattenChunks(this.chunks)),this.chunks=[],this.err=r,this.msg=this.strm.msg};function IM(r,e){const t=new Mu(e);if(t.push(r),t.err)throw t.msg||of[t.err];return t.result}var PM=IM,kM={inflate:PM};const{inflate:MM}=kM;var DM=MM;const NM={red:"#ff0000",blue:"#0000ff",green:"#00ff00",yellow:"#ffff00",purple:"#800080",orange:"#ffa500",pink:"#ffc0cb",gray:"#808080",teal:"#008080",navy:"#000080",lime:"#00ff00",cyan:"#00ffff",maroon:"#800000",olive:"#808000",beige:"#f5f5dc",white:"#ffffff",indigo:"#4b0082",aqua:"#00ffff",tan:"#d2b48c",charcoal:"#36454f",silver:"#c0c0c0"};function U1(r,e=null){if(typeof r!="string")return console.warn(`[KD]  Invalid color type for horse ${e??"unknown"}:`,r),16711935;const t=r.trim().toLowerCase(),i=NM[t];if(i){const n=parseInt(i.slice(1),16);return console.log(`[KD]  Parsed hex for horse ${e}: ${t}  ${i}`),n}return console.warn(`[KD]  Unknown color string for horse ${e??"unknown"}:`,r),16711935}function OM(r,e=null,t=null){const i=U1(r,e),n=typeof i=="number"&&i>=0&&i<=16777215,s=n?i:16711935;s.toString(16).padStart(6,"0"),n||console.warn(`[KD]  Invalid color value for horse ${e??"unknown"}:`,r);const o=20,a=new wi;if(a.beginFill(s),a.drawPolygon([o/2,0,-20/2,o/2,-20/2,-20/2]),a.endFill(),!t||!t.renderer||typeof t.renderer.generateTexture!="function")return console.error(`[KD]  App instance or renderer not available  cannot generate texture for horse ${e}`),new xi;const l=t.renderer.generateTexture(a),u=new xi(l);return u.anchor.set(.5),u}function BM({app:r,horses:e,debugVisible:t,horseSpritesRef:i,labelSpritesRef:n,debugDotsRef:s,debugPathLinesRef:o,finishDotsRef:a,startDotsRef:l,horsePathsRef:u}){e.forEach(h=>{var I,D;const{id:d,path:c,startPoint:f,placement:p,color:v}=h,x=OM(v,d,r);(D=(I=x.anchor)==null?void 0:I.set)==null||D.call(I,.5),x.zIndex=5,x.__progress=0;const g=c[1].x-c[0].x,y=c[1].y-c[0].y,m=Math.sqrt(g**2+y**2),_=g/m,w=y/m,S=f.x+_*(x.width/2),E=f.y+w*(x.height/2);x.position.set(S,E),x.rotation=Math.atan2(y,g),r.stage.addChild(x),i.current.set(d,x);const T=new _p(`${p}`,{fontSize:12,fill:16777215,stroke:0,strokeThickness:2});T.anchor.set(.5),T.position.set(S,E),T.zIndex=6,n.current.set(d,T),t&&r.stage.addChild(T);const b=new wi;b.beginFill(65280).drawCircle(0,0,4).endFill(),b.zIndex=99,b.position.set(S,E),l.current.push(b),t&&r.stage.addChild(b);const A=new wi;A.lineStyle(1,U1(v,d)),A.moveTo(c[0].x,c[0].y);for(let C=1;C<c.length-1;C++){const k=c[C],L=c[C+1],Y=(k.x+L.x)/2,$=(k.y+L.y)/2;A.quadraticCurveTo(k.x,k.y,Y,$)}A.lineTo(c.at(-1).x,c.at(-1).y),A.zIndex=1,o.current.push(A),t&&r.stage.addChild(A),u.current[d]=h})}function LM(...r){console.info("[KD]",...r)}function FM(r){const{socket:e,appRef:t,horseSpritesRef:i,labelSpritesRef:n,debugDotsRef:s,debugPathLinesRef:o,finishDotsRef:a,startDotsRef:l,horsePathsRef:u,horsesRef:h,setRaceReady:d,setCanGenerate:c,debugVisible:f}=r;e.on("race:init",p=>{const v=DM(new Uint8Array(p),{to:"string"}),x=JSON.parse(v),g=t.current;g.__raceTicker&&(LM("[KD]  Clearing old ticker before loading new horses"),g.ticker.remove(g.__raceTicker),g.__raceTicker=null),BM({app:g,horses:x.horses,debugVisible:f,horseSpritesRef:i,labelSpritesRef:n,debugDotsRef:s,debugPathLinesRef:o,finishDotsRef:a,startDotsRef:l,horsePathsRef:u}),h.current=x.horses,d(!0),c(!1)})}function UM({replays:r,onReplaySelect:e}){const[t,i]=ue.useState(!1),n=s=>{const o=new Date(s),a={hour:"numeric",minute:"numeric",hour12:!0};return`${String(o.getMonth()+1).padStart(2,"0")}-${String(o.getDate()).padStart(2,"0")} ${o.toLocaleTimeString("en-US",a)}`};return Pe.jsxs("div",{className:"absolute top-2 right-2 bg-white/80 backdrop-blur-sm p-2 rounded-xl shadow-md z-20",children:[Pe.jsx("button",{onClick:()=>i(!t),className:"w-full px-3 py-1.5 bg-indigo-600 text-white text-sm rounded",children:t?"Hide Replays":"Show Replays"}),t&&Pe.jsx("ul",{className:"mt-2 max-h-64 overflow-y-auto w-56",children:r.map((s,o)=>Pe.jsxs("li",{className:"border-b py-1 px-2 hover:bg-gray-100 cursor-pointer text-sm",onClick:()=>e(s),children:["Race #",o+1,"  ",n(s.timestamp)]},s.timestamp))})]})}const GM="v1.5.1",HM=ll("/race",{path:"/api/socket.io"}),lc=800,r0=.55,lf=()=>{const r=ue.useRef(null),e=ue.useRef(null),t=ue.useRef(null),i=ue.useRef(new Map),n=ue.useRef(new Map),s=ue.useRef([]),o=ue.useRef([]),a=ue.useRef([]),l=ue.useRef([]),u=ue.useRef(null),h=ue.useRef({}),d=ue.useRef([]),c=ue.useRef(new Set);ue.useRef(new Set);const[f,p]=ue.useState(!1),[v,x]=ue.useState(!1),[g,y]=ue.useState(!0),[m,_]=ue.useState(1),[w,S]=ue.useState([]),[E,T]=ue.useState(null);ue.useEffect(()=>{const I=new Gx({view:e.current,backgroundColor:12251322,width:r.current.offsetWidth,height:lc,resolution:window.devicePixelRatio||1,autoDensity:!0});I.stage.sortableChildren=!0,t.current=I,fetch(`/api/track?startAtPercent=${r0}&width=${I.view.width}&height=${lc}`).then(D=>D.json()).then(D=>{u.current=D,mk(I,D)}),FM({socket:HM,appRef:t,horseSpritesRef:i,labelSpritesRef:n,debugDotsRef:s,debugPathLinesRef:o,finishDotsRef:a,startDotsRef:l,horsePathsRef:h,horsesRef:d,setRaceReady:x,setCanGenerate:y,debugVisible:f})},[]),ue.useEffect(()=>{gk({app:t.current,debugVisible:f,debugDotsRef:s,debugPathLinesRef:o,startDotsRef:l,finishDotsRef:a,labelSpritesRef:n})},[f]),ue.useEffect(()=>{!E||!t.current||gT(async()=>{const{playReplay:I}=await import("./playReplay-B1wy9DwZ.js");return{playReplay:I}},[],import.meta.url).then(({playReplay:I})=>{I({app:t.current,horseSprites:i.current,labelSprites:n.current,horsePaths:h.current,replayData:E.data})})},[E]);const b=()=>{yk({width:r.current.offsetWidth,height:lc,startAtPercent:r0,setRaceReady:x,setCanGenerate:y})},A=()=>{_k({appRef:t,horsesRef:d,horsePathsRef:h,horseSpritesRef:i,labelSpritesRef:n,finishedHorsesRef:c,debugPathLinesRef:o,finishDotsRef:a,setRaceReady:x,setCanGenerate:y,speedMultiplier:m}),typeof window<"u"&&window.playRace&&(window.playRace.onReplayReady=I=>{const D={timestamp:Date.now(),data:I};S(C=>[...C,D])})};return Pe.jsxs("div",{ref:r,className:"p-4 relative",children:[Pe.jsx("canvas",{ref:e,className:"block w-full h-[800px]"}),Pe.jsxs("div",{className:"mt-4 space-x-2",children:[Pe.jsx("button",{onClick:b,disabled:!g,className:"bg-blue-600 px-4 py-2 text-white rounded disabled:opacity-50",children:"Generate Horses"}),Pe.jsx("button",{onClick:A,disabled:!v,className:"bg-green-600 px-4 py-2 text-white rounded disabled:opacity-50",children:"Start Race"}),Pe.jsx("button",{onClick:()=>p(I=>!I),className:"bg-gray-600 px-4 py-2 text-white rounded",children:"Toggle Visuals"}),Pe.jsx("button",{onClick:()=>_(m===1?4:1),className:"bg-purple-600 px-4 py-2 text-white rounded",children:m===1?"Enable Test Speed":"Back to Live Speed"})]}),Pe.jsx(UM,{replays:w,onReplaySelect:I=>{console.log("[KD]  Playing saved replay",I),T(I)}})]})};lf.VERSION=GM;function $M(){return Pe.jsxs("div",{className:"min-h-screen bg-green-50 p-4",children:[Pe.jsxs("div",{className:"relative",children:[Pe.jsx("div",{className:"absolute top-2 right-4 text-right text-xs",children:Pe.jsxs("div",{className:"text-green-600",children:["Loaded: ",lf.VERSION]})}),Pe.jsx("h1",{className:"text-3xl font-bold text-center mb-2",children:" Welcome to the KD Race App"}),Pe.jsx("p",{className:"text-lg text-center mb-6",children:"Let the races begin!"})]}),Pe.jsx(lf,{})]})}uc.createRoot(document.getElementById("root")).render(Pe.jsx(rw.StrictMode,{children:Pe.jsx($M,{})}));
