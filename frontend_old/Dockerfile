# frontend/Dockerfile

# ğŸ§± Base image for building the React app
FROM node:20 AS builder

# ğŸ‘¤ Create non-root user for safety
RUN useradd -m media-apps
USER media-apps

# ğŸ“ Set working directory
WORKDIR /usr/src/app

# ğŸ“¦ Install dependencies first
COPY --chown=media-apps:media-apps package*.json ./
RUN npm install

# ğŸ§  Copy the full app after installing dependencies
COPY --chown=media-apps:media-apps . .

# âš™ï¸ Run React build (uses react-app-rewired and config-overrides.js)
RUN npm run build

# ğŸ—‚ï¸ Output location will be mounted by docker-compose, so we skip copying to nginx inside this Dockerfile
